window.__require=function t(e,o,i){function a(r,l){if(!o[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var s="function"==typeof __require&&__require;if(!l&&s)return s(c,!0);if(n)return n(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var u=o[r]={exports:{}};e[r][0].call(u.exports,function(t){return a(e[r][1][t]||t)},u,u.exports,t,e,o,i)}return o[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<i.length;r++)a(i[r]);return a}({action_point_recover_time_ui:[function(t,e,o){"use strict";cc._RF.push(e,"1b5e3SQp+xHFpWfKDYq1R8g","action_point_recover_time_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("local_currency"),u=a("currency_config"),d=a("gtime"),p=a("ggame"),f=a("local_action"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.recoverTimeLabel=null,t.updatePassTime1=.2,t}r(y,c=cc.Component),y.prototype.onLoad=function(){},y.prototype.onEnable=function(){},y.prototype.update=function(t){this.updatePassTime1+=t,.2<this.updatePassTime1&&(this.updatePassTime1=0,t=p.sGGame.localModel.getModule(f.LocalAction).remainRecoverTime(),this.recoverTimeLabel&&(this.recoverTimeLabel.string=d.sGTime.toTimeSpanString(t),t=p.sGGame.localModel.getModule(s.LocalCurrency).get(u.sCurrencyConfig.config.actionPoint),this.recoverTimeLabel.node.active=t<p.sGGame.localModel.getModule(f.LocalAction).getActionPointMax()))},y.prototype.onDisable=function(){},l([a(cc.Label)],y.prototype,"recoverTimeLabel",void 0),g=l([h,g("Game/UI/ActionPointRecoverTimeUI")],y),n.default=g,cc._RF.pop()},{}],ad_reward_collect_ui:[function(t,e,o){"use strict";cc._RF.push(e,"51dc3jDHLRLDIuTP5F5xYJz","ad_reward_collect_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var s,u=a("encourage_icon_ui"),d=a("vm_encourage"),p=a("audio_config"),f=a("scroll_decimal"),h=a("reward_helper"),g=a("decimal"),y=a("gaudio"),m=a("gnode"),b=a("ggame"),_=a("gview_model"),v=a("local_reward"),C=a("reason_define"),P=a("vm_reward"),S=a("encourage_close_button_ui");function G(){var t=null!==s&&s.apply(this,arguments)||this;return t.closeButton=null,t.confirmButton=null,t.adConfirmButton=null,t.numberLabel=null,t.iconNode=null,t.superIconNode=null,t.encourageIconUI=null,t.rewardList=new h.RewardList,t.encourageType=d.eEncourageType.closed,t.targetNum=new g.Decimal(0),t.displayNum=new g.Decimal(0),t.displayTimes=0,t.rewardMul=0,t}a=(n=cc._decorator).ccclass,n=n.property,l(G,s=cc.Component),G.prototype.onLoad=function(){var t=this;this.closeButton&&this.closeButton.node.on("click",function(){y.sGAudio.playEffect(p.sAudioConfig.config.reward),t.callback&&t.callback(!1),_.sGViewModel.getModule(P.VMReward).openRewardResult(t.rewardList),m.sGNode.destoryNode(t.node)},this),this.confirmButton&&(this.confirmButton.node.on("click",function(){y.sGAudio.playEffect(p.sAudioConfig.config.reward),t.callback&&t.callback(!0),_.sGViewModel.getModule(P.VMReward).openRewardResult(t.rewardList),m.sGNode.destoryNode(t.node)}),this.confirmButton.node.active=!1),this.adConfirmButton&&this.adConfirmButton.node.on("click",function(){t.tryRewardAgain()}),this.numberLabel&&(this.numberScroll=m.sGNode.addUniqueComponent(this.numberLabel,f.default),this.numberScroll.prefix="+"),this.closeButton&&this.node.addComponent(S.default).init(this.closeButton)},G.prototype.reset=function(t,e,o){return this.rewardList.addList(t),this.encourageEntry=e,this.callback=o,!0},G.prototype.onEnable=function(){y.sGAudio.playEffect(p.sAudioConfig.config.reward);var t,e=this.getComponent(cc.Animation);!e||0<(t=e.getClips()).length&&e.play(t[0].name),this.refresh(1),this.encourageEntry&&(this.encourageType=_.sGViewModel.getModule(d.VMEncourage).preEncourage(this.encourageEntry)),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType),this.adConfirmButton.node.active=this.encourageType!==d.eEncourageType.closed,this.confirmButton.node.active=this.encourageType===d.eEncourageType.closed},G.prototype.onDisable=function(){m.sGNode.targetOff(this)},G.prototype.addRewardAgain=function(){b.sGGame.localModel.getModule(v.LocalReward).takeRewardList(this.rewardList,!0,2,C.eReasonType.encourage),this.refresh(3),this.adConfirmButton.node.active=!1,this.confirmButton.node.active=!0},G.prototype.tryRewardAgain=function(){var t=this;_.sGViewModel.getModule(d.VMEncourage).encourage(this.encourageEntry,this.encourageType,function(){y.sGAudio.playEffect(p.sAudioConfig.config.reward),t.addRewardAgain()})},G.prototype.refresh=function(t){this.rewardList.multiply(t),this.rewardMul=t;var e,o=this.rewardList.getReward(0);this.iconNode&&(e=_.sGViewModel.getModule(P.VMReward).getIcon(o.type,o.id,P.eIconType.smallIcon),m.sGNode.setSprite(this.iconNode,e,this)),this.superIconNode&&(e=_.sGViewModel.getModule(P.VMReward).getIcon(o.type,o.id,P.eIconType.superIcon),m.sGNode.setSprite(this.superIconNode,e,this)),this.numberScroll&&this.numberScroll.setNumber(new g.Decimal(o.count),1<t)},c([n(cc.Button)],G.prototype,"closeButton",void 0),c([n(cc.Button)],G.prototype,"confirmButton",void 0),c([n(cc.Button)],G.prototype,"adConfirmButton",void 0),c([n(cc.Label)],G.prototype,"numberLabel",void 0),c([n(cc.Sprite)],G.prototype,"iconNode",void 0),c([n(cc.Sprite)],G.prototype,"superIconNode",void 0),c([n(u.default)],G.prototype,"encourageIconUI",void 0),a=c([a],G),r.default=a,cc._RF.pop()},{}],add_action_point_button_root_ui:[function(t,e,o){"use strict";cc._RF.push(e,"84db9szJadIfaw4ECdM892l","add_action_point_button_root_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("local_currency"),u=a("audio_config"),d=a("gui"),p=a("gaudio"),f=a("ggame"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.addActionPointButton=null,t}r(y,c=cc.Component),y.prototype.onLoad=function(){this.addActionPointButton&&this.addActionPointButton.node.on("click",this.onOpenButtonClick.bind(this))},y.prototype.onEnable=function(){var t=this;f.sGGame.on(s.sLocalCurrencyEvent.changed,function(){t.refresh()},this),this.refresh()},y.prototype.onDisable=function(){f.sGGame.targetOff(this)},y.prototype.onOpenButtonClick=function(){p.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),d.sGUI.openDialogUI("prefabs/ui/tl_add_tips_bottom")},y.prototype.refresh=function(){},l([a(cc.Button)],y.prototype,"addActionPointButton",void 0),g=l([h,g("Game/Currency/AddActionPointButtonRootUI")],y),n.default=g,cc._RF.pop()},{}],add_action_point_ui:[function(t,e,o){"use strict";cc._RF.push(e,"abfad5HJnVCxpfQdYyiySBp","add_action_point_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("vm_ui"),p=a("audio_config"),f=a("encourage_config"),h=a("i18n"),g=a("gaudio"),y=a("gnode"),m=a("ggame"),b=a("gview_model"),_=a("local_action"),v=a("vm_reward"),C=(P=cc._decorator).ccclass,P=(a=P.property,P.menu);function S(){var t=null!==c&&c.apply(this,arguments)||this;return t.adConfirmButton=null,t.closeButton=null,t.timesLabel=null,t.encourageIconUI=null,t.encourageType=u.eEncourageType.closed,t}r(S,c=cc.Component),S.prototype.onLoad=function(){this.adConfirmButton&&this.adConfirmButton.node.on("click",this.onAdConfirmClick.bind(this)),this.closeButton&&this.closeButton.node.on("click",this.onCloseButtonClick.bind(this))},S.prototype.onEnable=function(){var t=this;m.sGGame.on(_.sLocalActionEvent.addActionPointByEncorage,function(){t.refresh()},this),this.refresh(),this.encourageType=b.sGViewModel.getModule(u.VMEncourage).preEncourage(f.sEncourageConfig.config.collectActionPointDaily),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType),g.sGAudio.playEffect(p.sAudioConfig.config.popUI)},S.prototype.onDisable=function(){m.sGGame.targetOff(this)},S.prototype.onAdConfirmClick=function(){var t=this;g.sGAudio.playEffect(p.sAudioConfig.config.buttonClick);var e=m.sGGame.localModel.getModule(_.LocalAction);e.getAddActionPointByEncorageTimes()>=e.getAddActionPointByEncorageMaxTimes()?b.sGViewModel.getModule(d.VMUI).addMessageTip(h.i18n.t("action.notTimesToBuy")):b.sGViewModel.getModule(u.VMEncourage).encourage(f.sEncourageConfig.config.collectActionPointDaily,this.encourageType,function(){e.addActionPointByEncorage(function(e,o){e||(y.sGNode.destoryNode(t.node),b.sGViewModel.getModule(v.VMReward).openRewardResult(o.rewardList))})})},S.prototype.onCloseButtonClick=function(){g.sGAudio.playEffect(p.sAudioConfig.config.buttonClick),y.sGNode.destoryNode(this.node)},S.prototype.refresh=function(){var t=(e=m.sGGame.localModel.getModule(_.LocalAction)).getAddActionPointByEncorageTimes(),e=e.getAddActionPointByEncorageMaxTimes();this.timesLabel&&(this.timesLabel.string=e-t+"/"+e)},l([a(cc.Button)],S.prototype,"adConfirmButton",void 0),l([a(cc.Button)],S.prototype,"closeButton",void 0),l([a(cc.Label)],S.prototype,"timesLabel",void 0),l([a(s.default)],S.prototype,"encourageIconUI",void 0),P=l([C,P("Game/Currency/AddActionPointUI")],S),n.default=P,cc._RF.pop()},{}],age_background:[function(t,e,o){"use strict";cc._RF.push(e,"03f662OtJNHYo8O7XHJglxL","age_background");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("glog"),u=a("gnode"),d=a("gres"),p=a("res_auto_release"),f=a("ggame"),h=a("local_building"),g=(m=cc._decorator).ccclass,y=m.property,m=(a=m.menu,m.executeInEditMode);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.bundleName="game",t.sprite=null,t.age=0,t}r(b,c=cc.Component),b.prototype.onLoad=function(){this.sprite=this.getComponent(cc.Sprite)},b.prototype.start=function(){},b.prototype.onEnable=function(){var t;this.age=0,f.sGGame.localModel&&f.sGGame.localModel.inited&&(t=f.sGGame.localModel.getModule(h.LocalBuildingPackage).getCurrentAge(),this.updateSprite(t))},b.prototype.onDisable=function(){d.sGRes.targetOff(this)},b.prototype.getSpritePath=function(t){var e=d.sGRes.getAssetInfo(t,this.bundleName).path;return e?(t=e.indexOf("/"),t=e.indexOf("/",t+1),t=e.indexOf("/",t+1),e.slice(t+1)):""},b.prototype.updateSprite=function(t){var e;this.sprite?t&&t!=this.age&&(this.age=t,e=this.getSpritePath(this.sprite.spriteFrame),this._refreshSprite(t,e)):s.sGLog.error("Failed to update localized sprite, sprite component is invalid!")},b.prototype._refreshSprite=function(t,e){var o,i=this;!e||d.sGRes.getRes(o="images/age/age"+t+"/"+e,cc.SpriteFrame)!=this.sprite.spriteFrame&&(this.sprite.node.opacity=0,d.sGRes.loadResUniqueByCompWithBundle(this.bundleName,this.sprite,o,cc.SpriteFrame,function(t){i.sprite.node.opacity=255,t?(i.sprite.spriteFrame=t,u.sGNode.addUniqueComponent(i.sprite.node,p.default).reset(o,t)):cc.log("!!!!!!!!! age sprite is missing ",o)},this))},l([y],b.prototype,"bundleName",void 0),m=l([g,a("Game/AgeSprite/AgeBackground"),m],b),n.default=m,cc._RF.pop()},{}],age_info_button_root:[function(t,e,o){"use strict";cc._RF.push(e,"9b2bbqPsiJHCLTNLy0kc03v","age_info_button_root");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reddot"),u=a("age_config"),d=a("audio_config"),p=a("scroll_number"),f=a("i18n"),h=a("gaudio"),g=a("gnode"),y=a("gnumber"),m=a("ggame"),b=a("gview_model"),_=a("local_battle_stage"),v=a("local_building"),C=a("local_card"),P=a("vm_building"),S=(G=cc._decorator).ccclass,G=(a=G.property,G.menu);function M(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t.progressBar=null,t.iconSprite=null,t.nameLabel=null,t.totalCollectPerSecondLabel=null,t.battleScoreLabel=null,t.animSpine=null,t.progressLabel=null,t}r(M,c=cc.Component),M.prototype.onLoad=function(){var t;this.button&&(this.button.node.on("click",function(){h.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),b.sGViewModel.getModule(P.VMBuilding).openUpgradeAgeUI()}),(t=g.sGNode.addUniqueComponent(this.button.node,s.default))&&t.init(function(){return 0===m.sGGame.localModel.getModule(v.LocalBuildingPackage).checkUpgradeAge()},"reddot"))},M.prototype.onEnable=function(){var t=this;m.sGGame.on(v.sLocalBuildingEvent.upgrade,function(){t._refresh(!1),t.animSpine&&(t.animSpine.setAnimation(0,"open",!1),t.animSpine.addAnimation(0,"animation",!0))},this),m.sGGame.on(C.sLocalCardEvent.changeEquip,function(){t._refresh(!1)},this),this._refresh(!0)},M.prototype.onDisable=function(){m.sGGame.targetOff(this),g.sGNode.targetOff(this)},M.prototype._refresh=function(t){var e=m.sGGame.localModel.getModule(v.LocalBuildingPackage),o=m.sGGame.localModel.getModule(_.LocalBattleStage),i=e.getCurrentAge(),a=(i=u.sAgeConfig.getEntry(i),0),n=0;if(this.progressBar){for(var r=v.eBuildingType.base;r<v.eBuildingType.max;++r){var l=e.getBuildingByType(r);l&&(a+=l.getLevel(),n+=l.getMaxLevel())}this.progressBar.progress=a/n}this.progressLabel&&(this.progressLabel.string=a+"/"+n,t||cc.tween(this.progressLabel.node).delay(.1).set({scale:3}).to(.5,{scale:1},{easing:"backOut"}).start()),this.iconSprite&&g.sGNode.setSprite(this.iconSprite,i.icon,this),this.nameLabel&&(this.nameLabel.string=f.i18n.t(i.name)),this.totalCollectPerSecondLabel&&(this.totalCollectPerSecondLabel.string=y.sGNumber.toHuman(e.getTotalCollectPerSecond())),this.battleScoreLabel&&(g.sGNode.addUniqueComponent(this.battleScoreLabel.node,p.default).setNumber(o.getBattleScore(),!t),t||cc.tween(this.battleScoreLabel.node).delay(.2).set({scale:3}).to(.5,{scale:1},{easing:"backOut"}).start()),this.animSpine&&this.animSpine.setAnimation(0,"animation",!0)},l([a(cc.Button)],M.prototype,"button",void 0),l([a(cc.ProgressBar)],M.prototype,"progressBar",void 0),l([a(cc.Sprite)],M.prototype,"iconSprite",void 0),l([a(cc.Label)],M.prototype,"nameLabel",void 0),l([a(cc.Label)],M.prototype,"totalCollectPerSecondLabel",void 0),l([a(cc.Label)],M.prototype,"battleScoreLabel",void 0),l([a(sp.Skeleton)],M.prototype,"animSpine",void 0),l([a(cc.Label)],M.prototype,"progressLabel",void 0),G=l([S,G("Game/Building/AgeInfoButtonRoot")],M),n.default=G,cc._RF.pop()},{}],age_node:[function(t,e,o){"use strict";cc._RF.push(e,"2770142r7ZHYr0rWnOmWzp8","age_node");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0});var l,c=a("ggame"),s=a("local_building"),u=(d=cc._decorator).ccclass,d=(d.property,a=d.menu,d.executeInEditMode);function p(){var t=null!==l&&l.apply(this,arguments)||this;return t.age=0,t}r(p,l=cc.Component),p.prototype.onLoad=function(){},p.prototype.start=function(){},p.prototype.onEnable=function(){var t;this.age=0,c.sGGame.localModel&&c.sGGame.localModel.inited&&(t=c.sGGame.localModel.getModule(s.LocalBuildingPackage).getCurrentAge(),this.refresh(t))},p.prototype.onDisable=function(){},p.prototype.refresh=function(t){if(t&&t!=this.age){this.age=t;for(var e=1;;e++){var o=this.node.getChildByName("age"+e);if(!o)break;o.active=e==t}}},d=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([u,a("Game/AgeSprite/AgeNode"),d],p),n.default=d,cc._RF.pop()},{}],age_sprite_editor_test:[function(t,e,o){"use strict";cc._RF.push(e,"f1345lhEEtEZLO/CuZhnn1M","age_sprite_editor_test");var i,a=e,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=(d=cc._decorator).ccclass,u=d.property,d=(a=d.menu,d.executeInEditMode);function p(){var t=null!==c&&c.apply(this,arguments)||this;return t._editorConfigAge=1,t}r(p,c=cc.Component),Object.defineProperty(p.prototype,"editorConfigAge",{get:function(){return this._editorConfigAge},set:function(t){this._editorConfigAge!==t&&(this._editorConfigAge=t)},enumerable:!1,configurable:!0}),p.prototype.updateSceneRenderers=function(t){for(var e,o=this.node.children,i=[],a=[],n=0;n<o.length;++n){var r=o[n].getComponentsInChildren("age_sprite");Array.prototype.push.apply(i,r),r=o[n].getComponentsInChildren("age_node"),Array.prototype.push.apply(a,r)}for(n=0;n<i.length;++n)(e=i[n]).node.activeInHierarchy&&e.updateSprite(t);for(n=0;n<a.length;++n)(e=a[n]).node.activeInHierarchy&&e.refresh(t)},l([u],p.prototype,"editorConfigAge",null),d=l([s,a("Game/AgeSprite/AgeSpriteEditorTest"),d],p),n.default=d,cc._RF.pop()},{}],age_sprite:[function(t,e,o){"use strict";cc._RF.push(e,"f70fc9lgmBA45KWmp9//3M1","age_sprite");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("glog"),u=a("gnode"),d=a("gres"),p=a("res_auto_release"),f=a("ggame"),h=a("local_building"),g=(m=cc._decorator).ccclass,y=m.property,m=(a=m.menu,m.executeInEditMode);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.bundleName="game",t.sprite=null,t.age=0,t.sourceOpacity=0,t}r(b,c=cc.Component),b.prototype.onLoad=function(){this.sprite=this.getComponent(cc.Sprite),this.sourceOpacity=this.node.opacity},b.prototype.start=function(){},b.prototype.onEnable=function(){var t;this.age=0,f.sGGame.localModel&&f.sGGame.localModel.inited&&(t=f.sGGame.localModel.getModule(h.LocalBuildingPackage).getCurrentAge(),this.updateSprite(t))},b.prototype.onDisable=function(){d.sGRes.targetOff(this)},b.prototype.getSpritePath=function(t){var e=d.sGRes.getAssetInfo(t,this.bundleName).path;return e?(t=e.indexOf("/"),t=e.indexOf("/",t+1),t=e.indexOf("/",t+1),t=e.indexOf("/",t+1),e.slice(t+1)):""},b.prototype.updateSprite=function(t){var e;this.sprite?t&&t!=this.age&&(this.age=t,e=this.getSpritePath(this.sprite.spriteFrame),this._refreshSprite(t,e)):s.sGLog.error("Failed to update localized sprite, sprite component is invalid!")},b.prototype._refreshSprite=function(t,e){var o,i=this;!e||d.sGRes.getRes(o="images/main/age/age"+t+"/"+e,cc.SpriteFrame)!=this.sprite.spriteFrame&&(this.sprite.node.opacity=0,d.sGRes.loadResUniqueByCompWithBundle(this.bundleName,this.sprite,o,cc.SpriteFrame,function(t){i.sprite.node.opacity=i.sourceOpacity,t?(i.sprite.spriteFrame=t,u.sGNode.addUniqueComponent(i.sprite.node,p.default).reset(o,t)):cc.log("!!!!!!!!! age sprite is missing ",o)},this))},l([y],b.prototype,"bundleName",void 0),m=l([g,a("Game/AgeSprite/AgeSprite"),m],b),n.default=m,cc._RF.pop()},{}],age_upgrade_effect_ui:[function(t,e,o){"use strict";cc._RF.push(e,"37faffjVrhAy6N6NHUfxyzM","age_upgrade_effect_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("age_config"),u=a("audio_config"),d=a("i18n"),p=a("gui"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("local_building"),m=(b=cc._decorator).ccclass,b=(a=b.property,b.menu);function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.anim=null,t.confirmButton=null,t.iconSprite=null,t.nameLabel=null,t.descLabel=null,t.cardNodeArray=[],t}r(_,c=cc.Component),_.prototype.onLoad=function(){var t=this;this.confirmButton&&this.confirmButton.node.on("click",function(){f.sGAudio.playEffect(u.sAudioConfig.config.reward),t.callback&&t.callback(),t.confirmButton.node.active=!1,t.anim&&(t.anim.play("age_upgrade_effect_leave_anim"),t.anim.on(cc.Animation.EventType.FINISHED,function(){h.sGNode.destoryNode(t.node)},t))})},_.prototype.onEnable=function(){var t=this;p.sGUI.addCustomLoadingRef("updateEffect"),g.sGGame.on(y.sLocalBuildingEvent.upgrade,function(){t._refresh()},this),this._refresh()},_.prototype.onDisable=function(){p.sGUI.subCustomLoadingRef("updateEffect"),g.sGGame.targetOff(this),h.sGNode.targetOff(this);for(var t=0;t<this.cardNodeArray.length;++t){var e=this.cardNodeArray[t];e&&h.sGNode.destoryNode(e)}this.cardNodeArray=[]},_.prototype._refresh=function(){var t=g.sGGame.localModel.getModule(y.LocalBuildingPackage),e=t.getCurrentAge();e=s.sAgeConfig.getEntry(e),this.iconSprite&&h.sGNode.setSprite(this.iconSprite,e.icon,this),this.nameLabel&&(this.nameLabel.string=d.i18n.t(e.name)),this.descLabel&&(this.descLabel.string=d.i18n.t(e.desc)),this.iconSprite&&h.sGNode.setSprite(this.iconSprite,e.icon,this);for(var o=y.eBuildingType.base;o<y.eBuildingType.max;++o){var i=t.getBuildingByType(o);i&&(i.getLevel(),i.getMaxLevel())}},_.prototype.onAnimationFinish=function(){this.callback&&(this.callback(),this.callback=void 0)},l([a(cc.Animation)],_.prototype,"anim",void 0),l([a(cc.Button)],_.prototype,"confirmButton",void 0),l([a(cc.Sprite)],_.prototype,"iconSprite",void 0),l([a(cc.Label)],_.prototype,"nameLabel",void 0),l([a(cc.Label)],_.prototype,"descLabel",void 0),b=l([m,b("Game/Building/AgeUpgradeEffectUI")],_),n.default=b,cc._RF.pop()},{}],age_upgrade_tip_ui:[function(t,e,o){"use strict";cc._RF.push(e,"359802TYpNOa7WGsizvtFZ8","age_upgrade_tip_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("age_config"),u=a("audio_config"),d=a("i18n"),p=a("gui"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("game_define"),m=a("local_building"),b=a("local_card"),_=a("card_hero_info_ui"),v=a("card_icon_ui"),C=a("card_skill_info_ui"),P=(S=cc._decorator).ccclass,S=(a=S.property,S.menu);function G(){var t=null!==c&&c.apply(this,arguments)||this;return t.confirmButton=null,t.iconSprite=null,t.nameLabel=null,t.cardRoot=null,t.cardPrefab=null,t.progressBar=null,t.progressLabel=null,t.cardNodeArray=[],t}r(G,c=cc.Component),G.prototype.onLoad=function(){var t=this;this.confirmButton&&this.confirmButton.node.on("click",function(){f.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),t.callback&&t.callback(),h.sGNode.destoryNode(t.node)})},G.prototype.onEnable=function(){var t=this;g.sGGame.on(m.sLocalBuildingEvent.upgrade,function(){t._refresh()},this),this._refresh()},G.prototype.onDisable=function(){g.sGGame.targetOff(this),h.sGNode.targetOff(this);for(var t=0;t<this.cardNodeArray.length;++t){var e=this.cardNodeArray[t];e&&h.sGNode.destoryNode(e)}this.cardNodeArray=[]},G.prototype._refresh=function(){var t=g.sGGame.localModel.getModule(m.LocalBuildingPackage),e=t.getCurrentAge();e=s.sAgeConfig.getEntry(e),this.iconSprite&&h.sGNode.setSprite(this.iconSprite,e.icon,this),this.nameLabel&&(this.nameLabel.string=d.i18n.t(e.name));var o=0,i=0;this.iconSprite&&h.sGNode.setSprite(this.iconSprite,e.icon,this);for(var a=m.eBuildingType.base;a<m.eBuildingType.max;++a){var n=t.getBuildingByType(a);n&&(o+=n.getLevel(),i+=n.getMaxLevel())}this.progressBar&&(this.progressBar.progress=o/i),this.progressLabel&&(this.progressLabel.string=o+"/"+i),this._refreshCard()},G.prototype._refreshCard=function(){if(this.cardRoot&&this.cardPrefab){var t=g.sGGame.localModel.getModule(m.LocalBuildingPackage),e=g.sGGame.localModel.getModule(b.LocalCardPackage);if(t=t.getCurrentAge(),t=s.sAgeConfig.getEntry(t)){var o=e.getCardArrayByAge(t.id);o.sort(function(t,e){return t.isSoldierCard!=e.isSoldierCard?e.isSoldierCard?1:-1:t.entry.quality!==e.entry.quality?t.entry.quality-e.entry.quality:t.entry.id-e.entry.id});for(var i,a=0;a<o.length;++a){(i=this.cardNodeArray[a])?i.active=!0:((i=cc.instantiate(this.cardPrefab)).parent=this.cardRoot,this.cardNodeArray.push(i));var n=i.getComponent(v.default);n&&n.init(o[a],function(t){t.isSoldierCard?p.sGUI.openDialogUI(y.GameDefine.prefabSoldierCardInfoPop,function(e){(e=e.getComponent(_.default))&&(e.card=t)}):p.sGUI.openDialogUI(y.GameDefine.prefabSkillCardInfoPop,function(e){(e=e.getComponent(C.default))&&(e.card=t)})})}for(a=o.length;a<this.cardNodeArray.length;++a)(i=this.cardNodeArray[a])&&(i.active=!1)}}},l([a(cc.Button)],G.prototype,"confirmButton",void 0),l([a(cc.Sprite)],G.prototype,"iconSprite",void 0),l([a(cc.Label)],G.prototype,"nameLabel",void 0),l([a(cc.Node)],G.prototype,"cardRoot",void 0),l([a(cc.Prefab)],G.prototype,"cardPrefab",void 0),l([a(cc.ProgressBar)],G.prototype,"progressBar",void 0),l([a(cc.Label)],G.prototype,"progressLabel",void 0),S=l([P,S("Game/Building/AgeUpgradeTipUI")],G),n.default=S,cc._RF.pop()},{}],age_upgrade_ui:[function(t,e,o){"use strict";cc._RF.push(e,"065a61LzX9ChLCeT/1HHFxF","age_upgrade_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("age_config"),u=a("audio_config"),d=a("client_config"),p=a("anim_player"),f=a("i18n"),h=a("gui"),g=a("gaudio"),y=a("gnode"),m=a("gres"),b=a("ggame"),_=a("gview_model"),v=a("game_define"),C=a("local_building"),P=a("local_card"),S=a("vm_game"),G=a("card_hero_info_ui"),M=a("card_icon_ui"),w=a("card_skill_info_ui"),A=(B=cc._decorator).ccclass,B=(a=B.property,B.menu);function R(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.iconSprite=null,t.fullLevelNodes=[],t.notFullLevelNodes=[],t.buildingRoot=null,t.upgradeAgeButton=null,t.cardRoot=null,t.cardPrefab=null,t.progressBar=null,t.progressLabel=null,t.cardNodeArray=[],t}r(R,c=cc.Component),R.prototype.onLoad=function(){var t=this;this.upgradeAgeButton&&this.upgradeAgeButton.node.on("click",function(){g.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),0===b.sGGame.localModel.getModule(C.LocalBuildingPackage).checkUpgradeAge()&&(g.sGAudio.playEffect(u.sAudioConfig.config.reward),d.sClientConfig.config.testAgeUpgradeEffect?h.sGUI.openDialogUI(v.GameDefine.prefabAgeUpgradePreEffect,function(t){!t||(t=t.getComponent(p.default))&&t.init(function(){b.sGGame.localModel.getModule(C.LocalBuildingPackage).upgradeAge()},[0],!0)},t):b.sGGame.localModel.getModule(C.LocalBuildingPackage).upgradeAge())})},R.prototype.onEnable=function(){b.sGGame.on(C.sLocalBuildingEvent.upgradeAge,function(){g.sGAudio.playEffect(u.sAudioConfig.config.build),d.sClientConfig.config.testAgeUpgradeEffect?_.sGViewModel.getModule(S.VMGame).enterMain(void 0,function(){var t=m.sGRes.getRes(v.GameDefine.prefabAgeUpgradeEffect,cc.Prefab);h.sGUI.openSystemUI(t)},void 0,!0):_.sGViewModel.getModule(S.VMGame).enterMain(void 0,function(){h.sGUI.openDialogUI(v.GameDefine.prefabAgeUpgradeTip)})},this),this.refresh()},R.prototype.onDisable=function(){b.sGGame.targetOff(this),y.sGNode.targetOff(this);for(var t=0;t<this.cardNodeArray.length;++t){var e=this.cardNodeArray[t];e&&y.sGNode.destoryNode(e)}this.cardNodeArray=[]},R.prototype.refresh=function(){var t=b.sGGame.localModel.getModule(C.LocalBuildingPackage),e=t.getCurrentAge(),o=s.sAgeConfig.getEntry(e),i=t.isAgeFull()?null:s.sAgeConfig.getEntry(e+1);this.nameLabel&&(this.nameLabel.string=f.i18n.t(o.name)),this.iconSprite&&y.sGNode.setSprite(this.iconSprite,o.icon,this);for(var a,n=0;n<this.fullLevelNodes.length;++n)(a=this.fullLevelNodes[n])&&(a.active=!i);for(n=0;n<this.notFullLevelNodes.length;++n)(a=this.notFullLevelNodes[n])&&(a.active=!!i);this.upgradeAgeButton&&(this.upgradeAgeButton.interactable=0===t.checkUpgradeAge());var r=0,l=0;for(this.iconSprite&&y.sGNode.setSprite(this.iconSprite,o.icon,this),n=C.eBuildingType.base;n<C.eBuildingType.max;++n){var c=t.getBuildingByType(n);c&&(r+=c.getLevel(),l+=c.getMaxLevel())}this.progressBar&&(this.progressBar.progress=r/l),this.progressLabel&&(this.progressLabel.string=r+"/"+l),this._refreshBuilding(),this._refreshCard()},R.prototype._refreshBuilding=function(){if(this.buildingRoot)for(var t=b.sGGame.localModel.getModule(C.LocalBuildingPackage),e=C.eBuildingType.base;e<C.eBuildingType.max;++e){var o,i=t.getBuildingByType(e),a=this.buildingRoot.getChildByName("building"+e);a&&(i?((o=y.sGNode.findComponent(a,"icon",cc.Sprite))&&y.sGNode.setSprite(o,i.entry.icon,this),(o=y.sGNode.findComponent(a,"layout/Label_attribute1",cc.Label))&&(0<i.getLevel()?o.string=f.i18n.t(i.entry.name)+" lv"+i.getLevel():o.string=f.i18n.t(i.entry.name)),(o=y.sGNode.findComponent(a,"progressBar",cc.ProgressBar))&&(o.progress=i.getLevel()/i.getMaxLevel())):a.active=!1)}},R.prototype._refreshCard=function(){if(this.cardRoot&&this.cardPrefab){var t=b.sGGame.localModel.getModule(C.LocalBuildingPackage),e=b.sGGame.localModel.getModule(P.LocalCardPackage),o=t.getCurrentAge();if(o=t.isAgeFull()?null:s.sAgeConfig.getEntry(o+1)){var i=e.getCardArrayByAge(o.id);i.sort(function(t,e){return t.isSoldierCard!=e.isSoldierCard?e.isSoldierCard?1:-1:t.entry.quality!==e.entry.quality?t.entry.quality-e.entry.quality:t.entry.id-e.entry.id});for(var a,n=0;n<i.length;++n){(a=this.cardNodeArray[n])?a.active=!0:((a=cc.instantiate(this.cardPrefab)).parent=this.cardRoot,this.cardNodeArray.push(a));var r=a.getComponent(M.default);r&&r.init(i[n],function(t){t.isSoldierCard?h.sGUI.openDialogUI(v.GameDefine.prefabSoldierCardInfoPop,function(e){(e=e.getComponent(G.default))&&(e.card=t)}):h.sGUI.openDialogUI(v.GameDefine.prefabSkillCardInfoPop,function(e){(e=e.getComponent(w.default))&&(e.card=t)})})}for(n=i.length;n<this.cardNodeArray.length;++n)(a=this.cardNodeArray[n])&&(a.active=!1)}}},l([a(cc.Label)],R.prototype,"nameLabel",void 0),l([a(cc.Sprite)],R.prototype,"iconSprite",void 0),l([a(cc.Node)],R.prototype,"fullLevelNodes",void 0),l([a(cc.Node)],R.prototype,"notFullLevelNodes",void 0),l([a(cc.Node)],R.prototype,"buildingRoot",void 0),l([a(cc.Button)],R.prototype,"upgradeAgeButton",void 0),l([a(cc.Node)],R.prototype,"cardRoot",void 0),l([a(cc.Prefab)],R.prototype,"cardPrefab",void 0),l([a(cc.ProgressBar)],R.prototype,"progressBar",void 0),l([a(cc.Label)],R.prototype,"progressLabel",void 0),B=l([A,B("Game/Building/AgeUpgradeUI")],R),n.default=B,cc._RF.pop()},{}],attribute_slot:[function(t,e,o){"use strict";cc._RF.push(e,"7e53cm0wm9L7JshQNZ+pEA+","attribute_slot");var i=t,a=o;Object.defineProperty(a,"__esModule",{value:!0}),a.AttributeSlot=a.AttributeEffectData=a.eAttributePos=void 0;var n,r=i("glog");function l(){this.attributeEntry=void 0,this.posValues={},this.convertPercentDic={}}function c(t,e){this.attributeEffectDataDic={},this._attributeSystem=null,this._callOnChange=!0,this._attributeSystem=t,this._callOnChange=e}(i=n=a.eAttributePos||(a.eAttributePos={}))[i.init=0]="init",i[i.add=1]="add",i[i.percentAdd=2]="percentAdd",i[i.mul=3]="mul",i[i.div=4]="div",i[i.extend=5]="extend",a.AttributeEffectData=l,c.prototype.clear=function(){for(var t in this.attributeEffectDataDic)t=t,t=this._attributeSystem.getAttributeEntry(t),this._callOnChange&&this._attributeSystem._onChanged(t);this.attributeEffectDataDic={}},c.prototype.setPosValue=function(t,e,o){var i=this._attributeSystem.getAttributeEntry(t);e=this._attributeSystem.getPosFromString(e),void 0===(t=this._getAttributeEffectData(i)).posValues&&(t.posValues={}),t.posValues[e]=o,this._callOnChange&&this._attributeSystem._onChanged(i)},c.prototype.addPosValue=function(t,e,o){var i=this._attributeSystem.getAttributeEntry(t);e=this._attributeSystem.getPosFromString(e),void 0===(t=this._getAttributeEffectData(i)).posValues&&(t.posValues={}),e===n.mul||e===n.div?(void 0===t.posValues[e]&&(t.posValues[e]=1),t.posValues[e]=o<0?t.posValues[e]/-o:t.posValues[e]*o):t.posValues[e]=t.posValues[e]?t.posValues[e]+o:o,this._callOnChange&&this._attributeSystem._onChanged(i)},c.prototype.getPosValue=function(t,e){return t=this._attributeSystem._getAttributeID(t),e=this._attributeSystem.getPosFromString(e),(t=this.attributeEffectDataDic[t])&&t.posValues&&t.posValues[e]?t.posValues[e]:e===n.mul||e===n.div?1:0},c.prototype.setConvertPercent=function(t,e,o){var i=this._attributeSystem.getAttributeEntry(t);t=this._attributeSystem._getAttributeID(e),(e=this._getAttributeEffectData(i)).convertPercentDic||(e.convertPercentDic={}),e.convertPercentDic[t]=o,this._callOnChange&&this._attributeSystem._onChanged(i)},c.prototype.addConvertPercent=function(t,e,o){var i=this._attributeSystem.getAttributeEntry(t);t=this._attributeSystem._getAttributeID(e),(e=this._getAttributeEffectData(i)).convertPercentDic||(e.convertPercentDic={}),e.convertPercentDic[t]||this._attributeSystem._addDependAttribute(i,t),e.convertPercentDic[t]=e.convertPercentDic[t]?e.convertPercentDic[t]+o:o,this._callOnChange&&this._attributeSystem._onChanged(i)},c.prototype.getConvertPercent=function(t,e){return t=this._attributeSystem.getAttributeEntry(t),e=this._attributeSystem._getAttributeID(e),(t=this._getAttributeEffectData(t)).convertPercentDic?t.convertPercentDic[e]:0},c.prototype._getAttributeEffectData=function(t){var e=this._attributeSystem._getAttributeIDByEntry(t),o=this.attributeEffectDataDic[e];return o||((o=new l).attributeEntry=t,void 0===e&&r.sGLog.info("attributeID is undefined"),this.attributeEffectDataDic[e]=o),o},c.prototype.addAttributeEffectData=function(t){for(var e in t.posValues)this.addPosValue(t.attributeEntry,parseInt(e),t.posValues[e]);for(var e in t.convertPercentDic)this.addConvertPercent(t.attributeEntry,e,t.convertPercentDic[e])},i=c,a.AttributeSlot=i,cc._RF.pop()},{}],attribute_system:[function(t,e,o){"use strict";cc._RF.push(e,"b6df0cjHN1CyoKWNh973O4/","attribute_system");var i=t,a=o;Object.defineProperty(a,"__esModule",{value:!0}),a.AttributeSystem=a.AttributeFormula=a.eAttributeValueType=void 0;var n,r=i("glog"),l=i("attribute_slot");(i=n=a.eAttributeValueType||(a.eAttributeValueType={}))[i.init=0]="init",i[i.add=1]="add",i[i.percent=2]="percent",i[i.extend=3]="extend",i[i.total=4]="total",i[i.max=5]="max";var c=(f.prototype.setValue=function(t,e){this.values[t]=e},f.prototype.getValue=function(t){return this.values[t]},f),s=(p.prototype.getEntry=function(t){return this.asset.getEntry(t)||void 0},p.prototype.getAttributeID=function(t){return t?t.id:void 0},p),u=(d.prototype.addDepend=function(t){var e=this._attributeSystem.getAttributeEntry(t);t=this._attributeSystem._getAttributeIDByEntry(e),this._dependAttributeEntryArray[this._dependAttributeEntryArray.length]=e,this._attributeSystem._addDependAttribute(this._targetAttributeEntry,t)},d.prototype.setFormula=function(t){this._formulaCallback=t},d.prototype._callFromula=function(t){var e,o=new Map,i=this._attributeSystem._getAttributeIDByEntry(this._targetAttributeEntry);for(e in this._dependAttributeEntryArray){var a=this._dependAttributeEntryArray[e];(a=this._attributeSystem._getAttributeIDByEntry(a))!==i&&o.set(a,this._attributeSystem.getValue(a))}this._formulaCallback&&this._formulaCallback(this._targetAttributeEntry,t,o)},d);function d(t,e){this._dependAttributeEntryArray=[],this._attributeSystem=void 0,this._attributeSystem=t,this._targetAttributeEntry=e}function p(){this.asset=null}function f(){this.values=[],this.values.length=n.max}function h(){this._attributeSlotDic={},this._attributeValueDic={},this._initFormulaDic=new Map,this._attributeDirtyDic={},this._attributeConfig=new s,this._dependAttributeDic=new Map,this._onChangedCallback=null}a.AttributeFormula=u,h.prototype.init=function(t,e){this._attributeConfig.asset=t;var o,i=this.getSlot("configInit");for(o in t.config){var a=this._attributeConfig.getEntry(o);a.init&&i.setPosValue(a.id,l.eAttributePos.init,a.init)}this._onChangedCallback=e},h.prototype.getSlot=function(t){return this._attributeSlotDic[t]||(this._attributeSlotDic[t]=new l.AttributeSlot(this,!0)),this._attributeSlotDic[t]},h.prototype.forEachSlot=function(t){if(t)for(var e in this._attributeSlotDic)t(e,this._attributeSlotDic[e])},h.prototype.clone=function(){var t,e=new h;for(t in e._initFormulaDic=this._initFormulaDic,e.init(this._attributeConfig.asset),this._attributeSlotDic)if("configInit"!==t){var o,i=this.getSlot(t),a=e.getSlot(t);for(o in i.attributeEffectDataDic)a.addAttributeEffectData(i.attributeEffectDataDic[o])}return e},h.prototype.getValue=function(t,e){return void 0===e&&(e=n.total),t=this._getAttributeID(t),!this._attributeDirtyDic[t]&&this._attributeValueDic[t]||(this._attributeDirtyDic[t]=!1,this._attributeValueDic[t]=this._calcValue(t)),this._attributeValueDic[t].getValue(e)},h.prototype._calcValue=function(t){var e,o=this,i=0,a=0,r=100,s=1,u=1,d=0,p=new Map,f=this._initFormulaDic.get(t);if(f){var h=new l.AttributeSlot(this,!1);if(f._callFromula(h),(e=h.attributeEffectDataDic[t])&&e.posValues&&(e.posValues[l.eAttributePos.init]&&(i+=e.posValues[l.eAttributePos.init]),e.posValues[l.eAttributePos.add]&&(a+=e.posValues[l.eAttributePos.add]),e.posValues[l.eAttributePos.percentAdd]&&(r+=e.posValues[l.eAttributePos.percentAdd]),e.posValues[l.eAttributePos.mul]&&(s*=e.posValues[l.eAttributePos.mul]),e.posValues[l.eAttributePos.div]&&(u*=e.posValues[l.eAttributePos.div]),e.posValues[l.eAttributePos.extend]&&(d+=e.posValues[l.eAttributePos.extend])),e&&e.convertPercentDic){var g,y=e.convertPercentDic;for(g in y){var m=g,b=y[m];(C=p.get(m))||(C=0),C+=b,p.set(m,C)}}}for(g in this._attributeSlotDic)if((h=this._attributeSlotDic[g])&&((e=h.attributeEffectDataDic[t])&&e.posValues&&(e.posValues[l.eAttributePos.init]&&(i+=e.posValues[l.eAttributePos.init]),e.posValues[l.eAttributePos.add]&&(a+=e.posValues[l.eAttributePos.add]),e.posValues[l.eAttributePos.percentAdd]&&(r+=e.posValues[l.eAttributePos.percentAdd]),e.posValues[l.eAttributePos.mul]&&(s*=e.posValues[l.eAttributePos.mul]),e.posValues[l.eAttributePos.div]&&(u*=e.posValues[l.eAttributePos.div]),e.posValues[l.eAttributePos.extend]&&(d+=e.posValues[l.eAttributePos.extend])),e&&e.convertPercentDic)){var _,v=e.convertPercentDic;for(_ in v){var C,P=_;b=v[P],(C=p.get(P))||(C=0),C+=b,p.set(P,C)}}var S=(r=r<0?0:r)*(s=s<=0?0:s)/(u=u<1?1:u),G=(i+a)*S/100;return G+=d,p.forEach(function(t,e){e=o.getValue(e),G+=e*t/100}),(f=new c).setValue(n.init,i),f.setValue(n.add,a),f.setValue(n.percent,S),f.setValue(n.extend,d),f.setValue(n.total,G),f},h.prototype.getInitFormula=function(t){var e=this.getAttributeEntry(t),o=this._getAttributeIDByEntry(e);return(t=this._initFormulaDic.get(o))||(t=new u(this,e),this._initFormulaDic.set(o,t)),t},h.prototype._addDependAttribute=function(t,e){var o=this._dependAttributeDic.get(e);o||this._dependAttributeDic.set(e,o=[e]),t=this._getAttributeIDByEntry(t),o.push(t)},h.prototype._onChanged=function(t){t=this._getAttributeIDByEntry(t),this._setDirty(t),this._onChangedCallback&&this._onChangedCallback(t)},h.prototype._setDirty=function(t){if(!this._attributeDirtyDic[t]){var e=this._dependAttributeDic.get(t);e||this._dependAttributeDic.set(t,e=[t]);for(var o=0,i=e;o<i.length;o++){var a=i[o];a!==t?this._setDirty(a):this._attributeDirtyDic[a]=!0}}},h.prototype.getPosFromString=function(t){return"string"==typeof t?l.eAttributePos[t]:t},h.prototype.getAttributeEntry=function(t){var e="string"==typeof t?t:t.id;if(t=this._attributeConfig.getEntry(e))return t;r.sGLog.log("attribute "+e+" read name failed")},h.prototype._getAttributeID=function(t){var e;if("string"==typeof t){if(!(e=this.getAttributeEntry(t)))return void r.sGLog.log("attribute "+t+" read name failed")}else e=t;return this._attributeConfig.getAttributeID(e)},h.prototype._getAttributeIDByEntry=function(t){return this._attributeConfig.getAttributeID(t)},i=h,a.AttributeSystem=i,cc._RF.pop()},{}],battle_building_health_ui:[function(t,e,o){"use strict";cc._RF.push(e,"24871eDWT9NbZVtU15AUoGb","battle_building_health_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("soldier_attribute_config"),u=a("scroll_process_bar"),d=a("gnode"),p=a("gview_model"),f=a("vm_battle"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.progressBar=null,t.hpLabel=null,t.scrollProgressBar=null,t}r(y,c=cc.Component),y.prototype.onLoad=function(){},y.prototype.onEnable=function(){this.progressBar&&(this.scrollProgressBar=d.sGNode.addUniqueComponent(this.progressBar.node,u.default))},y.prototype.onDisable=function(){},y.prototype.update=function(){this._refresh()},y.prototype._refresh=function(){var t=p.sGViewModel.getModule(f.VMBattle),e=Math.floor(t.battleManager.playerBuildingBase.unitHealth.hp);t=t.battleManager.playerBuildingBase.unitAttribute.attributeSystem.getValue(s.sSoldierAttributeConfig.config.maxHP),this.scrollProgressBar&&this.scrollProgressBar.node.activeInHierarchy&&this.scrollProgressBar.setProgress(e/t),this.hpLabel&&(this.hpLabel.string=e+"/"+t)},l([a(cc.ProgressBar)],y.prototype,"progressBar",void 0),l([a(cc.Label)],y.prototype,"hpLabel",void 0),g=l([h,g("Game/UI/BattleBuildingHealthUI")],y),n.default=g,cc._RF.pop()},{}],battle_building_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"4aef4LjdWZMCqTiKo0s1pOe","battle_building_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("gnode"),u=(d=cc._decorator).ccclass,d=(a=d.property,d.menu);function p(){var t=null!==c&&c.apply(this,arguments)||this;return t.selectNode=null,t.clickButton=null,t.selected=!1,t.entry=null,t.clickCallback=null,t}r(p,c=cc.Component),p.prototype.setCallback=function(t){this.clickCallback=t},p.prototype.init=function(t){this.entry=t,this.enabledInHierarchy&&this.selectNode&&(this.selectNode.active=!1)},p.prototype.onLoad=function(){var t=this;this.clickButton&&this.clickButton.node.on("click",function(){t.clickCallback&&t.clickCallback()})},p.prototype.onEnable=function(){this.entry&&this._refresh()},p.prototype.onDisable=function(){s.sGNode.targetOff(this)},p.prototype.setSelected=function(t){this.selected=t,this.enabledInHierarchy&&this._refresh()},p.prototype._refresh=function(){this.selectNode&&(this.selectNode.active=!1)},l([a(cc.Node)],p.prototype,"selectNode",void 0),l([a(cc.Button)],p.prototype,"clickButton",void 0),d=l([u,d("Game/UI/BattleBuildingIconUI")],p),n.default=d,cc._RF.pop()},{}],battle_bullet_linear:[function(t,e,o){"use strict";cc._RF.push(e,"388609bdhdLD7g2hDIE/ECk","battle_bullet_linear");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=a("ggame"),d=a("local_battle"),p=a("battle_bullet"),f=a("unit_health"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.g=2,t.moveSpeed=300,t.rotationSpeed=0,t.rotationSpeedRandom=0,t._velocity=null,t._passTime=0,t._startPosition=null,t._startRotation=0,t._battleBullet=null,t}n.MAX_MAP_VALUE=1e100,r(y,c=cc.Component),y.prototype.onEnable=function(){var t=this;this._battleBullet=this.node.getComponent(p.default);var e=this._battleBullet.rotation;this._velocity=cc.v2(),this._velocity.y=this.moveSpeed*Math.sin(.0174532925199*e),this._velocity.x=this.moveSpeed*Math.cos(.0174532925199*e),this.node.angle=e,this._startPosition=this.node.getPosition().clone(),this._startRotation=this.node.angle,this.node.scale=this._battleBullet.scale,this.rotationSpeedRandom&&(this.rotationSpeed=this.rotationSpeed+Math.random()*this.rotationSpeedRandom),u.sGGame.on(d.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},y.prototype.onDisable=function(){u.sGGame.targetOff(this)},y.prototype.battleUpdate=function(t){this._passTime+=t;var e=this._velocity.x*this._passTime;if(t=this._velocity.y*this._passTime+.5*this.g*this._passTime*this._passTime,this.node.setPosition(this._startPosition.add(cc.v2(e,t))),0!=this.rotationSpeed&&(this.node.angle=(this._startRotation+this.rotationSpeed*this._passTime)%360),this.node.y<this._battleBullet.battleManager.spawnPositionOfPlayer.y)s.sGNode.destoryNode(this.node);else if(this.node.x>=this._battleBullet.battleManager.spawnPositionNodeOfEnemy.x+300||this.node.x<=this._battleBullet.battleManager.spawnPositionNodeOfPlayer.x-300)s.sGNode.destoryNode(this.node);else{var o,i=this._battleBullet.battleManager.enemySoldierDic;for(o in e=this.node.getComponent(p.default),t=this._battleBullet.battleManager.enemyBuildingBase,e.teamID===d.enumTeam.enemy&&(i=this._battleBullet.battleManager.playerSoldierDic,t=this._battleBullet.battleManager.playerBuildingBase),i){var a=i[o];if(this.node.y<a.node.y+a.soldier.entry.bodyHeight&&this.node.x>a.node.x-a.soldier.entry.bodyWidth/2-20&&this.node.x<a.node.x+a.soldier.entry.bodyWidth/2+20)return s.sGNode.destoryNode(this.node),void(this._battleBullet.spawner?this._battleBullet.spawner.onAttackDamage(a.unit,this._battleBullet.damage):a.unit.onHurt(null,this._battleBullet.damage,f.eUnitHurtType.normal))}this._battleBullet.spawner&&t&&0<(a=t).unitHealth.hp&&this.node.y<a.node.y+150&&this.node.x>a.node.x-20&&this.node.x<a.node.x+20&&(s.sGNode.destoryNode(this.node),a.unit.onHurt(null,this._battleBullet.damage,f.eUnitHurtType.normal))}},l([a({tooltip:"\u91cd\u529b\u52a0\u901f\u5ea6"})],y.prototype,"g",void 0),l([a({tooltip:"\u79fb\u52a8\u901f\u5ea6"})],y.prototype,"moveSpeed",void 0),l([a({tooltip:"\u89d2\u901f\u5ea6"})],y.prototype,"rotationSpeed",void 0),l([a({tooltip:"\u89d2\u901f\u5ea6\u968f\u673a\u9644\u52a0"})],y.prototype,"rotationSpeedRandom",void 0),g=l([h,g("Game/Battle/BattleBulletLinear")],y),n.default=g,cc._RF.pop()},{}],battle_bullet_point:[function(t,e,o){"use strict";cc._RF.push(e,"a6ce4sB3Y5B87stxgcsAS5l","battle_bullet_point");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=a("ggame"),d=a("local_battle"),p=a("battle_bullet"),f=a("unit_health"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.bombTime=0,t._passTime=0,t._battleBullet=null,t._bombed=!1,t}n.MAX_MAP_VALUE=1e100,r(y,c=cc.Component),y.prototype.onEnable=function(){var t=this;this._bombed=!1,this._battleBullet=this.node.getComponent(p.default);var e,o=this._battleBullet.battleManager.enemySoldierDic;for(e in this._battleBullet.battleManager.enemyBuildingBase,this._battleBullet.teamID===d.enumTeam.enemy&&(o=this._battleBullet.battleManager.playerSoldierDic,this._battleBullet.battleManager.playerBuildingBase),u.sGGame.on(d.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this),o){var i=o[e],a=i.node.x-i.soldier.entry.bodyWidth/2,n=i.node.x+i.soldier.entry.bodyWidth/2;if(this.node.x>a&&this.node.x<n)return void(this._battleBullet.spawner?this._battleBullet.spawner.onAttackDamage(i.unit,this._battleBullet.damage):i.unit.onHurt(null,this._battleBullet.damage,f.eUnitHurtType.normal))}},y.prototype.onDisable=function(){u.sGGame.targetOff(this)},y.prototype.battleUpdate=function(t){this._passTime+=t,this._passTime>this.bombTime&&!this._bombed&&(this._passTime=0,this._bombed=!0,s.sGNode.destoryNode(this.node))},l([a({tooltip:"\u70b8\u5f39\u4e8b\u4ef6"})],y.prototype,"bombTime",void 0),g=l([h,g("Game/Battle/BattleBulletPoint")],y),n.default=g,cc._RF.pop()},{}],battle_bullet:[function(t,e,o){"use strict";cc._RF.push(e,"7febdsBhPZIc7gZ3wVOFB6D","battle_bullet");var i,a=o,n=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.MAX_MAP_VALUE=void 0;var r,l=(c=cc._decorator).ccclass,c=(c.property,c.menu);function s(){var t=null!==r&&r.apply(this,arguments)||this;return t.damage=0,t.teamID=0,t.bulletID=0,t.battleManager=void 0,t.rotation=0,t.spawner=void 0,t.scale=0,t}a.MAX_MAP_VALUE=1e100,n(s,r=cc.Component),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([l,c("Game/Battle/BattleBullet")],s),a.default=c,cc._RF.pop()},{}],battle_damage_number:[function(t,e,o){"use strict";cc._RF.push(e,"bc7c1xOOJ9HdoPxueBEKj4w","battle_damage_number");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("gnumber"),u=a("game_define"),d=(p=cc._decorator).ccclass,p=(a=p.property,p.menu);function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.damageLabel=null,t.damage=0,t.hurtTeamID=1,t}r(f,c=cc.Component),f.prototype.init=function(t,e){this.damage=Math.floor(t),this.hurtTeamID=e,this.enabledInHierarchy&&this._refresh()},f.prototype.onEnable=function(){this._refresh()},f.prototype._refresh=function(){this.damageLabel&&(this.damageLabel.string="-"+s.sGNumber.toHuman(this.damage),this.damageLabel.node.color=u.GameDefine.teamColorArray[this.hurtTeamID])},l([a({type:cc.Label,tooltip:"\u4f24\u5bb3\u6570\u5b57"})],f.prototype,"damageLabel",void 0),p=l([d,p("Game/Battle/BattleDamageNumber")],f),n.default=p,cc._RF.pop()},{}],battle_debug_button_root:[function(t,e,o){"use strict";cc._RF.push(e,"5ac5fELTQhNtoY5rhFHGXq1","battle_debug_button_root");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("client_config"),u=a("gui"),d=a("ggame"),p=(f=cc._decorator).ccclass,f=(a=f.property,f.menu);function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t}r(h,c=cc.Component),h.prototype.onLoad=function(){},h.prototype.onEnable=function(){this.button&&(this.button.node.active=s.sClientConfig.config.devMode,this.button.node.on("click",function(){u.sGUI.openDialogUI("prefabs/ui/battle_debug")}))},h.prototype.onDisable=function(){d.sGGame.targetOff(this)},l([a(cc.Button)],h.prototype,"button",void 0),f=l([p,f("Game/Battle/BattleDebugButtonRoot")],h),n.default=f,cc._RF.pop()},{}],battle_debug_ui:[function(t,e,o){"use strict";cc._RF.push(e,"cd8a7AsN29OwqoIR1NG6erm","battle_debug_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("age_config"),u=a("avatar_config"),d=a("skill_config"),p=a("soldier_config"),f=a("i18n"),h=a("glog"),g=a("gnode"),y=a("ggame"),m=a("gview_model"),b=a("local_battle"),_=a("local_skill"),v=a("local_soldier"),C=a("vm_battle"),P=(S=cc._decorator).ccclass,S=(a=S.property,S.menu);function G(){var t=null!==c&&c.apply(this,arguments)||this;return t.closeButton=null,t.clearCDButton=null,t.soldierRoot=null,t.skillRoot=null,t.flySkillNode=null,t.switchTeamButton=null,t.teamSkillLabel=null,t}r(G,c=cc.Component),G.prototype.onLoad=function(){var t=this;this.closeButton&&this.closeButton.node.on("click",function(){g.sGNode.destoryNode(t.node)}),this.clearCDButton&&this.clearCDButton.node.on("click",function(){y.sGGame.localModel.getModule(b.LocalBattle).debugNoCD=!0}),this.switchTeamButton&&this.switchTeamButton.node.on("click",function(){t.switchTeam()})},G.prototype.onEnable=function(){this._refershSoldier(),this._refershSkill();var t=y.sGGame.localModel.getModule(b.LocalBattle);this.teamSkillLabel&&(this.teamSkillLabel.string=t.debugEnemyOperate?"\u654c\u65b9":"\u6211\u65b9")},G.prototype.onDisable=function(){y.sGGame.targetOff(this)},G.prototype._refershSoldier=function(){var t=y.sGGame.localModel.getModule(b.LocalBattle).enemyBaseLevel,e=this.soldierRoot;if(e)if(s.sAgeConfig.getEntry(t))for(var o=y.sGGame.localModel.getModule(v.LocalSoldierPackage).getSoldierArrayEquiped(),i=this,a=0;a<5;++a){var n=function(t){if(!(a=e.getChildByName("icon_bottom"+(t+1))))return{value:void 0};if(t>=o.length)return a.active=!1,"continue";a.active=!0;var a,n=o[t];t=a.getChildByName("botton"),(a=t.getChildByName("icon"))&&g.sGNode.setSprite(a.getComponent(cc.Sprite),n.card.entry.icon),t&&(t.targetOff(i),t.on("click",function(){m.sGViewModel.getModule(C.VMBattle).battleManager.addSoldierBySummon(n.entry.id,b.enumTeam.enemy)},i))}(a);if("object"==typeof n)return n.value}else e.active=!1},G.prototype._refershSkill=function(){for(var t=this,e=m.sGViewModel.getModule(C.VMBattle).battleManager,o=this,i=1;i<11;++i){var a=function(i){var a=o.skillRoot.getChildByName("Skill"+i),n=y.sGGame.localModel.getModule(_.LocalSkillPackage).getSkill(i);if(!a||!n)return{value:void 0};(i=g.sGNode.findNode(a,"Background/Label"))&&(i.getComponent(cc.Label).string=f.i18n.t(n.card.entry.name)),a.on("click",function(){switch(d.sSkillConfig.getEntry(n.entry.id).id){case 1:e.useSkillStone();break;case 2:e.useSkillEarthquake();break;case 3:e.useSkillTsunami();break;case 4:e.useSkillTornado();break;case 5:e.useSkillArrow();break;case 6:e.useSkillStonecastn();break;case 7:e.useSkillCannon();break;case 8:e.useSkillCallSoldier(8);break;case 9:e.useSkillCallSoldier(9);break;case 10:e.useSkillCallSoldier(10);break;default:e.useSkillStone()}g.sGNode.destoryNode(t.node)})}(i);if("object"==typeof a)return a.value}var n=this.skillRoot.getChildByName("Skill");n&&n.on("click",function(){e.useSkillPlane(),g.sGNode.destoryNode(t.node)})},G.prototype.switchTeam=function(){var t=y.sGGame.localModel.getModule(b.LocalBattle);t.debugEnemyOperate=!t.debugEnemyOperate,this.teamSkillLabel&&(this.teamSkillLabel.string=t.debugEnemyOperate?"\u654c\u65b9\u6280\u80fd":"\u6211\u65b9\u6280\u80fd")},G.prototype.outputAttackTime=function(){function t(){if(n&&o<=i){var t,e="###################### \n";for(t in a)e+="soldierID: "+t+" AttackTime:"+a[t]+"\n";h.sGLog.info(e)}}var e,o=0,i=0,a={},n=!1,r=this;for(e in p.sSoldierConfig.config)!function(e){var n,l,c=p.sSoldierConfig.config[e];c&&c.avatar&&(n=u.sAvatarConfig.getEntry(c.avatar))&&(e=(l=new cc.Node).addComponent(sp.Skeleton),r.node.addChild(l),o++,g.sGNode.setSpine(e,n.spine,"attack",function(e){e&&(e=e.getCurrent(0).animation.duration,a[c.id]=e,i++,t())}))}(e);n=!0,t()},l([a(cc.Button)],G.prototype,"closeButton",void 0),l([a(cc.Button)],G.prototype,"clearCDButton",void 0),l([a(cc.Node)],G.prototype,"soldierRoot",void 0),l([a(cc.Node)],G.prototype,"skillRoot",void 0),l([a(cc.Node)],G.prototype,"flySkillNode",void 0),l([a(cc.Button)],G.prototype,"switchTeamButton",void 0),l([a(cc.Label)],G.prototype,"teamSkillLabel",void 0),S=l([P,S("Game/Battle/BattleDebugUI")],G),n.default=S,cc._RF.pop()},{}],battle_defeat_ui:[function(t,e,o){"use strict";cc._RF.push(e,"a65f1Qvs3RCzYl5i+lXCgw5","battle_defeat_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.eBattleDefeatGotoType=void 0;var s,u=a("const_config"),d=a("ggame"),p=a("local_stage");(h=s=r.eBattleDefeatGotoType||(r.eBattleDefeatGotoType={}))[h.invalid=0]="invalid",h[h.upgradeBuilding=1]="upgradeBuilding",h[h.pullCard=2]="pullCard",h[h.upgradeCard=3]="upgradeCard",h[h.retry=4]="retry",a=(n=cc._decorator).ccclass;var f,h=n.property;function g(){var t=null!==f&&f.apply(this,arguments)||this;return t.closeButton=null,t.retryButton=null,t.adviseRoot=null,t.upgradeBuildingButton=null,t.pullCardButton=null,t.upgradeCardButton=null,t}n=n.menu,l(g,f=cc.Component),g.prototype.init=function(t){this.gotoCallback=t},g.prototype.onLoad=function(){var t=this,e=d.sGGame.localModel.getModule(p.LocalStage).getCurrentBattleStageID()>=u.sConstConfig.config.defeatAdviseOpenStage;this.closeButton&&(this.closeButton.node.active=e,this.closeButton.node.on("click",function(){t.onGoto(void 0)})),this.retryButton&&this.retryButton.node.on("click",this.onGoto.bind(this,s.retry)),this.adviseRoot&&(this.adviseRoot.active=e),this.upgradeBuildingButton&&this.upgradeBuildingButton.node.on("click",this.onGoto.bind(this,s.upgradeBuilding)),this.pullCardButton&&this.pullCardButton.node.on("click",this.onGoto.bind(this,s.pullCard)),this.upgradeCardButton&&this.upgradeCardButton.node.on("click",this.onGoto.bind(this,s.upgradeCard))},g.prototype.onEnable=function(){},g.prototype.onDisable=function(){},g.prototype.onGoto=function(t){this.gotoCallback&&this.gotoCallback(t)},c([h(cc.Button)],g.prototype,"closeButton",void 0),c([h(cc.Button)],g.prototype,"retryButton",void 0),c([h({displayName:"\u7acb\u5373\u5f3a\u5316\u6839\u8282\u70b9",type:cc.Node})],g.prototype,"adviseRoot",void 0),c([h({displayName:"\u5347\u7ea7\u5efa\u7b51",type:cc.Button})],g.prototype,"upgradeBuildingButton",void 0),c([h({displayName:"\u62bd\u5361",type:cc.Button})],g.prototype,"pullCardButton",void 0),c([h({displayName:"\u5347\u7ea7\u5361\u724c",type:cc.Button})],g.prototype,"upgradeCardButton",void 0),n=c([a,n("Game/Battle/BattleDefeatUI")],g),r.default=n,cc._RF.pop()},{}],battle_define:[function(t,e,o){"use strict";cc._RF.push(e,"a7b7doGrJZMSI0AmyTncSAW","battle_define");var i,a=o;function n(){}Object.defineProperty(a,"__esModule",{value:!0}),a.BattleDefine=void 0,n.closestDistance=100,i=n,a.BattleDefine=i,cc._RF.pop()},{}],battle_exit_button_root:[function(t,e,o){"use strict";cc._RF.push(e,"62f60IQpmFA36RCOlmtN0R2","battle_exit_button_root");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("client_config"),u=a("ggame"),d=a("gview_model"),p=a("vm_battle"),f=(h=cc._decorator).ccclass,h=(a=h.property,h.menu);function g(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t}r(g,c=cc.Component),g.prototype.onLoad=function(){},g.prototype.onEnable=function(){this.button&&(this.button.node.active=s.sClientConfig.config.devMode,this.button.node.on("click",function(){var t=d.sGViewModel.getModule(p.VMBattle);t.battleManager&&t.battleManager.onExitBattle()}))},g.prototype.onDisable=function(){u.sGGame.targetOff(this)},l([a(cc.Button)],g.prototype,"button",void 0),h=l([f,h("Game/Battle/BattleExitButtonRoot")],g),n.default=h,cc._RF.pop()},{}],battle_icon_manager:[function(t,e,o){"use strict";cc._RF.push(e,"efa761cJ0tBOofnuZbyuPaI","battle_icon_manager");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("gglobal_node"),u=a("gnode"),d=a("ggame"),p=a("gview_model"),f=a("local_battle"),h=a("local_soldier"),g=a("vm_battle"),y=a("battle_skill_panel_icon"),m=a("battle_soldier_icon_ui"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu);function v(){var t=null!==c&&c.apply(this,arguments)||this;return t.soldierIconRoot=null,t.skillIconRoot=null,t.soldierIconPrefab=null,t.skillIconPrefab=null,t.battleSkillIconArray=[],t.battleSoldierIconArray=[],t}r(v,c=cc.Component),v.prototype.onLoad=function(){this.localBattle=d.sGGame.localModel.getModule(f.LocalBattle)},v.prototype.onEnable=function(){for(var t=this,e=d.sGGame.localModel.getModule(f.LocalBattle),o=1==d.sGGame.localModel.getModule(h.LocalSoldierPackage).getSoldierActiveCount(),i=0;i<5;++i){var a,n=e.getSoldierEquiped(i);n&&((a=cc.instantiate(this.soldierIconPrefab)).getComponent(m.default).init(n,o),(r=a.getComponent(s.default))&&(r.rootNode.name+=(i+1).toString()),a.parent=this.soldierIconRoot)}for(i=0;i<3;++i){var r,l,c=e.getSkillEquiped(i);c&&((l=cc.instantiate(this.skillIconPrefab)).getComponent(y.default).init(c),(r=l.getComponent(s.default))&&(r.rootNode.name+=(i+1).toString()),l.parent=this.skillIconRoot)}d.sGGame.on(f.sLocalBattleEvent.addSoldierByBuy,function(e){t.localBattle.debugEnemyOperate?p.sGViewModel.getModule(g.VMBattle).battleManager.addSoldierByBuy(e,f.enumTeam.enemy):p.sGViewModel.getModule(g.VMBattle).battleManager.addSoldierByBuy(e,f.enumTeam.player)},this)},v.prototype.onDisable=function(){d.sGGame.targetOff(this),u.sGNode.targetOff(this);for(var t=0;t<this.battleSkillIconArray.length;++t){var e=this.battleSkillIconArray[t];u.sGNode.destoryNode(e.node)}for(t=0;t<this.battleSoldierIconArray.length;++t){var o=this.battleSoldierIconArray[t];u.sGNode.destoryNode(o.node)}this.battleSkillIconArray=[],this.battleSoldierIconArray=[]},l([a(cc.Node)],v.prototype,"soldierIconRoot",void 0),l([a(cc.Node)],v.prototype,"skillIconRoot",void 0),l([a(cc.Prefab)],v.prototype,"soldierIconPrefab",void 0),l([a(cc.Prefab)],v.prototype,"skillIconPrefab",void 0),_=l([b,_("Game/UI/BattleIconManager")],v),n.default=_,cc._RF.pop()},{}],battle_manager_lock_zone:[function(t,e,o){"use strict";cc._RF.push(e,"520b1rqob5FQ6wyrmw2qVOO","battle_manager_lock_zone");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.MAX_MAP_VALUE=void 0;var c,s=a("ggame"),u=a("map_camera"),d=a("battle_manager"),p=(f=cc._decorator).ccclass,f=(a=f.property,f.menu);function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.mapCamera=null,t.mapZone=null,t}n.MAX_MAP_VALUE=1e100,r(h,c=cc.Component),h.prototype.onLoad=function(){},h.prototype.onEnable=function(){var t,e,o=this;this.mapCamera&&this.mapZone&&(t=this.mapZone.getContentSize(),e=this.mapZone.getPosition(),this.mapCamera.setMapLockZone(cc.rect(e.x+cc.winSize.width/2,e.y,t.width-cc.winSize.width,t.height))),this.mapCamera&&this.mapCamera.lockPos(cc.v2(-600,0)),s.sGGame.on(d.sBattleManagerEvent.enterStep2,function(){var t=o.mapZone.getContentSize(),e=o.mapZone.getPosition();o.mapCamera.setMapLockZone(cc.rect(e.x+cc.winSize.width/2,e.y,t.width-cc.winSize.width+350,t.height))},this)},h.prototype.onDisable=function(){s.sGGame.targetOff(this)},l([a(u.default)],h.prototype,"mapCamera",void 0),l([a(cc.Node)],h.prototype,"mapZone",void 0),f=l([p,f("Game/Battle/BattleManagerLockZone")],h),n.default=f,cc._RF.pop()},{}],battle_manager_mode_base:[function(t,e,o){"use strict";cc._RF.push(e,"1a190qAXGNOpoNcVLEuHlfk","battle_manager_mode_base");var i=o;Object.defineProperty(i,"__esModule",{value:!0}),cc._RF.pop()},{}],battle_manager_mode_fuben:[function(t,e,o){"use strict";cc._RF.push(e,"3e6abxhC65HzIBFxogR8Gqa","battle_manager_mode_fuben");var i=t,a=o;Object.defineProperty(a,"__esModule",{value:!0}),a.BattleManagerModeFuben=void 0;var n=i("audio_config"),r=i("anim_player"),l=i("gui"),c=i("gaudio"),s=i("gnode"),u=i("ggame"),d=i("gview_model"),p=i("game_define"),f=i("local_battle"),h=i("vm_battle"),g=i("fuben_victory_ui"),y=i("battle_defeat_ui");function m(){}m.prototype.onEnterStep2=function(){var t,e=this;this.battleManager.warnningAnim?((t=s.sGNode.addUniqueComponent(this.battleManager.warnningAnim.node,r.default)).node.active=!0,this.battleManager.localBattle.pause(),t.init(function(){t.node.active=!1,e.battleManager.localBattle.resume(),d.sGViewModel.getModule(h.VMBattle).openBattleBuff()}),t.play(),c.sGAudio.playEffect(n.sAudioConfig.config.warning)):d.sGViewModel.getModule(h.VMBattle).openBattleBuff()},m.prototype.onVictory=function(){this.battleManager.localBattle.pause(),u.sGGame.localModel.getModule(f.LocalBattle).victory(),l.sGUI.openDialogUI("prefabs/ui/settlement_win_fb",function(t){(t=t.getComponent(g.default))&&t.init(function(){d.sGViewModel.getModule(h.VMBattle).exitBattleFuben()})})},m.prototype.onDefeat=function(){this.battleManager.localBattle.pause(),u.sGGame.localModel.getModule(f.LocalBattle).defeat(),l.sGUI.openDialogUI(p.GameDefine.prefabBattleDefeat,function(t){(t=t.getComponent(y.default))&&t.init(function(t){d.sGViewModel.getModule(h.VMBattle).exitBattleFuben(t)})})},i=m,a.BattleManagerModeFuben=i,cc._RF.pop()},{}],battle_manager_mode_pata:[function(t,e,o){"use strict";cc._RF.push(e,"5422byZvmBNobhclaSC6WE9","battle_manager_mode_pata");var i=t,a=o;Object.defineProperty(a,"__esModule",{value:!0}),a.BattleManagerModePata=void 0;var n=i("audio_config"),r=i("anim_player"),l=i("gui"),c=i("gaudio"),s=i("gnode"),u=i("ggame"),d=i("gview_model"),p=i("local_battle"),f=i("vm_battle"),h=i("pata_battle_victory_ui"),g=i("battle_defeat_ui");function y(){}y.prototype.onEnterStep2=function(){var t,e=this;this.battleManager.warnningAnim?((t=s.sGNode.addUniqueComponent(this.battleManager.warnningAnim.node,r.default)).node.active=!0,this.battleManager.localBattle.pause(),t.init(function(){t.node.active=!1,e.battleManager.localBattle.resume(),d.sGViewModel.getModule(f.VMBattle).openBattleBuff()}),t.play(),c.sGAudio.playEffect(n.sAudioConfig.config.warning)):d.sGViewModel.getModule(f.VMBattle).openBattleBuff()},y.prototype.onVictory=function(){this.battleManager.localBattle.pause(),u.sGGame.localModel.getModule(p.LocalBattle).victory(),l.sGUI.openDialogUI("prefabs/ui/dungeon_settlement_win",function(t){(t=t.getComponent(h.default))&&t.init(function(){d.sGViewModel.getModule(f.VMBattle).exitBattlePata()})})},y.prototype.onDefeat=function(){this.battleManager.localBattle.pause(),u.sGGame.localModel.getModule(p.LocalBattle).defeat(),l.sGUI.openDialogUI("prefabs/ui/dungeon_settlement_fail",function(t){(t=t.getComponent(g.default))&&t.init(function(t){d.sGViewModel.getModule(f.VMBattle).exitBattlePata(t)})})},i=y,a.BattleManagerModePata=i,cc._RF.pop()},{}],battle_manager_mode_stage:[function(t,e,o){"use strict";cc._RF.push(e,"d5fdc2XsWZFZbwrpQq0c3pn","battle_manager_mode_stage");var i=t,a=o;Object.defineProperty(a,"__esModule",{value:!0}),a.BattleManagerModeStage=void 0;var n=i("audio_config"),r=i("anim_player"),l=i("gui"),c=i("gaudio"),s=i("gnode"),u=i("ggame"),d=i("gview_model"),p=i("game_define"),f=i("local_battle"),h=i("vm_battle"),g=i("battle_defeat_ui"),y=i("battle_victory_ui");function m(){}m.prototype.onEnterStep2=function(){var t,e=this;this.battleManager.warnningAnim?((t=s.sGNode.addUniqueComponent(this.battleManager.warnningAnim.node,r.default)).node.active=!0,this.battleManager.localBattle.pause(),t.init(function(){t.node.active=!1,e.battleManager.localBattle.resume(),d.sGViewModel.getModule(h.VMBattle).openBattleBuff()}),t.play(),c.sGAudio.playEffect(n.sAudioConfig.config.warning)):d.sGViewModel.getModule(h.VMBattle).openBattleBuff()},m.prototype.onVictory=function(){this.battleManager.localBattle.pause(),u.sGGame.localModel.getModule(f.LocalBattle).victory(),l.sGUI.openDialogUI(p.GameDefine.prefabBattleVictory,function(t){(t=t.getComponent(y.default))&&t.init(function(){d.sGViewModel.getModule(h.VMBattle).exitBattleStage()})})},m.prototype.onDefeat=function(){this.battleManager.localBattle.pause(),u.sGGame.localModel.getModule(f.LocalBattle).defeat(),l.sGUI.openDialogUI(p.GameDefine.prefabBattleDefeat,function(t){(t=t.getComponent(g.default))&&t.init(function(t){d.sGViewModel.getModule(h.VMBattle).exitBattleStage(t)})})},i=m,a.BattleManagerModeStage=i,cc._RF.pop()},{}],battle_manager_spawner:[function(t,e,o){"use strict";cc._RF.push(e,"a341dlEhRlHPrXCdarsV5iV","battle_manager_spawner");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};function c(){}Object.defineProperty(n,"__esModule",{value:!0});var s,u=a("ggame"),d=a("local_battle"),p=a("local_stage"),f=a("battle_manager"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==s&&s.apply(this,arguments)||this;return t.battleManager=null,t.minimumSpawnCooldown=3e3,t.passTime=0,t.localStage=null,t.localBattle=null,t.delaySoldierArray=[],t.waitSpawnerSoldierArray=[],t.spawnerSoldierPassTime=0,t.tailDelaySoldierArray=[],t}r(y,s=cc.Component),y.prototype.onLoad=function(){},y.prototype.onEnable=function(){var t=this;this.waitSpawnerSoldierArray=[],this.delaySoldierArray=[],this.localStage=u.sGGame.localModel.getModule(p.LocalStage),this.localBattle=u.sGGame.localModel.getModule(d.LocalBattle),this.delaySoldierArray=this.localBattle.delaySoldierArray;for(var e=this.delaySoldierArray.length-1;0<=e;--e){var o=this.delaySoldierArray[e];if(o.seconds<9999)break;this.tailDelaySoldierArray.push(o),this.delaySoldierArray.splice(e)}this.localBattle.waitDelayWaveCount=this.delaySoldierArray.length,u.sGGame.on(d.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this),u.sGGame.on(f.sBattleManagerEvent.enterStep2,function(){t.delaySoldierArray=[],t.waitSpawnerSoldierArray=[];for(var e=0;e<t.tailDelaySoldierArray.length;++e)for(var o=t.tailDelaySoldierArray[e],i=0;i<o.soldiers.length;++i){var a=o.soldiers[i],n=new c;n.teamID=o.teamID,n.soldierID=a,n.spawnerCount=i<o.spawnerCount.length?o.spawnerCount[i]:o.spawnerCount[o.spawnerCount.length-1],n.level=i<o.level.length?o.level[i]:o.level[o.level.length-1],n.percentAdd=i<o.percent.length?o.percent[i]:o.percent[o.percent.length-1],t.waitSpawnerSoldierArray.push(n)}t.localBattle.waitDelayWaveCount=0,t.localBattle.waitSpawnerSoldierCount=t.waitSpawnerSoldierArray.length,t.tailDelaySoldierArray=[]},this)},y.prototype.onDisable=function(){u.sGGame.targetOff(this)},y.prototype.battleUpdate=function(t){this.passTime+=t,this.spawnerSoldierPassTime+=t;for(var e,o=0;o<this.delaySoldierArray.length;++o){var i=this.delaySoldierArray[o];if(this.passTime<i.seconds)break;this.delaySoldierArray.shift(),this.localBattle.waitDelayWaveCount=this.delaySoldierArray.length;for(var a=0;a<i.soldiers.length;++a){var n=i.soldiers[a];(e=new c).teamID=i.teamID,e.soldierID=n,e.spawnerCount=a<i.spawnerCount.length?i.spawnerCount[a]:i.spawnerCount[i.spawnerCount.length-1],e.level=a<i.level.length?i.level[a]:i.level[i.level.length-1],e.percentAdd=a<i.percent.length?i.percent[a]:i.percent[i.percent.length-1],this.waitSpawnerSoldierArray.push(e)}this.localBattle.waitSpawnerSoldierCount=this.waitSpawnerSoldierArray.length}.3<this.spawnerSoldierPassTime&&(this.spawnerSoldierPassTime=0,this.waitSpawnerSoldierArray.length&&(0<(e=this.waitSpawnerSoldierArray[0]).spawnerCount&&--e.spawnerCount,0===e.spawnerCount&&this.waitSpawnerSoldierArray.shift(),this.battleManager.addSoldierByLevel(e.soldierID,e.teamID,e.level,e.percentAdd),this.localBattle.waitSpawnerSoldierCount=this.waitSpawnerSoldierArray.length))},l([a({type:f.default,tooltip:"\u6218\u573a\u7ba1\u7406\u5668"})],y.prototype,"battleManager",void 0),g=l([h,g("Game/Battle/BattleManagerSpawner")],y),n.default=g,cc._RF.pop()},{}],battle_manager:[function(t,e,o){"use strict";cc._RF.push(e,"c198fT7m7NEoLmt+v4ZXmnd","battle_manager");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.sBattleManagerEvent=void 0;var c,s=a("avatar_config"),u=a("player_attribute_config"),d=a("soldier_config"),p=a("anim_player"),f=a("glog"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("game_define"),b=a("local_attribute"),_=a("local_battle"),v=a("local_skill"),C=a("vm_battle"),P=a("map_manager"),S=a("map_scrollview"),G=a("battle_bullet"),M=a("battle_manager_mode_fuben"),w=a("battle_manager_mode_pata"),A=a("battle_manager_mode_stage"),B=a("battle_particle"),R=a("battle_skill_arrow"),k=a("battle_skill_cannon"),T=a("battle_skill_earthquake"),L=a("battle_skill_plane"),D=a("battle_skill_stone"),O=a("battle_skill_summon"),I=a("battle_skill_tank"),N=a("battle_skill_tonecastn"),E=a("battle_skill_tornado"),j=a("battle_skill_tsunami"),U=a("building_base"),V=a("soldier"),F=a("unit_health"),x=a("unit_skill_buff_package"),q=a("unit_skill_package"),Q=(H=cc._decorator).ccclass,H=(a=H.property,H.menu);function W(){var t=null!==c&&c.apply(this,arguments)||this;return t.unitRoot=null,t.playerBuildingBase=null,t.enemyBuildingBase=null,t.spawnPositionNodeOfPlayer=null,t.spawnPositionNodeOfEnemy=null,t.mapManager=null,t.warnningAnim=null,t.battleModeType=_.enumBattleType.stage,t.battleModeImpl=null,t.battleStep=0,t.unitAIID=0,t.unitDic={},t.playerSoldierDic={},t.enemySoldierDic={},t.spawnPositionOfPlayer=null,t.spawnPositionOfEnemy=null,t.totalLength=0,t.localBattle=null,t.bulletAIID=0,t.particuleAIID=0,t.hasBattleResult=!1,t.mapMaunalMoveLastTime=0,t.waitFinishTime=0,t.isVictory=!1,t.passTime=0,t.soldierCountOfCreating=0,t.damageResultCount=0,t.numberRoot=null,t}n.sBattleManagerEvent={enterStep2:"sBattleManagerEvent.enterStep2",destroySoldier:"sBattleManagerEvent.destroySoldier",afterEnterStep2:"sBattleManagerEvent.afterEnterStep2",afterUpdate:"sBattleManagerEvent.afterUpdate",afterLateUpdate:"sBattleManagerEvent.afterLateUpdate"},r(W,c=cc.Component),W.prototype.onLoad=function(){switch(this.localBattle=g.sGGame.localModel.getModule(_.LocalBattle),this.localBattle.onEnterBattle(this.battleModeType),this._addBuildingBase(this.playerBuildingBase,_.enumTeam.player),this._addBuildingBase(this.enemyBuildingBase,_.enumTeam.enemy),this.spawnPositionOfPlayer=this.spawnPositionNodeOfPlayer.getPosition(),this.spawnPositionOfEnemy=this.spawnPositionNodeOfEnemy.getPosition(),this.battleModeType){case _.enumBattleType.stage:this.battleModeImpl=new A.BattleManagerModeStage,this.battleModeImpl.battleManager=this;break;case _.enumBattleType.pata:this.battleModeImpl=new w.BattleManagerModePata,this.battleModeImpl.battleManager=this;break;case _.enumBattleType.fuben:this.battleModeImpl=new M.BattleManagerModeFuben,this.battleModeImpl.battleManager=this}},W.prototype.onEnable=function(){var t=this;this.totalLength=this.spawnPositionOfPlayer.sub(this.spawnPositionOfEnemy).mag(),y.sGViewModel.getModule(C.VMBattle).battleManager=this,g.sGGame.on(S.sMapScrollViewEvent.touchStart,function(){t.mapMaunalMoveLastTime=99999},this),g.sGGame.on(S.sMapScrollViewEvent.touchEnd,function(){t.mapMaunalMoveLastTime=2},this),g.sGGame.on(_.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this),g.sGGame.on(F.sUnitHealthEvent.damageResult,function(e){h.sGNode.createPoolNode("prefabs/ui/battle_hurt_root",function(o){o&&t.showDamageResult(e)})},this),this.mapMaunalMoveLastTime=2,this.waitFinishTime=1,this.warnningAnim&&(this.warnningAnim.node.active=!1)},W.prototype.onDisable=function(){y.sGViewModel.getModule(C.VMBattle).battleManager=null,h.sGNode.targetOff(this),g.sGGame.targetOff(this)},W.prototype.onDestroy=function(){this.localBattle.onExitBattle()},W.prototype.battleUpdate=function(t){var e=g.sGGame.localModel.getModule(_.LocalBattle);if(!e.pauseBattle)if(this.hasBattleResult)0<this.waitFinishTime&&(this.waitFinishTime-=t,this.waitFinishTime<=0&&(this.isVictory?this.battleModeImpl.onVictory():this.battleModeImpl.onDefeat()));else{for(var o in 0<=this.mapMaunalMoveLastTime&&(this.mapMaunalMoveLastTime-=t),this.updateCamera(),this.passTime+=t,this.playerSoldierDic)(i=this.playerSoldierDic[o]).updateAutoRecover(t);for(var o in this.playerSoldierDic){var i=this.playerSoldierDic[o],a=this.getNearestHostileUnit(i,_.enumTeam.player);i.updateAttack(a,t)}for(var o in this.enemySoldierDic)i=this.enemySoldierDic[o],a=this.getNearestHostileUnit(i,_.enumTeam.enemy),i.updateAttack(a,t);for(var o in this.playerSoldierDic)(i=this.playerSoldierDic[o]).updateMove(null,t);for(var o in this.enemySoldierDic)(i=this.enemySoldierDic[o]).updateMove(null,t);for(var o in this.playerSoldierDic){var r=(i=this.playerSoldierDic[o]).getComponent(x.UnitSkillBuffPackage);i.getComponent(q.default).battleUpdate(t),r.battleUpdate(t)}for(var o in this.enemySoldierDic)r=(i=this.enemySoldierDic[o]).getComponent(x.UnitSkillBuffPackage),i.getComponent(q.default).battleUpdate(t),r.battleUpdate(t);if(1==this.battleStep){if(this.playerBuildingBase&&this.playerBuildingBase.getComponent(F.default).hp<=0&&this.setBattleResult(!1),this.enemyBuildingBase&&this.enemyBuildingBase.getComponent(F.default).hp<=0&&(this.battleStep=2,g.sGGame.emit(n.sBattleManagerEvent.enterStep2),this.localBattle.waitSpawnerSoldierCount?(this.mapMaunalMoveLastTime=2,this.totalLength=this.totalLength+300,this.mapManager.mapCamera.lockTarget(null),this.mapManager.mapCamera.lockDeltaPos(cc.v2(300,0),!0),this.battleModeImpl.onEnterStep2()):this.setBattleResult(!0)),this.battleModeType===_.enumBattleType.pata&&0===this.localBattle.waitDelayWaveCount&&0===e.waitSpawnerSoldierCount&&0===this.soldierCountOfCreating){var l=!0;for(o in this.playerSoldierDic)if(0<(i=this.playerSoldierDic[o]).unitHealth.hp){l=!1;break}if(l)this.setBattleResult(!1);else{var c=!0;for(o in this.enemySoldierDic)if(0<(i=this.enemySoldierDic[o]).unitHealth.hp){c=!1;break}c&&this.setBattleResult(!0)}}}else if(2==this.battleStep&&(this.playerBuildingBase&&this.playerBuildingBase.getComponent(F.default).hp<=0&&this.setBattleResult(!1),0===e.waitSpawnerSoldierCount&&0===this.soldierCountOfCreating)){for(var o in l=!0,this.enemySoldierDic)if(0<(i=this.enemySoldierDic[o]).unitHealth.hp){l=!1;break}l&&this.setBattleResult(!0)}}},W.prototype.lateUpdate=function(){var t,e=[];for(t in this.unitDic)(i=(o=this.unitDic[t]).getComponent(V.default))&&i.unitHealth.hp<=0&&e.push(o);for(var o,i,a,n,r=0;r<e.length;++r)(i=(o=e[r]).getComponent(V.default))&&(a=g.sGGame.localModel.getModule(_.LocalBattle),i.unit.teamID===_.enumTeam.enemy&&(n=g.sGGame.localModel.getModule(b.LocalAttribute),n=Math.round(i.soldier.entry.dropGold*n.attributeSystem.getValue(u.sPlayerAttributeConfig.config.battleGoldAddPercent)/100),a.addGold(n))),o.node===this.mapManager.mapCamera.lockTargetNode&&this.mapManager.mapCamera.lockTarget(null,!0),this.removeUnit(o);this.playerBuildingBase.checkBomb(),this.enemyBuildingBase.checkBomb()},W.prototype.updateCamera=function(){var t,e;!this.mapManager||!this.mapManager.mapCamera||0<this.mapMaunalMoveLastTime?this.mapManager.mapCamera.lockTarget(null,!0):((e=(e=this.getFirstSoldier(_.enumTeam.player))||this.getFirstSoldier(_.enumTeam.enemy))&&(t=e.node),this.mapManager.mapCamera.lockTarget(t,!0))},W.prototype.readyBattle=function(){},W.prototype.startBattle=function(){this.battleStep=1,this.localBattle.resume()},W.prototype._addBuildingBase=function(t,e){var o=++this.unitAIID,i=e===_.enumTeam.player?this.localBattle.playerBaseLevel:this.localBattle.enemyBaseLevel;t.init(o,i,e,this),this.unitDic[t.unit.unitID]=t.unit},W.prototype.addSoldierByLevel=function(t,e,o,i){var a,n,r,l=this;this.node.activeInHierarchy&&(a=++this.unitAIID,n=(n=e===_.enumTeam.player?this.spawnPositionOfPlayer:this.spawnPositionOfEnemy).clone(),e===_.enumTeam.player?n.x+=5:(n.x-=5,2===this.battleStep&&(n.x+=300)),(r=d.sSoldierConfig.getEntry(t))?((r=s.sAvatarConfig.getEntry(r.avatar)).height?n.y=n.y+r.height:(r=3*Math.random(),n.y=n.y-30+20*r),this.soldierCountOfCreating++,h.sGNode.createNode(m.GameDefine.prefabSoldier,function(r){var c;l.soldierCountOfCreating--,r&&(r.setPosition(n),(c=r.getComponent(V.default))&&c.initByLevel(a,t,e,l,o,i),l._addSoldier(c),l.unitRoot.addChild(r),r.zIndex=-n.y)},this)):f.sGLog.error("soldier is not exists ("+t+")"))},W.prototype.addSoldierBySummon=function(t,e,o){var i,a,n,r=this;void 0===o&&(o=100),this.node.activeInHierarchy&&(0===o&&(o=10),i=++this.unitAIID,a=(a=e===_.enumTeam.player?this.spawnPositionOfPlayer:this.spawnPositionOfEnemy).clone(),e===_.enumTeam.player?a.x+=5:(a.x-=5,2===this.battleStep&&(a.x+=300)),(n=d.sSoldierConfig.getEntry(t))?((n=s.sAvatarConfig.getEntry(n.avatar)).height?a.y=a.y+n.height:(n=3*Math.random(),a.y=a.y-30+20*n),this.soldierCountOfCreating++,h.sGNode.createNode(m.GameDefine.prefabSoldier,function(n){var l;r.soldierCountOfCreating--,n&&(n.setPosition(a),(l=n.getComponent(V.default))&&l.initBySummon(i,t,e,r,o),r._addSoldier(l),r.unitRoot.addChild(n),n.zIndex=-a.y)},this)):f.sGLog.error("soldier is not exists ("+t+")"))},W.prototype.addSoldierByBuy=function(t,e){var o,i,a,n=this;this.node.activeInHierarchy&&(o=++this.unitAIID,i=(i=e===_.enumTeam.player?this.spawnPositionOfPlayer:this.spawnPositionOfEnemy).clone(),e===_.enumTeam.player?i.x+=5:(i.x-=5,2===this.battleStep&&(i.x+=300)),(a=d.sSoldierConfig.getEntry(t))?((a=s.sAvatarConfig.getEntry(a.avatar)).height?i.y=i.y+a.height:(a=3*Math.random(),i.y=i.y-30+20*a),this.soldierCountOfCreating++,h.sGNode.createNode(m.GameDefine.prefabSoldier,function(a){var r;n.soldierCountOfCreating--,a&&(a.setPosition(i),(r=a.getComponent(V.default))&&r.initByBuy(o,t,e,n),n._addSoldier(r),n.unitRoot.addChild(a),a.zIndex=-i.y)},this)):f.sGLog.error("soldier is not exists ("+t+")"))},W.prototype._addSoldier=function(t){this.unitDic[t.unit.unitID]=t.unit,t.unit.teamID===_.enumTeam.player?this.playerSoldierDic[t.unit.unitID]=t:t.unit.teamID===_.enumTeam.enemy&&(this.enemySoldierDic[t.unit.unitID]=t)},W.prototype.removeUnit=function(t){t.unitType!==_.enumUnitType.base&&(delete this.unitDic[t.unitID],t.teamID===_.enumTeam.player?delete this.playerSoldierDic[t.unitID]:t.teamID===_.enumTeam.enemy&&delete this.enemySoldierDic[t.unitID],(t=t.getComponent(V.default))&&(t.destorySelf(),g.sGGame.emit(n.sBattleManagerEvent.destroySoldier,t)))},W.prototype.getTeamSoldierArray=function(t){var e,o=[],i=t===_.enumTeam.player?this.playerSoldierDic:this.enemySoldierDic;for(e in i){var a=i[e];o.push(a)}return o},W.prototype.getNearestHostileUnit=function(t,e){var o,i=9999999,a=void 0,n=e===_.enumTeam.player?this.enemySoldierDic:this.playerSoldierDic,r=e===_.enumTeam.player?this.enemyBuildingBase:this.playerBuildingBase;for(o in n){var l=n[o];if(V.enumSoldierStandType[t.soldier.entry.targetType]==V.enumSoldierStandType.land){if(0<l.avatarEntry.height)continue}else if(V.enumSoldierStandType[t.soldier.entry.targetType]==V.enumSoldierStandType.air&&0==l.avatarEntry.height)continue;var c=l.node.getPosition().sub(t.node.getPosition()).mag();if(e===_.enumTeam.player){if(t.node.x>l.node.x)continue}else if(t.node.x<l.node.x)continue;c<i&&(i=c,a=l)}return(a||r).unit},W.prototype.getFirstSoldier=function(t){var e,o=t===_.enumTeam.player?this.playerSoldierDic:this.enemySoldierDic,i=t===_.enumTeam.player?this.enemyBuildingBase:this.playerBuildingBase,a=9999999,n=null;for(e in o){var r=o[e],l=r.node.getPosition().sub(i.unit.node.getPosition()).mag();l<a&&(a=l,n=r)}return n},W.prototype.getFirstSoldierWithCount=function(t,e){var o,i=t===_.enumTeam.player?this.playerSoldierDic:this.enemySoldierDic,a=t===_.enumTeam.player?this.enemyBuildingBase:this.playerBuildingBase,n=[];for(o in i){var r=i[o],l=r.node.getPosition().sub(a.unit.node.getPosition()).mag();n.push({soldier:r,distance:l})}n.sort(function(t,e){return t.distance-e.distance});for(var c=[],s=0;s<e&&n[s];++s)c.push(n[s].soldier);return c},W.prototype.getRandomSoldierWithCount=function(t,e){var o,i=t===_.enumTeam.player?this.playerSoldierDic:this.enemySoldierDic,a=[];for(o in i){var n=i[o],r=Math.random();a.push({soldier:n,value:r})}a.sort(function(t,e){return t.value-e.value});for(var l=[],c=0;c<e&&a[c];++c)l.push(a[c].soldier);return l},W.prototype.getMinHPSoldierWithCount=function(t,e){var o,i=t===_.enumTeam.player?this.playerSoldierDic:this.enemySoldierDic,a=[];for(o in i){var n=i[o],r=n.unitHealth.hp;a.push({soldier:n,value:r})}a.sort(function(t,e){return t.value-e.value});for(var l=[],c=0;c<e&&a[c];++c)l.push(a[c].soldier);return l},W.prototype.getAttackableDistanceHostileUnit=function(t,e){var o,i=t.unit.teamID===_.enumTeam.player?this.enemySoldierDic:this.playerSoldierDic,a=[];for(o in i){var n=i[o];if(V.enumSoldierStandType[t.soldier.entry.targetType]==V.enumSoldierStandType.land){if(0<n.avatarEntry.height)continue}else if(V.enumSoldierStandType[t.soldier.entry.targetType]==V.enumSoldierStandType.air&&0==n.avatarEntry.height)continue;n.node.getPosition().sub(t.node.getPosition()).mag()<e&&a.push(n)}return a},W.prototype.getDistanceHostileUnit=function(t,e){var o,i=t.unit.teamID===_.enumTeam.player?this.enemySoldierDic:this.playerSoldierDic,a=[];for(o in i){var n=i[o];n.node.getPosition().sub(t.node.getPosition()).mag()<e&&a.push(n)}return a},W.prototype.useSkillStone=function(){var t;this.node.activeInHierarchy&&(t=g.sGGame.localModel.getModule(v.LocalSkillPackage).getSkill(1).getAttr1(),this.mapManager.mapCamera&&this.mapManager.mapCamera.shake(5,100*(.225*t+1)),t=new cc.Node,(h.sGNode.addUniqueComponent(t,D.default).battleManager=this).unitRoot.addChild(t))},W.prototype.useSkillEarthquake=function(){var t;this.node.activeInHierarchy&&(t=g.sGGame.localModel.getModule(v.LocalSkillPackage).getSkill(2).getAttr1(),this.mapManager.mapCamera&&this.mapManager.mapCamera.shake(5,100*(.125*t+1)),t=new cc.Node,(h.sGNode.addUniqueComponent(t,T.default).battleManager=this).unitRoot.addChild(t))},W.prototype.useSkillTsunami=function(){var t=this;this.node.activeInHierarchy&&(this.mapManager.mapCamera&&this.mapManager.mapCamera.shake(5,800),h.sGNode.createNode(m.GameDefine.prefabBattleSkillTsunami,function(e){e&&(h.sGNode.addUniqueComponent(e,j.default).battleManager=t).unitRoot.addChild(e)},this))},W.prototype.useSkillTornado=function(){var t;this.node.activeInHierarchy&&(t=g.sGGame.localModel.getModule(v.LocalSkillPackage).getSkill(4).getAttr1(),this.mapManager.mapCamera&&this.mapManager.mapCamera.shake(5,100*(.125*t+1)),t=new cc.Node,(h.sGNode.addUniqueComponent(t,E.default).battleManager=this).unitRoot.addChild(t))},W.prototype.useSkillArrow=function(){var t;this.node.activeInHierarchy&&(t=g.sGGame.localModel.getModule(v.LocalSkillPackage).getSkill(5).getAttr2(),this.mapManager.mapCamera&&this.mapManager.mapCamera.shake(5,100*(.125*t+1)),t=new cc.Node,(h.sGNode.addUniqueComponent(t,R.default).battleManager=this).unitRoot.addChild(t))},W.prototype.useSkillStonecastn=function(){var t;this.node.activeInHierarchy&&(t=g.sGGame.localModel.getModule(v.LocalSkillPackage).getSkill(6).getAttr2(),this.mapManager.mapCamera&&this.mapManager.mapCamera.shake(5,100*(.125*t+1)),t=new cc.Node,(h.sGNode.addUniqueComponent(t,N.default).battleManager=this).unitRoot.addChild(t))},W.prototype.useSkillTank=function(){var t=this;this.node.activeInHierarchy&&(this.mapManager.mapCamera&&this.mapManager.mapCamera.shake(5,800),h.sGNode.createNode(m.GameDefine.prefabBattleSkillTank,function(e){e&&(h.sGNode.addUniqueComponent(e,I.default).battleManager=t).unitRoot.addChild(e)},this))},W.prototype.useSkillCannon=function(){var t=this;this.node.activeInHierarchy&&(this.mapManager.mapCamera&&this.mapManager.mapCamera.shake(5,80),h.sGNode.createNode(m.GameDefine.prefabBattleSkillCannon,function(e){e&&(h.sGNode.addUniqueComponent(e,k.default).battleManager=t).unitRoot.addChild(e)},this))},W.prototype.useSkillHealth=function(){if(this.node.activeInHierarchy)for(var t in this.playerSoldierDic)this.playerSoldierDic[t].autoRecoverSeconds=15},W.prototype.useSkillPlane=function(){var t=this;this.node.activeInHierarchy&&(this.mapManager.mapCamera&&this.mapManager.mapCamera.shake(5,400),h.sGNode.createNode(m.GameDefine.prefabBattleSkillPlane,function(e){e&&(h.sGNode.addUniqueComponent(e,L.default).battleManager=t).unitRoot.addChild(e)},this))},W.prototype.useSkillCallSoldier=function(t){var e,o;this.node.activeInHierarchy&&(o=g.sGGame.localModel.getModule(v.LocalSkillPackage).getSkill(t).getAttr1(),this.mapManager.mapCamera&&this.mapManager.mapCamera.shake(5,100*(.125*o+1)),e=new cc.Node,(o=h.sGNode.addUniqueComponent(e,O.default)).battleManager=this,o.skillID=t,this.unitRoot.addChild(e))},W.prototype.createBullet=function(t,e,o,i,a,n,r,l){var c,s=this;this.node.activeInHierarchy&&(c=++this.bulletAIID,h.sGNode.createNode(e,function(e){var u;e&&((u=h.sGNode.addUniqueComponent(e,G.default)).damage=r,u.teamID=l,u.bulletID=c,u.battleManager=s,u.rotation=a,u.scale=n,u.spawner=t,e.setPosition(cc.v2(o,i)),s.unitRoot.addChild(e))},this))},W.prototype.createParticle=function(t,e,o,i,a,n){var r,l=this;this.node.activeInHierarchy&&(r=++this.particuleAIID,h.sGNode.createNode(t,function(t){var c;t&&((c=h.sGNode.addUniqueComponent(t,B.default)).params=n,c.particuleID=r,c.battleManager=l,t.scale=a,t.angle=i,t.setPosition(cc.v2(e,o)),l.unitRoot.addChild(t))},this))},W.prototype.createParticleZero=function(t,e,o,i,a,n){var r,l=this;this.node.activeInHierarchy&&(r=++this.particuleAIID,h.sGNode.createNode(t,function(t){var c;t&&((c=h.sGNode.addUniqueComponent(t,B.default)).params=n,c.particuleID=r,c.battleManager=l,t.scale=a,t.angle=i,t.zIndex=-100,t.setPosition(cc.v2(e,o)),l.unitRoot.addChild(t))},this))},W.prototype.createParticleScaleX=function(t,e,o,i,a){var n,r=this;this.node.activeInHierarchy&&(n=++this.particuleAIID,h.sGNode.createNode(t,function(t){var l;t&&((l=h.sGNode.addUniqueComponent(t,B.default)).params=a,l.particuleID=n,l.battleManager=r,t.scaleX=i,t.setPosition(cc.v2(e,o)),r.unitRoot.addChild(t))},this))},W.prototype.onExitBattle=function(){this.setBattleResult(!0)},W.prototype.setBattleResult=function(t){this.hasBattleResult=!0,this.isVictory=t},W.prototype.showDamageResult=function(t){var e=this;if(this.damageResultCount++,!(30<this.damageResultCount)&&t){var o="battle_hurt_root";switch(t.hurtType){case F.eUnitHurtType.normal:o="battle_number_normal";break;case F.eUnitHurtType.critical:o="battle_number_critical";break;case F.eUnitHurtType.extra:o="battle_number_extra";break;case F.eUnitHurtType.splash:o="battle_number_splash";break;case F.eUnitHurtType.shield:o="battle_number_shield";break;case F.eUnitHurtType.oneHitKill:o="battle_number_oneHitKill";break;case F.eUnitHurtType.immuneDamage:o="battle_number_immuneDamage";break;case F.eUnitHurtType.heal:o="battle_number_heal"}h.sGNode.createPoolNode("prefabs/ui/"+o,null,function(o){var i,a=cc.find("anim_root",o),n=cc.find("anim_root/label_hurt",o);a&&((i=n?n.getComponent(cc.Label):null)&&(t.hurtType==F.eUnitHurtType.heal?(i.string="+"+t.damage,i.node.color=cc.color(0,255,0)):(i.string="-"+t.damage,i.node.color=m.GameDefine.teamColorArray[t.unit.teamID])),n=cc.v2(0,0),(i=h.sGNode.addUniqueComponent(a,p.default))&&i.init(function(){},null,!1),e.numberRoot?(n=t.unit.node.convertToWorldSpaceAR(n),n=e.numberRoot.convertToNodeSpaceAR(n),o.setPosition(n),e.numberRoot.addChild(o)):(o.setPosition(n),t.unit.node.addChild(o)),o.opacity=255,a=cc.tween(o),n=t.unit.teamID==_.enumTeam.enemy?cc.v3(n.x+50*Math.random()+30,n.y+30*Math.random()+20,0):cc.v3(n.x-50*Math.random()-30,n.y+30*Math.random()+20,0),a.to(.22,{position:n}).delay(.7).to(.3,{opacity:0}).call(function(){h.sGNode.destoryPoolNode(o),e.damageResultCount--}).start(),i&&i.play())},this)}},l([a({type:cc.Node,tooltip:"\u51fa\u751f\u70b9\u8282\u70b9"})],W.prototype,"unitRoot",void 0),l([a({type:U.default,tooltip:"\u73a9\u5bb6\u57fa\u5730"})],W.prototype,"playerBuildingBase",void 0),l([a({type:U.default,tooltip:"\u654c\u65b9\u57fa\u5730"})],W.prototype,"enemyBuildingBase",void 0),l([a({type:cc.Node,tooltip:"\u73a9\u5bb6\u51fa\u751f\u70b9\u8282\u70b9"})],W.prototype,"spawnPositionNodeOfPlayer",void 0),l([a({type:cc.Node,tooltip:"\u5730\u65b9\u51fa\u751f\u70b9\u8282\u70b9"})],W.prototype,"spawnPositionNodeOfEnemy",void 0),l([a(P.default)],W.prototype,"mapManager",void 0),l([a(cc.Animation)],W.prototype,"warnningAnim",void 0),l([a({type:cc.Enum(_.enumBattleType),tooltip:"\u6a21\u5f0f\u914d\u7f6e"})],W.prototype,"battleModeType",void 0),l([a(cc.Node)],W.prototype,"numberRoot",void 0),H=l([Q,H("Game/Battle/BattleManager")],W),n.default=H,cc._RF.pop()},{}],battle_monitor_ui:[function(t,e,o){"use strict";cc._RF.push(e,"0cd7cRS6WJAzqQ7C4SDI6fe","battle_monitor_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("age_config"),u=a("scroll_process_bar"),d=a("glog"),p=a("gnode"),f=a("gtime"),h=a("ggame"),g=a("gview_model"),y=a("local_battle"),m=a("local_stage"),b=a("vm_battle"),_=a("vm_building"),v=a("battle_manager"),C=a("battle_soldier_progress_tip_ui"),P=a("soldier"),S=(G=cc._decorator).ccclass,G=(a=G.property,G.menu);function M(){var t=null!==c&&c.apply(this,arguments)||this;return t.playerProgressBar=null,t.enemyProgressBar=null,t.battleNode=null,t.battleStageLabel=null,t.battleTimeLabel=null,t.battleSoldierCountLabel=null,t.speedx1Button=null,t.speedx2Button=null,t.battleBGRoot=null,t.battleUIRoot=null,t.soldierProgressTipRoot=null,t.soldierProgressTipPrefab=null,t.battleBGNode=null,t.barLength=0,t.isFinished=!1,t.totalDt=0,t.battleSoldierProgressTipUIDic={},t}r(M,c=cc.Component),M.prototype.onLoad=function(){var t=this;this.localBattle=h.sGGame.localModel.getModule(y.LocalBattle),this.playerProgressBar&&(this.playerScrollProgressBar=p.sGNode.addUniqueComponent(this.playerProgressBar.node,u.default),this.barLength=this.playerProgressBar.totalLength),this.enemyProgressBar&&(this.enemyScrollProgressBar=p.sGNode.addUniqueComponent(this.enemyProgressBar.node,u.default)),this.speedx1Button&&this.speedx1Button.node.on("click",function(){t.setSpeed(1)}),this.speedx2Button&&this.speedx2Button.node.on("click",function(){var e=t.localBattle.getDoubleSpeedRemainEffectiveTime();0==e?(t.localBattle.pause(),g.sGViewModel.getModule(_.VMBuilding).openDoubleCollectUI(function(e){h.sGGame.localModel.getModule(y.LocalBattle).resume(),e&&(t.localBattle.effectDoubleSpeed(),t.setSpeed(1.6))},t)):(d.sGLog.info("doubleSpeedRemainEffectiveTime:",f.sGTime.toTimeSpanString(e/1e3)),t.setSpeed(1.6))})},M.prototype.onEnable=function(){var t=this;this._refresh();var e,o=h.sGGame.localModel.getModule(m.LocalStage);this.battleStageLabel&&(e=o.currentBattleStageEntry,this.battleStageLabel.string=e.name),h.sGGame.on(y.sLocalBattleEvent.activeDoubleSpeed,function(){t.refreshSpeed()},this),this.battleBGRoot&&(o=o.currentBattleStageEntry.age,o=s.sAgeConfig.getEntry(o),p.sGNode.createNode(o.battleBackground,function(e){t.battleBGNode=e,t.battleBGNode.parent=t.battleBGRoot},this)),this.refreshSpeed(),p.sGNode.createNode("prefabs/ui/battle_buff_status",this.battleUIRoot,function(e){e&&(e.active=!t.localBattle.battleFinish)},this),h.sGGame.on(y.sLocalBattleEvent.finished,this.onBattleFinished.bind(this),this),this.initSoldierProgress()},M.prototype.onBattleFinished=function(){this.battleUIRoot&&(this.battleUIRoot.active=!1)},M.prototype.onDisable=function(){p.sGNode.targetOff(this),h.sGGame.targetOff(this),this.battleBGNode&&(p.sGNode.destoryNode(this.battleBGNode),this.battleBGNode=null)},M.prototype.update=function(t){this._refresh(),this.totalDt+=t,1<=this.totalDt&&(this.totalDt=0,1<this.localBattle.battleTimeScale&&this.localBattle.getDoubleSpeedRemainEffectiveTime()<=0&&this.setSpeed(1))},M.prototype.setSpeed=function(t){this.localBattle.battleTimeScale=t,this.refreshSpeed()},M.prototype.refreshSpeed=function(){var t=this.localBattle.battleTimeScale;this.speedx1Button&&(this.speedx1Button.node.active=1!==t&&this.localBattle.doubleSpeedEnabled),this.speedx2Button&&(this.speedx2Button.node.active=1.6!==t&&this.localBattle.doubleSpeedEnabled)},M.prototype._refresh=function(){var t,e,o,i,a,n=g.sGViewModel.getModule(b.VMBattle);n.battleManager?(t=n.battleManager.getFirstSoldier(y.enumTeam.player),e=n.battleManager.getFirstSoldier(y.enumTeam.enemy),o=(o=t&&t.attackState!==P.enumSoldierAttackState.idle)||e&&e.attackState!==P.enumSoldierAttackState.idle,i=-this.barLength/2,t?(i+=(a=Math.abs(t.node.getPosition().sub(n.battleManager.spawnPositionOfPlayer).x))/n.battleManager.totalLength*this.barLength,this.playerScrollProgressBar&&this.playerScrollProgressBar.setProgress(a/n.battleManager.totalLength)):this.playerScrollProgressBar&&this.playerScrollProgressBar.setProgress(0),e?(a=Math.abs(e.node.getPosition().sub(n.battleManager.spawnPositionOfEnemy).x),this.enemyScrollProgressBar&&this.enemyScrollProgressBar.setProgress(a/n.battleManager.totalLength)):this.enemyScrollProgressBar&&this.enemyScrollProgressBar.setProgress(0),this.battleNode&&(this.battleNode.x=i,this.battleNode.active=o),this.battleTimeLabel&&(this.battleTimeLabel.string=f.sGTime.toTimeSpanString(n.battleManager.passTime)),this.battleSoldierCountLabel&&(this.battleSoldierCountLabel.string="0/0"),this.refreshSoldierProgress()):(this.playerScrollProgressBar&&this.playerScrollProgressBar.setProgress(0),this.enemyScrollProgressBar&&this.enemyScrollProgressBar.setProgress(0))},M.prototype.initSoldierProgress=function(){var t=this;h.sGGame.on(v.sBattleManagerEvent.destroySoldier,function(e){var o=t.battleSoldierProgressTipUIDic[e.unit.unitID];o&&(p.sGNode.destoryNode(o.node),delete t.battleSoldierProgressTipUIDic[e.unit.unitID])},this)},M.prototype.refreshSoldierProgress=function(){if(this.soldierProgressTipRoot&&this.soldierProgressTipPrefab){var t=g.sGViewModel.getModule(b.VMBattle);if(t.battleManager){for(var e in t.battleManager.playerSoldierDic)this.refreshSoldierProgressTip(t.battleManager.playerSoldierDic[e]);for(var e in t.battleManager.enemySoldierDic)this.refreshSoldierProgressTip(t.battleManager.enemySoldierDic[e])}}},M.prototype.refreshSoldierProgressTip=function(t){var e,o=g.sGViewModel.getModule(b.VMBattle),i=this.battleSoldierProgressTipUIDic[t.unit.unitID];i||(e=cc.instantiate(this.soldierProgressTipPrefab))&&((i=e.getComponent(C.default))&&(i.init(t),this.battleSoldierProgressTipUIDic[t.unit.unitID]=i),this.soldierProgressTipRoot.addChild(e)),o=(t.unit.teamID===y.enumTeam.player?Math.abs(t.node.getPosition().sub(o.battleManager.spawnPositionOfPlayer).x):Math.abs(t.node.getPosition().sub(o.battleManager.spawnPositionOfEnemy).x))/o.battleManager.totalLength*this.playerScrollProgressBar.progressbar.totalLength,t.unit.teamID===y.enumTeam.player?i.node.x=o:i.node.x=this.soldierProgressTipRoot.getContentSize().width-o},l([a(cc.ProgressBar)],M.prototype,"playerProgressBar",void 0),l([a(cc.ProgressBar)],M.prototype,"enemyProgressBar",void 0),l([a(cc.Node)],M.prototype,"battleNode",void 0),l([a(cc.Label)],M.prototype,"battleStageLabel",void 0),l([a(cc.Label)],M.prototype,"battleTimeLabel",void 0),l([a(cc.Label)],M.prototype,"battleSoldierCountLabel",void 0),l([a({type:cc.Button,tooltip:"1\u500d\u901f"})],M.prototype,"speedx1Button",void 0),l([a({type:cc.Button,tooltip:"2\u500d\u901f"})],M.prototype,"speedx2Button",void 0),l([a(cc.Node)],M.prototype,"battleBGRoot",void 0),l([a(cc.Node)],M.prototype,"battleUIRoot",void 0),l([a({displayName:"\u58eb\u5175\u8fdb\u5ea6\u6302\u8282\u70b9",type:cc.Node})],M.prototype,"soldierProgressTipRoot",void 0),l([a({displayName:"\u58eb\u5175\u8fdb\u5ea6\u5c55\u793a\u9884\u5236\u4ef6",type:cc.Prefab})],M.prototype,"soldierProgressTipPrefab",void 0),G=l([S,G("Game/UI/BattleMonitorUI")],M),n.default=G,cc._RF.pop()},{}],battle_particle:[function(t,e,o){"use strict";cc._RF.push(e,"45ee9czrY5DApmgWou/35hB","battle_particle");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=(d=cc._decorator).ccclass,d=(a=d.property,d.menu);function p(){var t=null!==c&&c.apply(this,arguments)||this;return t.spine=null,t.params=void 0,t.particuleID=0,t.battleManager=void 0,t}n.MAX_MAP_VALUE=1e100,r(p,c=cc.Component),p.prototype.onEnable=function(){var t,e=this;this.spine&&(t=this.spine.getCurrent(0),this.spine.setAnimation(0,t.animation.name,!1),this.spine.setCompleteListener(function(){s.sGNode.destoryNode(e.node)}))},l([a({type:sp.Skeleton,tooltip:"\u52a8\u753b\u6587\u4ef6"})],p.prototype,"spine",void 0),d=l([u,d("Game/Battle/BattleParticle")],p),n.default=d,cc._RF.pop()},{}],battle_skill_arrow:[function(t,e,o){"use strict";cc._RF.push(e,"ff310IjbCVBMamNulE9fC8w","battle_skill_arrow");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=a("ggame"),d=a("game_define"),p=a("local_battle"),f=a("local_skill");function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._maxSkyY=700,t._passTime=0,t._oneBulletTime=.125,t._bulletCount=0,t._bulletCountMax=0,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(h,c=cc.Component),h.prototype.onLoad=function(){},h.prototype.onEnable=function(){var t=this;this._passTime=0;var e=u.sGGame.localModel.getModule(f.LocalSkillPackage);this._skill=e.getSkill(5),this._bulletCountMax=this._skill.getAttr2(),0<(e=this._skill.getAttr4())&&(this._bulletCountMax=e),this._bulletCount=0,u.sGGame.on(p.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},h.prototype.onDisable=function(){u.sGGame.targetOff(this)},h.prototype.battleUpdate=function(t){var e,o,i,a,n;this._passTime+=t,this._passTime>this._oneBulletTime&&(this._passTime=0,e=260+20*Math.random(),o=this.battleManager.spawnPositionOfPlayer.x+Math.random()*this.battleManager.totalLength,i=this.battleManager.spawnPositionOfPlayer.y+this._maxSkyY,a=(70*Math.random()+120)/100,t=u.sGGame.localModel.getModule(p.LocalBattle).debugEnemyOperate?p.enumTeam.enemy:p.enumTeam.player,0!==this._bulletCount||(n=this._getEnemy())&&(o=n.node.x,e=270),n=this._skill.getAttr1(),this.battleManager.createBullet(void 0,d.GameDefine.prefabBattleSkillArrow,o,i,e,a,n=0==n?1e4:n,t),this._bulletCount++,this._bulletCount>=this._bulletCountMax&&s.sGNode.destoryNode(this.node))},h.prototype._getEnemy=function(){var t,e=this.battleManager.enemySoldierDic;for(t in e=u.sGGame.localModel.getModule(p.LocalBattle).debugEnemyOperate?this.battleManager.playerSoldierDic:e)return e[t];return null},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillArrow")],h),r.default=n,cc._RF.pop()},{}],battle_skill_cannon:[function(t,e,o){"use strict";cc._RF.push(e,"4d4ebRZ1etNJ5Kl4MKgj/iS","battle_skill_cannon");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=a("ggame"),d=a("local_battle"),p=a("local_skill"),f=a("unit_health");function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._moveSpeed=2400,t._damageEnemyDic={},t._pushEnemyDic={},t._startPos=void 0,t._bulletFinishX=0,t._passTime=0,t._dir=0,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(h,c=cc.Component),h.prototype.onLoad=function(){},h.prototype.onEnable=function(){var t=this;this._pushEnemyDic={},this._damageEnemyDic={},this._passTime=0;var e=u.sGGame.localModel.getModule(p.LocalSkillPackage);this._skill=e.getSkill(7),u.sGGame.localModel.getModule(d.LocalBattle).debugEnemyOperate?(this._startPos=this.battleManager.spawnPositionOfEnemy.clone(),this._bulletFinishX=this.battleManager.spawnPositionOfPlayer.x,this._dir=-1,this.node.scaleX=-this.node.scaleX):(this._startPos=this.battleManager.spawnPositionOfPlayer.clone(),this._bulletFinishX=this.battleManager.spawnPositionOfPlayer.x+this.battleManager.totalLength,this._dir=1),this._startPos.x-=300*this._dir,this.node.setPosition(this._startPos),u.sGGame.on(d.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},h.prototype.onDisable=function(){u.sGGame.targetOff(this)},h.prototype.battleUpdate=function(t){this._passTime+=t;var e=this._startPos.x+this._dir*this._passTime*this._moveSpeed,o=(t=u.sGGame.localModel.getModule(d.LocalBattle).debugEnemyOperate?d.enumTeam.enemy:d.enumTeam.player,this.battleManager.enemySoldierDic);for(n in o=t===d.enumTeam.enemy?this.battleManager.playerSoldierDic:o){var i=o[n],a=e+150;!this._damageEnemyDic[n]&&a>i.node.x-i.soldier.entry.bodyWidth/2&&a<i.node.x+i.soldier.entry.bodyWidth/2&&(0==(a=this._skill.getAttr1())&&(a=1e4),i.onHurt(void 0,a,f.eUnitHurtType.normal),0<(this._damageEnemyDic[n]=i).unitHealth.hp&&(a=this._skill.getAttr2(),100*Math.random()<=a&&(this._pushEnemyDic[n]=i)))}if(e<this._bulletFinishX)for(var n in this._pushEnemyDic)(i=o[n])&&i.node.x<e&&i.node.setPosition(cc.v2(e,i.node.y));1===this._dir?e>this._bulletFinishX+300&&s.sGNode.destoryNode(this.node):e<this._bulletFinishX-300&&s.sGNode.destoryNode(this.node)},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillConnon")],h),r.default=n,cc._RF.pop()},{}],battle_skill_earthquake_bullet:[function(t,e,o){"use strict";cc._RF.push(e,"25dd65TV/xOw5jVjX+VNjvE","battle_skill_earthquake_bullet");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("game_define");function u(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._passTime=0,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(u,c=cc.Component),u.prototype.onLoad=function(){},u.prototype.onEnable=function(){this._passTime=0},u.prototype.onDisable=function(){var t=this.node.position.x+15*Math.random(),e=this.node.position.y;this.battleManager&&this.battleManager.createParticle(s.GameDefine.prefabParticleStoneBomb,t,e,this.node.angle,this.node.scale,{})},u.prototype.update=function(t){this._passTime+=t},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillEarthquakeBullet")],u),r.default=n,cc._RF.pop()},{}],battle_skill_earthquake:[function(t,e,o){"use strict";cc._RF.push(e,"5f80846/Z5IZpRWWqwW3tuY","battle_skill_earthquake");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("avatar_config"),u=a("gnode"),d=a("ggame"),p=a("game_define"),f=a("local_battle"),h=a("local_skill");function g(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._passTime=0,t._oneBulletTime=.125,t._bulletCount=0,t._bulletCountMax=0,t._bulletDamagePercent=0,t._damageEnemyDic={},t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(g,c=cc.Component),g.prototype.onLoad=function(){},g.prototype.onEnable=function(){var t=this;this._passTime=0;var e=d.sGGame.localModel.getModule(h.LocalSkillPackage);this._skill=e.getSkill(2),this._bulletCountMax=this._skill.getAttr1(),this._bulletDamagePercent=this._skill.getAttr2(),this._bulletCount=0,d.sGGame.on(f.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},g.prototype.onDisable=function(){d.sGGame.targetOff(this)},g.prototype.battleUpdate=function(t){var e,o;this._passTime+=t,this._passTime>this._oneBulletTime&&(this._passTime=0,e=d.sGGame.localModel.getModule(f.LocalBattle).debugEnemyOperate?f.enumTeam.enemy:f.enumTeam.player,o=this.battleManager.enemySoldierDic,e===f.enumTeam.enemy&&(o=this.battleManager.playerSoldierDic),0<(t=Object.keys(o)).length?(t=t[Math.floor(Math.random()*t.length)],this._damageEnemyDic[t]||(o=o[t],this._damageEnemyDic[t]=o,(t=s.sAvatarConfig.getEntry(o.soldier.entry.avatar))&&0===t.height&&(t=Math.floor(this._bulletDamagePercent*o.unitHealth.maxHP/100),this.battleManager.createBullet(void 0,p.GameDefine.prefabBattleSkillEarthquake,o.node.x,o.node.y,0,1,t,e),this._bulletCount++,this._bulletCount>=this._bulletCountMax&&u.sGNode.destoryNode(this.node)))):u.sGNode.destoryNode(this.node))},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillEarthquake")],g),r.default=n,cc._RF.pop()},{}],battle_skill_panel_icon:[function(t,e,o){"use strict";cc._RF.push(e,"3b163t/2pxOs47pK/0ToKPs","battle_skill_panel_icon");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("card_config"),d=a("i18n"),p=a("gaudio"),f=a("gnode"),h=a("ggame"),g=a("gview_model"),y=a("local_battle"),m=a("vm_battle"),b=a("vm_reward"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.icon=null,t.cooldownProgressBar=null,t.starLabel=null,t.nameLabel=null,t.clickButton=null,t.localSkill=null,t}r(C,c=cc.Component),C.prototype.init=function(t){this.localSkill=t,this.enabledInHierarchy&&this._refresh()},C.prototype.onLoad=function(){var t=this;this.clickButton&&this.clickButton.node.on("click",function(){0===g.sGViewModel.getModule(m.VMBattle).useLocalSkill(t.localSkill)&&p.sGAudio.playEffect(s.sAudioConfig.config.flyerSend)})},C.prototype.onEnable=function(){this._refresh()},C.prototype.onDisable=function(){f.sGNode.targetOff(this),h.sGGame.targetOff(this)},C.prototype.update=function(){var t,e;this.localSkill&&(t=(e=h.sGGame.localModel.getModule(y.LocalBattle)).getSkillCooldown(this.localSkill),e=e.getSkillCD(this.localSkill.entry),this.cooldownProgressBar&&(this.cooldownProgressBar.progress=1-t/e),this.icon&&f.sGNode.setSpriteMaterial(this.icon,0<t?"2d-gray-sprite":"2d-sprite"))},C.prototype._refresh=function(){var t,e;this.localSkill&&(t=h.sGGame.localModel.getModule(y.LocalBattle).getSkillCooldown(this.localSkill),e=u.sCardConfig.getEntry(this.localSkill.entry.cardID),this.icon&&(f.sGNode.setSprite(this.icon,e.icon),f.sGNode.setSpriteMaterial(this.icon,0<t?"2d-gray-sprite":"2d-sprite")),this.nameLabel&&(this.nameLabel.string=d.i18n.t(e.name),this.nameLabel.node.color=g.sGViewModel.getModule(b.VMReward).getQualityColor(e.quality)),this.starLabel&&(this.starLabel.string=this.localSkill.card.getLevel().toString()))},l([a(cc.Sprite)],C.prototype,"icon",void 0),l([a(cc.ProgressBar)],C.prototype,"cooldownProgressBar",void 0),l([a(cc.Label)],C.prototype,"starLabel",void 0),l([a(cc.Label)],C.prototype,"nameLabel",void 0),l([a(cc.Button)],C.prototype,"clickButton",void 0),v=l([_,v("Game/Battle/BattleSkillPanelIcon")],C),n.default=v,cc._RF.pop()},{}],battle_skill_plane_bullet:[function(t,e,o){"use strict";cc._RF.push(e,"aa272KJ7chCWJX5fHH5tkmM","battle_skill_plane_bullet");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("ggame"),u=a("game_define"),d=a("local_battle"),p=a("battle_bullet");function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._passTime=0,t._oneBulletTime=.033,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(f,c=cc.Component),f.prototype.onLoad=function(){},f.prototype.onEnable=function(){var t=this;this._passTime=0,s.sGGame.on(d.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},f.prototype.onDisable=function(){s.sGGame.targetOff(this);var t=this.node.position.x+15*Math.random(),e=this.node.position.y;this.battleManager&&this.battleManager.createParticle(u.GameDefine.prefabParticlePlaneMissileBomb,t,e,this.node.angle,this.node.scale,{})},f.prototype.battleUpdate=function(t){this._passTime+=t,this.battleManager||(this.battleManager=this.node.getComponent(p.default).battleManager)},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillPlaneBullet")],f),r.default=n,cc._RF.pop()},{}],battle_skill_plane:[function(t,e,o){"use strict";cc._RF.push(e,"32ac4vBbrlKo6s1iLWkboVn","battle_skill_plane");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=a("ggame"),d=a("game_define"),p=a("local_battle");function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._passTimeCreateBullet=0,t._moveSpeed=400,t._startPos=void 0,t._bulletFinishX=0,t._passTime=0,t._dir=0,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(f,c=cc.Component),f.prototype.onLoad=function(){},f.prototype.onEnable=function(){var t=this;this._passTime=0,this._passTimeCreateBullet=0,u.sGGame.localModel.getModule(p.LocalBattle).debugEnemyOperate?(this._startPos=this.battleManager.spawnPositionOfEnemy.clone(),this._bulletFinishX=this.battleManager.spawnPositionOfPlayer.x,this._dir=-1,this.node.scaleX=-this.node.scaleX):(this._startPos=this.battleManager.spawnPositionOfPlayer.clone(),this._bulletFinishX=this.battleManager.spawnPositionOfPlayer.x+this.battleManager.totalLength,this._dir=1),this._startPos.x-=this._dir*(250+100*Math.random()),this._startPos.y+=500,this.node.setPosition(this._startPos),u.sGGame.on(p.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},f.prototype.onDisable=function(){u.sGGame.targetOff(this)},f.prototype.battleUpdate=function(t){this._passTime+=t,this._passTimeCreateBullet+=t;var e,o=this._startPos.x+this._dir*this._passTime*this._moveSpeed;this.node.setPosition(cc.v2(o,this._startPos.y)),.17<this._passTimeCreateBullet&&(this._passTimeCreateBullet=0,this.node.position.x>this.battleManager.spawnPositionOfPlayer.x&&this.node.position.x<this.battleManager.spawnPositionOfPlayer.x+this.battleManager.totalLength&&(e=this.node.position.x,t=this.node.position.y,o=u.sGGame.localModel.getModule(p.LocalBattle).debugEnemyOperate?p.enumTeam.enemy:p.enumTeam.player,this.battleManager.createBullet(void 0,d.GameDefine.prefabBattleSkillMissile,e,t,270,1,1e4,o))),1===this._dir?this.node.position.x>this._bulletFinishX+300&&s.sGNode.destoryNode(this.node):this.node.position.x<this._bulletFinishX-300&&s.sGNode.destoryNode(this.node)},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillPlane")],f),r.default=n,cc._RF.pop()},{}],battle_skill_stone_bullet:[function(t,e,o){"use strict";cc._RF.push(e,"3c7d80V2qJIjKkiyXSUtFH0","battle_skill_stone_bullet");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("ggame"),u=a("game_define"),d=a("local_battle"),p=a("battle_bullet");function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._passTime=0,t._oneBulletTime=.033,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(f,c=cc.Component),f.prototype.onLoad=function(){},f.prototype.onEnable=function(){var t=this;this._passTime=0,s.sGGame.on(d.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},f.prototype.onDisable=function(){var t=this.node.position.x+15*Math.random(),e=this.node.position.y;this.battleManager&&this.battleManager.createParticle(u.GameDefine.prefabParticleStoneBomb,t,e,this.node.angle,this.node.scale,{}),s.sGGame.targetOff(this)},f.prototype.battleUpdate=function(t){var e;this._passTime+=t,this._passTime>this._oneBulletTime&&(this._passTime=0,e=this.node.position.x+15*Math.random(),t=this.node.position.y,this.battleManager||(this.battleManager=this.node.getComponent(p.default).battleManager),this.battleManager&&this.battleManager.createParticleZero(u.GameDefine.prefabParticleStoneFire,e,t,this.node.angle,this.node.scale,{}))},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillStoneBullet")],f),r.default=n,cc._RF.pop()},{}],battle_skill_stone:[function(t,e,o){"use strict";cc._RF.push(e,"aa530kfMidNDL2iKRmYspqr","battle_skill_stone");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=a("ggame"),d=a("game_define"),p=a("local_battle"),f=a("local_skill");function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._maxSkyY=700,t._passTime=0,t._oneBulletTime=.225,t._bulletCount=0,t._bulletCountMax=0,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(h,c=cc.Component),h.prototype.onLoad=function(){},h.prototype.onEnable=function(){var t=this;this._passTime=0;var e=u.sGGame.localModel.getModule(f.LocalSkillPackage);this._skill=e.getSkill(1),this._bulletCountMax=this._skill.getAttr1(),this._bulletCount=0,u.sGGame.on(p.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},h.prototype.onDisable=function(){u.sGGame.targetOff(this)},h.prototype.battleUpdate=function(t){var e,o,i,a,n;this._passTime+=t,this._passTime>this._oneBulletTime&&(this._passTime=0,e=260+20*Math.random(),o=this.battleManager.spawnPositionOfPlayer.x+Math.random()*this.battleManager.totalLength,i=this.battleManager.spawnPositionOfPlayer.y+this._maxSkyY,a=(70*Math.random()+120)/100,t=u.sGGame.localModel.getModule(p.LocalBattle).debugEnemyOperate?p.enumTeam.enemy:p.enumTeam.player,0!==this._bulletCount||(n=this._getEnemy())&&(o=n.node.x,e=270),n=this._skill.getAttr2(),this.battleManager.createBullet(void 0,d.GameDefine.prefabBattleSkillStone,o,i,e,a,n=0==n?1e4:n,t),this._bulletCount++,this._bulletCount>=this._bulletCountMax&&s.sGNode.destoryNode(this.node))},h.prototype._getEnemy=function(){var t,e=this.battleManager.enemySoldierDic;for(t in e=u.sGGame.localModel.getModule(p.LocalBattle).debugEnemyOperate?this.battleManager.playerSoldierDic:e)return e[t];return null},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillStone")],h),r.default=n,cc._RF.pop()},{}],battle_skill_summon:[function(t,e,o){"use strict";cc._RF.push(e,"c176fSwzRZK+p92SICZfnzH","battle_skill_summon");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("age_config"),u=a("gnode"),d=a("ggame"),p=a("local_battle"),f=a("local_card"),h=a("local_skill"),g=a("local_soldier");function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._passTime=0,t._oneBulletTime=.125,t._bulletCount=0,t._bulletCountMax=0,t.skillID=8,t._attrbutePercent=0,t._summonCard=null,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(y,c=cc.Component),y.prototype.onLoad=function(){},y.prototype.onEnable=function(){var t=this;this._passTime=0;var e=d.sGGame.localModel.getModule(h.LocalSkillPackage),o=d.sGGame.localModel.getModule(f.LocalCardPackage);this._skill=e.getSkill(this.skillID);var i=this._skill.getAttr2();this._ageEntry=s.sAgeConfig.getEntry(i);for(var a,n=o.getSoldierCardArray(),r=[],l=0;l<n.length;++l)(a=n[l]).isSoldierCard&&a.isActive()&&a.entry.unlockAge==i&&r.push(a);if(0===r.length)for(l=0;l<n.length;++l)(a=n[l]).isSoldierCard&&a.isActive()&&r.push(a);0===r.length&&(r=n),this._summonCard=r[Math.floor(Math.random()*r.length)],this._bulletCountMax=this._skill.getAttr1(),this._bulletCount=0,this._attrbutePercent=this._skill.getAttr3(),d.sGGame.on(p.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},y.prototype.onDisable=function(){d.sGGame.targetOff(this)},y.prototype.battleUpdate=function(t){var e;this._passTime+=t,this._passTime>this._oneBulletTime&&(this._passTime=0,e=d.sGGame.localModel.getModule(p.LocalBattle).debugEnemyOperate?p.enumTeam.enemy:p.enumTeam.player,t=d.sGGame.localModel.getModule(g.LocalSoldierPackage).getSoldierByCard(this._summonCard.entry.id),this.battleManager.addSoldierBySummon(t.entry.id,e,this._attrbutePercent),this._bulletCount++,this._bulletCount>=this._bulletCountMax&&u.sGNode.destoryNode(this.node))},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillSummon")],y),r.default=n,cc._RF.pop()},{}],battle_skill_tank:[function(t,e,o){"use strict";cc._RF.push(e,"06494UsPidLRa+tX5fo57tl","battle_skill_tank");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=a("ggame"),d=a("local_battle"),p=a("local_skill"),f=a("unit_health");function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._moveSpeed=200,t._damageEnemyDic={},t._pushEnemyDic={},t._startPos=void 0,t._bulletFinishX=0,t._passTime=0,t._dir=0,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(h,c=cc.Component),h.prototype.onLoad=function(){},h.prototype.onEnable=function(){var t=this;this._pushEnemyDic={},this._damageEnemyDic={},this._passTime=0;var e=u.sGGame.localModel.getModule(p.LocalSkillPackage);this._skill=e.getSkill(7),u.sGGame.localModel.getModule(d.LocalBattle).debugEnemyOperate?(this._startPos=this.battleManager.spawnPositionOfEnemy.clone(),this._bulletFinishX=this.battleManager.spawnPositionOfPlayer.x,this._dir=-1,this.node.scaleX=-this.node.scaleX):(this._startPos=this.battleManager.spawnPositionOfPlayer.clone(),this._bulletFinishX=this.battleManager.spawnPositionOfPlayer.x+this.battleManager.totalLength,this._dir=1),this._startPos.x-=300*this._dir,this.node.setPosition(this._startPos),u.sGGame.on(d.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},h.prototype.onDisable=function(){u.sGGame.targetOff(this)},h.prototype.battleUpdate=function(t){this._passTime+=t;var e=this._startPos.x+this._dir*this._passTime*this._moveSpeed;this.node.setPosition(cc.v2(e,this._startPos.y)),t=u.sGGame.localModel.getModule(d.LocalBattle).debugEnemyOperate?d.enumTeam.enemy:d.enumTeam.player;var o=this.battleManager.enemySoldierDic;for(n in o=t===d.enumTeam.enemy?this.battleManager.playerSoldierDic:o){var i=o[n],a=this.node.x+150;!this._damageEnemyDic[n]&&a>i.node.x-i.soldier.entry.bodyWidth/2&&a<i.node.x+i.soldier.entry.bodyWidth/2&&(0==(a=this._skill.getAttr1())&&(a=1e4),i.onHurt(void 0,a,f.eUnitHurtType.normal),0<(this._damageEnemyDic[n]=i).unitHealth.hp&&this._skill.getAttr2()<100*Math.random()&&(this._pushEnemyDic[n]=i))}if(this.node.position.x<this._bulletFinishX)for(var n in this._pushEnemyDic)(i=o[n])&&i.node.x<e&&i.node.setPosition(cc.v2(e,i.node.y));1===this._dir?this.node.position.x>this._bulletFinishX+300&&s.sGNode.destoryNode(this.node):this.node.position.x<this._bulletFinishX-300&&s.sGNode.destoryNode(this.node)},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillTank")],h),r.default=n,cc._RF.pop()},{}],battle_skill_tonecastn_bullet:[function(t,e,o){"use strict";cc._RF.push(e,"0288fVgPGdBMbm0JisDWUZP","battle_skill_tonecastn_bullet");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("ggame"),u=a("game_define"),d=a("local_battle"),p=a("local_skill"),f=a("battle_bullet"),h=a("unit_health");function g(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._passTime=0,t._oneBulletTime=.033,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(g,c=cc.Component),g.prototype.onLoad=function(){},g.prototype.onEnable=function(){var t=this;this._passTime=0;var e=s.sGGame.localModel.getModule(p.LocalSkillPackage);this._skill=e.getSkill(6),this.battleManager||(this.battleManager=this.node.getComponent(f.default).battleManager),s.sGGame.on(d.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},g.prototype.onDisable=function(){var t=this.node.position.x+15*Math.random(),e=this.node.position.y;this.battleManager&&this.battleManager.createParticle(u.GameDefine.prefabParticleStonecastnBomb,t,e,this.node.angle,this.node.scale,{});var o=this._skill.getAttr3();if(o=0==o?1e4:o){e=s.sGGame.localModel.getModule(d.LocalBattle).debugEnemyOperate?d.enumTeam.enemy:d.enumTeam.player,this.battleManager||(this.battleManager=this.battleManager);var i,a=this.battleManager.enemySoldierDic;for(i in a=e===d.enumTeam.enemy?this.battleManager.playerSoldierDic:a){var n=a[i];this.node.position.sub(n.node.position).mag()<100&&n.onHurt(void 0,o,h.eUnitHurtType.normal)}}s.sGGame.targetOff(this)},g.prototype.battleUpdate=function(t){var e;this._passTime+=t,this._passTime>this._oneBulletTime&&(this._passTime=0,e=this.node.position.x+15*Math.random(),t=this.node.position.y,this.battleManager||(this.battleManager=this.node.getComponent(f.default).battleManager),this.battleManager&&this.battleManager.createParticle(u.GameDefine.prefabParticleStonecastnFire,e,t,this.node.angle,this.node.scale,{}))},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillTonecastnBullet")],g),r.default=n,cc._RF.pop()},{}],battle_skill_tonecastn:[function(t,e,o){"use strict";cc._RF.push(e,"c1b88Vx8A1B4ZAh7Ouavt2+","battle_skill_tonecastn");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=a("ggame"),d=a("game_define"),p=a("local_battle"),f=a("local_skill");function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._maxSkyY=700,t._passTime=0,t._oneBulletTime=.225,t._bulletCount=0,t._bulletCountMax=0,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(h,c=cc.Component),h.prototype.onLoad=function(){},h.prototype.onEnable=function(){var t=this;this._passTime=0;var e=u.sGGame.localModel.getModule(f.LocalSkillPackage);this._skill=e.getSkill(6),this._bulletCountMax=this._skill.getAttr2(),0<(e=this._skill.getAttr4())&&(this._bulletCountMax=e),this._bulletCount=0,u.sGGame.on(p.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},h.prototype.onDisable=function(){u.sGGame.targetOff(this)},h.prototype.battleUpdate=function(t){var e,o,i,a,n;this._passTime+=t,this._passTime>this._oneBulletTime&&(this._passTime=0,e=260+20*Math.random(),o=this.battleManager.spawnPositionOfPlayer.x+Math.random()*this.battleManager.totalLength,i=this.battleManager.spawnPositionOfPlayer.y+this._maxSkyY,a=(70*Math.random()+120)/100,t=u.sGGame.localModel.getModule(p.LocalBattle).debugEnemyOperate?p.enumTeam.enemy:p.enumTeam.player,0!==this._bulletCount||(n=this._getEnemy())&&(o=n.node.x,e=270),n=this._skill.getAttr1(),this.battleManager.createBullet(void 0,d.GameDefine.prefabBattleSkillStonecastn,o,i,e,a,n=0==n?1e4:n,t),this._bulletCount++,this._bulletCount>=this._bulletCountMax&&s.sGNode.destoryNode(this.node))},h.prototype._getEnemy=function(){var t,e=this.battleManager.enemySoldierDic;for(t in e=u.sGGame.localModel.getModule(p.LocalBattle).debugEnemyOperate?this.battleManager.playerSoldierDic:e)return e[t];return null},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillTonecastn")],h),r.default=n,cc._RF.pop()},{}],battle_skill_tornado_bullet:[function(t,e,o){"use strict";cc._RF.push(e,"b41b9zNZAdLB5+VAf/RiNjF","battle_skill_tornado_bullet");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("ggame"),u=a("game_define"),d=a("local_battle");function p(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._passTime=0,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(p,c=cc.Component),p.prototype.onLoad=function(){},p.prototype.onEnable=function(){var t=this;this._passTime=0,s.sGGame.on(d.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},p.prototype.onDisable=function(){var t=this.node.position.x+15*Math.random(),e=this.node.position.y;this.battleManager&&this.battleManager.createParticle(u.GameDefine.prefabParticleStoneBomb,t,e,this.node.angle,this.node.scale,{}),s.sGGame.targetOff(this)},p.prototype.battleUpdate=function(t){this._passTime+=t},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillTornadoBullet")],p),r.default=n,cc._RF.pop()},{}],battle_skill_tornado:[function(t,e,o){"use strict";cc._RF.push(e,"02520HfZ9JISIEvJOAxQg6K","battle_skill_tornado");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=a("ggame"),d=a("game_define"),p=a("local_battle"),f=a("local_skill");function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._passTime=0,t._oneBulletTime=.125,t._bulletCount=0,t._bulletCountMax=0,t._bulletDamagePercent=0,t._damageEnemyDic={},t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(h,c=cc.Component),h.prototype.onLoad=function(){},h.prototype.onEnable=function(){var t=this;this._passTime=0;var e=u.sGGame.localModel.getModule(f.LocalSkillPackage);this._skill=e.getSkill(4),this._bulletCountMax=this._skill.getAttr1(),this._bulletDamagePercent=this._skill.getAttr2(),this._bulletCount=0,u.sGGame.on(p.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},h.prototype.onDisable=function(){u.sGGame.targetOff(this)},h.prototype.battleUpdate=function(t){var e,o,i;this._passTime+=t,this._passTime>this._oneBulletTime&&(this._passTime=0,e=u.sGGame.localModel.getModule(p.LocalBattle).debugEnemyOperate?p.enumTeam.enemy:p.enumTeam.player,i=this.battleManager.enemySoldierDic,o=this.battleManager.spawnPositionOfPlayer.y-20,e===p.enumTeam.enemy&&(i=this.battleManager.playerSoldierDic),0<(t=Object.keys(i)).length?(t=t[Math.floor(Math.random()*t.length)],this._damageEnemyDic[t]||(i=i[t],this._damageEnemyDic[t]=i,t=Math.floor(this._bulletDamagePercent*i.unitHealth.maxHP/100),this.battleManager.createBullet(void 0,d.GameDefine.prefabBattleSkillTornado,i.node.x,o,0,1,t,e),this._bulletCount++,this._bulletCount>=this._bulletCountMax&&s.sGNode.destoryNode(this.node))):s.sGNode.destoryNode(this.node))},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillTornado")],h),r.default=n,cc._RF.pop()},{}],battle_skill_tsunami:[function(t,e,o){"use strict";cc._RF.push(e,"01fa1BIUq9FU6U4Ysok6Q6R","battle_skill_tsunami");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=a("ggame"),d=a("local_battle"),p=a("local_skill"),f=a("unit_health");function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.battleManager=void 0,t._moveSpeed=200,t._startPos=void 0,t._bulletStartX=0,t._bulletFinishX=0,t._passTime=0,t._pushEnemyDic={},t._damageEnemyDic={},t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,r.MAX_MAP_VALUE=1e100,l(h,c=cc.Component),h.prototype.onLoad=function(){},h.prototype.onEnable=function(){var t=this;this._pushEnemyDic={},this._damageEnemyDic={},this._passTime=0,this._startPos=this.battleManager.spawnPositionOfPlayer.clone(),this._bulletStartX=this.battleManager.spawnPositionOfPlayer.x,this._bulletFinishX=this.battleManager.spawnPositionOfPlayer.x+this.battleManager.totalLength,this._startPos.x-=300,this.node.setPosition(this._startPos),u.sGGame.on(d.sLocalBattleEvent.battleUpdate,function(e){t.battleUpdate(e)},this)},h.prototype.onDisable=function(){u.sGGame.targetOff(this)},h.prototype.battleUpdate=function(t){this._passTime+=t;var e=this._startPos.x+this._passTime*this._moveSpeed;if(this.node.setPosition(cc.v2(e,this._startPos.y)),this.node.position.x>this._bulletFinishX+300)s.sGNode.destoryNode(this.node);else{t=u.sGGame.localModel.getModule(d.LocalBattle).debugEnemyOperate?d.enumTeam.enemy:d.enumTeam.player;var o=this.battleManager.enemySoldierDic;t===d.enumTeam.enemy&&(o=this.battleManager.playerSoldierDic);var i=u.sGGame.localModel.getModule(p.LocalSkillPackage).getSkill(3).getAttr1();for(r in 0==i&&(i=1e4),o){var a=o[r],n=this.node.x+150;!this._damageEnemyDic[r]&&n>a.node.x-a.soldier.entry.bodyWidth/2&&n<a.node.x+a.soldier.entry.bodyWidth/2&&(a.onHurt(void 0,i,f.eUnitHurtType.normal),0<(this._damageEnemyDic[r]=a).unitHealth.hp&&(this._pushEnemyDic[r]=a))}if(this.node.position.x<this._bulletFinishX)for(var r in this._pushEnemyDic)(a=o[r])&&a.node.x<e&&a.node.setPosition(cc.v2(e,a.node.y))}},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/BattleSkillTsunami")],h),r.default=n,cc._RF.pop()},{}],battle_soldier_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"9cf3fncirtAL4195eZoYQLQ","battle_soldier_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("vm_guide"),u=a("audio_config"),d=a("gaudio"),p=a("gnode"),f=a("gnumber"),h=a("ggame"),g=a("gview_model"),y=a("local_battle"),m=a("local_soldier"),b=a("vm_battle"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.iconSprite=null,t.clickButton=null,t.progressBar=null,t.guideArrowNode=null,t.priceLabel=null,t.starLabel=null,t.qualityRoot=null,t.localSoldier=null,t.buyEnabled=!1,t.hasGuide=!1,t}r(C,c=cc.Component),C.prototype.init=function(t,e){this.localSoldier=t,this.hasGuide=e,this.enabledInHierarchy&&this._refresh()},C.prototype.onLoad=function(){var t=this;this.clickButton&&this.clickButton.node.on("click",function(){0===g.sGViewModel.getModule(b.VMBattle).buySoldier(t.localSoldier.entry.id,!1)&&d.sGAudio.playEffect(u.sAudioConfig.config.flyerSend)})},C.prototype.onEnable=function(){this._refresh()},C.prototype.onDisable=function(){p.sGNode.targetOff(this)},C.prototype.update=function(){var t,e,o;this.localSoldier&&(t=0==(o=h.sGGame.localModel.getModule(y.LocalBattle)).checkBuySoldier(this.localSoldier.entry.id),e=o.getSoldierCooldown(this.localSoldier),o=this.localSoldier.entry.employSeconds,this.progressBar&&(this.progressBar.node.active=!0,this.progressBar.progress=e/o),this.clickButton&&(this.clickButton.interactable=0===e),t!=this.buyEnabled&&(this.iconSprite&&p.sGNode.setSpriteMaterial(this.iconSprite,t?"2d-sprite":"2d-gray-sprite"),this.buyEnabled=t),this.guideArrowNode&&(this.guideArrowNode.active=t&&this.hasGuide&&!g.sGViewModel.getModule(s.VMGuide).isGuideOpened()))},C.prototype._refresh=function(){if(this.localSoldier){var t=h.sGGame.localModel.getModule(m.LocalSoldierPackage).getSoldier(this.localSoldier.entry.id),e=0==h.sGGame.localModel.getModule(y.LocalBattle).checkBuySoldier(this.localSoldier.entry.id);if(this.iconSprite&&(p.sGNode.setSprite(this.iconSprite,t.card.entry.bigIcon,this),p.sGNode.setSpriteMaterial(this.iconSprite,e?"2d-sprite":"2d-gray-sprite")),this.guideArrowNode&&(this.guideArrowNode.active=e&&this.hasGuide&&!g.sGViewModel.getModule(s.VMGuide).isGuideOpened()),this.priceLabel&&(this.priceLabel.string=f.sGNumber.toHuman(this.localSoldier.entry.price)),this.starLabel&&(this.starLabel.string=t.card.record.level.toString()),this.qualityRoot)for(var o=1;;++o){var i=this.qualityRoot.getChildByName("quality"+o);if(!i)break;i.active=o+2===this.localSoldier.card.entry.quality}this.buyEnabled=e}},l([a(cc.Sprite)],C.prototype,"iconSprite",void 0),l([a(cc.Button)],C.prototype,"clickButton",void 0),l([a(cc.ProgressBar)],C.prototype,"progressBar",void 0),l([a({type:cc.Node})],C.prototype,"guideArrowNode",void 0),l([a(cc.Label)],C.prototype,"priceLabel",void 0),l([a(cc.Label)],C.prototype,"starLabel",void 0),l([a(cc.Node)],C.prototype,"qualityRoot",void 0),v=l([_,v("Game/UI/BattleSoldierIconUI")],C),n.default=v,cc._RF.pop()},{}],battle_soldier_progress_tip_ui:[function(t,e,o){"use strict";cc._RF.push(e,"93e31n9sT1MIIexybr1qtWj","battle_soldier_progress_tip_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("gnode"),u=a("local_battle"),d=(p=cc._decorator).ccclass,p=(a=p.property,p.menu);function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.bgNode=null,t.soldierIconSprite=null,t.soldier=null,t}r(f,c=cc.Component),f.prototype.init=function(t){this.soldier=t},f.prototype.onEnable=function(){this.bgNode&&(this.bgNode.color=this.soldier.unit.teamID===u.enumTeam.player?cc.Color.BLUE:cc.Color.RED),this.soldierIconSprite&&s.sGNode.setSprite(this.soldierIconSprite,this.soldier.soldier.entry.icon,this)},f.prototype.onDisable=function(){s.sGNode.targetOff(this)},l([a({displayName:"\u5e95\u677f\u56fe\u7247",tooltip:"\u53ef\u4ee5\u6709\u7a0b\u5e8f\u6765\u67d3\u8272",type:cc.Node})],f.prototype,"bgNode",void 0),l([a({displayName:"\u58eb\u5175\u56fe\u7247",type:cc.Sprite})],f.prototype,"soldierIconSprite",void 0),p=l([d,p("Game/Battle/BattleSoldierProgressTipUI")],f),n.default=p,cc._RF.pop()},{}],battle_start_buff_status_ui:[function(t,e,o){"use strict";cc._RF.push(e,"349dfxKBRVE9LNO5fnciTuN","battle_start_buff_status_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("i18n"),u=a("gnode"),d=a("ggame"),p=a("gview_model"),f=a("local_battle"),h=a("vm_reward"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu);function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.buffRootArray=[],t}r(m,c=cc.Component),m.prototype.onLoad=function(){},m.prototype.refresh=function(){for(var t=0;t<this.buffRootArray.length;++t)this.refreshBuffRoot(t)},m.prototype.onEnable=function(){var t=this;d.sGGame.on(f.sLocalBattleEvent.buffChanged,function(){t.refresh()},this),this.refresh()},m.prototype.onDisable=function(){u.sGNode.targetOff(this),d.sGGame.targetOff(this)},m.prototype.refreshBuffRoot=function(t){var e=d.sGGame.localModel.getModule(f.LocalBattle).battleBuffArray[t],o=this.buffRootArray[t];if(o)if(e){o.active=!0;var i=e.entry,a=e.quality,n=cc.find("icon_bottom/quality_root",o);if(t=cc.find("icon_bottom/icon",o),(e=cc.find("Label_name",o))&&(e.getComponent(cc.Label).string=s.i18n.t(i.name),e.color=p.sGViewModel.getModule(h.VMReward).getQualityColor(a)),t&&u.sGNode.setSprite(t.getComponent(cc.Sprite),i.icon,this),n)for(var r=1;;++r){var l=n.getChildByName("quality"+r);if(!l)break;l.active=r+2===a}}else o.active=!1},l([a(cc.Node)],m.prototype,"buffRootArray",void 0),y=l([g,y("Game/UI/BattleStartBuffStatusUI")],m),n.default=y,cc._RF.pop()},{}],battle_start_buff_ui:[function(t,e,o){"use strict";cc._RF.push(e,"b66cenvtCFBj4MBJIxvlfpN","battle_start_buff_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("battle_start_buff_config"),p=a("encourage_config"),f=a("i18n"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_battle"),b=a("vm_battle"),_=a("vm_reward"),v=(C=cc._decorator).ccclass,C=(a=C.property,C.menu);function P(){var t=null!==c&&c.apply(this,arguments)||this;return t.buffRootArray=[],t.collectAllBuffButton=null,t.encourageIconUI=null,t}r(P,c=cc.Component),P.prototype.onLoad=function(){var t=this;this.collectAllBuffButton&&this.collectAllBuffButton.node.on("click",function(){y.sGViewModel.getModule(u.VMEncourage).encourage(p.sEncourageConfig.config.collectAllBattleBuff,t.encourageType,function(){y.sGViewModel.getModule(b.VMBattle).selectAllBattleStartBuff(function(){h.sGNode.destoryNode(t.node)})})});for(var e=this,o=0;o<this.buffRootArray.length;++o)!function(o){var i=e.buffRootArray[o];(i=cc.find("button_use",i))&&i.on("click",function(){y.sGViewModel.getModule(b.VMBattle).selectBattleStartBuff(o),h.sGNode.destoryNode(t.node)})}(o)},P.prototype.onEnable=function(){this.encourageType=y.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.collectAllBattleBuff),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType);for(var t=0;t<this.buffRootArray.length;++t)this.refreshBuffRoot(t)},P.prototype.onDisable=function(){h.sGNode.targetOff(this)},P.prototype.refreshBuffRoot=function(t){var e=g.sGGame.localModel.getModule(m.LocalBattle),o=d.sBattleStartBuffConfig.getEntry(e.battleStartBuff[t]),i=e.battleStartBuffQuality[t],a=this.buffRootArray[t],n=cc.find("icon_bottom/quality_root",a);if(e=cc.find("icon_bottom/icon",a),t=cc.find("info/Label_name",a),a=cc.find("info/Label_attribute",a),t&&(t.getComponent(cc.Label).string=f.i18n.t(o.name),t.color=y.sGViewModel.getModule(_.VMReward).getQualityColor(i)),a&&(t=(t=f.i18n.t(o.desc)).replace("${value}",o.attributeValues[i-3]+""),a.getComponent(cc.Label).string=t,a.color=y.sGViewModel.getModule(_.VMReward).getQualityColor(i)),e&&h.sGNode.setSprite(e.getComponent(cc.Sprite),o.icon,this),n)for(var r=1;;++r){var l=n.getChildByName("quality"+r);if(!l)break;l.active=r+2===i}},l([a(cc.Node)],P.prototype,"buffRootArray",void 0),l([a(cc.Button)],P.prototype,"collectAllBuffButton",void 0),l([a(s.default)],P.prototype,"encourageIconUI",void 0),C=l([v,C("Game/UI/BattleStartBuffUI")],P),n.default=C,cc._RF.pop()},{}],battle_start_button_root:[function(t,e,o){"use strict";cc._RF.push(e,"88b2clnLdhPK4LZ/j8uZwMd","battle_start_button_root");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gaudio"),d=a("ggame"),p=a("gview_model"),f=a("vm_battle"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t}r(y,c=cc.Component),y.prototype.onLoad=function(){this.button&&this.button.node.on("click",this.onBattle.bind(this))},y.prototype.onEnable=function(){},y.prototype.onDisable=function(){d.sGGame.targetOff(this)},y.prototype.onBattle=function(){p.sGViewModel.getModule(f.VMBattle).enterBattleStage(),u.sGAudio.playEffect(s.sAudioConfig.config.joinBattle)},l([a(cc.Button)],y.prototype,"button",void 0),g=l([h,g("Game/Battle/BattleStartButtonRoot")],y),n.default=g,cc._RF.pop()},{}],battle_start_ui:[function(t,e,o){"use strict";cc._RF.push(e,"9f808oAmfpPwa8tOUdwbX8q","battle_start_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gaudio"),d=a("gnode"),p=a("gnumber"),f=a("ggame"),h=a("gview_model"),g=a("local_stage"),y=a("vm_battle"),m=(b=cc._decorator).ccclass,b=(a=b.property,b.menu);function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.cancelButton=null,t.confirmButton=null,t.stageLabel=null,t.recommendBattleScoreLabel=null,t}r(_,c=cc.Component),_.prototype.init=function(t){this.callback=t},_.prototype.onLoad=function(){var t=this;this.cancelButton&&this.cancelButton.node.on("click",function(){u.sGAudio.playEffect(s.sAudioConfig.config.buttonClose),d.sGNode.destoryNode(t.node)}),this.confirmButton&&this.confirmButton.node.on("click",function(){h.sGViewModel.getModule(y.VMBattle).enterBattleStage(),u.sGAudio.playEffect(s.sAudioConfig.config.joinBattle)})},_.prototype.onEnable=function(){u.sGAudio.playEffect(s.sAudioConfig.config.popUI),this._refresh()},_.prototype.onDisable=function(){},_.prototype._refresh=function(){var t=f.sGGame.localModel.getModule(g.LocalStage).currentBattleStageEntry;this.stageLabel&&(this.stageLabel.string=t.name),this.recommendBattleScoreLabel&&(this.recommendBattleScoreLabel.string=p.sGNumber.toHuman(t.recommendBattleScore))},l([a(cc.Button)],_.prototype,"cancelButton",void 0),l([a(cc.Button)],_.prototype,"confirmButton",void 0),l([a(cc.Label)],_.prototype,"stageLabel",void 0),l([a(cc.Label)],_.prototype,"recommendBattleScoreLabel",void 0),b=l([m,b("Game/Battle/BattleStartUI")],_),n.default=b,cc._RF.pop()},{}],battle_sweep_result_ui:[function(t,e,o){"use strict";cc._RF.push(e,"cd6ddZDnGBJW5WsN2TB7pWE","battle_sweep_result_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("encourage_config"),f=a("gaudio"),h=a("gnode"),g=a("gnumber"),y=a("ggame"),m=a("gview_model"),b=a("local_stage"),_=a("battle_victory_card_ui"),v=(C=cc._decorator).ccclass,C=(a=C.property,C.menu);function P(){var t=null!==c&&c.apply(this,arguments)||this;return t.cardRootArray=[],t.cardPrefab=null,t.singleCardRootArray=null,t.cardUpgradePointLabel=null,t.buildingUpgradePointLabel=null,t.anim=null,t.closeButton=null,t.collectAllEncourageIconUI=null,t.collectAllButton=null,t.closeButton2=null,t.flopTimes=0,t}r(P,c=cc.Component),P.prototype.onLoad=function(){var t=this;this.closeButton&&(this.closeButton.node.active=!0,this.closeButton.node.on("click",function(){f.sGAudio.playEffect(d.sAudioConfig.config.reward),h.sGNode.destoryNode(t.node)})),this.closeButton2&&(this.closeButton2.node.active=!1,this.closeButton2.node.on("click",function(){f.sGAudio.playEffect(d.sAudioConfig.config.reward),h.sGNode.destoryNode(t.node)})),this.collectAllButton&&(this.collectAllButton.node.active=!0,this.collectAllButton.node.on("click",function(){m.sGViewModel.getModule(u.VMEncourage).encourage(p.sEncourageConfig.config.collectAllBattleReward,t._encourageType,function(){f.sGAudio.playEffect(d.sAudioConfig.config.reward),y.sGGame.localModel.getModule(b.LocalStage).collectAllVictoryReward()})}))},P.prototype.onEnable=function(){var t=this;f.sGAudio.playEffect(d.sAudioConfig.config.victory),this._encourageType=m.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.collectAllBattleReward),this.collectAllEncourageIconUI&&this.collectAllEncourageIconUI.setEncourageType(this._encourageType);var e=y.sGGame.localModel.getModule(b.LocalStage);this._initCardArray(),y.sGGame.on(_.sBattleVictoryCardUIEvent.playOneCardFinish,function(){t.flopTimes++,t.flopTimes==e.extendRewardArray.length&&(t._collectAllFinish(),t._playFinishAnim())},this),y.sGGame.on(_.sBattleVictoryCardUIEvent.playAllCardFinish,function(){t.flopTimes++,t.flopTimes==e.extendRewardArray.length&&t._playFinishAnim()},this),y.sGGame.on(b.sLocalStageEvent.collectAllVictoryRReward,function(){t._collectAllFinish()},this),this.cardUpgradePointLabel&&(this.cardUpgradePointLabel.string="+"+g.sGNumber.toHuman(e.baseCardUpgradePoint)),this.buildingUpgradePointLabel&&(this.buildingUpgradePointLabel.string="+"+g.sGNumber.toHuman(e.baseBuildingUpgradePoint))},P.prototype.onDisable=function(){y.sGGame.targetOff(this)},P.prototype._initCardArray=function(){this.singleCardRootArray&&((o=(e=cc.instantiate(this.cardPrefab)).getComponent(_.default)).init(-1,!0),o.playFlip(),this.singleCardRootArray.addChild(e),(o=(e=cc.instantiate(this.cardPrefab)).getComponent(_.default)).init(-2,!0),o.playFlip(),this.singleCardRootArray.addChild(e));for(var t=0;t<this.cardRootArray.length;++t){var e,o,i=this.cardRootArray[t];i&&this.cardPrefab&&((o=(e=cc.instantiate(this.cardPrefab)).getComponent(_.default)).init(t),i.addChild(e))}},P.prototype._playFinishAnim=function(){var t=this;this.anim&&(this.anim.play("settlement_win_button_anim"),this.anim.on(cc.Animation.EventType.FINISHED,function(){t.anim.targetOff(t)},this))},P.prototype._collectAllFinish=function(){this.closeButton&&(this.closeButton.node.active=!1),this.closeButton2&&(this.closeButton2.node.active=!0),this.collectAllButton&&(this.collectAllButton.node.active=!1)},l([a(cc.Node)],P.prototype,"cardRootArray",void 0),l([a(cc.Prefab)],P.prototype,"cardPrefab",void 0),l([a(cc.Node)],P.prototype,"singleCardRootArray",void 0),l([a(cc.Label)],P.prototype,"cardUpgradePointLabel",void 0),l([a(cc.Label)],P.prototype,"buildingUpgradePointLabel",void 0),l([a(cc.Animation)],P.prototype,"anim",void 0),l([a(cc.Button)],P.prototype,"closeButton",void 0),l([a(s.default)],P.prototype,"collectAllEncourageIconUI",void 0),l([a(cc.Button)],P.prototype,"collectAllButton",void 0),l([a(cc.Button)],P.prototype,"closeButton2",void 0),C=l([v,C("Game/Battle/BattleSweepResultUI")],P),n.default=C,cc._RF.pop()},{}],battle_sweep_ui:[function(t,e,o){"use strict";cc._RF.push(e,"0c86bMEUO5GKYQLkKC10Qe0","battle_sweep_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gaudio"),d=a("gnode"),p=a("gnumber"),f=a("ggame"),h=a("gview_model"),g=a("local_reward"),y=a("local_stage"),m=a("vm_battle"),b=a("vm_reward"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.cancelButton=null,t.confirmButton=null,t.stageLabel=null,t.cardUpgradePointLabel=null,t.buildingUpgradePointLabel=null,t}r(C,c=cc.Component),C.prototype.init=function(t){this.callback=t},C.prototype.onLoad=function(){var t=this;this.cancelButton&&this.cancelButton.node.on("click",function(){d.sGNode.destoryNode(t.node)}),this.confirmButton&&this.confirmButton.node.on("click",function(){h.sGViewModel.getModule(m.VMBattle).sweep(function(){})})},C.prototype.onEnable=function(){u.sGAudio.playEffect(s.sAudioConfig.config.popUI),this._refresh()},C.prototype.onDisable=function(){},C.prototype._refresh=function(){var t=f.sGGame.localModel.getModule(y.LocalStage).currentPassStageEntry;this.stageLabel&&(this.stageLabel.string=t.name),this.cardUpgradePointLabel&&(this.cardUpgradePointLabel.string="x"+p.sGNumber.toHuman(t.baseCardUpgradePoint)),this.buildingUpgradePointLabel&&(this.buildingUpgradePointLabel.string=h.sGViewModel.getModule(b.VMReward).getCount(g.eRewardType.buildingUpgradePointOverTime,t.baseBuildingUpgradePointOverTime))},l([a(cc.Button)],C.prototype,"cancelButton",void 0),l([a(cc.Button)],C.prototype,"confirmButton",void 0),l([a(cc.Label)],C.prototype,"stageLabel",void 0),l([a(cc.Label)],C.prototype,"cardUpgradePointLabel",void 0),l([a(cc.Label)],C.prototype,"buildingUpgradePointLabel",void 0),v=l([_,v("Game/Battle/BattleSweepUI")],C),n.default=v,cc._RF.pop()},{}],battle_victory_card_ui:[function(t,e,o){"use strict";cc._RF.push(e,"62bca6CCJlCX4B3tde72qhd","battle_victory_card_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.sBattleVictoryCardUIEvent=void 0;var c,s=a("audio_config"),u=a("gui"),d=a("gaudio"),p=a("gnode"),f=a("gnumber"),h=a("ggame"),g=a("gview_model"),y=a("local_reward"),m=a("local_stage"),b=a("vm_reward"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.mulLabel=null,t.amountLabel=null,t.iconSprite=null,t.iconSprite2=null,t.selectNode=null,t.firstPassNode=null,t.anim=null,t.flopButton=null,t.qualityRoot=null,t.rewardIndex=0,t.extendReward=null,t.autoFlip=!1,t.isFirstPass=!1,t.isFlipped=!1,t}n.sBattleVictoryCardUIEvent={playOneCardFinish:"sBattleVictoryCardUIEvent_playOneCardFinish",playAllCardFinish:"sBattleVictoryCardUIEvent_playAllCardFinish"},r(C,c=cc.Component),C.prototype.init=function(t,e,o){void 0===e&&(e=!1),void 0===o&&(o=!1),this.rewardIndex=t,this.autoFlip=e,this.isFirstPass=o,o=h.sGGame.localModel.getModule(m.LocalStage),-1===this.rewardIndex?(this.extendReward=new m.BattleExtendReward,this.extendReward.mul=1,this.extendReward.type=y.eRewardType.cardUpgradePoint,this.extendReward.count=o.baseCardUpgradePoint):-2===this.rewardIndex?(this.extendReward=new m.BattleExtendReward,this.extendReward.mul=1,this.extendReward.type=y.eRewardType.buildingUpgradePoint,this.extendReward.count=o.baseBuildingUpgradePoint):this.extendReward=o.extendRewardArray[this.rewardIndex]},C.prototype.onLoad=function(){var t=this;this.flopButton&&this.flopButton.node.on("click",function(){h.sGGame.localModel.getModule(m.LocalStage).collectOneVictoryRandomReward(t.rewardIndex)})},C.prototype.isCardIcon=function(t){switch(t){case y.eRewardType.buildingUpgradePoint:case y.eRewardType.cardUpgradePoint:case y.eRewardType.pullCardPoint:case y.eRewardType.actionPoint:case y.eRewardType.vipExp:return!1;case y.eRewardType.cardFragment:case y.eRewardType.card:case y.eRewardType.card2Fragment:case y.eRewardType.randomCard:case y.eRewardType.randomCardFragment:return!0}return!1},C.prototype.onEnable=function(){var t=this,e=g.sGViewModel.getModule(b.VMReward).getIcon(this.extendReward.type,this.extendReward.id),o=this.isCardIcon(this.extendReward.type);if(this.iconSprite&&(o||p.sGNode.setSprite(this.iconSprite,e,this),this.iconSprite.node.active=!o),this.iconSprite2&&(o&&p.sGNode.setSprite(this.iconSprite2,e,this),this.iconSprite2.node.active=o),this.nameLabel&&(this.nameLabel.string=g.sGViewModel.getModule(b.VMReward).getName(this.extendReward.type,this.extendReward.id)),this.amountLabel&&(this.amountLabel.string="x"+f.sGNumber.toHuman(this.extendReward.count*this.extendReward.mul)),this.mulLabel&&(this.mulLabel.node.parent.active=1<this.extendReward.mul,this.mulLabel.string=100*this.extendReward.mul+"%"),this.selectNode&&(this.selectNode.active=!1),this.firstPassNode&&(this.firstPassNode.active=!1),this.flopButton&&(this.flopButton.interactable=!this.autoFlip),this.qualityRoot)for(var i=1;;++i){var a=this.qualityRoot.getChildByName("quality"+i);if(!a)break;a.active=i===this.extendReward.mul}h.sGGame.on(m.sLocalStageEvent.collectOneVictoryRandomReward,function(e){t.rewardIndex==e&&(t.setSelect(),t.playFlip(function(){h.sGGame.emit(n.sBattleVictoryCardUIEvent.playOneCardFinish,e)})),t.flopButton&&(t.flopButton.interactable=!1)},this),h.sGGame.on(n.sBattleVictoryCardUIEvent.playOneCardFinish,function(e){t.rewardIndex!=e&&t.playFlip(function(){h.sGGame.emit(n.sBattleVictoryCardUIEvent.playAllCardFinish)})},this),h.sGGame.on(m.sLocalStageEvent.collectAllVictoryRReward,function(){t.setSelect()},this),this.flopButton&&u.sGUI.registerNode(this.node.name+(this.rewardIndex+1)+"."+this.flopButton.node.name,this.flopButton.node)},C.prototype.onDisable=function(){p.sGNode.targetOff(this),h.sGGame.targetOff(this),this.flopButton&&u.sGUI.unregisterNode(this.node.name+(this.rewardIndex+1)+"."+this.flopButton.node.name,this.flopButton.node)},C.prototype.setSelect=function(){this.selectNode&&(this.selectNode.active=!this.isFirstPass),this.firstPassNode&&(this.firstPassNode.active=this.isFirstPass)},C.prototype.playFlip=function(t){var e=this;this.isFlipped||(this.isFlipped=!0,this.anim?(this.autoFlip||d.sGAudio.playEffect(s.sAudioConfig.config.flipCard),this.anim.play(this.autoFlip?"settlement_win_cards_anim2":"settlement_win_cards_anim1"),this.anim.on(cc.Animation.EventType.FINISHED,function(){e.anim.targetOff(e),t&&t()},this)):t&&t())},C.prototype.playMoreReward=function(t){var e=this;this.amountLabel&&cc.tween(this.amountLabel.node).call(function(){e.amountLabel.string="x"+f.sGNumber.toHuman(e.extendReward.count*e.extendReward.mul*t)}).set({scale:5}).to(.2,{scale:1}).delay(.5).call(function(){cc.tween(e.amountLabel.node).repeatForever(cc.tween().to(.5,{scale:1.2}).to(.5,{scale:1})).start()}).start()},l([a(cc.Label)],C.prototype,"nameLabel",void 0),l([a(cc.Label)],C.prototype,"mulLabel",void 0),l([a(cc.Label)],C.prototype,"amountLabel",void 0),l([a(cc.Sprite)],C.prototype,"iconSprite",void 0),l([a(cc.Sprite)],C.prototype,"iconSprite2",void 0),l([a(cc.Node)],C.prototype,"selectNode",void 0),l([a(cc.Node)],C.prototype,"firstPassNode",void 0),l([a(cc.Animation)],C.prototype,"anim",void 0),l([a(cc.Button)],C.prototype,"flopButton",void 0),l([a(cc.Node)],C.prototype,"qualityRoot",void 0),v=l([_,v("Game/Battle/BattleVictoryCardUI")],C),n.default=v,cc._RF.pop()},{}],battle_victory_ui:[function(t,e,o){"use strict";cc._RF.push(e,"162a0yE1tBMqY6h8wFtw8Gf","battle_victory_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("encourage_config"),f=a("gaudio"),h=a("ggame"),g=a("gview_model"),y=a("local_stage"),m=a("battle_victory_card_ui"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu);function v(){var t=null!==c&&c.apply(this,arguments)||this;return t.cardRoot=null,t.cardPrefab=null,t.doubleFlagNode=null,t.anim=null,t.closeButton=null,t.collectDoubleEncourageIconUI=null,t.collectDoubleButton=null,t.closeButton2=null,t.cardUIArray=[],t}r(v,c=cc.Component),v.prototype.init=function(t){this.callback=t},v.prototype.onLoad=function(){var t=this;this.closeButton&&(this.closeButton.node.active=!0,this.closeButton.node.on("click",function(){f.sGAudio.playEffect(d.sAudioConfig.config.reward),t.callback&&t.callback()})),this.closeButton2&&(this.closeButton2.node.active=!1,this.closeButton2.node.on("click",function(){f.sGAudio.playEffect(d.sAudioConfig.config.reward),t.callback&&t.callback()})),this.collectDoubleButton&&this.collectDoubleButton.node.on("click",function(){g.sGViewModel.getModule(u.VMEncourage).encourage(p.sEncourageConfig.config.collectDoubleBattleReward,t._encourageType,function(){f.sGAudio.playEffect(d.sAudioConfig.config.reward),h.sGGame.localModel.getModule(y.LocalStage).collectDoubleVictoryReward(),t.doubleFlagNode&&(t.doubleFlagNode.active=!0,cc.tween(t.doubleFlagNode).repeatForever(cc.tween().to(.5,{scale:1.2}).to(.5,{scale:1})).start())})})},v.prototype.onEnable=function(){var t=this;f.sGAudio.playEffect(d.sAudioConfig.config.victory),this._encourageType=g.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.collectDoubleBattleReward),this.collectDoubleEncourageIconUI&&this.collectDoubleEncourageIconUI.setEncourageType(this._encourageType),h.sGGame.on(m.sBattleVictoryCardUIEvent.playOneCardFinish,function(){},this),h.sGGame.on(y.sLocalStageEvent.collectDoubleVictoryRReward,function(){if(t._collectAllFinish(),t.cardUIArray)for(var e=0;e<t.cardUIArray.length;++e){var o=t.cardUIArray[e];o&&o.playMoreReward(3)}},this),this._initCardArray(),this.anim&&(this.anim.play("settlement_win_anim"),this.anim.on(cc.Animation.EventType.FINISHED,function(){t.anim.targetOff(t),h.sGGame.localModel.getModule(y.LocalStage).canCollectDoubleVictoryReward()||t._collectAllFinish(),t._playFinishAnim()},this))},v.prototype.onDisable=function(){h.sGGame.targetOff(this)},v.prototype._initCardArray=function(){if(this.cardRoot){var t=h.sGGame.localModel.getModule(y.LocalStage);0<t.baseCardUpgradePoint&&((o=(e=cc.instantiate(this.cardPrefab)).getComponent(m.default))&&(o.init(-1,!0,!1),this.cardUIArray.push(o)),this.cardRoot.addChild(e)),0<t.baseBuildingUpgradePoint&&((o=(e=cc.instantiate(this.cardPrefab)).getComponent(m.default))&&(o.init(-2,!0,!1),this.cardUIArray.push(o)),this.cardRoot.addChild(e));for(var e,o,i=0;i<t.extendRewardArray.length;++i)(o=(e=cc.instantiate(this.cardPrefab)).getComponent(m.default))&&(o.init(i,!0,!0),this.cardUIArray.push(o)),this.cardRoot.addChild(e),t.collectOneVictoryRandomReward(i)}},v.prototype._playFinishAnim=function(){var t=this;this.anim&&(this.anim.play("settlement_win_button_anim"),this.anim.on(cc.Animation.EventType.FINISHED,function(){t.anim.targetOff(t)},this))},v.prototype._collectAllFinish=function(){this.closeButton&&(this.closeButton.node.active=!1),this.closeButton2&&(this.closeButton2.node.active=!0),this.collectDoubleButton&&(this.collectDoubleButton.node.active=!1)},l([a(cc.Node)],v.prototype,"cardRoot",void 0),l([a(cc.Prefab)],v.prototype,"cardPrefab",void 0),l([a(cc.Node)],v.prototype,"doubleFlagNode",void 0),l([a(cc.Animation)],v.prototype,"anim",void 0),l([a(cc.Button)],v.prototype,"closeButton",void 0),l([a(s.default)],v.prototype,"collectDoubleEncourageIconUI",void 0),l([a(cc.Button)],v.prototype,"collectDoubleButton",void 0),l([a(cc.Button)],v.prototype,"closeButton2",void 0),_=l([b,_("Game/Battle/BattleVictoryUI")],v),n.default=_,cc._RF.pop()},{}],beginning_ui:[function(t,e,o){"use strict";cc._RF.push(e,"d5f95roF1tHw43HHvLJwd30","beginning_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gaudio"),d=a("gnode"),p=(f=cc._decorator).ccclass,f=(a=f.property,f.menu);function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.animation=null,t.buttonClose=null,t.buttonSkip=null,t._callback=null,t}r(h,c=cc.Component),h.prototype.init=function(t){this._callback=t},h.prototype.onLoad=function(){var t=this;this.buttonClose&&(this.buttonClose.node.on("click",function(){u.sGAudio.playEffect(s.sAudioConfig.config.buttonClose),t.buttonClose.node.active=!1,t.playAnimationEnd()},this),this.buttonClose.node.active=!1),this.buttonSkip&&this.buttonSkip.node.on("click",function(){u.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),t.buttonSkip.node.active=!1,t.playAnimationEnd()},this)},h.prototype.onEnable=function(){},h.prototype.onDisable=function(){this.animation&&this.animation.targetOff(this)},h.prototype.playAnimationStart=function(){var t=this;this.animation&&(this.animation.targetOff(this),this.animation.play("intro_animation_anim"),this.animation.on(cc.Animation.EventType.FINISHED,function(){t.animation.targetOff(t),t.buttonSkip&&(t.buttonSkip.node.active=!1),t.buttonClose&&(t.buttonClose.node.active=!0)},this))},h.prototype.playAnimationEnd=function(){var t=this;this.buttonSkip&&(this.buttonSkip.node.active=!1),this.buttonClose&&(this.buttonClose.node.active=!1),this.animation&&(this.animation.targetOff(this),this.animation.play("intro_animation_end_anim"),this.animation.on(cc.Animation.EventType.FINISHED,function(){t.animation.targetOff(t),d.sGNode.destoryNode(t.node),t._callback&&t._callback()},this))},l([a({tooltip:"\u52a8\u753b\u8282\u70b9",type:cc.Animation})],h.prototype,"animation",void 0),l([a({tooltip:"\u5173\u95ed\u6309\u94ae",type:cc.Button})],h.prototype,"buttonClose",void 0),l([a({tooltip:"\u8df3\u8fc7\u6309\u94ae",type:cc.Button})],h.prototype,"buttonSkip",void 0),f=l([p,f("Game/Beginning/Beginning")],h),n.default=f,cc._RF.pop()},{}],benefit_ui:[function(t,e,o){"use strict";cc._RF.push(e,"f82c4bM6+9PPq+Fw1ROhfhV","benefit_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("daily_gift_config"),d=a("reward_helper"),p=a("i18n"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_benefits"),b=a("vm_benefit"),_=a("vm_reward"),v=(C=cc._decorator).ccclass,C=(a=C.property,C.menu);function P(){var t=null!==c&&c.apply(this,arguments)||this;return t.benefitDescLabel=null,t.benifitOpeningTimeLabel=null,t.benifitRewardLabel=null,t.benefitRewardSprite=null,t.commitButton=null,t.benefitID=0,t}r(P,c=cc.Component),P.prototype.init=function(t,e){this.benefitID=t,this.commitCallback=e},P.prototype.onLoad=function(){var t=this;this.localBenfits=g.sGGame.localModel.getModule(m.LocalBenefits),this.commitButton&&this.commitButton.node.on("click",function(){f.sGAudio.playEffect(s.sAudioConfig.config.reward);var e=t.commitCallback;y.sGViewModel.getModule(b.VMBenefit).commit(t.benefitID,function(){e&&e()}),h.sGNode.destoryNode(t.node)},this)},P.prototype.onEnable=function(){h.sGNode.updateWidgetImmediately(this.node),this.refresh()},P.prototype.onDisable=function(){g.sGGame.targetOff(this),h.sGNode.targetOff(this)},P.prototype.update=function(){this.commitButton&&(this.commitButton.interactable=0==this.localBenfits.checkCollectReward(this.benefitID))},P.prototype.refresh=function(){var t=u.sDailyGiftConfig.getEntry(this.benefitID);t?(this.benefitDescLabel&&(this.benefitDescLabel.string=p.i18n.t(t.desc)),this.benifitOpeningTimeLabel&&(this.benifitOpeningTimeLabel.string=t.openingTimeSection),t=d.RewardList.createFromString(t.reward).getReward(0),this.benefitRewardSprite&&h.sGNode.setSprite(this.benefitRewardSprite,y.sGViewModel.getModule(_.VMReward).getIcon(t.type,t.id),this),this.benifitRewardLabel&&(this.benifitRewardLabel.string="x"+t.count)):h.sGNode.destoryNode(this.node)},l([a({displayName:"\u798f\u5229\u540d\u79f0",type:cc.Label})],P.prototype,"benefitDescLabel",void 0),l([a({displayName:"\u798f\u5229\u65f6\u95f4",type:cc.Label})],P.prototype,"benifitOpeningTimeLabel",void 0),l([a({displayName:"\u798f\u5229\u5956\u52b1\u540d\u79f0",type:cc.Label})],P.prototype,"benifitRewardLabel",void 0),l([a({displayName:"\u798f\u5229\u5956\u52b1\u56fe\u6807",type:cc.Sprite})],P.prototype,"benefitRewardSprite",void 0),l([a({displayName:"\u9886\u53d6\u6309\u94ae",type:cc.Button})],P.prototype,"commitButton",void 0),C=l([v,C("Game/UI/BenefitUI")],P),n.default=C,cc._RF.pop()},{}],building_avatar_all:[function(t,e,o){"use strict";cc._RF.push(e,"fa91ah5ItRHz4NeoxC0FKNw","building_avatar_all");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var c,s=a("gnode"),u=a("ggame"),d=a("local_building"),p=a("building_avatar_ui");function f(){return null!==c&&c.apply(this,arguments)||this}a=(n=cc._decorator).ccclass,n.property,n=n.menu,l(f,c=cc.Component),f.prototype.onEnable=function(){for(var t=1;t<d.eBuildingType.max;++t){var e=this.node.getChildByName("button_building"+t);e&&(e.active=!0,s.sGNode.addUniqueComponent(e,p.default).init(t))}},f.prototype.onDisable=function(){u.sGGame.targetOff(this)},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Building/BuildingAvatarAll")],f),r.default=n,cc._RF.pop()},{}],building_avatar_ui:[function(t,e,o){"use strict";cc._RF.push(e,"cbae39N68FI8bn6LGx1PJTt","building_avatar_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gaudio"),d=a("geffect"),p=a("gnode"),f=a("ggame"),h=a("gview_model"),g=a("local_building"),y=a("vm_building");function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.infoButton=null,t.root=null,t.avatarNode=null,t.building=null,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,l(m,c=cc.Component),m.prototype.init=function(t){this.building=f.sGGame.localModel.getModule(g.LocalBuildingPackage).getBuildingByType(t),this.enabledInHierarchy&&this.refresh()},m.prototype.onLoad=function(){this.infoButton=this.node.getComponent(cc.Button),this.infoButton&&this.infoButton.node.on("click",this.onClickInfoButton.bind(this))},m.prototype.onEnable=function(){this.root=this.node.getChildByName("building_root"),f.sGGame.on(g.sLocalBuildingEvent.upgrade,this.onBuildingUpgrade.bind(this),this),this.refresh()},m.prototype.onDisable=function(){f.sGGame.targetOff(this),p.sGNode.targetOff(this)},m.prototype.refresh=function(t){var e,o=this;this.root&&(this.building?(e=this.building.getLevelStep(this.building.getLevel()),this.step!==e&&(this.step=e,this.root.active=!0,p.sGNode.targetOff(this),e="prefabs/building/building"+this.building.getBuildingType()+"/age"+this.building.getBuildingAge()+"/building"+e,p.sGNode.createNode(e,function(e){e&&(t&&d.sGEffect.addEffect(30,o.node,!0),o.avatarNode&&p.sGNode.destoryNode(o.avatarNode),o.avatarNode=e,o.avatarNode.parent=o.root,t&&cc.tween(e).set({opacity:0}).to(.5,{opacity:255}).start())},this))):this.root.active=!1)},m.prototype.onBuildingUpgrade=function(t){this.building&&t.entry.id===this.building.entry.id&&this.refresh(!0)},m.prototype.onClickInfoButton=function(){this.building&&(this.building.isUnlock()?0<this.building.getProduceCache()?(u.sGAudio.playEffect(s.sAudioConfig.config.reward),f.sGGame.localModel.getModule(g.LocalBuildingPackage).collect(this.building)):h.sGViewModel.getModule(y.VMBuilding).openUpgradeUI(this.building):h.sGViewModel.getModule(y.VMBuilding).openUnlockUI(this.building))},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Building/BuildingAvatarUI")],m),r.default=n,cc._RF.pop()},{}],building_base:[function(t,e,o){"use strict";cc._RF.push(e,"470daT8L5VL2beABDBNsPeP","building_base");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("age_config"),u=a("audio_config"),d=a("soldier_attribute_config"),p=a("gaudio"),f=a("gnode"),h=a("ggame"),g=a("game_define"),y=a("attribute_slot"),m=a("attribute_system"),b=a("local_battle"),_=a("unit"),v=a("unit_attribute"),C=a("unit_health"),P=(S=cc._decorator).ccclass,S=(a=S.property,S.menu);function G(){var t=null!==c&&c.apply(this,arguments)||this;return t.skinRoot=null,t.ageEntry=null,t.unit=null,t.unitHealth=null,t.unitAttribute=null,t.skinNode=null,t.isBombed=!1,t}r(G,c=cc.Component),G.prototype.init=function(t,e,o,i){this.unit=f.sGNode.addUniqueComponent(this.node,_.default),this.unitHealth=f.sGNode.addUniqueComponent(this.node,C.default),this.unitAttribute=f.sGNode.addUniqueComponent(this.node,v.default),this.unit.unitID=t,this.unit.teamID=o,this.unit.unitType=b.enumUnitType.soldier,this.unit.battleManager=i,this.ageEntry=s.sAgeConfig.getEntry(e),this.unitAttribute.attributeSystem=new m.AttributeSystem,this.unitAttribute.attributeSystem.init(d.sSoldierAttributeConfig),e=this.unitAttribute.attributeSystem.getSlot("init"),o=o===b.enumTeam.player?h.sGGame.localModel.getModule(b.LocalBattle).getPlayerBaseMaxHP():h.sGGame.localModel.getModule(b.LocalBattle).getEnemyBaseMaxHP(),e.setPosValue(d.sSoldierAttributeConfig.config.maxHP,y.eAttributePos.init,o),this.unitHealth.hp=this.unitAttribute.attributeSystem.getValue(d.sSoldierAttributeConfig.config.maxHP),this.unit.battleManager=i},G.prototype.onLoad=function(){},G.prototype.onEnable=function(){this.setSkin()},G.prototype.onDisable=function(){this.skinNode&&(f.sGNode.destoryNode(this.skinNode),this.skinNode=null),f.sGNode.targetOff(this)},G.prototype.setLevel=function(t){this.ageEntry=s.sAgeConfig.getEntry(t),this.node.activeInHierarchy&&this.setSkin()},G.prototype.setSkin=function(){var t=this;this.ageEntry&&(f.sGNode.targetOff(this),this.skinNode&&(f.sGNode.destoryNode(this.skinNode),this.skinNode=null),f.sGNode.createNode(this.ageEntry.prefab,function(e){e&&(t.skinNode=e,t.unit.teamID===b.enumTeam.player&&!t.ageEntry.faceRight||t.unit.teamID===b.enumTeam.enemy&&t.ageEntry.faceRight?t.skinNode.scaleX=-Math.abs(t.skinNode.scaleX):t.skinNode.scaleX=Math.abs(t.skinNode.scaleX),t.skinRoot&&t.skinRoot.addChild(e))},this))},G.prototype.checkBomb=function(){!this.isBombed&&this.unitHealth.hp<=0&&(p.sGAudio.playEffect(u.sAudioConfig.config.bomb),this.isBombed=!0,this.unit.battleManager.createParticleScaleX(g.GameDefine.prefabParticleBaseBomb,this.node.x,this.node.y,this.skinNode.scaleX,{}),this.node.opacity=0)},l([a({type:cc.Node,tooltip:"\u76ae\u80a4\u6240\u6302\u4f4d\u7f6e"})],G.prototype,"skinRoot",void 0),S=l([P,S("Game/Battle/BuildingBase")],G),n.default=S,cc._RF.pop()},{}],building_simple_all:[function(t,e,o){"use strict";cc._RF.push(e,"8c6b9OS82xFqISCQAusbIk6","building_simple_all");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("gnode"),u=a("local_building"),d=a("building_simple_ui"),p=(f=cc._decorator).ccclass,f=(a=f.property,f.menu);function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.btPrefab=null,t}r(h,c=cc.Component),h.prototype.onLoad=function(){for(var t=1;t<u.eBuildingType.max;++t){var e,o,i=this.node.getChildByName("bt"+t);i&&this.btPrefab&&(e=cc.instantiate(this.btPrefab))&&((o=s.sGNode.addUniqueComponent(e,d.default))&&o.init(t),i.addChild(e))}},l([a({displayName:"\u754c\u9762\u9884\u5236\u4ef6",type:cc.Prefab})],h.prototype,"btPrefab",void 0),f=l([p,f("Game/Building/BuildingSimpleAll")],h),n.default=f,cc._RF.pop()},{}],building_simple_ui:[function(t,e,o){"use strict";cc._RF.push(e,"59377fdXMdK4aO70edbMzKF","building_simple_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("local_currency"),u=a("reddot"),d=a("audio_config"),p=a("currency_config"),f=a("anim_player"),h=a("scroll_process_bar"),g=a("i18n"),y=a("gaudio"),m=a("gnode"),b=a("gnumber"),_=a("ggame"),v=a("gview_model"),C=a("local_building"),P=a("vm_building"),S=a("vm_reward"),G=a("building_upgrade_button_ui"),M=(w=cc._decorator).ccclass,w=(a=w.property,w.menu);function A(){var t=null!==c&&c.apply(this,arguments)||this;return t.building=null,t.goodsTipNode=null,t.collectGoodButton=null,t.cdProgressBar=null,t.collectSpeedLabel=null,t.cacheGoodLabel=null,t.lockNode=null,t.unlockLabel=null,t.nameLabel=null,t.unlockButton=null,t.upgradeButton=null,t.upgradePointLabel=null,t.cdScrollProgressBar=null,t.passTime1=1,t.lastCollectPassTime=0,t}r(A,c=cc.Component),A.prototype.init=function(t){this.building=_.sGGame.localModel.getModule(C.LocalBuildingPackage).getBuildingByType(t),this.node.name+=t.toString()},A.prototype.onClickUnlockButton=function(){var t;this.building&&(y.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),0==(t=_.sGGame.localModel.getModule(C.LocalBuildingPackage).unlock(this.building.entry.id)).errorCode&&(y.sGAudio.playEffect(d.sAudioConfig.config.build),y.sGAudio.playEffect(d.sAudioConfig.config.reward),t.rewardResult&&v.sGViewModel.getModule(S.VMReward).openRewardResult(t.rewardResult.rewardList)))},A.prototype.onLoad=function(){var t=this;this.unlockButton&&(m.sGNode.addUniqueComponent(this.unlockButton,u.default).init(function(){return v.sGViewModel.getModule(P.VMBuilding).hasBuildingReddot(t.building)},"reddot"),this.unlockButton.node.on("click",this.onClickUnlockButton.bind(this),this)),this.upgradeButton&&m.sGNode.addUniqueComponent(this.upgradeButton,u.default).init(function(){return v.sGViewModel.getModule(P.VMBuilding).hasBuildingReddot(t.building)},"reddot"),this.collectGoodButton&&this.collectGoodButton.node.on("click",this.onClickCollectButton.bind(this),this),this.cdProgressBar&&(this.cdScrollProgressBar=m.sGNode.addUniqueComponent(this.cdProgressBar,h.default))},A.prototype.onEnable=function(){var t=this;_.sGGame.on(C.sLocalBuildingEvent.collected,function(e,o,i){t.building&&e==t.building&&(t.refresh(!0),t.collectGoodButton&&m.sGNode.createPoolNode("prefabs/ui/kjd_get_tips",function(e){var a,n=m.sGNode.addUniqueComponent(e,f.default);e.parent=t.collectGoodButton.node.parent,e.setPosition(t.collectGoodButton.node.getPosition()),n.init(function(){m.sGNode.destoryPoolNode(e)}),n.play(),i?((a=cc.find("anim_root/layout_common",e))&&(a.active=!1),(a=cc.find("anim_root/layout_double",e))&&(a.active=!0)):((a=cc.find("anim_root/layout_double",e))&&(a.active=!1),(a=cc.find("anim_root/layout_common",e))&&(a.active=!0)),!a||(a=m.sGNode.findComponent(a,"Label_number",cc.Label))&&(a.string="+"+b.sGNumber.toHuman(o))},t))},this),_.sGGame.on(C.sLocalBuildingEvent.unlock,function(e){e==t.building&&(t.playNameAnim(),t.refresh(!1))},this),_.sGGame.on(C.sLocalBuildingEvent.upgrade,function(e){e==t.building?(t.playNameAnim(),t.refresh(!1)):t.building.isUnlock()||t.unlockButton.interactable||0!==_.sGGame.localModel.getModule(C.LocalBuildingPackage).checkUnlock(t.building.entry.id)||t.refresh(!1)},this),_.sGGame.on(s.sLocalCurrencyEvent.changed,function(e,o,i){e===p.sCurrencyConfig.config.buildingUpgradePoint&&t.building.isUnlock()&&(0<i&&!t.upgradeButton.interactable&&0===_.sGGame.localModel.getModule(C.LocalBuildingPackage).checkUpgrade(t.building.entry.id)||i<0&&t.upgradeButton.interactable&&0!==_.sGGame.localModel.getModule(C.LocalBuildingPackage).checkUpgrade(t.building.entry.id))&&t.refresh(!1)},this),this.upgradeButton&&m.sGNode.addUniqueComponent(this.upgradeButton,G.default).init(this.building),this.refresh(!0)},A.prototype.onDisable=function(){_.sGGame.targetOff(this),m.sGNode.targetOff(this)},A.prototype.playNameAnim=function(){this.nameLabel&&cc.tween(this.nameLabel.node).set({scale:3}).to(.5,{scale:1},{easing:"backOut"}).start()},A.prototype.update=function(t){var e,o;this.building&&(this.passTime1+=t,.5<this.passTime1&&(this.passTime1=0,e=this.building.isUnlock(),o=this.building.getCollectPassSeconds(),t=this.building.getCollectNeedSeconds(),this.goodsTipNode&&(this.goodsTipNode.active=e&&0<this.building.record.produceCache),this.cdScrollProgressBar&&(this.cdScrollProgressBar.node.active=e,this.cdScrollProgressBar.node.active&&(this.lastCollectPassTime>o&&this.cdScrollProgressBar.setProgress(0),this.cdScrollProgressBar.setProgress(o/t,.5)),this.lastCollectPassTime=o),this.cacheGoodLabel&&(this.cacheGoodLabel.string=b.sGNumber.toHuman(this.building.record.produceCache))))},A.prototype.onClickCollectButton=function(){this.building&&0<this.building.getProduceCache()&&(y.sGAudio.playEffect(d.sAudioConfig.config.reward),_.sGGame.localModel.getModule(C.LocalBuildingPackage).collect(this.building))},A.prototype.refresh=function(t){var e,o,i,a,n,r,l,c;this.building?(e=_.sGGame.localModel.getModule(C.LocalBuildingPackage),o=this.building.getCollectPassSeconds(),i=this.building.getCollectNeedSeconds(),a=this.building.isUnlock(),n=this.building.getLevel(),this.nameLabel&&(0<this.building.getLevel()?this.nameLabel.string=g.i18n.t(this.building.entry.name)+" lv"+this.building.getLevel():this.nameLabel.string=g.i18n.t(this.building.entry.name)),!this.collectSpeedLabel||(this.collectSpeedLabel.node.active=0<n)&&(c=(c=g.i18n.t("tips.collectPerSecond")).replace("${value}",b.sGNumber.toHuman(this.building.getProduce())),this.collectSpeedLabel.string=c),r=0===e.checkUnlock(this.building.entry.id),l=this.building.isUnlock(),this.lockNode&&(this.lockNode.active=!l),this.unlockLabel&&(l?this.unlockLabel.node.active=!1:(this.unlockLabel.node.active=!r,this.unlockLabel.node.active&&(c=g.i18n.t("building.unlockCondition"),c=(c=(l=e.getBuildingByType(this.building.getBuildingType()-1))?c.replace("${buildingName}",g.i18n.t(l.entry.name)):c).replace("${value}",this.building.entry.unlockLevel.toString()),this.unlockLabel.string=c))),t&&(this.cdScrollProgressBar&&(this.cdScrollProgressBar.node.active=a,this.cdScrollProgressBar.node.active&&this.cdScrollProgressBar.setProgress(o/i)),this.goodsTipNode&&(this.goodsTipNode.active=a&&0<this.building.record.produceCache),this.cacheGoodLabel&&(this.cacheGoodLabel.string=b.sGNumber.toHuman(this.building.record.produceCache))),this.upgradeButton&&(this.upgradeButton.node.active=0<n&&n<this.building.getMaxLevel(),this.upgradeButton.interactable=0===e.checkUpgrade(this.building.entry.id)),this.unlockButton&&(this.unlockButton.node.active=r,this.unlockButton.interactable=r),this.upgradePointLabel&&(this.upgradePointLabel.string=b.sGNumber.toHuman(this.building.getUpgradeNeed()))):this.node.active=!1},l([a({displayName:"\u91c7\u96c6\u4ed3\u5e93\u8282\u70b9",type:cc.Node})],A.prototype,"goodsTipNode",void 0),l([a({displayName:"\u91c7\u96c6\u79d1\u6280\u70b9\u6309\u94ae",type:cc.Button})],A.prototype,"collectGoodButton",void 0),l([a({displayName:"\u91c7\u96c6\u8fc7\u7a0b\u8fdb\u5ea6\u6761",type:cc.ProgressBar})],A.prototype,"cdProgressBar",void 0),l([a({displayName:"\u91c7\u96c6\u901f\u5ea6",type:cc.Label})],A.prototype,"collectSpeedLabel",void 0),l([a({displayName:"\u91c7\u96c6\u4ed3\u5e93\u79d1\u6280\u70b9\u6570\u503c",type:cc.Label})],A.prototype,"cacheGoodLabel",void 0),l([a({displayName:"\u5efa\u7b51\u9501\u6807\u8bb0",type:cc.Node})],A.prototype,"lockNode",void 0),l([a({displayName:"\u89e3\u9501\u6761\u4ef6",type:cc.Label})],A.prototype,"unlockLabel",void 0),l([a({displayName:"\u5efa\u7b51\u540d\u79f0",type:cc.Label})],A.prototype,"nameLabel",void 0),l([a({displayName:"\u89e3\u9501\u6309\u94ae",type:cc.Button})],A.prototype,"unlockButton",void 0),l([a({displayName:"\u5347\u7ea7\u6309\u94ae",type:cc.Button})],A.prototype,"upgradeButton",void 0),l([a({displayName:"\u5347\u7ea7\u4ef7\u683c\u5c55\u793a",type:cc.Label})],A.prototype,"upgradePointLabel",void 0),w=l([M,w("Game/Building/BuildingSimpleUI")],A),n.default=w,cc._RF.pop()},{}],building_unlock_ui:[function(t,e,o){"use strict";cc._RF.push(e,"941bbtsbF9G7aTq/UcDgUgb","building_unlock_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("reward_helper"),d=a("i18n"),p=a("gaudio"),f=a("gnode"),h=a("ggame"),g=a("gview_model"),y=a("local_building"),m=a("vm_reward"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu);function v(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.conditionLabel=null,t.unlockButton=null,t.unlockRewardRoot=null,t.unlockRewardSprite=null,t.unlockRewardLabel=null,t.building=null,t}r(v,c=cc.Component),v.prototype.init=function(t){this.building=t},v.prototype.onLoad=function(){var t=this;this.unlockButton&&this.unlockButton.node.on("click",function(){p.sGAudio.playEffect(s.sAudioConfig.config.buttonClick);var e=h.sGGame.localModel.getModule(y.LocalBuildingPackage).unlock(t.building.entry.id);0==e.errorCode&&(p.sGAudio.playEffect(s.sAudioConfig.config.build),p.sGAudio.playEffect(s.sAudioConfig.config.reward),e.rewardResult&&g.sGViewModel.getModule(m.VMReward).openRewardResult(e.rewardResult.rewardList)),f.sGNode.destoryNode(t.node)})},v.prototype.onEnable=function(){p.sGAudio.playEffect(s.sAudioConfig.config.popUI),this.refresh()},v.prototype.refresh=function(){var t,e;this.building&&(this.nameLabel&&(this.nameLabel.string=d.i18n.t(this.building.entry.name)),this.conditionLabel&&(t=d.i18n.t("tips.buildingUnlockCondition"),(e=h.sGGame.localModel.getModule(y.LocalBuildingPackage).getBuildingByType(this.building.getBuildingType()-1))&&(t=(t=t.replace("${name}",d.i18n.t(e.entry.name))).replace("${level}",this.building.entry.unlockLevel.toString()),this.conditionLabel.string=t)),this.unlockButton&&(this.unlockButton.interactable=0==h.sGGame.localModel.getModule(y.LocalBuildingPackage).checkUnlock(this.building.entry.id)),e=null!=this.building.entry.unlockReward,this.unlockRewardRoot&&(this.unlockRewardRoot.active=e)&&(t=u.RewardList.createFromString(this.building.entry.unlockReward).getReward(0),e=g.sGViewModel.getModule(m.VMReward),this.unlockRewardSprite&&f.sGNode.setSprite(this.unlockRewardSprite,e.getIcon(t.type,t.id),this),this.unlockRewardLabel&&(this.unlockRewardLabel.string=e.getName(t.type,t.id))))},l([a(cc.Label)],v.prototype,"nameLabel",void 0),l([a(cc.Label)],v.prototype,"conditionLabel",void 0),l([a(cc.Button)],v.prototype,"unlockButton",void 0),l([a({displayName:"\u89e3\u9501\u5956\u52b1\u6839\u8282\u70b9",type:cc.Node})],v.prototype,"unlockRewardRoot",void 0),l([a({displayName:"\u89e3\u9501\u5956\u52b1\u56fe\u6807",type:cc.Sprite})],v.prototype,"unlockRewardSprite",void 0),l([a({displayName:"\u89e3\u9501\u5956\u52b1\u6587\u672c",type:cc.Label})],v.prototype,"unlockRewardLabel",void 0),_=l([b,_("Game/Building/BuildingUnlockUI")],v),n.default=_,cc._RF.pop()},{}],building_upgrade_button_ui:[function(t,e,o){"use strict";cc._RF.push(e,"43037OgP4ZDUqnZXCxpmznr","building_upgrade_button_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("i18n"),d=a("gui"),p=a("gaudio"),f=a("gtime"),h=a("ggame"),g=a("gview_model"),y=a("local_building"),m=a("vm_building"),b=a("promote_tip_ui");function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.building=null,t.touchUpgradeAutomatic=!1,t.touchUpgradeInterval=0,t.touchUpgradeTimes=0,t.touchUpgradeLastTime=0,t.clickUpgradeLastTime=0,t.clickUpgradeTimes=0,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,l(_,c=cc.Component),_.prototype.init=function(t){this.building=t},_.prototype.onUpgradeButtonTouchStart=function(t){this.touchUpgradeStartPos=t.getLocation(),this.touchUpgradeAutomatic=!0,this.touchUpgradeInterval=1,this.touchUpgradeTimes=0,this.touchUpgradeLastTime=0,p.sGAudio.playEffect(s.sAudioConfig.config.buttonClick)},_.prototype.onUpgradeButtonTouchMove=function(t){this.touchUpgradeAutomatic&&100<t.getLocation().sub(this.touchUpgradeStartPos).lengthSqr()&&(this.touchUpgradeAutomatic=!1)},_.prototype.onUpgradeButtonTouchEnd=function(){var t;0===this.touchUpgradeTimes&&(this.upgradeBuilding(),t=f.sGTime.timestamp(),!this.clickUpgradeLastTime||5e3<t-this.clickUpgradeLastTime?this.clickUpgradeTimes=1:(this.clickUpgradeTimes++,5===this.clickUpgradeTimes&&d.sGUI.openNoticeUI("prefabs/ui/important_tips",function(t){t.getComponent(b.default).init(u.i18n.t("importantTips.touchLongTime2Upgrade"))})),this.clickUpgradeLastTime=t),this.touchUpgradeAutomatic=!1},_.prototype.onUpgradeButtonTouchCancel=function(){this.touchUpgradeAutomatic=!1},_.prototype.upgradeBuilding=function(){var t=h.sGGame.localModel.getModule(y.LocalBuildingPackage);0===t.upgrade(this.building.entry.id)&&(this.touchUpgradeTimes%10==0&&p.sGAudio.playEffect(s.sAudioConfig.config.build),this.touchUpgradeTimes<3&&p.sGAudio.playEffect(s.sAudioConfig.config.reward),0===t.checkUpgradeAge()&&g.sGViewModel.getModule(m.VMBuilding).openUpgradeAgeUI())},_.prototype.updateTouchUpgrade=function(t){this.touchUpgradeAutomatic&&(this.touchUpgradeLastTime+=t,this.touchUpgradeLastTime>=this.touchUpgradeInterval&&(this.touchUpgradeLastTime=0,this.upgradeBuilding(),this.touchUpgradeTimes++,this.touchUpgradeInterval=.1))},_.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onUpgradeButtonTouchStart.bind(this),this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onUpgradeButtonTouchMove.bind(this),this),this.node.on(cc.Node.EventType.TOUCH_END,this.onUpgradeButtonTouchEnd.bind(this),this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onUpgradeButtonTouchCancel.bind(this),this)},_.prototype.onDisable=function(){this.node.targetOff(this)},_.prototype.update=function(t){this.updateTouchUpgrade(t)},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Building/BuildingUpgradeButtonUI")],_),r.default=n,cc._RF.pop()},{}],building_upgrade_ui:[function(t,e,o){"use strict";cc._RF.push(e,"2a926iP3m9HHInc+RKjRhEi","building_upgrade_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("i18n"),d=a("gaudio"),p=a("gnode"),f=a("gnumber"),h=a("ggame"),g=a("local_building"),y=a("building_upgrade_button_ui"),m=(b=cc._decorator).ccclass,b=(a=b.property,b.menu);function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.levelLabel=null,t.nextLevelNodeArray=[],t.currentTechPointLabel=null,t.currentTechPointIntervalLabel=null,t.currentSpecialEffectLabel=null,t.nextTechPointLabel=null,t.nextTechPointIntervalLabel=null,t.nextSpecialEffectLabel=null,t.upgradeButton=null,t.upgradePointLabel=null,t.fullLevelNode=null,t.upgradeAgeNode=null,t.upgradeAgeButton=null,t.building=null,t}r(_,c=cc.Component),_.prototype.init=function(t){this.building=t},_.prototype.onLoad=function(){this.upgradeButton&&p.sGNode.addUniqueComponent(this.upgradeButton,y.default).init(this.building)},_.prototype.onEnable=function(){var t=this;d.sGAudio.playEffect(s.sAudioConfig.config.popUI),h.sGGame.on(g.sLocalBuildingEvent.upgrade,function(){t.refresh()},this),this.refresh()},_.prototype.onDisable=function(){h.sGGame.targetOff(this),p.sGNode.targetOff(this)},_.prototype.update=function(){var t;this.building&&(t=h.sGGame.localModel.getModule(g.LocalBuildingPackage),this.upgradeButton&&(this.upgradeButton.interactable=0==t.checkUpgrade(this.building.entry.id)))},_.prototype.refresh=function(){if(this.building){var t=h.sGGame.localModel.getModule(g.LocalBuildingPackage);this.nameLabel&&(this.nameLabel.string=u.i18n.t(this.building.entry.name)),this.levelLabel&&(this.levelLabel.string=this.building.record.level+""),this.upgradeButton&&(this.upgradeButton.interactable=0==t.checkUpgrade(this.building.entry.id),this.upgradeButton.node.active=!this.building.isLevelFull()),this.upgradePointLabel&&(this.upgradePointLabel.string=f.sGNumber.toHuman(this.building.getUpgradeNeed()));for(var e,o,i,a=0;a<this.nextLevelNodeArray.length;++a){var n=this.nextLevelNodeArray[a];n&&(n.active=!this.building.isLevelFull())}this.currentTechPointLabel&&(i=(i=u.i18n.t("tips.collectPerSecond")).replace("${value}",f.sGNumber.toHuman(this.building.getProduce())),this.currentTechPointLabel.string=i),this.currentTechPointIntervalLabel&&(this.currentTechPointIntervalLabel.string=this.building.getCollectNeedSeconds()+u.i18n.t("time.second")),this.currentSpecialEffectLabel&&(e=void 0,e=u.i18n.t(this.building.entry.upgradeDesc),o=this.building.getAttributeLevelValue(this.building.getLevel())+t.getAttributeValueFromOldAge(this.building),e=e.replace("${value}",f.sGNumber.toFixed(o,2)),this.currentSpecialEffectLabel.string=e),this.building.isLevelFull()?this.fullLevelNode&&(this.fullLevelNode.active=!0):(this.nextTechPointLabel&&(i=(i=u.i18n.t("tips.collectPerSecond")).replace("${value}",f.sGNumber.toHuman(this.building.getProduce(this.building.getLevel()+1))),this.nextTechPointLabel.string=i),this.nextTechPointIntervalLabel&&(this.nextTechPointIntervalLabel.string=this.building.getCollectNeedSeconds()+u.i18n.t("time.second")),this.nextSpecialEffectLabel&&(e=void 0,e=u.i18n.t(this.building.entry.upgradeDesc),o=this.building.getAttributeLevelValue(this.building.getLevel()+1)+t.getAttributeValueFromOldAge(this.building),e=e.replace("${value}",f.sGNumber.toFixed(o,2)),this.nextSpecialEffectLabel.string=e),this.fullLevelNode&&(this.fullLevelNode.active=!1)),this.upgradeAgeButton&&(this.upgradeAgeButton.node.active=!1)}},l([a(cc.Label)],_.prototype,"nameLabel",void 0),l([a(cc.Label)],_.prototype,"levelLabel",void 0),l([a(cc.Node)],_.prototype,"nextLevelNodeArray",void 0),l([a(cc.Label)],_.prototype,"currentTechPointLabel",void 0),l([a(cc.Label)],_.prototype,"currentTechPointIntervalLabel",void 0),l([a(cc.Label)],_.prototype,"currentSpecialEffectLabel",void 0),l([a(cc.Label)],_.prototype,"nextTechPointLabel",void 0),l([a(cc.Label)],_.prototype,"nextTechPointIntervalLabel",void 0),l([a(cc.Label)],_.prototype,"nextSpecialEffectLabel",void 0),l([a(cc.Button)],_.prototype,"upgradeButton",void 0),l([a(cc.Label)],_.prototype,"upgradePointLabel",void 0),l([a(cc.Node)],_.prototype,"fullLevelNode",void 0),l([a(cc.Node)],_.prototype,"upgradeAgeNode",void 0),l([a(cc.Button)],_.prototype,"upgradeAgeButton",void 0),b=l([m,b("Game/Building/BuildingUpgradeUI")],_),n.default=b,cc._RF.pop()},{}],card_button_ui:[function(t,e,o){"use strict";cc._RF.push(e,"ce4c0pF6UlMlZwjeUcHePdn","card_button_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reddot"),u=a("stage_config"),d=a("gui"),p=a("gnode"),f=a("ggame"),h=a("gview_model"),g=a("local_stage"),y=a("vm_card"),m=(b=cc._decorator).ccclass,b=(a=b.property,b.menu);function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.lockNode=null,t.openStageConditionLabel=null,t.openStageCondition=1,t.openButton=null,t.reddotRootArray=[],t.isOpen=!1,t}r(_,c=cc.Component),_.prototype.onLoad=function(){this.openButton&&this.openButton.node.on("click",this.onOpenButtonClick.bind(this));for(var t=0;t<this.reddotRootArray.length;++t){var e=this.reddotRootArray[t];e&&p.sGNode.addUniqueComponent(e,s.default).init(function(){return h.sGViewModel.getModule(y.VMCard).hasCardReddot()},"reddot")}},_.prototype.onEnable=function(){var t=this,e=u.sStageConfig.getEntry(this.openStageCondition);this.openStageConditionLabel&&(this.openStageConditionLabel.string=e.name),f.sGGame.on(g.sLocalStageEvent.currentStageChanged,function(){t.refreshLock()},this),this.refreshLock()},_.prototype.onDisable=function(){f.sGGame.targetOff(this)},_.prototype.onOpenButtonClick=function(){f.sGGame.localModel.getModule(g.LocalStage).getCurrentBattleStageID()<this.openStageCondition||d.sGUI.openDialogUI("prefabs/ui/building_card_ui")},_.prototype.refreshLock=function(){var t=f.sGGame.localModel.getModule(g.LocalStage).getCurrentBattleStageID();this.isOpen=t>=this.openStageCondition,this.lockNode&&(this.lockNode.active=!this.isOpen)},l([a(cc.Node)],_.prototype,"lockNode",void 0),l([a(cc.Label)],_.prototype,"openStageConditionLabel",void 0),l([a],_.prototype,"openStageCondition",void 0),l([a(cc.Button)],_.prototype,"openButton",void 0),l([a(cc.Node)],_.prototype,"reddotRootArray",void 0),b=l([m,b("Game/UI/CardButtonUI")],_),n.default=b,cc._RF.pop()},{}],card_equip_skill_package_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"9e831B9x/tAq78/zmiC9n6p","card_equip_skill_package_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("i18n"),u=a("fast_scrollview"),d=a("fast_scrollview_cell"),p=a("gnode"),f=a("ggame"),h=a("gview_model"),g=a("game_define"),y=a("local_card"),m=a("vm_reward"),b=a("card_equip_skill_ui"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.countLabel=null,t.starLabel=null,t.countProgressBar=null,t.iconSprite=null,t.starRoot=null,t.qualityRoot=null,t.emptyCardRoot=null,t.notEmptyCardRoot=null,t.selectNode=null,t.selectButton=null,t.typeRoot=null,t.fastScrollViewCell=null,t.card=null,t._selected=!1,t}r(C,c=cc.Component),Object.defineProperty(C.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected!=t&&this.node.activeInHierarchy&&this.selectNode&&(this.selectNode.active=t),this._selected=t},enumerable:!1,configurable:!0}),C.prototype.onLoad=function(){var t=this;this.fastScrollViewCell=this.getComponent(d.FastScrollViewCell),this.selectButton&&this.selectButton.node.on("click",function(){var e;0!=f.sGGame.localModel.getModule(y.LocalCardPackage).changeSkillEquip(t.card)||(e=t.fastScrollViewCell.fastScrollView.getComponent(b.default))&&e.selectCard(t.card.entry.id)})},C.prototype.onEnable=function(){var t=this;this.card=this.fastScrollViewCell.data,this.selected=this.fastScrollViewCell.cellData.selected,this.fastScrollViewCell.fastScrollView.node.on(u.sFastScrollViewEvent.selectChanged,function(e,o){e==t.fastScrollViewCell.cellData?t.selected=!0:o==t.fastScrollViewCell.cellData&&(t.selected=!1)},this),this.refresh()},C.prototype.onDisable=function(){p.sGNode.targetOff(this),f.sGGame.targetOff(this),this.fastScrollViewCell.fastScrollView.node.targetOff(this)},C.prototype.refresh=function(){if(this.card){this.selectNode&&(this.selectNode.active=this.selected),this.notEmptyCardRoot&&(this.notEmptyCardRoot.active=!0),this.emptyCardRoot&&(this.emptyCardRoot.active=!1);var t=this.card.getFragment(),e=this.card.getUpgradeNeed();if(this.nameLabel&&(this.nameLabel.string=s.i18n.t(this.card.entry.name),this.nameLabel.node.color=h.sGViewModel.getModule(m.VMReward).getQualityColor(this.card.entry.quality)),this.card.isActive()&&(this.countLabel&&(this.countLabel.string=t+"/"+e,this.countLabel.node.active=this.card.isActive()),this.countProgressBar&&(this.countProgressBar.progress=t/e)),this.iconSprite&&(p.sGNode.setSprite(this.iconSprite,this.card.entry.icon),p.sGNode.setSpriteMaterial(this.iconSprite,0===this.card.record.level?"2d-gray-sprite":"2d-sprite")),this.starLabel&&(this.starLabel.string=this.card.record.level.toString()),this.starRoot)for(var o=1;;++o){var i=this.starRoot.getChildByName("star"+o);if(!i)break;(i=i.getChildByName("star"))&&(i.active=o<=this.card.record.level)}if(this.qualityRoot)for(o=1;;++o){var a=this.qualityRoot.getChildByName("quality"+o);if(!a)break;a.active=o+2===this.card.entry.quality}if(this.typeRoot)for(var n in g.GameDefine.uiTypeNodeNameDic){var r=this.typeRoot.getChildByName(n);if(!r)break;r.active=g.GameDefine.uiTypeNodeNameDic[n]===this.card.entry.type}}else this.notEmptyCardRoot&&(this.notEmptyCardRoot.active=!1),this.emptyCardRoot&&(this.emptyCardRoot.active=!0)},l([a(cc.Label)],C.prototype,"nameLabel",void 0),l([a(cc.Label)],C.prototype,"countLabel",void 0),l([a(cc.Label)],C.prototype,"starLabel",void 0),l([a(cc.ProgressBar)],C.prototype,"countProgressBar",void 0),l([a(cc.Sprite)],C.prototype,"iconSprite",void 0),l([a(cc.Node)],C.prototype,"starRoot",void 0),l([a(cc.Node)],C.prototype,"qualityRoot",void 0),l([a(cc.Node)],C.prototype,"emptyCardRoot",void 0),l([a(cc.Node)],C.prototype,"notEmptyCardRoot",void 0),l([a(cc.Node)],C.prototype,"selectNode",void 0),l([a(cc.Button)],C.prototype,"selectButton",void 0),l([a(cc.Node)],C.prototype,"typeRoot",void 0),v=l([_,v("Game/UI/CardEquipSkillPackageIconUI")],C),n.default=v,cc._RF.pop()},{}],card_equip_skill_top_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"a5416DrD+BBa7J/mLYaiqYP","card_equip_skill_top_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.sCardEquipTopIconUIEvent=void 0;var c,s=a("i18n"),u=a("gnode"),d=a("ggame"),p=a("gview_model"),f=a("game_define"),h=a("local_card"),g=a("vm_game"),y=a("vm_reward"),m=(b=cc._decorator).ccclass,b=(a=b.property,b.menu);function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.countLabel=null,t.starLabel=null,t.countProgressBar=null,t.iconSprite=null,t.starRoot=null,t.qualityRoot=null,t.emptyCardRoot=null,t.notEmptyCardRoot=null,t.selectNode=null,t.selectButton=null,t.typeRoot=null,t._card=null,t._selected=!1,t}n.sCardEquipTopIconUIEvent={selectChanged:"sCardEquipTopIconUIEvent.select"},r(_,c=cc.Component),Object.defineProperty(_.prototype,"card",{get:function(){return this._card},set:function(t){this._card=t,this.node.activeInHierarchy&&this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected!=t&&this.node.activeInHierarchy&&this.selectNode&&(this.selectNode.active=t),this._selected=t,this._selected&&d.sGGame.emit(n.sCardEquipTopIconUIEvent.selectChanged,this._card)},enumerable:!1,configurable:!0}),_.prototype.onLoad=function(){var t=this;this.selectButton&&this.selectButton.node.on("click",function(){t.selected=!0})},_.prototype.onEnable=function(){var t=this;d.sGGame.on(h.sLocalCardEvent.upgrade,function(){t.refresh()},this),d.sGGame.on(h.sLocalCardEvent.changeEquip,function(e){t.card&&e.entry.type===t.card.entry.type&&(t.card=e)},this),d.sGGame.on(n.sCardEquipTopIconUIEvent.selectChanged,function(e){t.card&&e.entry.type!==t.card.entry.type&&(t.selected=!1)},this),this.refresh()},_.prototype.onDisable=function(){u.sGNode.targetOff(this),d.sGGame.targetOff(this)},_.prototype.refresh=function(){if(this.card){this.selectNode&&(this.selectNode.active=this.selected),this.notEmptyCardRoot&&(this.notEmptyCardRoot.active=!0),this.emptyCardRoot&&(this.emptyCardRoot.active=!1);var t=this.card.getFragment(),e=this.card.getUpgradeNeed();if(this.nameLabel&&(this.nameLabel.string=s.i18n.t(this.card.entry.name),this.nameLabel.node.color=p.sGViewModel.getModule(y.VMReward).getQualityColor(this.card.entry.quality)),p.sGViewModel.getModule(g.VMGame),this.card.isActive()&&(this.countLabel&&(this.countLabel.string=t+"/"+e,this.countLabel.node.active=this.card.isActive()),this.countProgressBar&&(this.countProgressBar.progress=t/e)),this.iconSprite&&(u.sGNode.setSprite(this.iconSprite,this.card.entry.icon),u.sGNode.setSpriteMaterial(this.iconSprite,0===this.card.record.level?"2d-gray-sprite":"2d-sprite")),this.starLabel&&(this.starLabel.string=this.card.record.level.toString()),this.starRoot)for(var o=1;;++o){var i=this.starRoot.getChildByName("star"+o);if(!i)break;(i=i.getChildByName("star"))&&(i.active=o<=this.card.record.level)}if(this.qualityRoot)for(o=1;;++o){var a=this.qualityRoot.getChildByName("quality"+o);if(!a)break;a.active=o+2===this.card.entry.quality}if(this.typeRoot)for(var n in f.GameDefine.uiTypeNodeNameDic){var r=this.typeRoot.getChildByName(n);if(!r)break;r.active=f.GameDefine.uiTypeNodeNameDic[n]===this.card.entry.type}}else this.notEmptyCardRoot&&(this.notEmptyCardRoot.active=!1),this.emptyCardRoot&&(this.emptyCardRoot.active=!0)},l([a(cc.Label)],_.prototype,"nameLabel",void 0),l([a(cc.Label)],_.prototype,"countLabel",void 0),l([a(cc.Label)],_.prototype,"starLabel",void 0),l([a(cc.ProgressBar)],_.prototype,"countProgressBar",void 0),l([a(cc.Sprite)],_.prototype,"iconSprite",void 0),l([a(cc.Node)],_.prototype,"starRoot",void 0),l([a(cc.Node)],_.prototype,"qualityRoot",void 0),l([a(cc.Node)],_.prototype,"emptyCardRoot",void 0),l([a(cc.Node)],_.prototype,"notEmptyCardRoot",void 0),l([a(cc.Node)],_.prototype,"selectNode",void 0),l([a(cc.Button)],_.prototype,"selectButton",void 0),l([a(cc.Node)],_.prototype,"typeRoot",void 0),b=l([m,b("Game/UI/CardEquipSkillTopIconUI")],_),n.default=b,cc._RF.pop()},{}],card_equip_skill_ui:[function(t,e,o){"use strict";cc._RF.push(e,"45557W+B7lE6ZGWATWCeMqd","card_equip_skill_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("fast_scrollview"),d=a("gaudio"),p=a("ggame"),f=a("local_card"),h=a("card_equip_skill_top_icon_ui"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu),m=["tech","summon","disaster"];function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.cardIconUIArray=[],t.fastScrollView=null,t.filterIndex=-1,t}r(b,c=cc.Component),b.prototype.onLoad=function(){this.fastScrollView=this.getComponent(u.FastScrollView)},b.prototype.onEnable=function(){var t=this;p.sGGame.on(h.sCardEquipTopIconUIEvent.selectChanged,function(e){for(var o=0;o<m.length;++o)if(m[o]===e.entry.type)return void t.filter(o)},this),this.refresh(),d.sGAudio.playEffect(s.sAudioConfig.config.popUI)},b.prototype.onDisable=function(){p.sGGame.targetOff(this)},b.prototype.refresh=function(){for(var t=0;t<3;++t)this.refreshIcon(t);for(t=0;t<3;++t){var e=this.cardIconUIArray[t];if(e&&e.card)return void this.filter(t)}},b.prototype.refreshIcon=function(t){var e=p.sGGame.localModel.getModule(f.LocalCardPackage).equipSkillCardDic[m[t]];this.cardIconUIArray[t]&&(this.cardIconUIArray[t].card=e)},b.prototype.filter=function(t){if(this.fastScrollView&&this.filterIndex!=t&&this.cardIconUIArray[t]){var e,o=p.sGGame.localModel.getModule(f.LocalCardPackage);this.filterIndex=t;for(var i,a=0;a<this.cardIconUIArray.length;++a){var n=this.cardIconUIArray[a];n&&n.card&&(n.selected=a===this.filterIndex)}for(i in e=o.getSkillCardArray(m[t]),this.fastScrollView.clear(!0),e){var r=e[i];r.isActive()&&this.fastScrollView.pushCell(r)}for(i in this.fastScrollView.cellDataList.sort(function(t,e){return t=t.data,e=e.data,t.isActive()!=e.isActive()?e.isActive()?1:-1:t.entry.quality!==e.entry.quality?e.entry.quality-t.entry.quality:t.record.level!==e.record.level?e.record.level-t.record.level:t.entry.id-e.entry.id}),this.fastScrollView.initPosition(),this.fastScrollView.cellDataList){var l=this.fastScrollView.cellDataList[i];this.fastScrollView.select(l)}t=o.equipSkillCardDic[m[t]],this.selectCard(t?t.entry.id:0)}},b.prototype.selectCard=function(t){var e=this;0==t?this.fastScrollView.clearSelect():this.fastScrollView.scrollToCellInView(function(o){var i=o.data;return!(!i||i.entry.id!=t||(e.fastScrollView.select(o),0))},160)},l([a(h.default)],b.prototype,"cardIconUIArray",void 0),y=l([g,y("Game/UI/CardEquipSkillUI")],b),n.default=y,cc._RF.pop()},{}],card_equip_soldier_package_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"75597AnerJMbbORTle3lrAd","card_equip_soldier_package_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("i18n"),u=a("fast_scrollview"),d=a("fast_scrollview_cell"),p=a("gnode"),f=a("ggame"),h=a("gview_model"),g=a("game_define"),y=a("local_card"),m=a("vm_reward"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu);function v(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.countLabel=null,t.starLabel=null,t.countProgressBar=null,t.iconSprite=null,t.starRoot=null,t.qualityRoot=null,t.emptyCardRoot=null,t.notEmptyCardRoot=null,t.selectNode=null,t.selectButton=null,t.typeRoot=null,t.fastScrollViewCell=null,t.card=null,t._selected=!1,t}r(v,c=cc.Component),Object.defineProperty(v.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected!=t&&this.node.activeInHierarchy&&this.selectNode&&(this.selectNode.active=t),this._selected=t},enumerable:!1,configurable:!0}),v.prototype.onLoad=function(){var t=this;this.fastScrollViewCell=this.getComponent(d.FastScrollViewCell),this.selectButton&&this.selectButton.node.on("click",function(){t.card.record.equiped?f.sGGame.localModel.getModule(y.LocalCardPackage).removeSoldierEquip(t.card):f.sGGame.localModel.getModule(y.LocalCardPackage).addSoldierEquip(t.card)})},v.prototype.onEnable=function(){var t=this;this.card=this.fastScrollViewCell.data,this.selected=this.fastScrollViewCell.cellData.selected,this.fastScrollViewCell.fastScrollView.node.on(u.sFastScrollViewEvent.selectChanged,function(e,o){e==t.fastScrollViewCell.cellData?t.selected=!0:o==t.fastScrollViewCell.cellData&&(t.selected=!1)},this),this.refresh()},v.prototype.onDisable=function(){p.sGNode.targetOff(this),f.sGGame.targetOff(this),this.fastScrollViewCell.fastScrollView.node.targetOff(this)},v.prototype.refresh=function(){if(this.card){this.selectNode&&(this.selectNode.active=this.selected),this.notEmptyCardRoot&&(this.notEmptyCardRoot.active=!0),this.emptyCardRoot&&(this.emptyCardRoot.active=!1);var t=this.card.getFragment(),e=this.card.getUpgradeNeed();if(this.nameLabel&&(this.nameLabel.string=s.i18n.t(this.card.entry.name),this.nameLabel.node.color=h.sGViewModel.getModule(m.VMReward).getQualityColor(this.card.entry.quality)),this.card.isActive()&&(this.countLabel&&(this.countLabel.string=t+"/"+e,this.countLabel.node.active=this.card.isActive()),this.countProgressBar&&(this.countProgressBar.progress=t/e)),this.iconSprite&&(p.sGNode.setSprite(this.iconSprite,this.card.entry.icon),p.sGNode.setSpriteMaterial(this.iconSprite,0===this.card.record.level?"2d-gray-sprite":"2d-sprite")),this.starLabel&&(this.starLabel.string=this.card.record.level.toString()),this.starRoot)for(var o=1;;++o){var i=this.starRoot.getChildByName("star"+o);if(!i)break;(i=i.getChildByName("star"))&&(i.active=o<=this.card.record.level)}if(this.qualityRoot)for(o=1;;++o){var a=this.qualityRoot.getChildByName("quality"+o);if(!a)break;a.active=o+2===this.card.entry.quality}if(this.typeRoot)for(var n in g.GameDefine.uiTypeNodeNameDic){var r=this.typeRoot.getChildByName(n);if(!r)break;r.active=g.GameDefine.uiTypeNodeNameDic[n]===this.card.entry.type}}else this.notEmptyCardRoot&&(this.notEmptyCardRoot.active=!1),this.emptyCardRoot&&(this.emptyCardRoot.active=!0)},l([a(cc.Label)],v.prototype,"nameLabel",void 0),l([a(cc.Label)],v.prototype,"countLabel",void 0),l([a(cc.Label)],v.prototype,"starLabel",void 0),l([a(cc.ProgressBar)],v.prototype,"countProgressBar",void 0),l([a(cc.Sprite)],v.prototype,"iconSprite",void 0),l([a(cc.Node)],v.prototype,"starRoot",void 0),l([a(cc.Node)],v.prototype,"qualityRoot",void 0),l([a(cc.Node)],v.prototype,"emptyCardRoot",void 0),l([a(cc.Node)],v.prototype,"notEmptyCardRoot",void 0),l([a(cc.Node)],v.prototype,"selectNode",void 0),l([a(cc.Button)],v.prototype,"selectButton",void 0),l([a(cc.Node)],v.prototype,"typeRoot",void 0),_=l([b,_("Game/Card/CardEquipSoldierPackageIconUI")],v),n.default=_,cc._RF.pop()},{}],card_equip_soldier_top_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"9d29duvIQ5BsqUtdZTA1XQD","card_equip_soldier_top_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("i18n"),u=a("gnode"),d=a("ggame"),p=a("gview_model"),f=a("game_define"),h=a("local_card"),g=a("vm_reward"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.countLabel=null,t.starLabel=null,t.countProgressBar=null,t.iconSprite=null,t.starRoot=null,t.qualityRoot=null,t.emptyCardRoot=null,t.notEmptyCardRoot=null,t.selectNode=null,t.selectButton=null,t.typeRoot=null,t._card=null,t._selected=!1,t}r(b,c=cc.Component),Object.defineProperty(b.prototype,"card",{get:function(){return this._card},set:function(t){this._card=t,this.node.activeInHierarchy&&this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected!=t&&this.node.activeInHierarchy&&this.selectNode&&(this.selectNode.active=t),this._selected=t},enumerable:!1,configurable:!0}),b.prototype.onLoad=function(){this.selectButton&&this.selectButton.node.on("click",function(){})},b.prototype.onEnable=function(){var t=this;d.sGGame.on(h.sLocalCardEvent.upgrade,function(){t.refresh()},this),this.refresh()},b.prototype.onDisable=function(){u.sGNode.targetOff(this),d.sGGame.targetOff(this)},b.prototype.refresh=function(){if(this.card){this.selectNode&&(this.selectNode.active=this.selected),this.notEmptyCardRoot&&(this.notEmptyCardRoot.active=!0),this.emptyCardRoot&&(this.emptyCardRoot.active=!1);var t=this.card.getFragment(),e=this.card.getUpgradeNeed();if(this.nameLabel&&(this.nameLabel.string=s.i18n.t(this.card.entry.name),this.nameLabel.node.color=p.sGViewModel.getModule(g.VMReward).getQualityColor(this.card.entry.quality)),this.card.isActive()&&(this.countLabel&&(this.countLabel.string=t+"/"+e,this.countLabel.node.active=this.card.isActive()),this.countProgressBar&&(this.countProgressBar.progress=t/e)),this.iconSprite&&(u.sGNode.setSprite(this.iconSprite,this.card.entry.icon),u.sGNode.setSpriteMaterial(this.iconSprite,0===this.card.record.level?"2d-gray-sprite":"2d-sprite")),this.starLabel&&(this.starLabel.string=this.card.record.level.toString()),this.starRoot)for(var o=1;;++o){var i=this.starRoot.getChildByName("star"+o);if(!i)break;(i=i.getChildByName("star"))&&(i.active=o<=this.card.record.level)}if(this.qualityRoot)for(o=1;;++o){var a=this.qualityRoot.getChildByName("quality"+o);if(!a)break;a.active=o+2===this.card.entry.quality}if(this.typeRoot)for(var n in f.GameDefine.uiTypeNodeNameDic){var r=this.typeRoot.getChildByName(n);if(!r)break;r.active=f.GameDefine.uiTypeNodeNameDic[n]===this.card.entry.type}}else this.notEmptyCardRoot&&(this.notEmptyCardRoot.active=!1),this.emptyCardRoot&&(this.emptyCardRoot.active=!0)},l([a(cc.Label)],b.prototype,"nameLabel",void 0),l([a(cc.Label)],b.prototype,"countLabel",void 0),l([a(cc.Label)],b.prototype,"starLabel",void 0),l([a(cc.ProgressBar)],b.prototype,"countProgressBar",void 0),l([a(cc.Sprite)],b.prototype,"iconSprite",void 0),l([a(cc.Node)],b.prototype,"starRoot",void 0),l([a(cc.Node)],b.prototype,"qualityRoot",void 0),l([a(cc.Node)],b.prototype,"emptyCardRoot",void 0),l([a(cc.Node)],b.prototype,"notEmptyCardRoot",void 0),l([a(cc.Node)],b.prototype,"selectNode",void 0),l([a(cc.Button)],b.prototype,"selectButton",void 0),l([a(cc.Node)],b.prototype,"typeRoot",void 0),m=l([y,m("Game/Card/CardEquipSoldierTopIconUI")],b),n.default=m,cc._RF.pop()},{}],card_equip_soldier_ui:[function(t,e,o){"use strict";cc._RF.push(e,"dfa39Z8V3xPOIvpm26MTPmB","card_equip_soldier_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("fast_scrollview"),d=a("gaudio"),p=a("ggame"),f=a("local_card"),h=a("card_equip_soldier_top_icon_ui"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu);function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.cardIconUIArray=[],t.fastScrollView=null,t.filterIndex=-1,t}r(m,c=cc.Component),m.prototype.onLoad=function(){this.fastScrollView=this.getComponent(u.FastScrollView)},m.prototype.onEnable=function(){var t=this;this.refresh(),d.sGAudio.playEffect(s.sAudioConfig.config.popUI),p.sGGame.on(f.sLocalCardEvent.changeEquip,function(e){t.refresh(),e.record.equiped?t.selectCard(e.entry.id):t.unselectCard(e.entry.id)},this),this.filter()},m.prototype.onDisable=function(){p.sGGame.targetOff(this)},m.prototype.refresh=function(){for(var t,e=p.sGGame.localModel.getModule(f.LocalCardPackage),o=Object.keys(e.equipSoldierCardDic),i=0;i<5;++i)i<o.length?(t=e.equipSoldierCardDic[o[i]],this.refreshIcon(i,t)):this.refreshIcon(i,null)},m.prototype.refreshIcon=function(t,e){this.cardIconUIArray[t]&&(this.cardIconUIArray[t].card=e)},m.prototype.filter=function(){if(this.fastScrollView){var t=p.sGGame.localModel.getModule(f.LocalCardPackage),e=t.getSoldierCardArray();for(i in this.fastScrollView.clear(!0),e){var o=e[i];o.isActive()&&this.fastScrollView.pushCell(o)}this.fastScrollView.cellDataList.sort(function(t,e){return t=t.data,e=e.data,t.record.equiped!=e.record.equiped?e.record.equiped?1:-1:t.isActive()!=e.isActive()?e.isActive()?1:-1:t.entry.quality!==e.entry.quality?e.entry.quality-t.entry.quality:t.record.level!==e.record.level?e.record.level-t.record.level:t.entry.id-e.entry.id}),this.fastScrollView.initPosition();var i,a=t.equipSoldierCardDic;for(i in a){var n=a[i];n.record.equiped&&this.selectCard(n.entry.id)}}},m.prototype.selectCard=function(t){for(var e in this.fastScrollView.cellDataList)if((e=this.fastScrollView.cellDataList[e]).data.entry.id===t){this.fastScrollView.select(e);break}},m.prototype.unselectCard=function(t){for(var e in this.fastScrollView.cellDataList)if((e=this.fastScrollView.cellDataList[e]).data.entry.id===t){this.fastScrollView.unselect(e);break}},l([a(h.default)],m.prototype,"cardIconUIArray",void 0),y=l([g,y("Game/Card/CardEquipSoldierUI")],m),n.default=y,cc._RF.pop()},{}],card_hero_info_ui:[function(t,e,o){"use strict";cc._RF.push(e,"ee63dAtqNVNkaeSQ0IJBxTi","card_hero_info_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("local_currency"),u=a("encourage_icon_ui"),d=a("vm_encourage"),p=a("audio_config"),f=a("currency_config"),h=a("encourage_config"),g=a("soldier_attribute_config"),y=a("soldier_skill_config"),m=a("i18n"),b=a("gaudio"),_=a("gnode"),v=a("gnumber"),C=a("ggame"),P=a("gview_model"),S=a("game_define"),G=a("local_card"),M=a("local_soldier"),w=a("vm_card"),A=a("vm_game"),B=a("vm_reward"),R=(k=cc._decorator).ccclass,k=(a=k.property,k.menu);function T(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.countLabel=null,t.upgradeCardPointLabel=null,t.countProgressBar=null,t.iconSprite=null,t.starRoot=null,t.qualityRoot=null,t.currentStarMaxHPDesc=null,t.nextStarMaxHPDesc=null,t.currentStarAttackDesc=null,t.nextStarAttackDesc=null,t.currentStarAttackSpeedDesc=null,t.nextStarAttackSpeedDesc=null,t.nextStarTitleNode=null,t.upgradeStarButton=null,t.magicSkillNode=null,t.magicSkillNameLabel=null,t.magicSkillCDLabel=null,t.magicSkillPassiveNode=null,t.magicSkillDescLabel=null,t.typeRoot=null,t.ageRoot=null,t.notHaveNodes=[],t.haveNodes=[],t.notFullLevelNodes=[],t.fullLevelNodes=[],t.notFullFragmentNodes=[],t.fullFragmentNodes=[],t.notReadyUpgradeNodes=[],t.readyUpgradeNodes=[],t.upgradeStarAdButton=null,t.upgradeStarAdTimesLabel=null,t.upgradeStarAdEncourageIconUI=null,t.card=null,t}r(T,c=cc.Component),T.prototype.onLoad=function(){var t=this;this.upgradeStarButton&&this.upgradeStarButton.node.on("click",function(){t.upgradeCard(!1)}),this.upgradeStarAdButton&&this.upgradeStarAdButton.node.on("click",function(){P.sGViewModel.getModule(d.VMEncourage).encourage(h.sEncourageConfig.config.upgradeCardWhenNotEnoughPoint,t.upgradeStarAdEncourageType,function(){t.upgradeCard(!0)})})},T.prototype.upgradeCard=function(t){0===P.sGViewModel.getModule(w.VMCard).upgrade(this.card.entry.id,t)&&(this.upgradeStarAdEncourageType=void 0,b.sGAudio.playEffect(p.sAudioConfig.config.reward),this.refresh(!0))},T.prototype.onEnable=function(){var t=this;C.sGGame.on(G.sLocalCardEvent.upgrade,function(e){t.card.entry.id!=e.entry.id&&t.refresh(!1)},this),C.sGGame.on(s.sLocalCurrencyEvent.changed,function(e){e===f.sCurrencyConfig.config.cardUpgradePoint&&t.refresh(!1)},this),this.refresh(!1),b.sGAudio.playEffect(p.sAudioConfig.config.popUI)},T.prototype.onDisable=function(){_.sGNode.targetOff(this),C.sGGame.targetOff(this)},T.prototype.refresh=function(t){if(this.card){for(var e=C.sGGame.localModel.getModule(M.LocalSoldierPackage).getSoldierByCard(this.card.entry.id),o=this.card.isActive(),i=this.card.isLevelFull(),a=this.card.isFragmentReadyUpgrade(),n=this.card.isReadyUpgrade(),r=0;r<this.notHaveNodes.length;++r)this.notHaveNodes[r].active=!o;for(r=0;r<this.haveNodes.length;++r)this.haveNodes[r].active=o;for(r=0;r<this.notFullLevelNodes.length;++r)this.notFullLevelNodes[r].active=o&&!i;for(r=0;r<this.fullLevelNodes.length;++r)this.fullLevelNodes[r].active=o&&i;for(r=0;r<this.notFullFragmentNodes.length;++r)this.notFullFragmentNodes[r].active=o&&!i&&!a;for(r=0;r<this.fullFragmentNodes.length;++r)this.fullFragmentNodes[r].active=o&&!i&&a;for(r=0;r<this.notReadyUpgradeNodes.length;++r)this.notReadyUpgradeNodes[r].active=o&&!i&&a&&!n;for(r=0;r<this.readyUpgradeNodes.length;++r)this.readyUpgradeNodes[r].active=o&&!i&&a&&n;var l=this.card.getFragment(),c=this.card.getUpgradeNeed();this.nameLabel&&(this.nameLabel.string=m.i18n.t(this.card.entry.name),this.nameLabel.node.color=P.sGViewModel.getModule(B.VMReward).getQualityColor(this.card.entry.quality)),this.magicSkillNode&&(this.magicSkillDescLabel&&(this.magicSkillDescLabel.string=m.i18n.t(e.card.entry.desc)),e.entry.skillID?0<(p=y.sSoldierSkillConfig.getEntry(e.entry.skillID)).cd?(this.magicSkillCDLabel&&(this.magicSkillCDLabel.string=p.cd+m.i18n.t("time.second"),this.magicSkillCDLabel.node.parent.active=!0),this.magicSkillPassiveNode&&(this.magicSkillPassiveNode.active=!1)):(this.magicSkillCDLabel&&(this.magicSkillCDLabel.node.parent.active=!1),this.magicSkillPassiveNode&&(this.magicSkillPassiveNode.active=!0)):(this.magicSkillCDLabel&&(this.magicSkillCDLabel.node.parent.active=!1),this.magicSkillPassiveNode&&(this.magicSkillPassiveNode.active=!1)));var u,p,b=P.sGViewModel.getModule(A.VMGame);this.card.isLevelFull()?(this.nextStarMaxHPDesc&&(this.nextStarMaxHPDesc.node.parent.parent.parent.active=!1),this.nextStarTitleNode&&(this.nextStarTitleNode.active=!1),u=e.attributeSystem,this.currentStarMaxHPDesc&&(this.currentStarMaxHPDesc.string=v.sGNumber.toHuman(u.getValue(g.sSoldierAttributeConfig.config.maxHP)),_.sGNode.setChildLabelColor(this.currentStarMaxHPDesc.node,b.getValidColor(!0))),this.currentStarAttackDesc&&(this.currentStarAttackDesc.string=v.sGNumber.toHuman(u.getValue(g.sSoldierAttributeConfig.config.attack)),_.sGNode.setChildLabelColor(this.currentStarAttackDesc.node,b.getValidColor(!0))),this.currentStarAttackSpeedDesc&&(this.currentStarAttackSpeedDesc.string=u.getValue(g.sSoldierAttributeConfig.config.attackInterval)+"",_.sGNode.setChildLabelColor(this.currentStarAttackSpeedDesc.node,b.getValidColor(!0)))):0<this.card.record.level?(u=e.attributeSystem,p=e.getLevelAttributeSystem(this.card.record.level+1),this.currentStarMaxHPDesc&&(this.currentStarMaxHPDesc.string=v.sGNumber.toHuman(u.getValue(g.sSoldierAttributeConfig.config.maxHP)),_.sGNode.setChildLabelColor(this.currentStarMaxHPDesc.node,b.getValidColor(!0))),this.currentStarAttackDesc&&(this.currentStarAttackDesc.string=v.sGNumber.toHuman(u.getValue(g.sSoldierAttributeConfig.config.attack)),_.sGNode.setChildLabelColor(this.currentStarAttackDesc.node,b.getValidColor(!0))),this.currentStarAttackSpeedDesc&&(this.currentStarAttackSpeedDesc.string=u.getValue(g.sSoldierAttributeConfig.config.attackInterval)+"",_.sGNode.setChildLabelColor(this.currentStarAttackSpeedDesc.node,b.getValidColor(!0))),this.nextStarTitleNode&&(this.nextStarTitleNode.active=!0),this.nextStarMaxHPDesc&&(this.nextStarMaxHPDesc.node.parent.parent.parent.active=!0,this.nextStarMaxHPDesc.string=v.sGNumber.toHuman(p.getValue(g.sSoldierAttributeConfig.config.maxHP))),this.nextStarAttackDesc&&(this.nextStarAttackDesc.string=v.sGNumber.toHuman(p.getValue(g.sSoldierAttributeConfig.config.attack))),this.nextStarAttackSpeedDesc&&(this.nextStarAttackSpeedDesc.string=p.getValue(g.sSoldierAttributeConfig.config.attackInterval)+"")):(u=e.getLevelAttributeSystem(1),this.nextStarMaxHPDesc&&(this.nextStarMaxHPDesc.node.parent.parent.parent.active=!1),this.nextStarTitleNode&&(this.nextStarTitleNode.active=!1),this.currentStarMaxHPDesc&&(this.currentStarMaxHPDesc.string=v.sGNumber.toHuman(u.getValue(g.sSoldierAttributeConfig.config.maxHP)),_.sGNode.setChildLabelColor(this.currentStarMaxHPDesc.node,b.getValidColor(!1))),this.currentStarAttackDesc&&(this.currentStarAttackDesc.string=v.sGNumber.toHuman(u.getValue(g.sSoldierAttributeConfig.config.attack)),_.sGNode.setChildLabelColor(this.currentStarAttackDesc.node,b.getValidColor(!1))),this.currentStarAttackSpeedDesc&&(this.currentStarAttackSpeedDesc.string=u.getValue(g.sSoldierAttributeConfig.config.attackInterval)+"",_.sGNode.setChildLabelColor(this.currentStarAttackSpeedDesc.node,b.getValidColor(!1)))),this.countLabel&&(this.countLabel.string=l+"/"+c,this.countLabel.node.active=this.card.isActive()&&!this.card.isLevelFull()),this.upgradeCardPointLabel&&(R=C.sGGame.localModel.getModule(s.LocalCurrency).get(f.sCurrencyConfig.config.cardUpgradePoint),w=this.card.getPointNeed(),this.upgradeCardPointLabel.string="x"+w,this.upgradeCardPointLabel.node.active=this.card.isActive()&&!this.card.isLevelFull(),_.sGNode.setChildLabelColor(this.upgradeCardPointLabel.node,b.getCondtionValidColor(w<=R))),this.countProgressBar&&(this.countProgressBar.progress=l/c);var w=C.sGGame.localModel.getModule(G.LocalCardPackage),R=!this.card.isLevelFull()&&this.card.isActive();if(l=0<w.getRemainAdUpgradeTimes(),c=w.checkUpgrade(this.card.entry.id),this.upgradeStarButton&&(this.upgradeStarButton.node.active=R&&(3!==c||!l),this.upgradeStarButton.node.active&&(this.upgradeStarButton.interactable=0===c)),this.upgradeStarAdButton&&(this.upgradeStarAdButton.node.active=R&&3===c&&l,this.upgradeStarAdButton.node.active&&(this.upgradeStarAdButton.interactable=l)&&void 0===this.upgradeStarAdEncourageType&&(this.upgradeStarAdEncourageType=P.sGViewModel.getModule(d.VMEncourage).preEncourage(h.sEncourageConfig.config.upgradeCardWhenNotEnoughPoint))),this.upgradeStarAdEncourageIconUI&&this.upgradeStarAdEncourageIconUI.setEncourageType(this.upgradeStarAdEncourageType),this.upgradeStarAdTimesLabel&&(this.upgradeStarAdTimesLabel.string=w.getRemainAdUpgradeTimes()+"/"+w.getMaxAdUpgradeTimes()),this.iconSprite&&(_.sGNode.setSprite(this.iconSprite,this.card.entry.bigIcon),_.sGNode.setSpriteMaterial(this.iconSprite,0===this.card.record.level?"2d-gray-sprite":"2d-sprite")),this.starRoot)for(r=1;;++r){var k=this.starRoot.getChildByName("star"+r);if(!k)break;(k=k.getChildByName("star"))&&(k.active=r<=this.card.record.level),r!==this.card.record.level||!t||(k=k.getComponent(cc.Animation))&&k.play()}if(this.qualityRoot)for(r=1;;++r){var T=this.qualityRoot.getChildByName("quality"+r);if(!T)break;T.active=r+2===this.card.entry.quality}if(this.typeRoot)for(var L in S.GameDefine.uiTypeNodeNameDic){var D=this.typeRoot.getChildByName(L);if(!D)break;D.active=S.GameDefine.uiTypeNodeNameDic[L]===this.card.entry.type}if(this.ageRoot)for(r=0;r<6;r++){var O=cc.find("age"+(r+1),this.ageRoot);O&&(O.active=0===r?this.card.entry.unlockAge<3:this.card.entry.unlockAge===r+2)}}},l([a(cc.Label)],T.prototype,"nameLabel",void 0),l([a(cc.Label)],T.prototype,"countLabel",void 0),l([a(cc.Label)],T.prototype,"upgradeCardPointLabel",void 0),l([a(cc.ProgressBar)],T.prototype,"countProgressBar",void 0),l([a(cc.Sprite)],T.prototype,"iconSprite",void 0),l([a(cc.Node)],T.prototype,"starRoot",void 0),l([a(cc.Node)],T.prototype,"qualityRoot",void 0),l([a(cc.Label)],T.prototype,"currentStarMaxHPDesc",void 0),l([a(cc.Label)],T.prototype,"nextStarMaxHPDesc",void 0),l([a(cc.Label)],T.prototype,"currentStarAttackDesc",void 0),l([a(cc.Label)],T.prototype,"nextStarAttackDesc",void 0),l([a(cc.Label)],T.prototype,"currentStarAttackSpeedDesc",void 0),l([a(cc.Label)],T.prototype,"nextStarAttackSpeedDesc",void 0),l([a(cc.Node)],T.prototype,"nextStarTitleNode",void 0),l([a(cc.Button)],T.prototype,"upgradeStarButton",void 0),l([a(cc.Node)],T.prototype,"magicSkillNode",void 0),l([a(cc.Label)],T.prototype,"magicSkillNameLabel",void 0),l([a(cc.Label)],T.prototype,"magicSkillCDLabel",void 0),l([a(cc.Node)],T.prototype,"magicSkillPassiveNode",void 0),l([a(cc.Label)],T.prototype,"magicSkillDescLabel",void 0),l([a(cc.Node)],T.prototype,"typeRoot",void 0),l([a(cc.Node)],T.prototype,"ageRoot",void 0),l([a(cc.Node)],T.prototype,"notHaveNodes",void 0),l([a(cc.Node)],T.prototype,"haveNodes",void 0),l([a(cc.Node)],T.prototype,"notFullLevelNodes",void 0),l([a(cc.Node)],T.prototype,"fullLevelNodes",void 0),l([a(cc.Node)],T.prototype,"notFullFragmentNodes",void 0),l([a(cc.Node)],T.prototype,"fullFragmentNodes",void 0),l([a(cc.Node)],T.prototype,"notReadyUpgradeNodes",void 0),l([a(cc.Node)],T.prototype,"readyUpgradeNodes",void 0),l([a(cc.Button)],T.prototype,"upgradeStarAdButton",void 0),l([a(cc.Label)],T.prototype,"upgradeStarAdTimesLabel",void 0),l([a(u.default)],T.prototype,"upgradeStarAdEncourageIconUI",void 0),k=l([R,k("Game/Card/CardHeroInfoUI")],T),n.default=k,cc._RF.pop()},{}],card_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"b371aQ+n4FIX4OH8nPd1haa","card_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("i18n"),u=a("gnode"),d=a("ggame"),p=a("gview_model"),f=a("game_define"),h=a("local_card"),g=a("vm_reward"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.starLabel=null,t.iconSprite=null,t.qualityRoot=null,t.typeRoot=null,t.cardInfoButton=null,t.card=null,t}r(b,c=cc.Component),b.prototype.init=function(t,e){this.card=t,this.callback=e,this.enabledInHierarchy&&this.refresh()},b.prototype.onLoad=function(){var t=this;this.cardInfoButton&&this.cardInfoButton.node.on("click",function(){t.callback&&t.callback(t.card)})},b.prototype.onEnable=function(){var t=this;d.sGGame.on(h.sLocalCardEvent.upgrade,function(){t.refresh()},this),this.refresh()},b.prototype.onDisable=function(){u.sGNode.targetOff(this),d.sGGame.targetOff(this)},b.prototype.refresh=function(){if(this.card){if(this.nameLabel&&(this.nameLabel.string=s.i18n.t(this.card.entry.name),this.nameLabel.node.color=p.sGViewModel.getModule(g.VMReward).getQualityColor(this.card.entry.quality)),this.iconSprite&&u.sGNode.setSprite(this.iconSprite,this.card.entry.icon),this.starLabel&&(this.starLabel.string=this.card.record.level.toString()),this.qualityRoot)for(var t=0;;++t){var e=this.qualityRoot.getChildByName("quality"+t);if(!e)break;e.active=t+2===this.card.entry.quality}if(this.typeRoot)for(var o in f.GameDefine.uiTypeNodeNameDic){var i=this.typeRoot.getChildByName(o);if(!i)break;i.active=f.GameDefine.uiTypeNodeNameDic[o]===this.card.entry.type}}},l([a(cc.Label)],b.prototype,"nameLabel",void 0),l([a(cc.Label)],b.prototype,"starLabel",void 0),l([a(cc.Sprite)],b.prototype,"iconSprite",void 0),l([a(cc.Node)],b.prototype,"qualityRoot",void 0),l([a(cc.Node)],b.prototype,"typeRoot",void 0),l([a(cc.Button)],b.prototype,"cardInfoButton",void 0),m=l([y,m("Game/Card/CardIconUI")],b),n.default=m,cc._RF.pop()},{}],card_library_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"bfa99YCa+BPWJyz4X+L1JQf","card_library_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("fast_scrollview_cell"),u=a("gui"),d=a("game_define"),p=a("card_hero_info_ui"),f=a("card_icon_ui"),h=a("card_skill_info_ui"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu);function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.fastScrollViewCell=null,t.cardIconUI=null,t}r(m,c=cc.Component),m.prototype.init=function(){},m.prototype.onLoad=function(){this.fastScrollViewCell||(this.fastScrollViewCell=this.getComponent(s.FastScrollViewCell)),this.cardIconUI||(this.cardIconUI=this.getComponent(f.default))},m.prototype.onEnable=function(){this.fastScrollViewCell&&this.cardIconUI&&this.cardIconUI.init(this.fastScrollViewCell.data,function(t){t.isSoldierCard?u.sGUI.openDialogUI(d.GameDefine.prefabSoldierCardInfoPop,function(e){(e=e.getComponent(p.default))&&(e.card=t)}):u.sGUI.openDialogUI(d.GameDefine.prefabSkillCardInfoPop,function(e){(e=e.getComponent(h.default))&&(e.card=t)})})},m.prototype.onDisable=function(){this.cardIconUI&&this.cardIconUI.init(void 0,void 0)},l([a(s.FastScrollViewCell)],m.prototype,"fastScrollViewCell",void 0),l([a(f.default)],m.prototype,"cardIconUI",void 0),y=l([g,y("Game/UI/CardLibraryIconUI")],m),n.default=y,cc._RF.pop()},{}],card_library_ui:[function(t,e,o){"use strict";cc._RF.push(e,"4b351aQQvJJ8aJpVe0BagAQ","card_library_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("card_config"),u=a("fast_scrollview"),d=a("ggame"),p=a("local_card"),f=(h=cc._decorator).ccclass,h=(a=h.property,h.menu);function g(){var t=null!==c&&c.apply(this,arguments)||this;return t.fastScrollView=null,t}r(g,c=cc.Component),g.prototype.init=function(){},g.prototype.onEnable=function(){this._refreshCard()},g.prototype.onDisable=function(){},g.prototype._refreshCard=function(){if(this.fastScrollView){var t,e=[],o=d.sGGame.localModel.getModule(p.LocalCardPackage);for(t in s.sCardConfig.config){var i=o.getCard(parseInt(t));i.canRandomCard()&&e.push(i)}e.sort(function(t,e){return t.isSoldierCard!=e.isSoldierCard?e.isSoldierCard?1:-1:t.entry.quality!==e.entry.quality?t.entry.quality-e.entry.quality:t.entry.id-e.entry.id});for(var a=0;a<e.length;++a)this.fastScrollView.pushCell(e[a]);this.fastScrollView.initPosition()}},l([a(u.FastScrollView)],g.prototype,"fastScrollView",void 0),h=l([f,h("Game/UI/CardLibraryUI")],g),n.default=h,cc._RF.pop()},{}],card_package_tab_skill_ui:[function(t,e,o){"use strict";cc._RF.push(e,"c8a37lH851Opb1t/mXQXYA1","card_package_tab_skill_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("fast_scrollview"),d=a("gaudio"),p=a("ggame"),f=a("game_define"),h=a("local_card"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu);function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.filterNodeArray=[],t.countLabel=null,t.fastScrollView=null,t.filterIndex=-1,t}r(m,c=cc.Component),m.prototype.onLoad=function(){var t=this;this.fastScrollView=this.getComponent(u.FastScrollView);for(var e=this,o=0;o<this.filterNodeArray.length;++o)!function(o){var i=e.filterNodeArray[o];i&&i.on("click",function(){d.sGAudio.playEffect(s.sAudioConfig.config.switchTab),t.filter(o),t.refresh()})}(o)},m.prototype.onEnable=function(){this.filter(0),this.refresh()},m.prototype.onDisable=function(){this.filterIndex=-1},m.prototype.refresh=function(){var t=p.sGGame.localModel.getModule(h.LocalCardPackage);if(this.countLabel){var e,o=null,i=0,a=0;for(e in o=0==this.filterIndex?t.getSkillCardArray():t.getSkillCardArray(f.GameDefine.filterSoldierCardTypeArray[this.filterIndex]))o[e].isActive()&&i++,a++;this.countLabel.string=i+"/"+a}},m.prototype.filter=function(t){if(this.fastScrollView&&this.filterIndex!=t){var e=p.sGGame.localModel.getModule(h.LocalCardPackage);this.filterIndex=t;for(var o,i,a=0;a<this.filterNodeArray.length;++a){var n,r=this.filterNodeArray[a];r&&(n=r.getChildByName("normal"),r=r.getChildByName("select"),n&&(n.active=this.filterIndex!==a),r&&(r.active=this.filterIndex===a))}for(i in o=0==t?e.getSkillCardArray():e.getSkillCardArray(f.GameDefine.filterSkillCardTypeArray[t]),this.fastScrollView.clear(!0),o){var l=o[i];this.fastScrollView.pushCell(l)}this.fastScrollView.cellDataList.sort(function(t,e){return t=t.data,e=e.data,t.isEquiped()!=e.isEquiped()?e.isEquiped()?1:-1:t.isReadyUpgrade()!=e.isReadyUpgrade()?e.isReadyUpgrade()?1:-1:t.isFragmentReadyUpgrade()!=e.isFragmentReadyUpgrade()?e.isFragmentReadyUpgrade()?1:-1:t.isActive()!=e.isActive()?e.isActive()?1:-1:t.entry.quality!==e.entry.quality?e.entry.quality-t.entry.quality:t.record.level!==e.record.level?e.record.level-t.record.level:t.entry.id-e.entry.id}),this.fastScrollView.initPosition()}},l([a(cc.Node)],m.prototype,"filterNodeArray",void 0),l([a(cc.Label)],m.prototype,"countLabel",void 0),y=l([g,y("Game/Card/CardPackageTabSkillUI")],m),n.default=y,cc._RF.pop()},{}],card_package_tab_soldier_ui:[function(t,e,o){"use strict";cc._RF.push(e,"83bedi4WGZCg4HgfhFP8kbr","card_package_tab_soldier_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("fast_scrollview"),d=a("gaudio"),p=a("ggame"),f=a("game_define"),h=a("local_card"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu);function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.filterNodeArray=[],t.countLabel=null,t.fastScrollView=null,t.filterIndex=-1,t}r(m,c=cc.Component),m.prototype.onLoad=function(){var t=this;this.fastScrollView=this.getComponent(u.FastScrollView);for(var e=this,o=0;o<this.filterNodeArray.length;++o)!function(o){var i=e.filterNodeArray[o];i&&i.on("click",function(){d.sGAudio.playEffect(s.sAudioConfig.config.switchTab),t.filter(o),t.refresh()})}(o)},m.prototype.onEnable=function(){var t=this;p.sGGame.on(h.sLocalCardEvent.changeEquip,function(){t.filter(t.filterIndex,!0)},this),this.filter(0),this.refresh()},m.prototype.onDisable=function(){this.filterIndex=-1,p.sGGame.targetOff(this)},m.prototype.refresh=function(){var t=p.sGGame.localModel.getModule(h.LocalCardPackage);if(this.countLabel){var e,o=null,i=0,a=0;for(e in o=0==this.filterIndex?t.getSoldierCardArray():t.getSoldierCardArray(f.GameDefine.filterSoldierCardTypeArray[this.filterIndex]))o[e].isActive()&&i++,a++;this.countLabel.string=i+"/"+a}},m.prototype.filter=function(t,e){if(this.fastScrollView&&(e||this.filterIndex!=t)){e=p.sGGame.localModel.getModule(h.LocalCardPackage),this.filterIndex=t;for(var o,i,a=0;a<this.filterNodeArray.length;++a){var n,r=this.filterNodeArray[a];r&&(n=r.getChildByName("normal"),r=r.getChildByName("select"),n&&(n.active=this.filterIndex!==a),r&&(r.active=this.filterIndex===a))}for(i in o=0==this.filterIndex?e.getSoldierCardArray():e.getSoldierCardArray(f.GameDefine.filterSoldierCardTypeArray[t]),this.fastScrollView.clear(!0),o){var l=o[i];this.fastScrollView.pushCell(l)}this.fastScrollView.cellDataList.sort(function(t,e){return t=t.data,e=e.data,t.isEquiped()!=e.isEquiped()?e.isEquiped()?1:-1:t.isReadyUpgrade()!=e.isReadyUpgrade()?e.isReadyUpgrade()?1:-1:t.isFragmentReadyUpgrade()!=e.isFragmentReadyUpgrade()?e.isFragmentReadyUpgrade()?1:-1:t.isActive()!=e.isActive()?e.isActive()?1:-1:t.entry.quality!==e.entry.quality?e.entry.quality-t.entry.quality:t.record.level!==e.record.level?e.record.level-t.record.level:t.entry.id-e.entry.id}),this.fastScrollView.initPosition()}},l([a(cc.Node)],m.prototype,"filterNodeArray",void 0),l([a(cc.Label)],m.prototype,"countLabel",void 0),y=l([g,y("Game/Card/CardPackageTabSoldierUI")],m),n.default=y,cc._RF.pop()},{}],card_package_tab_ui:[function(t,e,o){"use strict";cc._RF.push(e,"96a5ezKHkZKWJ/Zb4bTUpS5","card_package_tab_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reddot"),u=a("audio_config"),d=a("gui"),p=a("gaudio"),f=a("gnode"),h=a("ggame"),g=a("gview_model"),y=a("vm_card"),m=(b=cc._decorator).ccclass,b=(a=b.property,b.menu);function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.tabToggleContainer=null,t.tabPrefabArray=[],t.tabRoot=null,t.currentTabIndex=void 0,t.tabNodeDic=[],t.currentTabNode=null,t}r(_,c=cc.Component),_.prototype.onLoad=function(){var t=this;if(this.tabToggleContainer)for(var e=this.tabToggleContainer.toggleItems.length,o=this,i=0;i<e;++i)!function(e){var i=o.tabToggleContainer.toggleItems[e];i&&i.node.on("toggle",function(){p.sGAudio.playEffect(u.sAudioConfig.config.switchTab),t._refreshTabs(e)},o),f.sGNode.addUniqueComponent(i.node,s.default).init(function(){return e!=t.currentTabIndex&&(0===e?g.sGViewModel.getModule(y.VMCard).soldierCardPackageHasReddot():1===e&&g.sGViewModel.getModule(y.VMCard).skillCardPackageHasReddot())},"Background/reddot")}(i)},_.prototype.onEnable=function(){this.tabToggleContainer&&this.tabToggleContainer.toggleItems[0].check(),this._refreshTabs(0),p.sGAudio.playEffect(u.sAudioConfig.config.popUI)},_.prototype.onDisable=function(){f.sGNode.targetOff(this),h.sGGame.targetOff(this)},_.prototype._refreshTabs=function(t){var e,o;this.currentTabIndex!==t&&(this.currentTabIndex=t,(e=this.tabNodeDic[t])?(this.currentTabNode&&(this.currentTabNode.active=!1),this.currentTabNode=e,d.sGUI.renameTopName(this.currentTabNode.name),this.currentTabNode&&(this.currentTabNode.active=!0)):(o=this.tabPrefabArray[t])&&(this.currentTabNode&&(this.currentTabNode.active=!1),e=cc.instantiate(o),this.tabNodeDic[t]=e,this.currentTabNode=e,d.sGUI.renameTopName(this.currentTabNode.name),this.tabRoot.addChild(e),f.sGNode.updateWidgetImmediately(e)))},l([a({tooltip:"\u5206\u9875",type:cc.ToggleContainer})],_.prototype,"tabToggleContainer",void 0),l([a({type:cc.Prefab,tooltip:"\u5206\u9875\u9884\u5236\u4ef6\u6570\u7ec4"})],_.prototype,"tabPrefabArray",void 0),l([a({type:cc.Node,tooltip:"\u529f\u80fd\u9875\u7684\u8282\u70b9"})],_.prototype,"tabRoot",void 0),b=l([m,b("Game/Card/CardPackageTabUI")],_),n.default=b,cc._RF.pop()},{}],card_skill_equip_simple_ui:[function(t,e,o){"use strict";cc._RF.push(e,"8a494fno6ZKr6jbbgVeCvrN","card_skill_equip_simple_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("client_config"),u=a("scroll_number"),d=a("gui"),p=a("gnode"),f=a("ggame"),h=a("game_define"),g=a("local_battle_stage"),y=a("local_card"),m=a("card_tab_pakcage_equip_icon_ui"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu),v=["tech","summon","disaster"];function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.cardIconUIArray=[],t.equipButton=null,t.testNode=null,t.battleScoreLabel=null,t}r(C,c=cc.Component),C.prototype.onLoad=function(){var t=this;this.equipButton&&this.equipButton.node.on("click",function(){var t=f.sGGame.localModel.getModule(y.LocalCardPackage);0<Object.keys(t.equipSkillCardDic).length&&d.sGUI.openDialogUI(h.GameDefine.prefabCardSkillEquipUI)}),s.sClientConfig.config.devMode&&this.testNode&&(p.sGNode.addUniqueComponent(this.testNode,cc.Button),this.testNode.on("click",function(){f.sGGame.localModel.getModule(y.LocalCardPackage).addAllCard(),t.refresh(!1)}))},C.prototype.onEnable=function(){var t=this;f.sGGame.on(y.sLocalCardEvent.changeEquip,function(){t.refresh(!1)},this),this.refresh(!0)},C.prototype.onDisable=function(){f.sGGame.targetOff(this)},C.prototype.refresh=function(t){for(var e=f.sGGame.localModel.getModule(g.LocalBattleStage),o=0;o<3;++o)this.refreshIcon(o);this.battleScoreLabel&&p.sGNode.addUniqueComponent(this.battleScoreLabel.node,u.default).setNumber(e.getBattleScore(),!t)},C.prototype.refreshIcon=function(t){var e=f.sGGame.localModel.getModule(y.LocalCardPackage).equipSkillCardDic[v[t]];this.cardIconUIArray[t]&&(this.cardIconUIArray[t].card=e)},l([a(m.default)],C.prototype,"cardIconUIArray",void 0),l([a(cc.Button)],C.prototype,"equipButton",void 0),l([a(cc.Node)],C.prototype,"testNode",void 0),l([a(cc.Label)],C.prototype,"battleScoreLabel",void 0),_=l([b,_("Game/Card/CardSkillEquipSimpleUI")],C),n.default=_,cc._RF.pop()},{}],card_skill_info_ui:[function(t,e,o){"use strict";cc._RF.push(e,"15fc2Iq++RJ/oU1PYFEyEV2","card_skill_info_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("local_currency"),u=a("encourage_icon_ui"),d=a("vm_encourage"),p=a("audio_config"),f=a("currency_config"),h=a("encourage_config"),g=a("i18n"),y=a("gaudio"),m=a("gnode"),b=a("ggame"),_=a("gview_model"),v=a("game_define"),C=a("local_card"),P=a("vm_card"),S=a("vm_game"),G=a("vm_reward"),M=(w=cc._decorator).ccclass,w=(a=w.property,w.menu);function A(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.countLabel=null,t.countProgressBar=null,t.iconSprite=null,t.starRoot=null,t.qualityRoot=null,t.currentStarDesc=null,t.nextStarDesc=null,t.nextStarTitleNode=null,t.upgradeStarButton=null,t.upgradeCardPointLabel=null,t.typeRoot=null,t.notHaveNodes=[],t.haveNodes=[],t.notFullLevelNodes=[],t.fullLevelNodes=[],t.notFullFragmentNodes=[],t.fullFragmentNodes=[],t.notReadyUpgradeNodes=[],t.readyUpgradeNodes=[],t.ageRoot=null,t.upgradeStarAdButton=null,t.upgradeStarAdTimesLabel=null,t.upgradeStarAdEncourageIconUI=null,t.card=null,t}r(A,c=cc.Component),A.prototype.onLoad=function(){var t=this;this.upgradeStarButton&&this.upgradeStarButton.node.on("click",function(){t.upgradeCard(!1)}),this.upgradeStarAdButton&&this.upgradeStarAdButton.node.on("click",function(){_.sGViewModel.getModule(d.VMEncourage).encourage(h.sEncourageConfig.config.upgradeCardWhenNotEnoughPoint,t.upgradeStarAdEncourageType,function(){t.upgradeCard(!0)})})},A.prototype.upgradeCard=function(t){0===_.sGViewModel.getModule(P.VMCard).upgrade(this.card.entry.id,t)&&(this.upgradeStarAdEncourageType=void 0,y.sGAudio.playEffect(p.sAudioConfig.config.reward),this.refresh(!0))},A.prototype.onEnable=function(){var t=this;b.sGGame.on(C.sLocalCardEvent.upgrade,function(){y.sGAudio.playEffect(p.sAudioConfig.config.reward),t.refresh(!1)},this),b.sGGame.on(s.sLocalCurrencyEvent.changed,function(e){e===f.sCurrencyConfig.config.cardUpgradePoint&&t.refresh(!1)},this),this.refresh(!1),y.sGAudio.playEffect(p.sAudioConfig.config.popUI)},A.prototype.onDisable=function(){m.sGNode.targetOff(this),b.sGGame.targetOff(this)},A.prototype.refresh=function(t){if(this.card){for(var e=this.card.getFragment(),o=this.card.getUpgradeNeed(),i=this.card.isActive(),a=this.card.isLevelFull(),n=this.card.isFragmentReadyUpgrade(),r=this.card.isReadyUpgrade(),l=0;l<this.notHaveNodes.length;++l)this.notHaveNodes[l].active=!i;for(l=0;l<this.haveNodes.length;++l)this.haveNodes[l].active=i;for(l=0;l<this.notFullLevelNodes.length;++l)this.notFullLevelNodes[l].active=i&&!a;for(l=0;l<this.fullLevelNodes.length;++l)this.fullLevelNodes[l].active=i&&a;for(l=0;l<this.notFullFragmentNodes.length;++l)this.notFullFragmentNodes[l].active=i&&!a&&!n;for(l=0;l<this.fullFragmentNodes.length;++l)this.fullFragmentNodes[l].active=i&&!a&&n;for(l=0;l<this.notReadyUpgradeNodes.length;++l)this.notReadyUpgradeNodes[l].active=i&&!a&&n&&!r;for(l=0;l<this.readyUpgradeNodes.length;++l)this.readyUpgradeNodes[l].active=i&&!a&&n&&r;this.nameLabel&&(this.nameLabel.string=g.i18n.t(this.card.entry.name),this.nameLabel.node.color=_.sGViewModel.getModule(G.VMReward).getQualityColor(this.card.entry.quality));var c=_.sGViewModel.getModule(S.VMGame);this.card.isLevelFull()?(this.nextStarDesc&&(this.nextStarDesc.node.active=!1),this.nextStarTitleNode&&(this.nextStarTitleNode.active=!1),this.currentStarDesc&&(this.currentStarDesc.string=_.sGViewModel.getModule(P.VMCard).getDesc(this.card.entry.id),m.sGNode.setChildLabelColor(this.currentStarDesc.node,c.getValidColor(!0)))):0<this.card.record.level?(this.currentStarDesc&&(this.currentStarDesc.node.active=!0,this.currentStarDesc.string=_.sGViewModel.getModule(P.VMCard).getDesc(this.card.entry.id),m.sGNode.setChildLabelColor(this.currentStarDesc.node,c.getValidColor(!0))),this.nextStarTitleNode&&(this.nextStarTitleNode.active=!0),this.nextStarDesc&&(this.nextStarDesc.string=_.sGViewModel.getModule(P.VMCard).getNextDesc(this.card.entry.id))):(this.nextStarDesc&&(this.nextStarDesc.node.active=!1),this.nextStarTitleNode&&(this.nextStarTitleNode.active=!1),this.currentStarDesc&&(this.currentStarDesc.string=_.sGViewModel.getModule(P.VMCard).getDesc(this.card.entry.id),m.sGNode.setChildLabelColor(this.currentStarDesc.node,c.getValidColor(!1)))),this.countLabel&&(this.countLabel.string=e+"/"+o,this.countLabel.node.active=this.card.isActive()&&!this.card.isLevelFull()),this.countProgressBar&&(this.countProgressBar.progress=e/o);var u=b.sGGame.localModel.getModule(C.LocalCardPackage),p=!this.card.isLevelFull()&&this.card.isActive();if(e=0<u.getRemainAdUpgradeTimes(),o=u.checkUpgrade(this.card.entry.id),this.upgradeStarButton&&(this.upgradeStarButton.node.active=p&&(3!==o||!e),this.upgradeStarButton.node.active&&(this.upgradeStarButton.interactable=0===o)),this.upgradeStarAdButton&&(this.upgradeStarAdButton.node.active=p&&3===o&&e,this.upgradeStarAdButton.node.active&&(this.upgradeStarAdButton.interactable=e)&&void 0===this.upgradeStarAdEncourageType&&(this.upgradeStarAdEncourageType=_.sGViewModel.getModule(d.VMEncourage).preEncourage(h.sEncourageConfig.config.upgradeCardWhenNotEnoughPoint))),this.upgradeStarAdEncourageIconUI&&this.upgradeStarAdEncourageIconUI.setEncourageType(this.upgradeStarAdEncourageType),this.upgradeStarAdTimesLabel&&(this.upgradeStarAdTimesLabel.string=u.getRemainAdUpgradeTimes()+"/"+u.getMaxAdUpgradeTimes()),this.iconSprite&&(m.sGNode.setSprite(this.iconSprite,this.card.entry.bigIcon),m.sGNode.setSpriteMaterial(this.iconSprite,0===this.card.record.level?"2d-gray-sprite":"2d-sprite")),this.upgradeCardPointLabel&&(e=b.sGGame.localModel.getModule(s.LocalCurrency).get(f.sCurrencyConfig.config.cardUpgradePoint),u=this.card.getPointNeed(),this.upgradeCardPointLabel.string="x"+u,this.upgradeCardPointLabel.node.active=this.card.isActive()&&!this.card.isLevelFull(),m.sGNode.setChildLabelColor(this.upgradeCardPointLabel.node,c.getCondtionValidColor(u<=e))),this.starRoot)for(l=1;;++l){var y=this.starRoot.getChildByName("star"+l);if(!y)break;(y=y.getChildByName("star"))&&(y.active=l<=this.card.record.level),l!==this.card.record.level||!t||(y=y.getComponent(cc.Animation))&&y.play()}if(this.qualityRoot)for(l=1;;++l){var M=this.qualityRoot.getChildByName("quality"+l);if(!M)break;M.active=l+2===this.card.entry.quality}if(this.typeRoot)for(var w in v.GameDefine.uiTypeNodeNameDic){var A=this.typeRoot.getChildByName(w);if(!A)break;A.active=v.GameDefine.uiTypeNodeNameDic[w]===this.card.entry.type}if(this.ageRoot)for(l=0;l<6;l++){var B=cc.find("age"+(l+1),this.ageRoot);B&&(B.active=0===l?this.card.entry.unlockAge<3:this.card.entry.unlockAge===l+2)}}},l([a(cc.Label)],A.prototype,"nameLabel",void 0),l([a(cc.Label)],A.prototype,"countLabel",void 0),l([a(cc.ProgressBar)],A.prototype,"countProgressBar",void 0),l([a(cc.Sprite)],A.prototype,"iconSprite",void 0),l([a(cc.Node)],A.prototype,"starRoot",void 0),l([a(cc.Node)],A.prototype,"qualityRoot",void 0),l([a(cc.Label)],A.prototype,"currentStarDesc",void 0),l([a(cc.Label)],A.prototype,"nextStarDesc",void 0),l([a(cc.Node)],A.prototype,"nextStarTitleNode",void 0),l([a(cc.Button)],A.prototype,"upgradeStarButton",void 0),l([a(cc.Label)],A.prototype,"upgradeCardPointLabel",void 0),l([a(cc.Node)],A.prototype,"typeRoot",void 0),l([a(cc.Node)],A.prototype,"notHaveNodes",void 0),l([a(cc.Node)],A.prototype,"haveNodes",void 0),l([a(cc.Node)],A.prototype,"notFullLevelNodes",void 0),l([a(cc.Node)],A.prototype,"fullLevelNodes",void 0),l([a(cc.Node)],A.prototype,"notFullFragmentNodes",void 0),l([a(cc.Node)],A.prototype,"fullFragmentNodes",void 0),l([a(cc.Node)],A.prototype,"notReadyUpgradeNodes",void 0),l([a(cc.Node)],A.prototype,"readyUpgradeNodes",void 0),l([a(cc.Node)],A.prototype,"ageRoot",void 0),l([a(cc.Button)],A.prototype,"upgradeStarAdButton",void 0),l([a(cc.Label)],A.prototype,"upgradeStarAdTimesLabel",void 0),l([a(u.default)],A.prototype,"upgradeStarAdEncourageIconUI",void 0),w=l([M,w("Game/Card/CardSkillInfoUI")],A),n.default=w,cc._RF.pop()},{}],card_soldier_equip_simple_ui:[function(t,e,o){"use strict";cc._RF.push(e,"aa6b9Oxt3VFl6d4cZWX/bUS","card_soldier_equip_simple_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("client_config"),u=a("scroll_number"),d=a("gui"),p=a("gnode"),f=a("ggame"),h=a("game_define"),g=a("local_battle_stage"),y=a("local_card"),m=a("card_tab_pakcage_equip_icon_ui"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu);function v(){var t=null!==c&&c.apply(this,arguments)||this;return t.cardIconUIArray=[],t.equipButton=null,t.testNode=null,t.battleScoreLabel=null,t}r(v,c=cc.Component),v.prototype.onLoad=function(){var t=this;this.equipButton&&this.equipButton.node.on("click",function(){d.sGUI.openDialogUI(h.GameDefine.prefabCardSoldierEquipUI)}),s.sClientConfig.config.devMode&&this.testNode&&(p.sGNode.addUniqueComponent(this.testNode,cc.Button),this.testNode.on("click",function(){f.sGGame.localModel.getModule(y.LocalCardPackage).addAllCard(),t.refresh(!1)}))},v.prototype.onEnable=function(){var t=this;this.refresh(!0),f.sGGame.on(y.sLocalCardEvent.changeEquip,function(){t.refresh(!1)},this)},v.prototype.onDisable=function(){f.sGGame.targetOff(this)},v.prototype.refresh=function(t){for(var e,o=f.sGGame.localModel.getModule(y.LocalCardPackage),i=f.sGGame.localModel.getModule(g.LocalBattleStage),a=Object.keys(o.equipSoldierCardDic),n=0;n<5;++n)n<a.length?(e=o.equipSoldierCardDic[a[n]],this.refreshIcon(n,e)):this.refreshIcon(n,null);this.battleScoreLabel&&p.sGNode.addUniqueComponent(this.battleScoreLabel.node,u.default).setNumber(i.getBattleScore(),!t)},v.prototype.refreshIcon=function(t,e){this.cardIconUIArray[t]&&(this.cardIconUIArray[t].card=e)},l([a(m.default)],v.prototype,"cardIconUIArray",void 0),l([a(cc.Button)],v.prototype,"equipButton",void 0),l([a(cc.Node)],v.prototype,"testNode",void 0),l([a(cc.Label)],v.prototype,"battleScoreLabel",void 0),_=l([b,_("Game/Card/CardSoldierEquipSimpleUI")],v),n.default=_,cc._RF.pop()},{}],card_tab_free_pull_card_ui:[function(t,e,o){"use strict";cc._RF.push(e,"62dbfpsl1tEAoRcGK/PYIEn","card_tab_free_pull_card_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("const_config"),p=a("encourage_config"),f=a("stage_config"),h=a("i18n"),g=a("gtime"),y=a("ggame"),m=a("gview_model"),b=a("local_card"),_=a("local_stage"),v=a("vm_card"),C=(P=cc._decorator).ccclass,P=(a=P.property,P.menu);function S(){var t=null!==c&&c.apply(this,arguments)||this;return t.startPullButton1=null,t.timeLabel1=null,t.startPullButton2=null,t.timeLabel2=null,t.systemUnlockStageLabel1=null,t.systemUnlockStageLabel2=null,t.systemUnlockStageNode1=null,t.systemUnlockStageNode2=null,t.encourageIconUI1=null,t.encourageType1=u.eEncourageType.closed,t.encourageIconUI2=null,t.encourageType2=u.eEncourageType.closed,t.passTimeDt1=1,t}r(S,c=cc.Component),S.prototype.onLoad=function(){var t=this;this.startPullButton1&&this.startPullButton1.node.on("click",function(){m.sGViewModel.getModule(u.VMEncourage).encourage(p.sEncourageConfig.config.normalSacrifice,t.encourageType1,function(){m.sGViewModel.getModule(v.VMCard).startNormalFreePull(),t.refresh()})}),this.startPullButton2&&this.startPullButton2.node.on("click",function(){m.sGViewModel.getModule(u.VMEncourage).encourage(p.sEncourageConfig.config.advancedSacrifice,t.encourageType2,function(){m.sGViewModel.getModule(v.VMCard).startAdvancedFreePull(),t.refresh()})})},S.prototype.onEnable=function(){this.encourageType1=m.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.normalSacrifice),this.encourageIconUI1&&this.encourageIconUI1.setEncourageType(this.encourageType1),this.encourageType2=m.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.advancedSacrifice),this.encourageIconUI2&&this.encourageIconUI2.setEncourageType(this.encourageType2),this.refresh()},S.prototype.update=function(t){this.passTimeDt1+=t,.3<=this.passTimeDt1&&(this.passTimeDt1=.3,this.refresh())},S.prototype.refresh=function(){var t,e=y.sGGame.localModel.getModule(b.LocalCardPackage),o=y.sGGame.localModel.getModule(_.LocalStage),i=e.getNormalFreePullRemainTime(),a=o.isSystemIsOpened(d.sConstConfig.config.normalSacrificeUnlockStage);o=o.isSystemIsOpened(d.sConstConfig.config.advancedSacrificeUnlockStage),this.startPullButton1&&(this.startPullButton1.node.active=a&&i<=0),this.timeLabel1&&(this.timeLabel1.node.parent.active=a&&0<i,this.timeLabel1.node.parent.active&&(this.timeLabel1.string=g.sGTime.toTimeSpanString(i))),e=e.getAdvancedFreePullRemainTime(),this.startPullButton2&&(this.startPullButton2.node.active=o&&e<=0),this.timeLabel2&&(this.timeLabel2.node.parent.active=o&&0<e,this.timeLabel2.node.parent.active&&(this.timeLabel2.string=g.sGTime.toTimeSpanString(e))),this.systemUnlockStageNode1&&(this.systemUnlockStageNode1.active=!a),this.systemUnlockStageNode2&&(this.systemUnlockStageNode2.active=!o),this.systemUnlockStageLabel1&&(t=f.sStageConfig.getEntry(d.sConstConfig.config.normalSacrificeUnlockStage),this.systemUnlockStageLabel1.string=h.i18n.t("tip.unlockStage").replace("${value}",t.name)),this.systemUnlockStageLabel2&&(t=f.sStageConfig.getEntry(d.sConstConfig.config.advancedSacrificeUnlockStage),this.systemUnlockStageLabel2.string=h.i18n.t("tip.unlockStage").replace("${value}",t.name))},l([a(cc.Button)],S.prototype,"startPullButton1",void 0),l([a(cc.Label)],S.prototype,"timeLabel1",void 0),l([a(cc.Button)],S.prototype,"startPullButton2",void 0),l([a(cc.Label)],S.prototype,"timeLabel2",void 0),l([a(cc.Label)],S.prototype,"systemUnlockStageLabel1",void 0),l([a(cc.Label)],S.prototype,"systemUnlockStageLabel2",void 0),l([a(cc.Node)],S.prototype,"systemUnlockStageNode1",void 0),l([a(cc.Node)],S.prototype,"systemUnlockStageNode2",void 0),l([a(s.default)],S.prototype,"encourageIconUI1",void 0),l([a(s.default)],S.prototype,"encourageIconUI2",void 0),P=l([C,P("Game/UI/CardTabFreePullCardUI")],S),n.default=P,cc._RF.pop()},{}],card_tab_package_cell_ui:[function(t,e,o){"use strict";cc._RF.push(e,"28149q4V6tJ/KLU2LmmtglV","card_tab_package_cell_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("i18n"),u=a("fast_scrollview_cell"),d=a("gui"),p=a("gnode"),f=a("ggame"),h=a("gview_model"),g=a("game_define"),y=a("local_card"),m=a("vm_reward"),b=a("card_hero_info_ui"),_=a("card_skill_info_ui"),v=(C=cc._decorator).ccclass,C=(a=C.property,C.menu);function P(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.countLabel=null,t.countProgressBar=null,t.iconSprite=null,t.starRoot=null,t.qualityRoot=null,t.typeRoot=null,t.cardInfoButton=null,t.notHaveNodes=[],t.haveNodes=[],t.notFullLevelNodes=[],t.fullLevelNodes=[],t.notFullFragmentNodes=[],t.fullFragmentNodes=[],t.notReadyUpgradeNodes=[],t.readyUpgradeNodes=[],t.ageRoot=null,t.equipedTagNode=null,t.fastScrollViewCell=null,t.card=null,t}r(P,c=cc.Component),P.prototype.onLoad=function(){var t=this;this.fastScrollViewCell=this.getComponent(u.FastScrollViewCell),this.cardInfoButton&&this.cardInfoButton.node.on("click",function(){t.card.isSoldierCard?d.sGUI.openDialogUI(g.GameDefine.prefabSoldierCardInfoPop,function(e){(e=e.getComponent(b.default))&&(e.card=t.card)}):d.sGUI.openDialogUI(g.GameDefine.prefabSkillCardInfoPop,function(e){(e=e.getComponent(_.default))&&(e.card=t.card)})})},P.prototype.onEnable=function(){var t=this;f.sGGame.on(y.sLocalCardEvent.upgrade,function(){t.refresh()},this),f.sGGame.on(y.sLocalCardEvent.changeEquip,function(){t.equipedTagNode&&(t.equipedTagNode.active=t.card.isEquiped())},this),this.card=this.fastScrollViewCell.data,this.refresh(),this.cardInfoButton&&d.sGUI.registerNode(this.node.name+this.fastScrollViewCell.index+"."+this.cardInfoButton.node.name,this.cardInfoButton.node)},P.prototype.onDisable=function(){p.sGNode.targetOff(this),this.cardInfoButton&&d.sGUI.unregisterNode(this.node.name+this.fastScrollViewCell.index+"."+this.cardInfoButton.node.name,this.cardInfoButton.node)},P.prototype.refresh=function(){for(var t=this.card.getFragment(),e=this.card.getUpgradeNeed(),o=this.card.isActive(),i=this.card.isLevelFull(),a=this.card.isFragmentReadyUpgrade(),n=this.card.isReadyUpgrade(),r=0;r<this.notHaveNodes.length;++r)this.notHaveNodes[r].active=!o;for(r=0;r<this.haveNodes.length;++r)this.haveNodes[r].active=o;for(r=0;r<this.notFullLevelNodes.length;++r)this.notFullLevelNodes[r].active=o&&!i;for(r=0;r<this.fullLevelNodes.length;++r)this.fullLevelNodes[r].active=o&&i;for(r=0;r<this.notFullFragmentNodes.length;++r)this.notFullFragmentNodes[r].active=o&&!i&&!a;for(r=0;r<this.fullFragmentNodes.length;++r)this.fullFragmentNodes[r].active=o&&!i&&a;for(r=0;r<this.notReadyUpgradeNodes.length;++r)this.notReadyUpgradeNodes[r].active=o&&!i&&a&&!n;for(r=0;r<this.readyUpgradeNodes.length;++r)this.readyUpgradeNodes[r].active=o&&!i&&a&&n;if(this.nameLabel&&(this.nameLabel.string=s.i18n.t(this.card.entry.name),this.nameLabel.node.color=h.sGViewModel.getModule(m.VMReward).getQualityColor(this.card.entry.quality)),this.countLabel&&(this.countLabel.string=t+"/"+e),this.countProgressBar&&(this.countProgressBar.progress=t/e),this.equipedTagNode&&(this.equipedTagNode.active=this.card.isEquiped()),this.iconSprite&&(p.sGNode.setSprite(this.iconSprite,this.card.entry.bigIcon),p.sGNode.setSpriteMaterial(this.iconSprite,0===this.card.record.level?"2d-gray-sprite":"2d-sprite")),this.starRoot)for(r=1;;++r){var l=this.starRoot.getChildByName("star"+r);if(!l)break;(l=l.getChildByName("star"))&&(l.active=r<=this.card.record.level)}if(this.qualityRoot)for(r=0;;++r){var c=this.qualityRoot.getChildByName("quality"+r);if(!c)break;c.active=r+2===this.card.entry.quality}if(this.typeRoot)for(var u in g.GameDefine.uiTypeNodeNameDic){var d=this.typeRoot.getChildByName(u);if(!d)break;d.active=g.GameDefine.uiTypeNodeNameDic[u]===this.card.entry.type}if(this.ageRoot)for(r=0;r<6;r++){var f=cc.find("age"+(r+1),this.ageRoot);f&&(f.active=0===r?this.card.entry.unlockAge<3:this.card.entry.unlockAge===r+2)}},l([a(cc.Label)],P.prototype,"nameLabel",void 0),l([a(cc.Label)],P.prototype,"countLabel",void 0),l([a(cc.ProgressBar)],P.prototype,"countProgressBar",void 0),l([a(cc.Sprite)],P.prototype,"iconSprite",void 0),l([a(cc.Node)],P.prototype,"starRoot",void 0),l([a(cc.Node)],P.prototype,"qualityRoot",void 0),l([a(cc.Node)],P.prototype,"typeRoot",void 0),l([a(cc.Button)],P.prototype,"cardInfoButton",void 0),l([a(cc.Node)],P.prototype,"notHaveNodes",void 0),l([a(cc.Node)],P.prototype,"haveNodes",void 0),l([a(cc.Node)],P.prototype,"notFullLevelNodes",void 0),l([a(cc.Node)],P.prototype,"fullLevelNodes",void 0),l([a(cc.Node)],P.prototype,"notFullFragmentNodes",void 0),l([a(cc.Node)],P.prototype,"fullFragmentNodes",void 0),l([a(cc.Node)],P.prototype,"notReadyUpgradeNodes",void 0),l([a(cc.Node)],P.prototype,"readyUpgradeNodes",void 0),l([a(cc.Node)],P.prototype,"ageRoot",void 0),l([a(cc.Node)],P.prototype,"equipedTagNode",void 0),C=l([v,C("Game/UI/CardTabPackageCellUI")],P),n.default=C,cc._RF.pop()},{}],card_tab_package_ui:[function(t,e,o){"use strict";cc._RF.push(e,"513a7JZNZdGIasBJt7+kH4+","card_tab_package_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("fast_scrollview"),d=a("gaudio"),p=a("ggame"),f=a("game_define"),h=a("local_card"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu);function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.filterNodeArray=[],t.countLabel=null,t.fastScrollView=null,t.filterIndex=-1,t}r(m,c=cc.Component),m.prototype.onLoad=function(){var t=this;this.fastScrollView=this.getComponent(u.FastScrollView);for(var e=this,o=0;o<this.filterNodeArray.length;++o)!function(o){var i=e.filterNodeArray[o];i&&i.on("click",function(){d.sGAudio.playEffect(s.sAudioConfig.config.switchTab),t.filter(o),t.refresh()})}(o)},m.prototype.onEnable=function(){this.filter(0),this.refresh()},m.prototype.refresh=function(){p.sGGame.localModel.getModule(h.LocalCardPackage),this.countLabel},m.prototype.filter=function(t){if(this.fastScrollView&&this.filterIndex!=t){var e=p.sGGame.localModel.getModule(h.LocalCardPackage);this.filterIndex=t;for(var o,i,a=0;a<this.filterNodeArray.length;++a){var n,r=this.filterNodeArray[a];r&&(n=r.getChildByName("normal"),r=r.getChildByName("select"),n&&(n.active=this.filterIndex!==a),r&&(r.active=this.filterIndex===a))}for(i in o=0==t?e.getCardArray():e.getCardArray(f.GameDefine.filterSkillCardTypeArray[t]),this.fastScrollView.clear(!0),o){var l=o[i];this.fastScrollView.pushCell(l)}this.fastScrollView.cellDataList.sort(function(t,e){return t=t.data,e=e.data,t.isEquiped()!=e.isEquiped()?e.isEquiped()?1:-1:t.isReadyUpgrade()!=e.isReadyUpgrade()?e.isReadyUpgrade()?1:-1:t.isFragmentReadyUpgrade()!=e.isFragmentReadyUpgrade()?e.isFragmentReadyUpgrade()?1:-1:t.isActive()!=e.isActive()?e.isActive()?1:-1:t.entry.quality!==e.entry.quality?e.entry.quality-t.entry.quality:t.record.level!==e.record.level?e.record.level-t.record.level:t.entry.id-e.entry.id}),this.fastScrollView.initPosition()}},l([a(cc.Node)],m.prototype,"filterNodeArray",void 0),l([a(cc.Label)],m.prototype,"countLabel",void 0),y=l([g,y("Game/UI/CardTabPackageUI")],m),n.default=y,cc._RF.pop()},{}],card_tab_pakcage_equip_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"445b8qRyaNL55ZaP86dZnx9","card_tab_pakcage_equip_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("i18n"),u=a("gnode"),d=a("ggame"),p=a("gview_model"),f=a("local_card"),h=a("vm_game"),g=a("vm_reward"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.countLabel=null,t.starLabel=null,t.countProgressBar=null,t.iconSprite=null,t.starRoot=null,t.qualityRoot=null,t.emptyCardRoot=null,t.notEmptyCardRoot=null,t._card=null,t}r(b,c=cc.Component),Object.defineProperty(b.prototype,"card",{get:function(){return this._card},set:function(t){this._card=t,this.node.activeInHierarchy&&this.refresh()},enumerable:!1,configurable:!0}),b.prototype.onLoad=function(){},b.prototype.onEnable=function(){var t=this;d.sGGame.on(f.sLocalCardEvent.upgrade,function(){t.refresh()},this),this.refresh()},b.prototype.onDisable=function(){u.sGNode.targetOff(this),d.sGGame.targetOff(this)},b.prototype.refresh=function(){if(this.card){this.notEmptyCardRoot&&(this.notEmptyCardRoot.active=!0),this.emptyCardRoot&&(this.emptyCardRoot.active=!1);var t=this.card.getFragment(),e=this.card.getUpgradeNeed();if(this.nameLabel&&(this.nameLabel.string=s.i18n.t(this.card.entry.name),this.nameLabel.node.color=p.sGViewModel.getModule(g.VMReward).getQualityColor(this.card.entry.quality)),p.sGViewModel.getModule(h.VMGame),this.card.isActive()&&(this.countLabel&&(this.countLabel.string=t+"/"+e,this.countLabel.node.active=this.card.isActive()),this.countProgressBar&&(this.countProgressBar.progress=t/e)),this.iconSprite&&(u.sGNode.setSprite(this.iconSprite,this.card.entry.icon),u.sGNode.setSpriteMaterial(this.iconSprite,0===this.card.record.level?"2d-gray-sprite":"2d-sprite")),this.starLabel&&(this.starLabel.string=this.card.record.level.toString()),this.starRoot)for(var o=1;;++o){var i=this.starRoot.getChildByName("star"+o);if(!i)break;(i=i.getChildByName("star"))&&(i.active=o<=this.card.record.level)}if(this.qualityRoot)for(o=1;;++o){var a=this.qualityRoot.getChildByName("quality"+o);if(!a)break;a.active=o+2===this.card.entry.quality}}else this.notEmptyCardRoot&&(this.notEmptyCardRoot.active=!1),this.emptyCardRoot&&(this.emptyCardRoot.active=!0)},l([a(cc.Label)],b.prototype,"nameLabel",void 0),l([a(cc.Label)],b.prototype,"countLabel",void 0),l([a(cc.Label)],b.prototype,"starLabel",void 0),l([a(cc.ProgressBar)],b.prototype,"countProgressBar",void 0),l([a(cc.Sprite)],b.prototype,"iconSprite",void 0),l([a(cc.Node)],b.prototype,"starRoot",void 0),l([a(cc.Node)],b.prototype,"qualityRoot",void 0),l([a(cc.Node)],b.prototype,"emptyCardRoot",void 0),l([a(cc.Node)],b.prototype,"notEmptyCardRoot",void 0),m=l([y,m("Game/UI/CardTabPcakageEquipIconUI")],b),n.default=m,cc._RF.pop()},{}],card_tab_pull_card_ui:[function(t,e,o){"use strict";cc._RF.push(e,"b2976i2DKNCqJEOJ5i1+SQm","card_tab_pull_card_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("encourage_config"),f=a("gui"),h=a("gaudio"),g=a("ggame"),y=a("gview_model"),m=a("local_card"),b=a("vm_card"),_=a("vm_reward"),v=(C=cc._decorator).ccclass,C=(a=C.property,C.menu);function P(){var t=null!==c&&c.apply(this,arguments)||this;return t.pullCardButton=null,t.adPullCardButton=null,t.pullCard10TimesButton=null,t.timesLabel=null,t.pullNeedLabel=null,t.pull10TimesNeedLabel=null,t.encourageIconUI=null,t.passTimeDt1=1,t}r(P,c=cc.Component),P.prototype.onLoad=function(){var t=this;this.pullCardButton&&this.pullCardButton.node.on("click",function(){y.sGViewModel.getModule(b.VMCard).pullCard(function(){t.refresh()})}),this.adPullCardButton&&this.adPullCardButton.node.on("click",function(){t.adPullCard(function(){t.refresh()})}),this.pullCard10TimesButton&&this.pullCard10TimesButton.node.on("click",function(){y.sGViewModel.getModule(b.VMCard).pullCard10Times(function(){t.refresh()})})},P.prototype.onEnable=function(){this.encourageType=y.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.pullCard),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType),this.refresh();var t=g.sGGame.localModel.getModule(m.LocalCardPackage).isPullOpened();this.pullCardButton&&(this.pullCardButton.interactable=t),this.adPullCardButton&&(this.adPullCardButton.interactable=t),this.pullCard10TimesButton&&(this.pullCard10TimesButton.interactable=t)},P.prototype.update=function(t){this.passTimeDt1+=t,1<=this.passTimeDt1&&(this.passTimeDt1=1,this.pullCardButton&&(this.pullCardButton.interactable=0===g.sGGame.localModel.getModule(m.LocalCardPackage).checkPull(!1)),this.adPullCardButton&&(this.adPullCardButton.interactable=0===g.sGGame.localModel.getModule(m.LocalCardPackage).checkPull(!0)),this.pullCard10TimesButton&&(this.pullCard10TimesButton.interactable=0===g.sGGame.localModel.getModule(m.LocalCardPackage).checkPull10Times()))},P.prototype.refresh=function(){var t=g.sGGame.localModel.getModule(m.LocalCardPackage);this.timesLabel&&(this.timesLabel.string=t.getRemainPullTimes().toString()),this.pullNeedLabel&&(this.pullNeedLabel.string=t.getPullNeed().toString()),this.pull10TimesNeedLabel&&(this.pull10TimesNeedLabel.string=t.getPull10TimesNeed().toString())},P.prototype.adPullCard=function(t){var e=g.sGGame.localModel.getModule(m.LocalCardPackage);y.sGViewModel.getModule(u.VMEncourage).encourage(p.sEncourageConfig.config.pullCard,this.encourageType,function(){e.pull(!0,function(e,o){e||y.sGViewModel.getModule(_.VMReward).openPullCardRewardPage(o.rewardList.getReward(0),t)})})},P.prototype.onClickCardDrawTips=function(){h.sGAudio.playEffect(d.sAudioConfig.config.popUI),f.sGUI.openDialogUI("prefabs/ui/card_draw_tips")},l([a(cc.Button)],P.prototype,"pullCardButton",void 0),l([a(cc.Button)],P.prototype,"adPullCardButton",void 0),l([a(cc.Button)],P.prototype,"pullCard10TimesButton",void 0),l([a(cc.Label)],P.prototype,"timesLabel",void 0),l([a(cc.Label)],P.prototype,"pullNeedLabel",void 0),l([a(cc.Label)],P.prototype,"pull10TimesNeedLabel",void 0),l([a(s.default)],P.prototype,"encourageIconUI",void 0),C=l([v,C("Game/UI/CardTabPullCardUI")],P),n.default=C,cc._RF.pop()},{}],card_tips_ui:[function(t,e,o){"use strict";cc._RF.push(e,"96cdfFohFtG8a3zcNHHBXyw","card_tips_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("card_config"),d=a("i18n"),p=a("gui"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("local_card"),m=(b=cc._decorator).ccclass,b=(a=b.property,b.menu);function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.labelTips=null,t}r(_,c=cc.Component),_.prototype.onLoad=function(){this.labelTips&&(this.labelTips.string=d.i18n.t("card.pullCardTipContent").replace("${value}",this.getQualityProbabilityText()))},_.prototype.getQualityProbabilityText=function(){var t="",e=g.sGGame.localModel.getModule(y.LocalCardPackage);if(e){var o,i={},a=0;for(o in u.sCardConfig.config){var n=e.getCard(parseInt(o));n.canRandomCard()&&(void 0===(p=i[n.entry.quality])&&(p=0),i[n.entry.quality]=p+n.entry.pullWeight,a+=n.entry.pullWeight)}for(var r,l={},c=0,s=1;s<=5;++s)(p=i[s])&&(r=Math.floor(100*p/a),c+=l[s]=r);if(c<100)for(s=5;1<=s;--s)if(void 0!==l[s]){l[s]+=100-c;break}var p,f=0;for(s=1;s<=5;++s)void 0!==(p=l[s])&&(0<f&&(t+="\n"),t+="    "+d.i18n.t("card.qualityName"+s)+": "+l[s]+"%",f++)}return t},_.prototype.onClickCardLibrary=function(){h.sGNode.destoryNode(this.node),f.sGAudio.playEffect(s.sAudioConfig.config.popUI),p.sGUI.openDialogUI("prefabs/ui/card_library")},l([a(cc.Label)],_.prototype,"labelTips",void 0),b=l([m,b("Game/UI/CardTipsUI")],_),n.default=b,cc._RF.pop()},{}],card_ui:[function(t,e,o){"use strict";cc._RF.push(e,"1bbbf0Pyq5H0rw2wAM1w6f6","card_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reddot"),u=a("audio_config"),d=a("const_config"),p=a("gui"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_stage"),b=a("vm_card"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.tabRoot=null,t.tabButtonNodeArray=[],t.tabPrefabArray=[],t.jsButton=null,t.tabNodeArray=[],t.currentSelected=-1,t}r(C,c=cc.Component),C.prototype.onLoad=function(){for(var t=this,e=this,o=0;o<this.tabButtonNodeArray.length;++o)!function(o){var i=e.tabButtonNodeArray[o];i.on("click",function(){f.sGAudio.playEffect(u.sAudioConfig.config.switchTab),t.openTab(o)}),(i=i.getChildByName("normal"))&&h.sGNode.addUniqueComponent(i,s.default).init(function(){return 0===o?y.sGViewModel.getModule(b.VMCard).skillCardPackageHasReddot():1===o?y.sGViewModel.getModule(b.VMCard).pullHasReddot():2===o?y.sGViewModel.getModule(b.VMCard).freePullHasReddot():void 0},"red_dot")}(o);this.jsButton&&(h.sGNode.addUniqueComponent(this.jsButton,s.default).init(function(){return y.sGViewModel.getModule(b.VMCard).freePullHasReddot()},"Background/reddot"),this.jsButton.node.on("click",function(){f.sGAudio.playEffect(u.sAudioConfig.config.popUI),p.sGUI.openDialogUI("prefabs/ui/card_js_root")}))},C.prototype.onEnable=function(){for(var t=0;t<this.tabButtonNodeArray.length;++t)this._setTabSelectState(t,!1);this.currentSelected=-1,this.openTab(1);var e=(o=g.sGGame.localModel.getModule(m.LocalStage)).isSystemIsOpened(d.sConstConfig.config.normalSacrificeUnlockStage),o=o.isSystemIsOpened(d.sConstConfig.config.advancedSacrificeUnlockStage);3<=this.tabButtonNodeArray.length&&(this.tabButtonNodeArray[2].active=e||o),f.sGAudio.playEffect(u.sAudioConfig.config.popUI)},C.prototype.openTab=function(t){var e;this.currentSelected==t&&0<=t||(this.tabNodeArray[t]||(e=this.tabPrefabArray[t],e=cc.instantiate(e),this.tabNodeArray[t]=e,this.tabRoot.addChild(e)),this._setTabSelectState(this.currentSelected,!1),this.currentSelected=t,this._setTabSelectState(this.currentSelected,!0),p.sGUI.renameTopName(this.tabNodeArray[t].name))},C.prototype._setTabSelectState=function(t,e){var o;t<0||(this.tabNodeArray[t]&&(this.tabNodeArray[t].active=e),(o=this.tabButtonNodeArray[t])&&(t=o.getChildByName("select"),o=o.getChildByName("normal"),t&&(t.active=e),o&&(o.active=!e)))},C.prototype.onClickCardLibrary=function(){f.sGAudio.playEffect(u.sAudioConfig.config.popUI),p.sGUI.openDialogUI("prefabs/ui/card_library")},l([a(cc.Node)],C.prototype,"tabRoot",void 0),l([a(cc.Node)],C.prototype,"tabButtonNodeArray",void 0),l([a(cc.Prefab)],C.prototype,"tabPrefabArray",void 0),l([a({displayName:"\u796d\u7940\u6309\u94ae",type:cc.Button})],C.prototype,"jsButton",void 0),v=l([_,v("Game/UI/CardUI")],C),n.default=v,cc._RF.pop()},{}],check_in_7days_ad_ui:[function(t,e,o){"use strict";cc._RF.push(e,"1863cdD3Q1CRY8T1oiRGSCK","check_in_7days_ad_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gaudio"),d=a("gnode"),p=a("ggame"),f=a("gview_model"),h=a("local_checkin_beginner"),g=a("vm_check_in"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.buttonGoto=null,t.buttonConfirm=null,t.nodeNearestRewardAd=[],t}r(b,c=cc.Component),b.prototype.onLoad=function(){var t=this;this.buttonConfirm&&this.buttonConfirm.node.on("click",function(){u.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),d.sGNode.destoryNode(t.node)}),this.buttonGoto&&this.buttonGoto.node.on("click",function(){u.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),f.sGViewModel.getModule(g.VMCheckIn).openCheckInUI(void 0),d.sGNode.destoryNode(t.node)})},b.prototype.onEnable=function(){u.sGAudio.playEffect(s.sAudioConfig.config.popUI);var t=p.sGGame.localModel.getModule(h.default).getDayForChecked();if(this.nodeNearestRewardAd){for(var e,o=-1,i=-1,a=0;a<this.nodeNearestRewardAd.length;++a)if((e=this.nodeNearestRewardAd[a])&&t<=(i=a)){o=a;break}for(-1===o&&(o=i),a=0;a<this.nodeNearestRewardAd.length;++a)(e=this.nodeNearestRewardAd[a])&&(e.active=a===o)}},l([a({tooltip:"\u8df3\u8f6c\u6309\u94ae",type:cc.Button})],b.prototype,"buttonGoto",void 0),l([a({tooltip:"\u786e\u8ba4\u6309\u94ae",type:cc.Button})],b.prototype,"buttonConfirm",void 0),l([a({tooltip:"\u5e7f\u544a\u9875",type:cc.Node})],b.prototype,"nodeNearestRewardAd",void 0),m=l([y,m("Game/Main/CheckIn7DaysAdUI")],b),n.default=m,cc._RF.pop()},{}],check_in_7days_ui:[function(t,e,o){"use strict";cc._RF.push(e,"a0563xxGpRO67xd7HHp5Ecr","check_in_7days_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gaudio"),d=a("gnode"),p=a("ggame"),f=a("gview_model"),h=a("local_check_in_7day"),g=a("vm_check_in_7days"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.nodeRoot=null,t.nodeChecked=[],t.buttonConfirm=null,t}r(b,c=cc.Component),b.prototype.onLoad=function(){var t=this;if(this.buttonConfirm&&this.buttonConfirm.node.on("click",function(){0===f.sGViewModel.getModule(g.VMCheckIn7Days).checkIn()&&(u.sGAudio.playEffect(s.sAudioConfig.config.reward),t.refresh(!0))}),this.nodeRoot)for(var e=1;e<=7;++e){var o=this.nodeRoot.getChildByName("sign_strip"+e);o&&this.nodeChecked.push(o.getChildByName("sign_in"))}},b.prototype.onEnable=function(){this.refresh(!1),u.sGAudio.playEffect(s.sAudioConfig.config.popUI)},b.prototype.onDisable=function(){},b.prototype.refresh=function(t){for(var e=p.sGGame.localModel.getModule(h.default),o=e.getCurrentDay(),i=0;i<this.nodeChecked.length;++i){var a,n,r=this.nodeChecked[i];r&&(n=e.isChecked(a=i+1),r.active=n,t&&o===a&&n&&d.sGNode.playAnimation(r))}this.buttonConfirm&&(this.buttonConfirm.interactable=0===e.checkTodayChecked())},l([a({tooltip:"\u5956\u52b1\u9886\u53d6\u8282\u70b9",type:cc.Node})],b.prototype,"nodeRoot",void 0),l([a(cc.Button)],b.prototype,"buttonConfirm",void 0),m=l([y,m("Game/Main/CheckIn7DaysUI")],b),n.default=m,cc._RF.pop()},{}],check_in_daily_ui:[function(t,e,o){"use strict";cc._RF.push(e,"5d975j9nuhAZq4pExCB035K","check_in_daily_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gaudio"),d=a("gnode"),p=a("ggame"),f=a("gview_model"),h=a("local_check_in_daily"),g=a("vm_check_in_daily"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.nodeChecked=[],t.buttonConfirm=null,t}r(b,c=cc.Component),b.prototype.onLoad=function(){var t=this;this.buttonConfirm&&this.buttonConfirm.node.on("click",function(){0===f.sGViewModel.getModule(g.VMCheckInDaily).checkIn()&&(u.sGAudio.playEffect(s.sAudioConfig.config.reward),t.refresh(!0))})},b.prototype.onEnable=function(){this.refresh(!1)},b.prototype.onDisable=function(){},b.prototype.refresh=function(t){for(var e=p.sGGame.localModel.getModule(h.default),o=e.getCurrentDay(),i=0;i<this.nodeChecked.length;++i){var a,n,r=this.nodeChecked[i];r&&(n=e.isChecked(a=i+1),r.active=n,t&&o===a&&n&&d.sGNode.playAnimation(r))}this.buttonConfirm&&(this.buttonConfirm.interactable=0===e.checkTodayChecked())},l([a({tooltip:"\u5956\u52b1\u9886\u53d6\u8282\u70b9",type:cc.Node})],b.prototype,"nodeChecked",void 0),l([a(cc.Button)],b.prototype,"buttonConfirm",void 0),m=l([y,m("Game/Main/CheckInDailyUI")],b),n.default=m,cc._RF.pop()},{}],check_in_ui:[function(t,e,o){"use strict";cc._RF.push(e,"63aabb1vQZL5aSS7mjg0Gq0","check_in_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.CheckInUITabType=void 0;var s,u=a("audio_config"),d=a("client_config"),p=a("gaudio"),f=a("gnode"),h=a("gres"),g=a("ggame"),y=a("local_check_in_7day"),m=a("local_check_in_daily"),b=a("check_in_7days_ui"),_=a("check_in_daily_ui"),v=cc._decorator,C=v.ccclass;n=v.property,a=v.menu,(v=s=r.CheckInUITabType||(r.CheckInUITabType={}))[v.daily=0]="daily",v[v.sevenDays=1]="sevenDays",v[v.max=2]="max";var P,S=((v={})[s.daily]={path:"prefabs/ui/activity_sign",component:_.default},v[s.sevenDays]={path:"prefabs/ui/activity_sign_novice",component:b.default},v);function G(){var t=null!==P&&P.apply(this,arguments)||this;return t.buttonClose=null,t.buttonTab7Days=null,t.spriteTab7DaysSelected=null,t.spriteTab7DaysUnselected=null,t.spriteTab7DaysReddot=null,t.buttonTabDaily=null,t.spriteTabDailySelected=null,t.spriteTabDailyUnselected=null,t.spriteTabDailyReddot=null,t.nodeChild=null,t._tabType=s.sevenDays,t.nodeTab={},t.totalDt=0,t}l(G,P=cc.Component),G.prototype.init=function(t){this._tabType=t},G.prototype.onLoad=function(){var t=this;this.buttonClose&&this.buttonClose.node.on("click",function(){p.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),f.sGNode.destoryNode(t.node)}),this.buttonTab7Days&&this.buttonTab7Days.node.on("click",function(){p.sGAudio.playEffect(u.sAudioConfig.config.switchTab),t._switchTab(s.sevenDays)}),this.buttonTabDaily&&this.buttonTabDaily.node.on("click",function(){p.sGAudio.playEffect(u.sAudioConfig.config.switchTab),t._switchTab(s.daily)})},G.prototype.onEnable=function(){var t=this;d.sClientConfig.config.checkInDailyEnabled?g.sGGame.localModel.getModule(y.default).checkEnd()&&(this._tabType===s.sevenDays&&(this._tabType=s.daily),this.buttonTab7Days&&(this.buttonTab7Days.node.active=!1),this.buttonTabDaily&&(this.buttonTabDaily.node.active=!1)):(this._tabType=s.sevenDays,this.buttonTab7Days&&(this.buttonTab7Days.node.active=!1),this.buttonTabDaily&&(this.buttonTabDaily.node.active=!1));for(var e=this,o=0;o<s.max;++o)!function(o){f.sGNode.createNode(S[o].path,e.nodeChild,function(e){(t.nodeTab[o]=e).active=t._tabType===o},e)}(o);this._refreshTab(),this._refreshTabReddot()},G.prototype.onDisable=function(){for(var t in this.nodeTab)(t=this.nodeTab[t])&&f.sGNode.destoryNode(t);h.sGRes.targetOff(this)},G.prototype.update=function(t){this.totalDt+=t,1<=this.totalDt&&(this.totalDt=0,this._refreshTabReddot())},G.prototype._switchTab=function(t){this._tabType!==t&&(this._tabType=t,this._refreshTab())},G.prototype._refreshTab=function(){this._refreshTabButton(),this._refreshTabNode()},G.prototype._refreshTabButton=function(){this.buttonTabDaily&&(this.buttonTabDaily.interactable=this._tabType!==s.daily),this.spriteTabDailySelected&&(this.spriteTabDailySelected.node.active=this._tabType===s.daily),this.spriteTabDailyUnselected&&(this.spriteTabDailyUnselected.node.active=this._tabType!==s.daily),this.buttonTab7Days&&(this.buttonTab7Days.interactable=this._tabType!==s.sevenDays),this.spriteTab7DaysSelected&&(this.spriteTab7DaysSelected.node.active=this._tabType===s.sevenDays),this.spriteTab7DaysUnselected&&(this.spriteTab7DaysUnselected.node.active=this._tabType!==s.sevenDays)},G.prototype._refreshTabNode=function(){for(var t=0;t<s.max;++t){var e=this.nodeTab[t];e&&(e.active=this._tabType===t)}},G.prototype._refreshTabReddot=function(){this.spriteTab7DaysReddot&&(this.spriteTab7DaysReddot.node.active=0===g.sGGame.localModel.getModule(y.default).checkTodayChecked()),this.spriteTabDailyReddot&&(this.spriteTabDailyReddot.node.active=0===g.sGGame.localModel.getModule(m.default).checkTodayChecked())},c([n(cc.Button)],G.prototype,"buttonClose",void 0),c([n(cc.Button)],G.prototype,"buttonTab7Days",void 0),c([n(cc.Sprite)],G.prototype,"spriteTab7DaysSelected",void 0),c([n(cc.Sprite)],G.prototype,"spriteTab7DaysUnselected",void 0),c([n(cc.Sprite)],G.prototype,"spriteTab7DaysReddot",void 0),c([n(cc.Button)],G.prototype,"buttonTabDaily",void 0),c([n(cc.Sprite)],G.prototype,"spriteTabDailySelected",void 0),c([n(cc.Sprite)],G.prototype,"spriteTabDailyUnselected",void 0),c([n(cc.Sprite)],G.prototype,"spriteTabDailyReddot",void 0),c([n(cc.Node)],G.prototype,"nodeChild",void 0),a=c([C,a("Game/Main/CheckInUI")],G),r.default=a,cc._RF.pop()},{}],checkin_beginner_day_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"928254u2vBAMI+tQxxVJvFs","checkin_beginner_day_icon_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gaudio"),d=a("ggame"),p=a("local_checkin_beginner");function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.nodeCheckedIn=null,t.nodeNotCheckIn=null,t.nodeToday=null,t._day=0,t._selectCallback=null,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,l(f,c=cc.Component),f.prototype.init=function(t,e){this._day=t,this._selectCallback=e,this.node.activeInHierarchy&&this.refresh()},f.prototype.onLoad=function(){var t=this;this.nodeCheckedIn=this.node.getChildByName("finish_bottom"),this.nodeNotCheckIn=this.node.getChildByName("day_bottom"),this.nodeToday=this.node.getChildByName("today_bottom"),this.node.on("click",function(){u.sGAudio.playEffect(s.sAudioConfig.config.switchTab),t._selectCallback&&t._selectCallback()})},f.prototype.onEnable=function(){this.refresh()},f.prototype.onDisable=function(){},f.prototype.refresh=function(){var t=d.sGGame.localModel.getModule(p.default).getCurrentDay();this.nodeCheckedIn&&(this.nodeCheckedIn.active=this._day<t),this.nodeNotCheckIn&&(this.nodeNotCheckIn.active=this._day>t),this.nodeToday&&(this.nodeToday.active=this._day===t)},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Checkin/CheckinBeginnerUI")],f),r.default=n,cc._RF.pop()},{}],checkin_beginner_ui:[function(t,e,o){"use strict";cc._RF.push(e,"4e84f5h9cJIj5rZ8sYU8Yhr","checkin_beginner_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("checkin_beginner_config"),f=a("encourage_config"),h=a("reward_helper"),g=a("i18n"),y=a("gaudio"),m=a("gnode"),b=a("ggame"),_=a("gview_model"),v=a("local_checkin_beginner"),C=a("vm_reward"),P=a("checkin_beginner_day_icon_ui"),S=(G=cc._decorator).ccclass,G=(a=G.property,G.menu);function M(){var t=null!==c&&c.apply(this,arguments)||this;return t.buttonClose=null,t.nodeIcon=[],t.nodeSelect=null,t.nodeNearestRewardAd=[],t.nodeCheckedIn=null,t.nodePast=null,t.nodeFuture=null,t.nodeToday=null,t.labelDay=null,t.spriteRewardIcon=null,t.labelReward=null,t.labelConfirm=null,t.buttonConfirm=null,t.buttonADConfirm=null,t.buttonADPatchDouble=null,t.labelTip=null,t.iconUI=[],t._finishCallback=null,t.encourageIconUI=null,t.patchEncourageIconUI=null,t}r(M,c=cc.Component),M.prototype.init=function(t){this._finishCallback=t},M.prototype.onLoad=function(){var t=this;if(this.buttonConfirm&&this.buttonConfirm.node.on("click",function(){y.sGAudio.playEffect(d.sAudioConfig.config.buttonClick);var e=b.sGGame.localModel.getModule(v.default).checkIn(!1);e.errorCode===v.eLocalCheckinError.ok&&_.sGViewModel.getModule(C.VMReward).openRewardResult(e.rewardResult.rewardList,function(){t._onClose()})}),this.buttonADConfirm&&this.buttonADConfirm.node.on("click",function(){t.onAdConfirmClick()}),this.buttonADPatchDouble&&this.buttonADPatchDouble.node.on("click",function(){t.onAdPatchDoubleClick()}),this.nodeIcon)for(var e=this,o=0;o<this.nodeIcon.length;++o)!function(o){var i=e.nodeIcon[o],a=void 0;(a=i?m.sGNode.addUniqueComponent(i,P.default):a)&&a.init(o+1,function(){t._select(o+1)}),e.iconUI.push(a)}(o);this.buttonClose&&this.buttonClose.node.on("click",function(){y.sGAudio.playEffect(d.sAudioConfig.config.buttonClose),t._onClose()})},M.prototype._onClose=function(){m.sGNode.destoryNode(this.node),this._finishCallback&&this._finishCallback()},M.prototype.onEnable=function(){this._refresh(),y.sGAudio.playEffect(d.sAudioConfig.config.popUI)},M.prototype.onDisable=function(){m.sGNode.targetOff(this)},M.prototype._refresh=function(){if(this.encourageType=_.sGViewModel.getModule(u.VMEncourage).preEncourage(f.sEncourageConfig.config.checkinDouble),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType),this.patchEncourageType=_.sGViewModel.getModule(u.VMEncourage).preEncourage(f.sEncourageConfig.config.patchDoubleCheckInReward),this.patchEncourageIconUI&&this.patchEncourageIconUI.setEncourageType(this.patchEncourageType),this.iconUI)for(var t=0;t<this.iconUI.length;++t){var e=this.iconUI[t];e&&e.refresh()}var o=b.sGGame.localModel.getModule(v.default).getCurrentDay();if(this._select(o),this.nodeNearestRewardAd){var i,a=-1,n=-1;for(t=0;t<this.nodeNearestRewardAd.length;++t)if((i=this.nodeNearestRewardAd[t])&&o<=(n=t)){a=t;break}for(-1===a&&(a=n),t=0;t<this.nodeNearestRewardAd.length;++t)(i=this.nodeNearestRewardAd[t])&&(i.active=t===a)}this.labelTip&&(this.labelTip.string=b.sGGame.localModel.getModule(v.default).checkTodayChecked()===v.eLocalCheckinError.ok?g.i18n.t("checkin.notCheckinToday"):g.i18n.t("checkin.checkedinToday"))},M.prototype._select=function(t){var e,o,i,a,n;this.day!==t&&(this.day=t,e=(n=b.sGGame.localModel.getModule(v.default)).getCurrentDay(),o=n.getDayForChecked(),i=p.sCheckinBeginnerConfig.getEntry(t),a=n.checkTodayChecked()===v.eLocalCheckinError.ok,n=n.checkPatchDoubleReward(t)===v.eLocalCheckinError.ok,this.buttonConfirm&&(this.buttonConfirm.node.active=o<t,this.buttonConfirm.node.active&&(this.buttonConfirm.interactable=t==e&&a)),this.buttonADConfirm&&(this.buttonADConfirm.node.active=o<t,this.buttonADConfirm.node.active&&(this.buttonADConfirm.interactable=t==e&&a)),this.buttonADPatchDouble&&(this.buttonADPatchDouble.node.active=t<=o,this.buttonADPatchDouble.node.active&&(this.buttonADPatchDouble.interactable=n)),this.labelConfirm&&(this.labelConfirm.string=t<=o?g.i18n.t("checkin.alreadyCheckedin"):g.i18n.t("checkin.checkin")),this.iconUI&&this.nodeSelect&&(n=this.iconUI[t-1])&&(n=m.sGNode.convertToWorldSpaceAR(n.node,cc.Vec2.ZERO),this.nodeSelect.setPosition(m.sGNode.convertToNodeSpaceAR(this.nodeSelect.parent,n))),this.nodeCheckedIn&&(this.nodeCheckedIn.active=t<=o),this.nodePast&&(this.nodePast.active=t<e),this.nodeFuture&&(this.nodeFuture.active=e<t),this.nodeToday&&(this.nodeToday.active=t===e),this.labelDay&&(this.labelDay.string=g.i18n.t("checkin.currentDayReward").replace("${value}",t.toString())),t=h.RewardList.createFromString(i.reward).getReward(0),this.labelReward&&(this.labelReward.string=g.i18n.t(i.name).replace("${value}",t.count.toString())),this.spriteRewardIcon&&m.sGNode.setSprite(this.spriteRewardIcon,i.icon,this))},M.prototype.onAdConfirmClick=function(){var t=this;y.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),_.sGViewModel.getModule(u.VMEncourage).encourage(f.sEncourageConfig.config.checkinDouble,this.encourageType,function(){var e=b.sGGame.localModel.getModule(v.default).checkIn(!0);e.errorCode===v.eLocalCheckinError.ok&&_.sGViewModel.getModule(C.VMReward).openRewardResult(e.rewardResult.rewardList,function(){t._onClose()})})},M.prototype.onAdPatchDoubleClick=function(){var t=this;y.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),_.sGViewModel.getModule(u.VMEncourage).encourage(f.sEncourageConfig.config.patchDoubleCheckInReward,this.patchEncourageType,function(){var e=b.sGGame.localModel.getModule(v.default).patchDoubleReward(t.day);e.errorCode===v.eLocalCheckinError.ok&&_.sGViewModel.getModule(C.VMReward).openRewardResult(e.rewardResult.rewardList,function(){t._onClose()})})},l([a(cc.Button)],M.prototype,"buttonClose",void 0),l([a(cc.Node)],M.prototype,"nodeIcon",void 0),l([a(cc.Node)],M.prototype,"nodeSelect",void 0),l([a(cc.Node)],M.prototype,"nodeNearestRewardAd",void 0),l([a(cc.Node)],M.prototype,"nodeCheckedIn",void 0),l([a(cc.Node)],M.prototype,"nodePast",void 0),l([a(cc.Node)],M.prototype,"nodeFuture",void 0),l([a(cc.Node)],M.prototype,"nodeToday",void 0),l([a(cc.Label)],M.prototype,"labelDay",void 0),l([a(cc.Sprite)],M.prototype,"spriteRewardIcon",void 0),l([a(cc.Label)],M.prototype,"labelReward",void 0),l([a(cc.Label)],M.prototype,"labelConfirm",void 0),l([a(cc.Button)],M.prototype,"buttonConfirm",void 0),l([a(cc.Button)],M.prototype,"buttonADConfirm",void 0),l([a(cc.Button)],M.prototype,"buttonADPatchDouble",void 0),l([a(cc.Label)],M.prototype,"labelTip",void 0),l([a(s.default)],M.prototype,"encourageIconUI",void 0),l([a(s.default)],M.prototype,"patchEncourageIconUI",void 0),G=l([S,G("Game/Checkin/CheckinBeginnerUI")],M),n.default=G,cc._RF.pop()},{}],checkin_button:[function(t,e,o){"use strict";cc._RF.push(e,"40d2bta9ZNG2KBNQpIjv6dy","checkin_button");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reddot"),u=a("gnode"),d=a("gview_model"),p=a("vm_check_in"),f=(h=cc._decorator).ccclass,h=(a=h.property,h.menu);function g(){var t=null!==c&&c.apply(this,arguments)||this;return t.nodeButton=null,t._totalDt=0,t}r(g,c=cc.Component),g.prototype.onLoad=function(){var t=this;this.nodeButton||(this.nodeButton=this.node),this.nodeButton.on("click",function(){d.sGViewModel.getModule(p.VMCheckIn).openCheckInUI(t)}),u.sGNode.addUniqueComponent(this.nodeButton,s.default).init(function(){return d.sGViewModel.getModule(p.VMCheckIn).hasAnythingToDo()})},g.prototype.onEnable=function(){this.nodeButton&&(this.nodeButton.active=this._canShow())},g.prototype.update=function(t){this._totalDt+=t,1<=this._totalDt&&(this._totalDt=0,this.nodeButton&&!this.nodeButton.active&&(this.nodeButton.active=this._canShow()))},g.prototype._canShow=function(){return d.sGViewModel.getModule(p.VMCheckIn).canShowButton()},l([a({type:cc.Node,tooltip:"\u6309\u94ae\u8282\u70b9"})],g.prototype,"nodeButton",void 0),h=l([f,h("Game/Checkin/CheckinButton")],g),n.default=h,cc._RF.pop()},{}],client_template:[function(t,e,o){"use strict";cc._RF.push(e,"7dc68xJT3FENr6zMOPlidoF","client_template");var i,a=t,n=e,r=o;function l(){this.oid=0,this.name="",this.sex=0,this.headURL="",this.createTime="",this.loginTime="",this.logoutTime="",this.silencedTime="",this.topStageLevel=0}i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},n=function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},Object.defineProperty(r,"__esModule",{value:!0}),r.ClientTemplate=r.PlayerTemplateRecord=void 0;var c,s=a("ggame_data");function u(){var t=null!==c&&c.apply(this,arguments)||this;return t.clientModel=null,t}a=a("gmodule"),r.PlayerTemplateRecord=l,n(u,c=a.GModule),u.prototype.init=function(t){s.sGGameData.addTable(s.sGGameDataType.remote,"playerTemplate",new l),this.clientModel=t},u.prototype.getData=function(){return this.clientModel.remoteData.info},n=u,r.ClientTemplate=n,cc._RF.pop()},{}],currency_reward_ui:[function(t,e,o){"use strict";cc._RF.push(e,"f5c48jvPnJMBLXrArNYitGC","currency_reward_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("reward_helper"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_reward"),b=a("reason_define"),_=a("vm_reward"),v=(C=cc._decorator).ccclass,C=(a=C.property,C.menu);function P(){var t=null!==c&&c.apply(this,arguments)||this;return t.iconSprite=null,t.nameLabel=null,t.countLabel=null,t.closeButton=null,t.fullScreenCloseButton=null,t.moreEncourageIconUI=null,t.moreButton=null,t}r(P,c=cc.Component),P.prototype.init=function(t,e,o){this.reward=t,this.closeCallback=o,this.encourageEntry=e},P.prototype.onLoad=function(){var t=this;this.closeButton&&this.closeButton.node.on("click",this.onClickClose.bind(this)),this.fullScreenCloseButton&&this.fullScreenCloseButton.node.on("click",this.onClickClose.bind(this)),this.moreButton&&this.moreButton.node.on("click",function(){f.sGAudio.playEffect(d.sAudioConfig.config.reward),y.sGViewModel.getModule(u.VMEncourage).encourage(t.encourageEntry,t.encourageType,function(){var e=new p.RewardList;e.add(t.reward.type,t.reward.id,t.reward.count,t.reward.extend),g.sGGame.localModel.getModule(m.LocalReward).takeRewardList(e,!0,2,b.eReasonType.moreQuestTokenReward),e.multiply(3),e=e.getReward(0),t.countLabel&&(t.countLabel.string=y.sGViewModel.getModule(_.VMReward).getCount(e.type,e.count)),t.moreButton&&(t.moreButton.node.active=!1),t.fullScreenCloseButton&&(t.fullScreenCloseButton.node.active=!0)})})},P.prototype.update=function(){},P.prototype.onEnable=function(){f.sGAudio.playEffect(d.sAudioConfig.config.reward),this.encourageEntry&&(this.encourageType=y.sGViewModel.getModule(u.VMEncourage).preEncourage(this.encourageEntry)),this._refresh()},P.prototype.onDisable=function(){h.sGNode.targetOff(this)},P.prototype._refresh=function(){var t=y.sGViewModel.getModule(_.VMReward);this.iconSprite&&h.sGNode.setSprite(this.iconSprite,t.getIcon(this.reward.type,this.reward.id,_.eIconType.frameIcon)),this.nameLabel&&(this.nameLabel.string=t.getName(this.reward.type,this.reward.id)),this.countLabel&&(this.countLabel.string=t.getCount(this.reward.type,this.reward.count)),this.moreButton&&(this.moreButton.node.active=!!this.encourageEntry),this.fullScreenCloseButton&&(this.fullScreenCloseButton.node.active=!this.moreButton||!this.moreButton.node.active),this.moreEncourageIconUI&&void 0!==this.encourageType&&this.moreEncourageIconUI.setEncourageType(this.encourageType)},P.prototype.onClickClose=function(){f.sGAudio.playEffect(d.sAudioConfig.config.reward),this.closeCallback&&this.closeCallback(),h.sGNode.destoryNode(this.node)},l([a(cc.Sprite)],P.prototype,"iconSprite",void 0),l([a(cc.Label)],P.prototype,"nameLabel",void 0),l([a(cc.Label)],P.prototype,"countLabel",void 0),l([a(cc.Button)],P.prototype,"closeButton",void 0),l([a(cc.Button)],P.prototype,"fullScreenCloseButton",void 0),l([a(s.default)],P.prototype,"moreEncourageIconUI",void 0),l([a(cc.Button)],P.prototype,"moreButton",void 0),C=l([v,C("Game/Reward/CurrencyRewardUI")],P),n.default=C,cc._RF.pop()},{}],currency_ui:[function(t,e,o){"use strict";cc._RF.push(e,"29c0d+xSOdElLjiEYRb3xlD","currency_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("client_config"),u=a("scroll_number"),d=a("gnode"),p=a("ggame"),f=a("local_battle"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.goldLabel=null,t.expLabel=null,t.scrollNumberGold=null,t.scrollNumberExp=null,t._localBattle=null,t}r(y,c=cc.Component),y.prototype.onLoad=function(){},y.prototype.onEnable=function(){var t=this;this._localBattle=p.sGGame.localModel.getModule(f.LocalBattle),this.goldLabel&&(this.scrollNumberGold=d.sGNode.addUniqueComponent(this.goldLabel.node,u.default)),this.expLabel&&(this.scrollNumberExp=d.sGNode.addUniqueComponent(this.expLabel.node,u.default)),p.sGGame.on(f.sLocalBattleEvent.goldChanged,function(){t._refreshCurrency(!0)},this),this._refreshCurrency(),s.sClientConfig.config.devMode&&this.goldLabel&&this.goldLabel.node.parent.on(cc.Node.EventType.TOUCH_START,function(){t._localBattle.addGold(1e4)},this)},y.prototype.onDisable=function(){p.sGGame.targetOff(this),d.sGNode.targetOff(this),this.goldLabel&&this.goldLabel.node.parent.targetOff(this)},y.prototype._refreshCurrency=function(t){this.scrollNumberGold&&this.scrollNumberGold.setNumber(this._localBattle.gold,t),this.scrollNumberExp&&this.scrollNumberExp.setNumber(0,t)},l([a(cc.Label)],y.prototype,"goldLabel",void 0),l([a(cc.Label)],y.prototype,"expLabel",void 0),g=l([h,g("Game/UI/CurrencyUI")],y),n.default=g,cc._RF.pop()},{}],double_collect_button_root:[function(t,e,o){"use strict";cc._RF.push(e,"49f64PjLrhMTrv0i+jMFrGd","double_collect_button_root");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("vm_ui"),u=a("audio_config"),d=a("const_config"),p=a("i18n"),f=a("gaudio"),h=a("gnode"),g=a("gtime"),y=a("ggame"),m=a("gview_model"),b=a("local_building"),_=a("local_stage"),v=a("vm_building"),C=(P=cc._decorator).ccclass,P=(a=P.property,P.menu);function S(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t.hasBuffTipButton=null,t.hasBuffNode=null,t.remainTimeLabel=null,t._totalDt=0,t}r(S,c=cc.Component),S.prototype.onLoad=function(){var t=this;this.button&&this.button.node.on("click",function(){f.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),m.sGViewModel.getModule(v.VMBuilding).openDoubleCollectUI(void 0,t)}),this.hasBuffTipButton&&this.hasBuffTipButton.node.on("click",function(){f.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),m.sGViewModel.getModule(s.VMUI).addMessageTip(p.i18n.t("tips.doubleCollectInUsing"))})},S.prototype.onEnable=function(){this.refresh()},S.prototype.onDisable=function(){y.sGGame.targetOff(this),h.sGNode.targetOff(this)},S.prototype.update=function(t){this._totalDt+=t,.3<=this._totalDt&&(this._totalDt=0,this.refresh())},S.prototype.refresh=function(){var t=y.sGGame.localModel.getModule(b.LocalBuildingPackage).getDoubleCollectRemainTime(),e=y.sGGame.localModel.getModule(_.LocalStage).isSystemIsOpened(d.sConstConfig.config.checkInPopUnlockStage),o=e&&t<=0;this.button&&this.button.node&&this.button.node.active!=o&&(this.button.node.active=o),this.button&&(this.button.node.parent.active=e),this.remainTimeLabel&&(t=Math.floor(t/1e3),this.remainTimeLabel.string=g.sGTime.toTimeSpanString(t)),o=e&&0<t,this.hasBuffNode&&this.hasBuffNode.active!=o&&(this.hasBuffNode.active=o)},l([a(cc.Button)],S.prototype,"button",void 0),l([a(cc.Button)],S.prototype,"hasBuffTipButton",void 0),l([a(cc.Node)],S.prototype,"hasBuffNode",void 0),l([a(cc.Label)],S.prototype,"remainTimeLabel",void 0),P=l([C,P("Game/Building/DoubleCollectButtonRoot")],S),n.default=P,cc._RF.pop()},{}],double_collect_ui:[function(t,e,o){"use strict";cc._RF.push(e,"5606fTqWW5MTIRksTcLZ5cy","double_collect_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("encourage_config"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_building"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu);function v(){var t=null!==c&&c.apply(this,arguments)||this;return t.encourageIconUI=null,t.encourageType=u.eEncourageType.closed,t}r(v,c=cc.Component),v.prototype.onLoad=function(){},v.prototype.onEnable=function(){this.encourageType=y.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.doubleCollect),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType),f.sGAudio.playEffect(d.sAudioConfig.config.popUI)},v.prototype.onDisable=function(){g.sGGame.targetOff(this),h.sGNode.targetOff(this)},v.prototype.onAdConfirmClick=function(){var t=this;f.sGAudio.playEffect(d.sAudioConfig.config.buttonClick);var e=y.sGViewModel.getModule(u.VMEncourage),o=g.sGGame.localModel.getModule(m.LocalBuildingPackage);e.encourage(p.sEncourageConfig.config.doubleCollect,this.encourageType,function(){o.setDoubleCollectByAD(),t.callback&&t.callback(!0),h.sGNode.destoryNode(t.node)})},v.prototype.onCloseButtonClick=function(){f.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),this.callback&&this.callback(!1),h.sGNode.destoryNode(this.node)},l([a(s.default)],v.prototype,"encourageIconUI",void 0),_=l([b,_("Game/Building/DoubleCollectUI")],v),n.default=_,cc._RF.pop()},{}],encourage_close_button_ui:[function(t,e,o){"use strict";cc._RF.push(e,"3b806BlcmJLDbhleW2bk7qP","encourage_close_button_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var s,u=a("client_config");function d(){var t=null!==s&&s.apply(this,arguments)||this;return t.buttonClose=null,t._totalDt=0,t}a=(n=cc._decorator).ccclass,n=n.property,l(d,s=cc.Component),d.prototype.init=function(t){this.buttonClose=t,this.node.activeInHierarchy&&this._initButtonClose()},d.prototype.onLoad=function(){},d.prototype.onEnable=function(){this._initButtonClose()},d.prototype._initButtonClose=function(){this.buttonClose&&(this.buttonClose.node.active=u.sClientConfig.config.buttonCloseInEncourageUIDelayShowTime<=0)},d.prototype.update=function(t){this.buttonClose&&!this.buttonClose.node.active&&(this._totalDt+=t,this._totalDt>=u.sClientConfig.config.buttonCloseInEncourageUIDelayShowTime&&(this.buttonClose.node.active=!0))},c([n(cc.Button)],d.prototype,"buttonClose",void 0),a=c([a],d),r.default=a,cc._RF.pop()},{}],fuben_battle_monitor_ui:[function(t,e,o){"use strict";cc._RF.push(e,"e5c9c31kpxD7ZLdnyGq28uF","fuben_battle_monitor_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("age_config"),u=a("fuben_config"),d=a("scroll_process_bar"),p=a("i18n"),f=a("glog"),h=a("gnode"),g=a("gtime"),y=a("ggame"),m=a("gview_model"),b=a("local_battle"),_=a("local_fuben"),v=a("vm_battle"),C=a("vm_building"),P=a("battle_manager"),S=a("battle_soldier_progress_tip_ui"),G=a("soldier"),M=(w=cc._decorator).ccclass,w=(a=w.property,w.menu);function A(){var t=null!==c&&c.apply(this,arguments)||this;return t.playerProgressBar=null,t.enemyProgressBar=null,t.battleNode=null,t.battleFubenLabel=null,t.battleTimeLabel=null,t.battleSoldierCountLabel=null,t.speedx1Button=null,t.speedx2Button=null,t.battleBGRoot=null,t.battleUIRoot=null,t.soldierProgressTipRoot=null,t.soldierProgressTipPrefab=null,t.battleBGNode=null,t.barLength=0,t.isFinished=!1,t.totalDt=0,t.battleSoldierProgressTipUIDic={},t}r(A,c=cc.Component),A.prototype.onLoad=function(){var t=this;this.localBattle=y.sGGame.localModel.getModule(b.LocalBattle),this.playerProgressBar&&(this.playerScrollProgressBar=h.sGNode.addUniqueComponent(this.playerProgressBar.node,d.default),this.barLength=this.playerProgressBar.totalLength),this.enemyProgressBar&&(this.enemyScrollProgressBar=h.sGNode.addUniqueComponent(this.enemyProgressBar.node,d.default)),this.speedx1Button&&this.speedx1Button.node.on("click",function(){t.setSpeed(1)}),this.speedx2Button&&this.speedx2Button.node.on("click",function(){var e=t.localBattle.getDoubleSpeedRemainEffectiveTime();0==e?(t.localBattle.pause(),m.sGViewModel.getModule(C.VMBuilding).openDoubleCollectUI(function(e){y.sGGame.localModel.getModule(b.LocalBattle).resume(),e&&(t.localBattle.effectDoubleSpeed(),t.setSpeed(1.6))},t)):(f.sGLog.info("doubleSpeedRemainEffectiveTime:",g.sGTime.toTimeSpanString(e/1e3)),t.setSpeed(1.6))})},A.prototype.onEnable=function(){var t=this;this._refresh();var e=y.sGGame.localModel.getModule(_.LocalFuben),o=e.getCurrentBattleFubenID(e.currentBattleFubenType),i=u.sFubenConfig.getEntry(o);this.battleFubenLabel&&(e=p.i18n.t("fuben.name"),o=u.sFubenConfig.getEntry(o),e=e.replace("${value}",o.name.toString()),this.battleFubenLabel.string=e),y.sGGame.on(b.sLocalBattleEvent.activeDoubleSpeed,function(){t.refreshSpeed()},this),this.battleBGRoot&&(i=i.age,i=s.sAgeConfig.getEntry(i),h.sGNode.createNode(i.battleBackground,function(e){t.battleBGNode=e,t.battleBGNode.parent=t.battleBGRoot},this)),this.refreshSpeed(),h.sGNode.createNode("prefabs/ui/battle_buff_status",this.battleUIRoot,function(e){e&&(e.active=!t.localBattle.battleFinish)},this),y.sGGame.on(b.sLocalBattleEvent.finished,this.onBattleFinished.bind(this),this),this.initSoldierProgress()},A.prototype.onBattleFinished=function(){this.battleUIRoot&&(this.battleUIRoot.active=!1)},A.prototype.onDisable=function(){h.sGNode.targetOff(this),y.sGGame.targetOff(this),this.battleBGNode&&(h.sGNode.destoryNode(this.battleBGNode),this.battleBGNode=null)},A.prototype.update=function(t){this._refresh(),this.totalDt+=t,1<=this.totalDt&&(this.totalDt=0,1<this.localBattle.battleTimeScale&&this.localBattle.getDoubleSpeedRemainEffectiveTime()<=0&&this.setSpeed(1))},A.prototype.setSpeed=function(t){this.localBattle.battleTimeScale=t,this.refreshSpeed()},A.prototype.refreshSpeed=function(){var t=this.localBattle.battleTimeScale;this.speedx1Button&&(this.speedx1Button.node.active=1!==t&&this.localBattle.doubleSpeedEnabled),this.speedx2Button&&(this.speedx2Button.node.active=1.6!==t&&this.localBattle.doubleSpeedEnabled)},A.prototype._refresh=function(){var t,e,o,i,a,n=m.sGViewModel.getModule(v.VMBattle);n.battleManager?(t=n.battleManager.getFirstSoldier(b.enumTeam.player),e=n.battleManager.getFirstSoldier(b.enumTeam.enemy),o=(o=t&&t.attackState!==G.enumSoldierAttackState.idle)||e&&e.attackState!==G.enumSoldierAttackState.idle,i=-this.barLength/2,t?(i+=(a=Math.abs(t.node.getPosition().sub(n.battleManager.spawnPositionOfPlayer).x))/n.battleManager.totalLength*this.barLength,this.playerScrollProgressBar&&this.playerScrollProgressBar.setProgress(a/n.battleManager.totalLength)):this.playerScrollProgressBar&&this.playerScrollProgressBar.setProgress(0),e?(a=Math.abs(e.node.getPosition().sub(n.battleManager.spawnPositionOfEnemy).x),this.enemyScrollProgressBar&&this.enemyScrollProgressBar.setProgress(a/n.battleManager.totalLength)):this.enemyScrollProgressBar&&this.enemyScrollProgressBar.setProgress(0),this.battleNode&&(this.battleNode.x=i,this.battleNode.active=o),this.battleTimeLabel&&(this.battleTimeLabel.string=g.sGTime.toTimeSpanString(n.battleManager.passTime)),this.battleSoldierCountLabel&&(this.battleSoldierCountLabel.string="0/0"),this.refreshSoldierProgress()):(this.playerScrollProgressBar&&this.playerScrollProgressBar.setProgress(0),this.enemyScrollProgressBar&&this.enemyScrollProgressBar.setProgress(0))},A.prototype.initSoldierProgress=function(){var t=this;y.sGGame.on(P.sBattleManagerEvent.destroySoldier,function(e){var o=t.battleSoldierProgressTipUIDic[e.unit.unitID];o&&(h.sGNode.destoryNode(o.node),delete t.battleSoldierProgressTipUIDic[e.unit.unitID])},this)},A.prototype.refreshSoldierProgress=function(){if(this.soldierProgressTipRoot&&this.soldierProgressTipPrefab){var t=m.sGViewModel.getModule(v.VMBattle);if(t.battleManager){for(var e in t.battleManager.playerSoldierDic)this.refreshSoldierProgressTip(t.battleManager.playerSoldierDic[e]);for(var e in t.battleManager.enemySoldierDic)this.refreshSoldierProgressTip(t.battleManager.enemySoldierDic[e])}}},A.prototype.refreshSoldierProgressTip=function(t){var e,o=m.sGViewModel.getModule(v.VMBattle),i=this.battleSoldierProgressTipUIDic[t.unit.unitID];i||(e=cc.instantiate(this.soldierProgressTipPrefab))&&((i=e.getComponent(S.default))&&(i.init(t),this.battleSoldierProgressTipUIDic[t.unit.unitID]=i),this.soldierProgressTipRoot.addChild(e)),o=(t.unit.teamID===b.enumTeam.player?Math.abs(t.node.getPosition().sub(o.battleManager.spawnPositionOfPlayer).x):Math.abs(t.node.getPosition().sub(o.battleManager.spawnPositionOfEnemy).x))/o.battleManager.totalLength*this.playerScrollProgressBar.progressbar.totalLength,t.unit.teamID===b.enumTeam.player?i.node.x=o:i.node.x=this.soldierProgressTipRoot.getContentSize().width-o},l([a(cc.ProgressBar)],A.prototype,"playerProgressBar",void 0),l([a(cc.ProgressBar)],A.prototype,"enemyProgressBar",void 0),l([a(cc.Node)],A.prototype,"battleNode",void 0),l([a(cc.Label)],A.prototype,"battleFubenLabel",void 0),l([a(cc.Label)],A.prototype,"battleTimeLabel",void 0),l([a(cc.Label)],A.prototype,"battleSoldierCountLabel",void 0),l([a({type:cc.Button,tooltip:"1\u500d\u901f"})],A.prototype,"speedx1Button",void 0),l([a({type:cc.Button,tooltip:"2\u500d\u901f"})],A.prototype,"speedx2Button",void 0),l([a(cc.Node)],A.prototype,"battleBGRoot",void 0),l([a(cc.Node)],A.prototype,"battleUIRoot",void 0),l([a({displayName:"\u58eb\u5175\u8fdb\u5ea6\u6302\u8282\u70b9",type:cc.Node})],A.prototype,"soldierProgressTipRoot",void 0),l([a({displayName:"\u58eb\u5175\u8fdb\u5ea6\u5c55\u793a\u9884\u5236\u4ef6",type:cc.Prefab})],A.prototype,"soldierProgressTipPrefab",void 0),w=l([M,w("Game/Fuben/FubenBattleMonitorUI")],A),n.default=w,cc._RF.pop()},{}],fuben_button_root_ui:[function(t,e,o){"use strict";cc._RF.push(e,"c78a4O6vmlFBbVrVej5kIDd","fuben_button_root_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reddot"),u=a("audio_config"),d=a("gui"),p=a("gaudio"),f=a("ggame"),h=a("gview_model"),g=a("local_fuben"),y=a("vm_battle"),m=(b=cc._decorator).ccclass,b=(a=b.property,b.menu);function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t}r(_,c=cc.Component),_.prototype.onLoad=function(){this.button&&(this.button.node.on("click",this.onOpenButtonClick.bind(this)),this.button.addComponent(s.default).init(function(){return h.sGViewModel.getModule(y.VMBattle).hasFubenAnythingToDo()}))},_.prototype.onEnable=function(){this.refresh()},_.prototype.onDisable=function(){f.sGGame.targetOff(this)},_.prototype.onOpenButtonClick=function(){p.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),d.sGUI.openDialogUI("prefabs/ui/fb_bottom")},_.prototype.refresh=function(){this.button&&(this.button.node.active=h.sGViewModel.getModule(y.VMBattle).isFubneOpened(g.enumFubenType.fuben1))},l([a(cc.Button)],_.prototype,"button",void 0),b=l([m,b("Game/Fuben/FubenButtonRootUI")],_),n.default=b,cc._RF.pop()},{}],fuben_main_type_ui:[function(t,e,o){"use strict";cc._RF.push(e,"35888dC4dFLQpnU/vWAMhM4","fuben_main_type_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("encourage_config"),f=a("fuben_config"),h=a("stage_config"),g=a("i18n"),y=a("gaudio"),m=a("ggame"),b=a("gview_model"),_=a("local_fuben"),v=a("local_stage"),C=a("vm_battle"),P=a("vm_reward"),S=(G=cc._decorator).ccclass,G=(a=G.property,G.menu);function M(){var t=null!==c&&c.apply(this,arguments)||this;return t.sweepButton=null,t.challengeButton=null,t.currentLabel=null,t.sweepTimesLabel=null,t.fubenType=_.enumFubenType.fuben1,t.lockNode=null,t.challengeConditionLabel=null,t.challengeNode=null,t.emptySweepTimesNode=null,t.encourageRoot=null,t.encourageIconUI=null,t.encourageType=u.eEncourageType.closed,t}r(M,c=cc.Component),M.prototype.onLoad=function(){var t=this;this.localFuben=m.sGGame.localModel.getModule(_.LocalFuben),this.sweepButton&&this.sweepButton.node.on("click",function(){0===t.localFuben.checkFreeSweep(t.fubenType)?(t.localFuben.freeSweep(t.fubenType),b.sGViewModel.getModule(P.VMReward).openRewardResult(t.localFuben.rewardList),t._refresh()):0===t.localFuben.checkADSweep(t.fubenType)&&b.sGViewModel.getModule(u.VMEncourage).encourage(t.encourageEntry,t.encourageType,function(){t.localFuben.adSweep(t.fubenType),b.sGViewModel.getModule(P.VMReward).openRewardResult(t.localFuben.rewardList),t._refresh()})}),this.challengeButton&&this.challengeButton.node.on("click",function(){b.sGViewModel.getModule(C.VMBattle).enterBattleFuben(t.fubenType),y.sGAudio.playEffect(d.sAudioConfig.config.joinBattle)})},M.prototype.onEnable=function(){this.localFuben=m.sGGame.localModel.getModule(_.LocalFuben),y.sGAudio.playEffect(d.sAudioConfig.config.popUI),this._refresh()},M.prototype.onDisable=function(){m.sGGame.targetOff(this)},M.prototype._refresh=function(){var t=this.localFuben.getCurrentBattleFubenID(this.fubenType),e=f.sFubenConfig.getEntry(t),o=m.sGGame.localModel.getModule(v.LocalStage);this.currentLabel&&(i=(i=g.i18n.t("fuben.name")).replace("${value}",e.name.toString()),this.currentLabel.string=i);var i=this.localFuben.isSystemIsOpened(this.fubenType);o=o.isSystemIsOpened(e.condition),e=h.sStageConfig.getEntry(e.condition),this.lockNode&&(this.lockNode.active=!i),this.challengeButton&&(this.challengeButton.interactable=o&&this.localFuben.getCurrentBattleFubenID(this.fubenType)!==this.localFuben.getLastPassedFubenID(this.fubenType)),this.challengeConditionLabel&&(this.challengeConditionLabel.node.active=!o,o||(this.challengeConditionLabel.string=g.i18n.t("tips.stageUnlock").replace("${value}",e.name))),this.challengeNode&&(this.challengeNode.active=o),e=i&&t!==this.localFuben.fubenStartIDArray[this.fubenType],t=(o=this.localFuben.getFreeSweepTimes(this.fubenType))+(i=this.localFuben.getADSweepTimes(this.fubenType)),this.sweepTimesLabel&&(this.sweepTimesLabel.node.parent.active=e&&0<t),this.emptySweepTimesNode&&(this.emptySweepTimesNode.active=e&&t<=0),this.sweepButton&&(this.sweepButton.node.active=e,this.sweepButton.node.active&&(this.sweepTimesLabel&&(this.sweepTimesLabel.string=t.toString()),0<o?(this.sweepButton&&(this.sweepButton.interactable=!0),this.encourageRoot&&(this.encourageRoot.active=!1)):0==o&&0<i?(this.sweepButton&&(this.sweepButton.interactable=!0),this.fubenType==_.enumFubenType.fuben1?this.encourageEntry=p.sEncourageConfig.config.fuben1Sweep:this.encourageEntry=p.sEncourageConfig.config.fuben2Sweep,this.encourageType=b.sGViewModel.getModule(u.VMEncourage).preEncourage(this.encourageEntry),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType),this.encourageRoot&&(this.encourageRoot.active=!0)):(this.sweepButton&&(this.sweepButton.interactable=!1),this.encourageRoot&&(this.encourageRoot.active=!1))))},l([a({type:cc.Button,tooltip:"\u626b\u8361"})],M.prototype,"sweepButton",void 0),l([a({type:cc.Button,tooltip:"\u6311\u6218"})],M.prototype,"challengeButton",void 0),l([a({type:cc.Label,tooltip:"\u5f53\u524d\u5c42\u6570"})],M.prototype,"currentLabel",void 0),l([a({type:cc.Label,tooltip:"\u626b\u8361\u6b21\u6570"})],M.prototype,"sweepTimesLabel",void 0),l([a({type:cc.Enum(_.enumFubenType),tooltip:"\u526f\u672c\u7c7b\u578b"})],M.prototype,"fubenType",void 0),l([a({type:cc.Node,tooltip:"\u9501\u5b9a\u754c\u9762"})],M.prototype,"lockNode",void 0),l([a({type:cc.Label,tooltip:"\u6311\u6218\u6761\u4ef6"})],M.prototype,"challengeConditionLabel",void 0),l([a({type:cc.Node,tooltip:"\u6ee1\u8db3\u6311\u6218\u663e\u793a\u7684\u8282\u70b9"})],M.prototype,"challengeNode",void 0),l([a({type:cc.Node,tooltip:"\u7a7a\u626b\u8361\u7684\u63d0\u793a"})],M.prototype,"emptySweepTimesNode",void 0),l([a(cc.Node)],M.prototype,"encourageRoot",void 0),l([a(s.default)],M.prototype,"encourageIconUI",void 0),G=l([S,G("Game/Fuben/FubenMainTypeUI")],M),n.default=G,cc._RF.pop()},{}],fuben_victory_ui:[function(t,e,o){"use strict";cc._RF.push(e,"1e284j2lNxBg6AWt5MBjfUs","fuben_victory_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("encourage_config"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_fuben"),b=a("vm_reward"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.rewardRoot=null,t.doubleFlagNode=null,t.closeButton=null,t.collectDoubleEncourageIconUI=null,t.collectDoubleButton=null,t.closeButton2=null,t.localFuben=null,t.encourageEntry=null,t}r(C,c=cc.Component),C.prototype.init=function(t){this.callback=t},C.prototype.onLoad=function(){var t=this;this.closeButton&&(this.closeButton.node.active=!0,this.closeButton.node.on("click",function(){f.sGAudio.playEffect(d.sAudioConfig.config.reward),g.sGGame.localModel.getModule(m.LocalFuben).collectReward(),t.callback&&t.callback()})),this.closeButton2&&(this.closeButton2.node.active=!1,this.closeButton2.node.on("click",function(){f.sGAudio.playEffect(d.sAudioConfig.config.reward),t.callback&&t.callback()})),this.collectDoubleButton&&this.collectDoubleButton.node.on("click",function(){y.sGViewModel.getModule(u.VMEncourage).encourage(t.encourageEntry,t._encourageType,function(){if(f.sGAudio.playEffect(d.sAudioConfig.config.reward),g.sGGame.localModel.getModule(m.LocalFuben).collectDoubleReward(),t.doubleFlagNode&&(t.doubleFlagNode.active=!0,cc.tween(t.doubleFlagNode).repeatForever(cc.tween().to(.5,{scale:1.2}).to(.5,{scale:1})).start()),t.rewardRoot)for(var e=t.localFuben.getRewardList(),o=y.sGViewModel.getModule(b.VMReward),i=0;i<t.rewardRoot.children.length;++i)!function(i){var a=t.rewardRoot.children[i],n=e.getReward(i),r=h.sGNode.findComponent(a,"Label_number",cc.Label);n&&r&&cc.tween(r.node).call(function(){r.string=o.getCount(n.type,2*n.count)}).set({scale:5}).to(.2,{scale:1}).delay(.5).call(function(){cc.tween(r.node).repeatForever(cc.tween().to(.5,{scale:1.2}).to(.5,{scale:1})).start()}).start()}(i)})})},C.prototype.onEnable=function(){var t=this;f.sGAudio.playEffect(d.sAudioConfig.config.victory),this.localFuben=g.sGGame.localModel.getModule(m.LocalFuben),this.localFuben.currentBattleFubenType===m.enumFubenType.fuben1?this.encourageEntry=p.sEncourageConfig.config.collectDoubleFuben1Reward:this.encourageEntry=p.sEncourageConfig.config.collectDoubleFuben2Reward,this._encourageType=y.sGViewModel.getModule(u.VMEncourage).preEncourage(this.encourageEntry),this.collectDoubleEncourageIconUI&&this.collectDoubleEncourageIconUI.setEncourageType(this._encourageType),g.sGGame.on(m.sLocalFubenEvent.collectDoubleReward,function(){t._collectAllFinish()},this),this._refresh()},C.prototype.onDisable=function(){g.sGGame.targetOff(this)},C.prototype._refresh=function(){if(this.rewardRoot)for(var t=this.localFuben.getRewardList(),e=y.sGViewModel.getModule(b.VMReward),o=0;o<this.rewardRoot.children.length;++o){var i=this.rewardRoot.children[o],a=t.getReward(o),n=h.sGNode.findComponent(i,"icon2",cc.Sprite),r=cc.find("main54",i),l=h.sGNode.findComponent(i,"Label_number",cc.Label),c=cc.find("quality_root",i);if(a){if(c)for(var s=1;s<=5;s++){var u=cc.find("quality"+s,c);u&&(u.active=s===e.getQuality(a.type,a.id))}r&&(r.active=e.isFragment(a.type)),n&&(r=e.getIcon(a.type,a.id),h.sGNode.setSprite(n,r)),l&&(l.string=e.getCount(a.type,a.count))}else i.active=!1}},C.prototype._collectAllFinish=function(){this.closeButton&&(this.closeButton.node.active=!1),this.closeButton2&&(this.closeButton2.node.active=!0),this.collectDoubleButton&&(this.collectDoubleButton.node.active=!1)},l([a({type:cc.Node,tooltip:"\u5f53\u524d\u5956\u52b1"})],C.prototype,"rewardRoot",void 0),l([a(cc.Node)],C.prototype,"doubleFlagNode",void 0),l([a(cc.Button)],C.prototype,"closeButton",void 0),l([a(s.default)],C.prototype,"collectDoubleEncourageIconUI",void 0),l([a(cc.Button)],C.prototype,"collectDoubleButton",void 0),l([a(cc.Button)],C.prototype,"closeButton2",void 0),v=l([_,v("Game/Fuben/FubenVictoryUI")],C),n.default=v,cc._RF.pop()},{}],game_currency_ui:[function(t,e,o){"use strict";cc._RF.push(e,"26e50Dmhb5BBpMm43xwe6sN","game_currency_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("local_currency"),u=a("client_config"),d=a("currency_config"),p=a("scroll_number"),f=a("gnode"),h=a("ggame"),g=a("local_action"),y=a("reason_define"),m=(b=cc._decorator).ccclass,b=(a=b.property,b.menu);function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.currencyActionLable=null,t.currencyCardUpgradeLable=null,t.currencyBuildingUpgradeLable=null,t.currencyPullCardLable=null,t.currencyQuestTokenLable=null,t.scrollNumberCurrencyAction=null,t.scrollNumberCurrencyTechUpgrade=null,t.scrollNumberCurrencyBuildingUpgrade=null,t.scrollNumberCurrencyPullCard=null,t.scrollNumberCurrencyQuestToken=null,t._localCurrency=null,t}r(_,c=cc.Component),_.prototype.onLoad=function(){},_.prototype.onEnable=function(){var t=this;this._localCurrency=h.sGGame.localModel.getModule(s.LocalCurrency),this.currencyActionLable&&(this.scrollNumberCurrencyAction=f.sGNode.addUniqueComponent(this.currencyActionLable.node,p.default)),this.currencyCardUpgradeLable&&(this.scrollNumberCurrencyTechUpgrade=f.sGNode.addUniqueComponent(this.currencyCardUpgradeLable.node,p.default)),this.currencyBuildingUpgradeLable&&(this.scrollNumberCurrencyBuildingUpgrade=f.sGNode.addUniqueComponent(this.currencyBuildingUpgradeLable.node,p.default)),this.currencyPullCardLable&&(this.scrollNumberCurrencyPullCard=f.sGNode.addUniqueComponent(this.currencyPullCardLable.node,p.default)),this.currencyQuestTokenLable&&(this.scrollNumberCurrencyQuestToken=f.sGNode.addUniqueComponent(this.currencyQuestTokenLable,p.default)),h.sGGame.on(s.sLocalCurrencyEvent.notifyChangedWhenLateUpdate,function(){t._refreshCurrency(!0)},this),this._refreshCurrency(),u.sClientConfig.config.devMode&&(this.currencyActionLable&&this.currencyActionLable.node.parent.on(cc.Node.EventType.TOUCH_START,function(){var t=10*(t=0===(t=h.sGGame.localModel.getModule(s.LocalCurrency).get(d.sCurrencyConfig.config.actionPoint))?1:t)-t;h.sGGame.localModel.getModule(s.LocalCurrency).add(d.sCurrencyConfig.config.actionPoint,t,y.eReasonType.test)}),this.currencyCardUpgradeLable&&this.currencyCardUpgradeLable.node.parent.on(cc.Node.EventType.TOUCH_START,function(){var t=10*(t=0===(t=h.sGGame.localModel.getModule(s.LocalCurrency).get(d.sCurrencyConfig.config.cardUpgradePoint))?1:t)-t;h.sGGame.localModel.getModule(s.LocalCurrency).add(d.sCurrencyConfig.config.cardUpgradePoint,t,y.eReasonType.test)}),this.currencyBuildingUpgradeLable&&this.currencyBuildingUpgradeLable.node.parent.on(cc.Node.EventType.TOUCH_START,function(){var t=10*(t=0===(t=h.sGGame.localModel.getModule(s.LocalCurrency).get(d.sCurrencyConfig.config.buildingUpgradePoint))?1:t)-t;h.sGGame.localModel.getModule(s.LocalCurrency).add(d.sCurrencyConfig.config.buildingUpgradePoint,t,y.eReasonType.test)}),this.currencyPullCardLable&&this.currencyPullCardLable.node.parent.on(cc.Node.EventType.TOUCH_START,function(){var t=10*(t=0===(t=h.sGGame.localModel.getModule(s.LocalCurrency).get(d.sCurrencyConfig.config.pullCardPoint))?1:t)-t;h.sGGame.localModel.getModule(s.LocalCurrency).add(d.sCurrencyConfig.config.pullCardPoint,t,y.eReasonType.test)}),this.currencyQuestTokenLable&&this.currencyQuestTokenLable.node.parent.on(cc.Node.EventType.TOUCH_START,function(){var t=10*(t=0===(t=h.sGGame.localModel.getModule(s.LocalCurrency).get(d.sCurrencyConfig.config.questToken))?1:t)-t;h.sGGame.localModel.getModule(s.LocalCurrency).add(d.sCurrencyConfig.config.questToken,t,y.eReasonType.test)}))},_.prototype.onDisable=function(){h.sGGame.targetOff(this),f.sGNode.targetOff(this)},_.prototype._refreshCurrency=function(t){this.scrollNumberCurrencyAction&&(this.scrollNumberCurrencyAction.suffix="/"+h.sGGame.localModel.getModule(g.LocalAction).getActionPointMax(),this.scrollNumberCurrencyAction.setNumber(this._localCurrency.get(d.sCurrencyConfig.config.actionPoint),t)),this.scrollNumberCurrencyTechUpgrade&&this.scrollNumberCurrencyTechUpgrade.setNumber(this._localCurrency.get(d.sCurrencyConfig.config.cardUpgradePoint),t),this.scrollNumberCurrencyBuildingUpgrade&&this.scrollNumberCurrencyBuildingUpgrade.setNumber(this._localCurrency.get(d.sCurrencyConfig.config.buildingUpgradePoint),t),this.scrollNumberCurrencyPullCard&&this.scrollNumberCurrencyPullCard.setNumber(this._localCurrency.get(d.sCurrencyConfig.config.pullCardPoint),t),this.scrollNumberCurrencyQuestToken&&this.scrollNumberCurrencyQuestToken.setNumber(this._localCurrency.get(d.sCurrencyConfig.config.questToken),t)},l([a(cc.Label)],_.prototype,"currencyActionLable",void 0),l([a(cc.Label)],_.prototype,"currencyCardUpgradeLable",void 0),l([a(cc.Label)],_.prototype,"currencyBuildingUpgradeLable",void 0),l([a(cc.Label)],_.prototype,"currencyPullCardLable",void 0),l([a(cc.Label)],_.prototype,"currencyQuestTokenLable",void 0),b=l([m,b("Game/UI/GameCurrencyUI")],_),n.default=b,cc._RF.pop()},{}],game_define:[function(t,e,o){"use strict";cc._RF.push(e,"db670LoKA1Hp4vdk3ZWHa2t","game_define");var i,a=o;function n(){}Object.defineProperty(a,"__esModule",{value:!0}),a.GameDefine=void 0,n.prefabMain="prefabs/ui/main",n.prefabResDebug="prefabs/common/res_debug",n.prefabBattleStage="prefabs/ui/battle",n.prefabBattlePata="prefabs/ui/battle_dungeon",n.prefabBattleFuben="prefabs/ui/battle_fb",n.prefabHero="prefabs/battle/battle_hero",n.prefabSoldier="prefabs/ui/battle_soldier",n.prefabBuildingBase="prefabs/ui/battle_building_base",n.prefabBuildingUnlock="prefabs/ui/building_unlock_pop",n.prefabBuildingUpgrade="prefabs/ui/building_upgrade_pop",n.prefabUpgradeAge="prefabs/ui/age_info_bottom",n.prefabSoldierCardInfoPop="prefabs/ui/card_hero_info_pop",n.prefabSkillCardInfoPop="prefabs/ui/card_info_pop",n.prefabBattleSkillStone="prefabs/bullet/battle_skill_stone",n.prefabBattleSkillArrow="prefabs/bullet/battle_skill_arrow",n.prefabBattleSkillMissile="prefabs/bullet/battle_skill_missile",n.prefabBattleSkillEarthquake="prefabs/bullet/battle_skill_earthquake",n.prefabBattleSkillTornado="prefabs/bullet/battle_skill_tornado",n.prefabBattleSkillStonecastn="prefabs/bullet/battle_skill_tonecastn",n.prefabBattleSkillPlane="prefabs/skill/skill_plane",n.prefabBattleSkillTank="prefabs/skill/skill_tank",n.prefabBattleSkillTsunami="prefabs/skill/skill_tsunami",n.prefabBattleSkillCannon="prefabs/skill/skill_cannon",n.prefabParticleStoneFire="prefabs/particle/battle_stone_fire",n.prefabParticleStoneBomb="prefabs/particle/battle_stone_bomb",n.prefabParticleStonecastnFire="prefabs/particle/battle_stonecastn_bomb_fire",n.prefabParticleStonecastnBomb="prefabs/particle/battle_stonecastn_bomb",n.prefabParticleBaseBomb="prefabs/particle/battle_base_bomb",n.prefabParticlePlaneMissileBomb="prefabs/particle/battle_missile_bomb",n.prefabPullCardReward="prefabs/ui/card_get_animation_bottom",n.prefabNormalCardReward="prefabs/ui/reward_get_animation_bottom",n.prefabNormalCardFragmentReward="prefabs/ui/get_fragment_anim_pop",n.prefabBattleSkillCardRemoveTip="prefabs/ui/battle_skill_icon_remove_tip",n.prefabCardReward10="prefabs/ui/get10_goods_pop",n.prefabCardSkillEquipUI="prefabs/ui/battle_select_skill_pop",n.prefabCardSoldierEquipUI="prefabs/ui/battle_select_card_pop",n.prefabCheckIn="prefabs/ui/sign_bottom2",n.prefabSlotMachine="prefabs/ui/slot_machine",n.prefabAdReward="prefabs/ui/ad_reward",n.prefabCurrencyReward="prefabs/ui/get_goods_pop",n.prefabBattleVictory="prefabs/ui/settlement_win",n.prefabBattleVictoryCard="prefabs/ui/settlement_win_cards_bottom",n.prefabBattleDefeat="prefabs/ui/settlement_fail",n.prefabBattleSweepResult="prefabs/ui/settlement_win_sd",n.prefabBattleBuff="prefabs/ui/battle_buff",n.prefabBattleSweep="prefabs/ui/battle_sd_tips",n.prefabBattleStart="prefabs/ui/battle_zd_tips",n.prefabOffline="prefabs/ui/come_back_gold_receive",n.prefabAgeUpgradeTip="prefabs/ui/age_advanced_tips_pop",n.prefabTreasureChestIcon="prefabs/ui/treasure_chest_root",n.prefabAgeUpgradePreEffect="prefabs/ui/age_upgrade_pre_effect",n.prefabAgeUpgradeEffect="prefabs/ui/age_upgrade_effect",n.filterSkillCardTypeArray=["all","disaster","tech","summon","totem"],n.filterSoldierCardTypeArray=["all","melee","range","air","magic"],n.battleExtendRewardTypeArray=["buildingUpgradePointOverTime","cardUpgradePoint","pullCardPoint","actionPoint"],n.uiTypeNodeNameDic={tz:"disaster",kj:"tech",zh:"summon",tt:"totem",jz:"melee",yc:"range",mf:"magic",fx:"air"},n.prefabCheckinAdDay="prefabs/ui/sign_ad_reward",n.battleSameCountForSkillToUse=2,n.battleSkillCardTotal=5,n.prefabQuest="prefabs/ui/task_bottom",n.prefabQuestMainPop="prefabs/ui/main_task_bottom_pop",n.prefabDoubleCollectUI="prefabs/ui/double_collect",n.teamColorArray=[cc.color(255,255,255),cc.color(10,126,255),cc.color(255,0,0)],i=n,a.GameDefine=i,cc._RF.pop()},{}],game_init:[function(t,e,o){"use strict";cc._RF.push(e,"9683c9RW5xBuaXsJENHZx+F","game_init");var i=t,a=o;Object.defineProperty(a,"__esModule",{value:!0});var n=i("vm_store"),r=i("glog"),l=i("ggame"),c=i("gview_model"),s=i("client_template"),u=i("local_action"),d=i("local_attribute"),p=i("local_battle"),f=i("local_stage"),h=i("local_benefits"),g=i("local_building"),y=i("local_card"),m=i("local_checkin_beginner"),b=i("local_check_in_7day"),_=i("local_check_in_daily"),v=i("local_config"),C=i("local_quest"),P=i("local_quest_achievement"),S=i("local_quest_daily"),G=i("local_quest_event"),M=i("local_quest_main"),w=i("local_quest_stage"),A=i("local_quest_stat"),B=i("local_reward"),R=i("local_reward_slot_machine"),k=i("local_skill"),T=i("local_soldier"),L=i("local_store"),D=i("local_tech"),O=i("local_template"),I=i("local_vip"),N=i("vm_attribute"),E=i("vm_audio"),j=i("vm_battle"),U=i("vm_benefit"),V=i("vm_building"),F=i("vm_card"),x=i("vm_channel"),q=i("vm_check_in"),Q=i("vm_check_in_7days"),H=i("vm_check_in_daily"),W=i("vm_game"),X=i("vm_game_guide"),Z=i("vm_notification"),z=i("vm_quest"),K=i("vm_reward"),J=i("vm_skill"),Y=i("vm_slot_machine"),$=i("vm_vip"),tt=i("local_battle_stage"),et=i("vm_game_recorder"),ot=i("local_battle_pata"),it=i("local_pata");a=i("local_battle_fuben"),i=i("local_fuben"),r.sGLog.log("game bundle script init"),c.sGViewModel.addModule(W.VMGame),c.sGViewModel.addModule(j.VMBattle),c.sGViewModel.addModule(E.VMAduio),c.sGViewModel.addModule(F.VMCard),c.sGViewModel.addModule(N.VMAttribute),c.sGViewModel.addModule(K.VMReward),c.sGViewModel.addModule(J.VMSkill),c.sGViewModel.addModule(q.VMCheckIn),c.sGViewModel.addModule(Q.VMCheckIn7Days),c.sGViewModel.addModule(H.VMCheckInDaily),c.sGViewModel.addModule(Y.VMSlotMachine),c.sGViewModel.addModule(X.VMGameGuide),c.sGViewModel.addModule($.VMVIP),c.sGViewModel.addModule(V.VMBuilding),c.sGViewModel.addModule(x.VMChannel),c.sGViewModel.addModule(Z.VMNotification),c.sGViewModel.addModule(z.VMQuest),c.sGViewModel.addModule(U.VMBenefit),c.sGViewModel.addModule(n.VMStore),c.sGViewModel.addModule(et.VMGameRecorder),l.sGGame.localModel.addModule(O.LocalTemplatePackage),l.sGGame.localModel.addModule(p.LocalBattle),l.sGGame.localModel.addModule(tt.LocalBattleStage),l.sGGame.localModel.addModule(f.LocalStage),l.sGGame.localModel.addModule(ot.LocalBattlePata),l.sGGame.localModel.addModule(it.LocalPata),l.sGGame.localModel.addModule(a.LocalBattleFuben),l.sGGame.localModel.addModule(i.LocalFuben),l.sGGame.localModel.addModule(v.LocalConfig),l.sGGame.localModel.addModule(d.LocalAttribute),l.sGGame.localModel.addModule(T.LocalSoldierPackage),l.sGGame.localModel.addModule(k.LocalSkillPackage),l.sGGame.localModel.addModule(y.LocalCardPackage),l.sGGame.localModel.addModule(D.LocalTechPackage),l.sGGame.localModel.addModule(B.LocalReward),l.sGGame.localModel.addModule(g.LocalBuildingPackage),l.sGGame.localModel.addModule(I.LocalVIP),l.sGGame.localModel.addModule(u.LocalAction),l.sGGame.localModel.addModule(G.LocalQuestEvent),l.sGGame.localModel.addModule(A.LocalQuestStat),l.sGGame.localModel.addModule(S.LocalDailyQuest),l.sGGame.localModel.addModule(M.default),l.sGGame.localModel.addModule(w.default),l.sGGame.localModel.addModule(P.default),l.sGGame.localModel.addModule(C.LocalQuest),l.sGGame.localModel.addModule(_.default),l.sGGame.localModel.addModule(b.default),l.sGGame.localModel.addModule(m.default),l.sGGame.localModel.addModule(R.default),l.sGGame.localModel.addModule(h.LocalBenefits),l.sGGame.localModel.addModule(L.default),l.sGGame.clientModel.addModule(s.ClientTemplate),cc._RF.pop()},{}],game_recorder_open:[function(t,e,o){"use strict";cc._RF.push(e,"7b1a2L8fkVKcr4CNkTUpPbw","game_recorder_open");var i,a,n=t,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var c,s=n("gui"),u=n("gnode"),d=n("thirdplatform_util");function p(){var t=null!==c&&c.apply(this,arguments)||this;return t.nodeGameRecorder=null,t}n=(a=cc._decorator).ccclass,a.property,l(p,c=cc.Component),p.prototype.onEnable=function(){var t=this;d.sThirdPlatformUtil.hasGameRecorder()&&s.sGUI.openSystemUI("prefabs/ui/game_recorder",function(e){t.nodeGameRecorder=e},this)},p.prototype.onDisable=function(){this.nodeGameRecorder&&(this.nodeGameRecorder.destroy(),this.nodeGameRecorder=null),u.sGNode.targetOff(this),s.sGUI.targetOff(this)},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([n],p),r.default=n,cc._RF.pop()},{}],game_recorder_ui:[function(t,e,o){"use strict";cc._RF.push(e,"8b794cymMdEF5IAiwA+zmfR","game_recorder_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var s,u=a("const_config"),d=a("i18n"),p=a("gtime"),f=a("thirdplatform_util");function h(){var t=null!==s&&s.apply(this,arguments)||this;return t.buttonStart=null,t.buttonStop=null,t.labelRemainTime=null,t.labelStatus=null,t.animRecording=null,t.remainSeconds=0,t}a=(n=cc._decorator).ccclass,n=n.property,l(h,s=cc.Component),h.prototype.onLoad=function(){this.buttonStart&&this.buttonStart.node.on("click",function(){f.sThirdPlatformUtil.startGameRecord(u.sConstConfig.config.maxGameRecordDuration)}),this.buttonStop&&this.buttonStop.node.on("click",function(){f.sThirdPlatformUtil.stopGameRecord()})},h.prototype.onEnable=function(){var t=this;this.refreshButton(),cc.director.on("startGameRecord",function(){t.refreshButton()},this),cc.director.on("stopGameRecord",function(){t.refreshButton()},this)},h.prototype.onDisable=function(){cc.director.targetOff(this)},h.prototype.update=function(){this.refreshRemainTime()},h.prototype.refreshButton=function(){var t=this,e=f.sThirdPlatformUtil.isGameRecording();this.buttonStart&&(this.buttonStart.node.active=!e),this.buttonStop&&(this.buttonStop.node.active=e),this.labelRemainTime&&(this.labelRemainTime.node.active=e),e&&this.animRecording&&(this.animRecording.play("game_recorder_anim1"),this.animRecording.node.on("finished",function(){t.animRecording.play("game_recorder_anim2")},this)),this.labelStatus&&(this.labelStatus.node.active=!e,this.labelStatus.string=e?d.i18n.t("gameRecorder.labelStopRecord"):d.i18n.t("gameRecorder.labelStartRecord"))},h.prototype.refreshRemainTime=function(){var t=u.sConstConfig.config.maxGameRecordDuration-Math.floor(f.sThirdPlatformUtil.getGameRecorderTime()/1e3);this.remainSeconds!=(t=t<0?0:t)&&(this.remainSeconds=t,this.labelRemainTime&&(this.labelRemainTime.string=p.sGTime.toTimeSpanString(this.remainSeconds)))},c([n(cc.Button)],h.prototype,"buttonStart",void 0),c([n(cc.Button)],h.prototype,"buttonStop",void 0),c([n(cc.Label)],h.prototype,"labelRemainTime",void 0),c([n(cc.Label)],h.prototype,"labelStatus",void 0),c([n(cc.Animation)],h.prototype,"animRecording",void 0),a=c([a],h),r.default=a,cc._RF.pop()},{}],info_ui:[function(t,e,o){"use strict";cc._RF.push(e,"6aa33ZdYQtE/IRAB2kbcOZW","info_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("i18n"),u=a("gui"),d=a("thirdplatform_util"),p=(f=cc._decorator).ccclass,f=(a=f.property,f.menu);function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.labelReal=null,t.labelAppName=null,t.labelVersionName=null,t.clickInfoDescButtonTimes=0,t}r(h,c=cc.Component),h.prototype.onLoad=function(){},h.prototype.onEnable=function(){this.labelReal&&(this.labelReal.string=d.sThirdPlatformUtil.isRealNameChecked()?s.i18n.t("info.isRealNameChecked"):s.i18n.t("info.isRealNameNotChecked")),this.labelAppName&&(this.labelAppName.string=d.sThirdPlatformUtil.getAppName()),this.labelVersionName&&(this.labelVersionName.string="v"+d.sThirdPlatformUtil.getVersionName())},h.prototype.onInfoDescButton=function(){this.clickInfoDescButtonTimes++,5<=this.clickInfoDescButtonTimes&&(this.clickInfoDescButtonTimes=0,u.sGUI.openMessageBoxOKUI(d.sThirdPlatformUtil.getDeviceID()))},l([a({displayName:"\u662f\u5426\u5b9e\u540d",type:cc.Label})],h.prototype,"labelReal",void 0),l([a({displayName:"\u6e38\u620f\u540d\u79f0",type:cc.Label})],h.prototype,"labelAppName",void 0),l([a({displayName:"\u6e38\u620f\u7248\u672c",type:cc.Label})],h.prototype,"labelVersionName",void 0),f=l([p,f("Game/UI/InfoUI")],h),n.default=f,cc._RF.pop()},{}],local_action:[function(t,e,o){"use strict";cc._RF.push(e,"3982fag1ZpFOKyOomm6gMz6","local_action");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalAction=n.LocalActionPlayerRecord=n.sLocalActionEvent=void 0;var l,c=a("local_currency"),s=a("const_config"),u=a("currency_config"),d=a("player_attribute_config"),p=a("reward_helper"),f=a("gtime"),h=a("ggame"),g=a("ggame_data"),y=a("gmodule"),m=a("reason_define"),b=a("local_attribute"),_=a("local_reward");function v(){this.oid=0,this.recoverTimestamp=0,this.todayAdTimes=0}function C(){var t=null!==l&&l.apply(this,arguments)||this;return t.localModel=null,t.actionPlayerRecord=null,t._dataDirty=!1,t}n.sLocalActionEvent={changed:"sLocalActionEvent_changed",addActionPointByEncorage:"sLocalActionEvent_addActionPointByEncorage"},n.LocalActionPlayerRecord=v,r(C,l=y.GModule),C.prototype.init=function(t){this.localModel=t,g.sGGameData.addTable(g.sGGameDataType.local,"actionPlayer",new v)},C.prototype.load=function(){this.actionPlayerRecord=this.localModel.localData.actionPlayer,0===this.actionPlayerRecord.recoverTimestamp&&(this.actionPlayerRecord.recoverTimestamp=f.sGTime.timestamp(),this._dataDirty=!0)},C.prototype.start=function(){},C.prototype.stop=function(){},C.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("actionPlayer",this.actionPlayerRecord))},C.prototype.update1=function(){this.recover()},C.prototype.dailyClear=function(){this.actionPlayerRecord.todayAdTimes=0,this._dataDirty=!0},C.prototype.remainRecoverTime=function(){var t=f.sGTime.timestamp()-this.actionPlayerRecord.recoverTimestamp;return 0<(t=Math.floor((1e3*s.sConstConfig.config.actionPointRecoverInterval-t)/1e3))?t:0},C.prototype.getActionPointMax=function(){return this.localModel.getModule(b.LocalAttribute).getValue(b.eAttributeObjectType.player,0,d.sPlayerAttributeConfig.config.maxActionCurrency)},C.prototype.recover=function(){var t=f.sGTime.timestamp(),e=t-this.actionPlayerRecord.recoverTimestamp,o=this.localModel.getModule(c.LocalCurrency).get(u.sCurrencyConfig.config.actionPoint),i=1e3*s.sConstConfig.config.actionPointRecoverInterval,a=this.getActionPointMax();i<=e&&o<a&&(a<o+(i=Math.floor(e/i))&&(i=a-o),this.localModel.getModule(c.LocalCurrency).add(u.sCurrencyConfig.config.actionPoint,i,m.eReasonType.recover),this.actionPlayerRecord.recoverTimestamp=t,this._dataDirty=!0)},C.prototype.getAddActionPointByEncorageTimes=function(){return this.actionPlayerRecord.todayAdTimes},C.prototype.getAddActionPointByEncorageMaxTimes=function(){return this.localModel.getModule(b.LocalAttribute).getValue(b.eAttributeObjectType.player,0,d.sPlayerAttributeConfig.config.maxBuyActionCurrencyTimes)},C.prototype.checkAddActionPointByEncorage=function(){return this.getAddActionPointByEncorageTimes()>=this.getAddActionPointByEncorageMaxTimes()?1:0},C.prototype.addActionPointByEncorage=function(t){var e=this.checkAddActionPointByEncorage();if(e)return e;var o=new p.RewardList;return o.add(_.eRewardType.actionPoint,s.sConstConfig.config.adActionPoint),o=h.sGGame.localModel.getModule(_.LocalReward).takeRewardList(o,!0,1,m.eReasonType.encourage),this.actionPlayerRecord.todayAdTimes++,this._dataDirty=!0,t&&t(e,o),0},r=C,n.LocalAction=r,cc._RF.pop()},{}],local_attribute:[function(t,e,o){"use strict";cc._RF.push(e,"4d241tJtwtKO6jQylqfwdlK","local_attribute");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalAttribute=n.eAttributeObjectType=void 0;var l,c,s=a("player_attribute_config"),u=a("gmodule"),d=a("attribute_system"),p=a("local_skill"),f=a("local_soldier");function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.localModel=null,t}(a=l=n.eAttributeObjectType||(n.eAttributeObjectType={}))[a.player=0]="player",a[a.skill=1]="skill",a[a.soldier=2]="soldier",r(h,c=u.GModule),h.prototype.init=function(t){this.localModel=t},h.prototype.load=function(){this.attributeSystem=new d.AttributeSystem,this.attributeSystem.init(s.sPlayerAttributeConfig)},h.prototype.start=function(){},h.prototype.stop=function(){},h.prototype.save=function(){},h.prototype.addPosValue=function(t,e,o,i,a,n){var r;(t="string"==typeof t?l[t]:t)===l.player?this.attributeSystem.getSlot(o).addPosValue(i,a,n):t===l.skill?(r=this.localModel.getModule(p.LocalSkillPackage).getSkill(e))&&r.attributeSystem.getSlot(o).addPosValue(i,a,n):t!==l.soldier||(e=this.localModel.getModule(f.LocalSoldierPackage).getSoldier(e))&&e.attributeSystem.getSlot(o).addPosValue(i,a,n)},h.prototype.setPosValue=function(t,e,o,i,a,n){var r;(t="string"==typeof t?l[t]:t)===l.player?this.attributeSystem.getSlot(o).setPosValue(i,a,n):t===l.skill?(r=this.localModel.getModule(p.LocalSkillPackage).getSkill(e))&&r.attributeSystem.getSlot(o).setPosValue(i,a,n):t!==l.soldier||(e=this.localModel.getModule(f.LocalSoldierPackage).getSoldier(e))&&e.attributeSystem.getSlot(o).setPosValue(i,a,n)},h.prototype.clear=function(t,e,o){var i;(t="string"==typeof t?l[t]:t)===l.player?this.attributeSystem.getSlot(o).clear():t===l.skill?(i=this.localModel.getModule(p.LocalSkillPackage).getSkill(e))&&i.attributeSystem.getSlot(o).clear():t!==l.soldier||(e=this.localModel.getModule(f.LocalSoldierPackage).getSoldier(e))&&e.attributeSystem.getSlot(o).clear()},h.prototype.getValue=function(t,e,o){if((t="string"==typeof t?l[t]:t)===l.player)return this.attributeSystem.getValue(o);if(t===l.skill){var i=this.localModel.getModule(p.LocalSkillPackage).getSkill(e);if(i)return i.attributeSystem.getValue(o)}else if(t===l.soldier&&(e=this.localModel.getModule(f.LocalSoldierPackage).getSoldier(e)))return e.attributeSystem.getValue(o);return 0},r=h,n.LocalAttribute=r,cc._RF.pop()},{}],local_battle_fuben:[function(t,e,o){"use strict";cc._RF.push(e,"a879fYA4OxJBI4ydOTfvnxR","local_battle_fuben");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalBattleFuben=n.BattleExtendReward=n.sLocalBattleFubenEvent=void 0;var l,c=a("age_config"),s=a("fuben_config"),u=a("fuben_spawner_config"),d=a("player_attribute_config"),p=a("ggame"),f=a("gmodule"),h=a("attribute_slot"),g=a("local_attribute"),y=a("local_battle"),m=a("local_fuben"),b=a("local_reward");function _(){var t=null!==l&&l.apply(this,arguments)||this;return t.localModel=null,t.inFuben=!1,t}n.sLocalBattleFubenEvent={start:"sLocalBattleFubenEvent.start",pause:"sLocalBattleFubenEvent.pause",resume:"sLocalBattleFubenEvent.resume",victory:"sLocalBattleFubenEvent.victory",defeat:"sLocalBattleFubenEvent.defeat"},n.BattleExtendReward=function(){this.type=b.eRewardType.invalid,this.id=0,this.count=0,this.mul=0,this.hasTaken=!1},r(_,l=f.GModule),_.prototype.init=function(t){this.localModel=t},_.prototype.load=function(){this.localFuben=this.localModel.getModule(m.LocalFuben),this.localBattle=this.localModel.getModule(y.LocalBattle)},_.prototype.start=function(){},_.prototype.stop=function(){},_.prototype.save=function(){},_.prototype.onEnterBattle=function(){if(!this.inFuben){this.inFuben=!0;var t=this.localBattle.getAgeEntry(y.enumTeam.player);this.localModel.getModule(g.LocalAttribute).setPosValue(g.eAttributeObjectType.player,0,"fuben",d.sPlayerAttributeConfig.config.addGoldPerMinute,h.eAttributePos.add,t.addGoldPerMinute),t=this.localFuben.getCurrentBattleFubenID(this.localFuben.currentBattleFubenType);var e=u.sFubenSpawnerConfig.getEntry(t);if(e)for(var o=0;o<e.length;++o){var i=e[o];this.localBattle.addDelaySoldier(y.enumTeam.enemy,i.seconds,i.soldiers,i.level,i.spawnerCount,i.percent)}p.sGGame.emit(n.sLocalBattleFubenEvent.start,t)}},_.prototype.onExitBattle=function(){this.inFuben&&(this.inFuben=!1,this.localModel.getModule(g.LocalAttribute).setPosValue(g.eAttributeObjectType.player,0,"fuben",d.sPlayerAttributeConfig.config.addGoldPerMinute,h.eAttributePos.add,0))},_.prototype.getInitGold=function(){var t=this.getPlayerAge(),e=c.sAgeConfig.getEntry(t);return t=this.localModel.getModule(g.LocalAttribute).getValue(g.eAttributeObjectType.player,0,d.sPlayerAttributeConfig.config.battleInitGold),e.initGold+Math.floor(e.initGold*t/100)},_.prototype.getPlayerAge=function(){return[9,10][this.localFuben.currentBattleFubenType]},_.prototype.getEnemyAge=function(){var t=this.localFuben.getCurrentBattleFubenID(this.localFuben.currentBattleFubenType);return(t=s.sFubenConfig.getEntry(t))?t.age:1},_.prototype.getPlayerBaseMaxHP=function(){var t=c.sAgeConfig.getEntry(this.getPlayerAge());return t?t.baseMaxHP:100},_.prototype.getEnemyBaseMaxHP=function(){var t=this.localFuben.getCurrentBattleFubenID(this.localFuben.currentBattleFubenType);return(t=s.sFubenConfig.getEntry(t))?t.baseMaxHP:1e4},_.prototype.onPause=function(){var t=this.localFuben.getCurrentBattleFubenID(this.localFuben.currentBattleFubenType);p.sGGame.emit(n.sLocalBattleFubenEvent.pause,t)},_.prototype.onResume=function(){var t=this.localFuben.getCurrentBattleFubenID(this.localFuben.currentBattleFubenType);p.sGGame.emit(n.sLocalBattleFubenEvent.resume,t)},_.prototype.onVictory=function(){this.localFuben.onVictory();var t=this.localFuben.getCurrentBattleFubenID(this.localFuben.currentBattleFubenType);p.sGGame.emit(n.sLocalBattleFubenEvent.victory,this.localFuben.currentBattleFubenType,this.localFuben.currentBattleFubenType,t)},_.prototype.onDefeat=function(){p.sGGame.emit(n.sLocalBattleFubenEvent.defeat)},r=_,n.LocalBattleFuben=r,cc._RF.pop()},{}],local_battle_pata:[function(t,e,o){"use strict";cc._RF.push(e,"87f63VdZsVHi4mXMY/vlKGZ","local_battle_pata");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalBattlePata=n.sLocalBattlePataEvent=void 0;var l,c=a("local_info"),s=a("age_config"),u=a("event_config"),d=a("pata_spawner_config"),p=a("ganalytics"),f=a("ggame"),h=a("gmodule"),g=a("local_battle"),y=a("local_building"),m=a("local_card"),b=a("local_pata"),_=a("local_soldier");function v(){var t=null!==l&&l.apply(this,arguments)||this;return t.localModel=null,t.inPata=!1,t}n.sLocalBattlePataEvent={start:"sLocalBattlePataEvent.start",pause:"sLocalBattlePataEvent.pause",resume:"sLocalBattlePataEvent.resume",victory:"sLocalBattlePataEvent.victory",defeat:"sLocalBattlePataEvent.defeat"},r(v,l=h.GModule),v.prototype.init=function(t){this.localModel=t},v.prototype.load=function(){this.localPata=this.localModel.getModule(b.LocalPata),this.localBattle=this.localModel.getModule(g.LocalBattle)},v.prototype.start=function(){},v.prototype.stop=function(){},v.prototype.save=function(){},v.prototype.onEnterBattle=function(){if(!this.inPata){this.inPata=!0;var t=this.localPata.getCurrentBattlePataID(),e=d.sPataSpawnerConfig.getEntry(t);if(e){for(var o=[],i=[],a=0;a<e.soldiers.length;++a)i.push(a);var r=0;for(a=0;a<e.count;++a){var l,c,s,u,p=-1;0<i.length&&(0===o.length||Math.random()<.8)&&(p=i[l=Math.floor(Math.random()*i.length)],i[l]=i[i.length-1],i.pop(),o.push(p)),-1!==(p=-1===p&&0<o.length?o[l=Math.floor(Math.random()*o.length)]:p)&&(c=e.soldiers[p],s=e.level&&p<e.level.length?e.level[p]:1,u=e.spawnerCount&&p<e.spawnerCount.length?e.spawnerCount[p]:1,p=e.percent&&p<e.percent.length?e.percent[p]:0,this.localBattle.addDelaySoldier(g.enumTeam.enemy,.5*r,[c],[s],[u],[p]),r++)}}var h=this.localModel.getModule(b.LocalPata),y=this.localModel.getModule(_.LocalSoldierPackage),m=h.getSoldierArray();for(a=0;a<m.length;++a){var v=y.getSoldier(m[a]);this.localBattle.addDelaySoldier(g.enumTeam.player,.5*a+.5,[m[a]],[v.getPataLevel()],[1],[0])}f.sGGame.emit(n.sLocalBattlePataEvent.start,t)}},v.prototype.onExitBattle=function(){this.inPata&&(this.inPata=!1)},v.prototype.getInitGold=function(){return 0},v.prototype.getPlayerAge=function(){return 8},v.prototype.getEnemyAge=function(){var t=this.localPata.currentBattlePataEntry;return t?t.age:1},v.prototype.getPlayerBaseMaxHP=function(){var t=s.sAgeConfig.getEntry(this.getPlayerAge());return t?t.baseMaxHP:100},v.prototype.getEnemyBaseMaxHP=function(){var t=this.localPata.currentBattlePataEntry;return t?t.baseMaxHP:100},v.prototype.onPause=function(){f.sGGame.emit(n.sLocalBattlePataEvent.pause,this.localPata.getCurrentBattlePataID())},v.prototype.onResume=function(){f.sGGame.emit(n.sLocalBattlePataEvent.resume,this.localPata.getCurrentBattlePataID())},v.prototype.onVictory=function(){var t=this.localPata.currentBattlePataEntry;this.localPata.onVictory(),this.localPata.gotoNext(t.id);var e=this.localModel.getModule(c.LocalInfo).getPlayDayCountForReport();p.sGAnalytics.reportAnalytics(u.sEventConfig.config.passPata,{days:e,stage:t.id.toString()}),f.sGGame.emit(n.sLocalBattlePataEvent.victory,t.id)},v.prototype.onDefeat=function(){f.sGGame.emit(n.sLocalBattlePataEvent.defeat,this.localPata.getCurrentBattlePataID())},v.prototype.getBattleScore=function(){var t=this.localModel.getModule(m.LocalCardPackage),e=this.localModel.getModule(y.LocalBuildingPackage);return t.getBattleScore()+e.getBattleScore()},r=v,n.LocalBattlePata=r,cc._RF.pop()},{}],local_battle_stage:[function(t,e,o){"use strict";cc._RF.push(e,"be0513VQK1Mq7z3Iq8jtaco","local_battle_stage");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalBattleStage=n.BattleExtendReward=n.sLocalBattleStageEvent=void 0;var l,c=a("local_currency"),s=a("local_info"),u=a("age_config"),d=a("const_config"),p=a("currency_config"),f=a("event_config"),h=a("player_attribute_config"),g=a("stage_spawner_config"),y=a("ganalytics"),m=a("ggame"),b=a("gmodule"),_=a("reason_define"),v=a("attribute_slot"),C=a("local_attribute"),P=a("local_battle"),S=a("local_building"),G=a("local_card"),M=a("local_reward"),w=a("local_stage");function A(){var t=null!==l&&l.apply(this,arguments)||this;return t.localModel=null,t.inStage=!1,t}n.sLocalBattleStageEvent={start:"sLocalBattleStageEvent.start",pause:"sLocalBattleStageEvent.pause",resume:"sLocalBattleStageEvent.resume",victory:"sLocalBattleStageEvent.victory",defeat:"sLocalBattleStageEvent.defeat"},n.BattleExtendReward=function(){this.type=M.eRewardType.invalid,this.id=0,this.count=0,this.mul=0,this.hasTaken=!1},r(A,l=b.GModule),A.prototype.init=function(t){this.localModel=t},A.prototype.load=function(){this.localStage=this.localModel.getModule(w.LocalStage),this.localBattle=this.localModel.getModule(P.LocalBattle)},A.prototype.start=function(){},A.prototype.stop=function(){},A.prototype.save=function(){},A.prototype.onEnterBattle=function(){if(!this.inStage){this.inStage=!0;var t=this.localBattle.getAgeEntry(P.enumTeam.player);this.localModel.getModule(C.LocalAttribute).setPosValue(C.eAttributeObjectType.player,0,"stage",h.sPlayerAttributeConfig.config.addGoldPerMinute,v.eAttributePos.add,t.addGoldPerMinute),t=this.localStage.getCurrentBattleStageID();var e=g.sStageSpawnerConfig.getEntry(t);if(e)for(var o=0;o<e.length;++o){var i=e[o];this.localBattle.addDelaySoldier(P.enumTeam.enemy,i.seconds,i.soldiers,i.level,i.spawnerCount,i.percent)}m.sGGame.emit(n.sLocalBattleStageEvent.start,this.localStage.currentBattleStageID)}},A.prototype.onExitBattle=function(){this.inStage&&(this.inStage=!1,this.localModel.getModule(C.LocalAttribute).setPosValue(C.eAttributeObjectType.player,0,"stage",h.sPlayerAttributeConfig.config.addGoldPerMinute,v.eAttributePos.add,0))},A.prototype.getInitGold=function(){var t=this.localModel.getModule(S.LocalBuildingPackage).getCurrentAge(),e=u.sAgeConfig.getEntry(t);return t=this.localModel.getModule(C.LocalAttribute).getValue(C.eAttributeObjectType.player,0,h.sPlayerAttributeConfig.config.battleInitGold),e.initGold+Math.floor(e.initGold*t/100)},A.prototype.getPlayerAge=function(){return this.localModel.getModule(S.LocalBuildingPackage).getCurrentAge()},A.prototype.getEnemyAge=function(){var t=this.localStage.currentBattleStageEntry;return t?t.age:1},A.prototype.getPlayerBaseMaxHP=function(){return m.sGGame.localModel.getModule(S.LocalBuildingPackage).getBaseMaxHP()},A.prototype.getEnemyBaseMaxHP=function(){var t=this.localStage.currentBattleStageEntry;return t?t.baseMaxHP:1e4},A.prototype.onPause=function(){m.sGGame.emit(n.sLocalBattleStageEvent.pause,this.localStage.currentBattleStageID)},A.prototype.onResume=function(){m.sGGame.emit(n.sLocalBattleStageEvent.resume,this.localStage.currentBattleStageID)},A.prototype.onVictory=function(){this.localStage.baseCardUpgradePoint=this.localStage.currentBattleStageEntry.baseCardUpgradePoint,this.localModel.getModule(c.LocalCurrency).add(p.sCurrencyConfig.config.cardUpgradePoint,this.localStage.baseCardUpgradePoint,_.eReasonType.battleVictory),this.localStage.baseBuildingUpgradePoint=this.localModel.getModule(M.LocalReward).getBuildingUpgradePointOverTime(this.localStage.currentBattleStageEntry.baseBuildingUpgradePointOverTime),this.localModel.getModule(c.LocalCurrency).add(p.sCurrencyConfig.config.buildingUpgradePoint,this.localStage.baseBuildingUpgradePoint,_.eReasonType.battleVictory),this.localStage.extendRewardArray=this.localStage._getRandomExtendReward(!1),this.localStage.victoryRandomCardIndex=-1,this.localModel.getModule(c.LocalCurrency).use(p.sCurrencyConfig.config.actionPoint,d.sConstConfig.config.battleActionPoint,_.eReasonType.battleVictory);var t=this.localStage.currentBattleStageEntry;this.localStage.currentPassStageID=t.id,this.localStage.currentBattleStageID=t.nextID,0===t.nextID&&(this.localStage.currentBattleStageID=this.localStage.currentPassStageID);var e=this.localModel.getModule(s.LocalInfo).getPlayDayCountForReport();y.sGAnalytics.reportAnalytics(f.sEventConfig.config.passStage,{days:e,stage:t.id.toString()}),m.sGGame.emit(n.sLocalBattleStageEvent.victory,t.id)},A.prototype.onDefeat=function(){m.sGGame.emit(n.sLocalBattleStageEvent.defeat,this.localStage.currentBattleStageID)},A.prototype.getBattleScore=function(){var t=this.localModel.getModule(G.LocalCardPackage),e=this.localModel.getModule(S.LocalBuildingPackage);return t.getBattleScore()+e.getBattleScore()},r=A,n.LocalBattleStage=r,cc._RF.pop()},{}],local_battle:[function(t,e,o){"use strict";cc._RF.push(e,"e7dc0KqX1lIE7+oK+/Hz9xd","local_battle");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalBattle=n.LocalBattleRecord=n.BattleBuff=n.LocalBattleSkillCard=n.sLocalBattleEvent=n.DelaySoldier=n.enumUnitType=n.enumTeam=n.enumBattleType=void 0;var l,c,s,u=a("age_config"),d=a("battle_start_buff_config"),p=a("const_config"),f=a("player_attribute_config"),h=a("soldier_config"),g=a("gtime"),y=a("ggame"),m=a("ggame_data"),b=a("gmodule"),_=a("game_define"),v=a("local_attribute"),C=a("local_battle_fuben"),P=a("local_battle_pata"),S=a("local_battle_stage"),G=a("local_building"),M=a("local_skill"),w=a("local_soldier"),A=a("local_stage");function B(){}function R(){this.active=!1}function k(){this.oid=0,this.cid=0,this.useSkillTimestamp=0,this.doubleSpeedEnabled=!1,this.doubleSpeedExpirationTime=0}function T(){var t=null!==s&&s.apply(this,arguments)||this;return t.localModel=null,t.localBattleImpl=null,t.localBuildingPackage=null,t.record=null,t._dataDirty=!1,t.debugNoCD=!1,t.battlePassTime=0,t.addGoldPassTime=0,t.soldierArrayEquiped=[],t.skillArrayEquiped=[],t.soldierCooldownDic={},t.skillCooldownDic={},t.skillMaxCooldownDic={},t.skillCDSubPercent=0,t.delaySoldierArray=[],t.waitSpawnerSoldierCount=0,t.waitDelayWaveCount=0,t._gold=0,t._debugEnemyOperate=!1,t._battleTimeScale=1,t.inBattle=!1,t.pauseRef=0,t._battleFinish=!1,t.battleStartBuff=[],t.battleStartBuffQuality=[],t.battleStartBuffSelected=!1,t.battleBuffArray=[],t.skillTimes=0,t.skillCardSpawnPassTime=0,t.randomBattleSkillCard=null,t.battleSkillCardArray={},t.battleSkillCardCount=0,t.randomSkillCount=0,t}(a=l=n.enumBattleType||(n.enumBattleType={}))[a.invalid=0]="invalid",a[a.stage=1]="stage",a[a.pata=2]="pata",a[a.fuben=3]="fuben",(a=c=n.enumTeam||(n.enumTeam={}))[a.invalid=0]="invalid",a[a.player=1]="player",a[a.enemy=2]="enemy",(a=n.enumUnitType||(n.enumUnitType={}))[a.invalid=0]="invalid",a[a.soldier=1]="soldier",a[a.turret=2]="turret",a[a.base=3]="base",n.DelaySoldier=B,n.sLocalBattleEvent={upgrade:"sLocalBattleEvent.upgrade",addSoldierByBuy:"sLocalBattleEvent.addSoldier",goldChanged:"sLocalBattleEvent.goldChaged",battleUpdate:"sLocalBattleEvent.battleUpdate",battleTimeScaleChanged:"sLocalBattleEvent.battleTimeScaleChanged",activeDoubleSpeed:"sLocalBattleEvent.activeDoubleSpeed",effectDoubleSpeed:"sLocalBattleEvent.effectDoubleSpeed",finished:"sLocalBattleEvent.finished",buffChanged:"sLocalBattleEvent.buffChanged",newSkillCard:"sLocalBattleEvent.newSkillCard",moveSkillCard:"sLocalBattleEvent.moveSkillCard",removeSkillCard:"sLocalBattleEvent.removeSkillCard",resetActiveSkillCard:"sLocalBattleEvent.resetActiveSkillCard",activeSkillCard:"sLocalBattleEvent.activeSkillCard",useSkillCard:"sLocalBattleEvent.useSkillCard",randomSkillCard:"sLocalBattleEvent.randomSkillCard"},n.LocalBattleSkillCard=R,n.BattleBuff=function(){},n.LocalBattleRecord=k,r(T,s=b.GModule),Object.defineProperty(T.prototype,"gold",{get:function(){return this._gold},enumerable:!1,configurable:!0}),T.prototype.addGold=function(t){this._gold+=t,y.sGGame.emit(n.sLocalBattleEvent.goldChanged)},Object.defineProperty(T.prototype,"debugEnemyOperate",{get:function(){return this._debugEnemyOperate},set:function(t){this._debugEnemyOperate=t},enumerable:!1,configurable:!0}),T.prototype.init=function(t){m.sGGameData.addTable(m.sGGameDataType.local,"battle",new k),this.localModel=t,this.localBuildingPackage=this.localModel.getModule(G.LocalBuildingPackage)},T.prototype.load=function(){this.record=this.localModel.localData.battle},T.prototype.start=function(){this.battleStartBuff=[1,2,3],this.initDoubleSpeed()},T.prototype.stop=function(){y.sGGame.targetOff(this)},T.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("battle",this.record))},T.prototype.update=function(t){if(!this.pauseBattle&&this.inBattle&&!this.battleFinish){var e;t*=this.battleTimeScale,this.battlePassTime+=t,this.addGoldPassTime+=t,1<this.addGoldPassTime&&(--this.addGoldPassTime,e=this.localModel.getModule(v.LocalAttribute).getValue(v.eAttributeObjectType.player,0,f.sPlayerAttributeConfig.config.addGoldPerMinute),this.addGold(e));for(var o=0;o<this.soldierArrayEquiped.length;++o){var i=this.soldierArrayEquiped[o].entry.id;0<this.soldierCooldownDic[i]&&(this.soldierCooldownDic[i]-=t,this.soldierCooldownDic[i]<0&&(this.soldierCooldownDic[i]=0))}for(o=0;o<this.skillArrayEquiped.length;++o)i=this.skillArrayEquiped[o].entry.id,0<this.skillCooldownDic[i]&&(this.skillCooldownDic[i]-=t,this.skillCooldownDic[i]<0&&(this.skillCooldownDic[i]=0));this.battleUpdate(t),y.sGGame.emit(n.sLocalBattleEvent.battleUpdate,t)}},T.prototype.battleUpdate=function(t){!this.inBattle||this.battleFinish||this.pauseBattle||(this.skillCardSpawnPassTime+=t,t=this.getSpawnCardInterval(),this.skillCardSpawnPassTime>t&&(this.skillCardSpawnPassTime-=t,y.sGGame.localModel.getModule(T).debugNoCD?this._debugNewBattleSkillCard():this._newBattleSkillCard()))},Object.defineProperty(T.prototype,"battleTimeScale",{get:function(){return this._battleTimeScale},set:function(t){1<t&&this.getDoubleSpeedRemainEffectiveTime()<=0||this._battleTimeScale==t||(this._battleTimeScale=t,y.sGGame.emit(n.sLocalBattleEvent.battleTimeScaleChanged))},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"battleFinish",{get:function(){return this._battleFinish},set:function(t){this._battleFinish!=t&&(this._battleFinish=t)&&y.sGGame.emit(n.sLocalBattleEvent.finished)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"pauseBattle",{get:function(){return 0<this.pauseRef},enumerable:!1,configurable:!0}),T.prototype.pause=function(){this.pauseRef++,this.localBattleImpl.onPause()},T.prototype.resume=function(){this.pauseRef--,this.localBattleImpl.onResume()},T.prototype.onEnterBattle=function(t){if(!this.inBattle){var e=this.localModel.getModule(w.LocalSoldierPackage),o=this.localModel.getModule(M.LocalSkillPackage);switch(t){case l.stage:this.localBattleImpl=this.localModel.getModule(S.LocalBattleStage);break;case l.pata:this.localBattleImpl=this.localModel.getModule(P.LocalBattlePata);break;case l.fuben:this.localBattleImpl=this.localModel.getModule(C.LocalBattleFuben)}this.inBattle=!0,this.battleFinish=!1,this.pauseRef=1,this.record.useSkillTimestamp=0,this.battlePassTime=0,this.addGoldPassTime=0,this.delaySoldierArray=[],this.battleStartBuffSelected=!1,this._randomBattleStartBuff(),this.skillTimes=0,this.skillCardSpawnPassTime=0,this.battleSkillCardArray={},this.battleSkillCardCount=0,this.randomSkillCount=0,this._refreshRandomBattleSkillCard(),t=y.sGGame.localModel.getModule(v.LocalAttribute),this.skillCDSubPercent=t.attributeSystem.getValue(f.sPlayerAttributeConfig.config.battleCardIntervalSubPercent),this.soldierArrayEquiped=e.getSoldierArrayEquiped(),this.skillArrayEquiped=o.getSkillArrayEquiped(),this.soldierCooldownDic={},this.skillCooldownDic={},this.skillMaxCooldownDic={};for(var i=0;i<this.soldierArrayEquiped.length;++i){var a=this.soldierArrayEquiped[i];this.soldierCooldownDic[a.entry.id]=0}for(i=0;i<this.skillArrayEquiped.length;++i){var n=this.skillArrayEquiped[i];this.skillMaxCooldownDic[n.entry.id]=n.entry.cd,this.skillCooldownDic[n.entry.id]=this.getSkillCD(n.entry)}for(this._gold=this.localBattleImpl.getInitGold(),this.playerBaseLevel=this.localBattleImpl.getPlayerAge(),this.enemyBaseLevel=this.localBattleImpl.getEnemyAge(),this.localBattleImpl.onEnterBattle(),i=0;i<this.delaySoldierArray.length;++i)this.delaySoldierArray[i].id=i+1;this.delaySoldierArray.sort(function(t,e){return t.seconds!==e.seconds?t.seconds-e.seconds:t.id-e.id})}},T.prototype.onExitBattle=function(){this.inBattle&&(this.inBattle=!1,this.battleFinish=!0,this.pauseRef=1,this.record.useSkillTimestamp=0,this.battlePassTime=0,this.addGoldPassTime=0,this.delaySoldierArray=[],this._clearBattleStartBuff(),this.localBattleImpl.onExitBattle())},T.prototype.getSkillCD=function(t){return t=this.skillMaxCooldownDic[t.id]||t.cd,Math.floor(t/(this.skillCDSubPercent/100))},T.prototype.getSoldierEquiped=function(t){return t>=this.soldierArrayEquiped.length?null:this.soldierArrayEquiped[t]},T.prototype.getSkillEquiped=function(t){return t>=this.skillArrayEquiped.length?null:this.skillArrayEquiped[t]},T.prototype.getAgeEntry=function(t){return t=t===c.player?this.playerBaseLevel:this.enemyBaseLevel,u.sAgeConfig.getEntry(t)},T.prototype.getSoldierCooldown=function(t){return this.soldierCooldownDic[t.entry.id]},T.prototype.checkUseLocalSoldier=function(t){return 0===this.soldierCooldownDic[t.entry.id]?0:1},T.prototype.checkBuySoldier=function(t){if(this.debugEnemyOperate)return 0;var e=this.localModel.getModule(w.LocalSoldierPackage).getSoldier(t);return e.active?0<this.soldierCooldownDic[e.entry.id]?4:(t=h.sSoldierConfig.getEntry(t),this.gold<t.price?1:0):3},T.prototype.buySoldier=function(t){var e=this.checkBuySoldier(t);return e||(this.debugEnemyOperate?(y.sGGame.emit(n.sLocalBattleEvent.addSoldierByBuy,t),0):(e=h.sSoldierConfig.getEntry(t),this._gold-=e.price,this.soldierCooldownDic[t]=e.employSeconds,y.sGGame.emit(n.sLocalBattleEvent.addSoldierByBuy,t),y.sGGame.emit(n.sLocalBattleEvent.goldChanged),0))},Object.defineProperty(T.prototype,"enemyBaseLevel",{get:function(){return this._enemyBaseLevel},set:function(t){this._enemyBaseLevel=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"playerBaseLevel",{get:function(){return this._playerBaseLevel},set:function(t){this._playerBaseLevel=t},enumerable:!1,configurable:!0}),T.prototype.initDoubleSpeed=function(){var t=this;this.record.doubleSpeedEnabled||y.sGGame.on(A.sLocalStageEvent.currentPassStageChanged,function(e){!t.record.doubleSpeedEnabled&&e>=p.sConstConfig.config.doubleSpeedUnlockStage&&t.activeDoubleSpeed()},this);var e=this.localModel.getModule(A.LocalStage).getCurrentPassStageID();!this.record.doubleSpeedEnabled&&e>=p.sConstConfig.config.doubleSpeedUnlockStage&&this.activeDoubleSpeed()},T.prototype.activeDoubleSpeed=function(){this.record.doubleSpeedEnabled||(this.record.doubleSpeedEnabled=!0,this._dataDirty=!0,y.sGGame.emit(n.sLocalBattleEvent.activeDoubleSpeed))},Object.defineProperty(T.prototype,"doubleSpeedEnabled",{get:function(){return this.record.doubleSpeedEnabled},enumerable:!1,configurable:!0}),T.prototype.effectDoubleSpeed=function(){this.record.doubleSpeedEnabled&&(this.record.doubleSpeedExpirationTime=g.sGTime.timestamp()+1e3*p.sConstConfig.config.sweepEffectiveDuration,this._dataDirty=!0,y.sGGame.emit(n.sLocalBattleEvent.effectDoubleSpeed))},T.prototype.getDoubleSpeedRemainEffectiveTime=function(){return this.record.doubleSpeedEnabled?this.localBuildingPackage.getDoubleCollectRemainTime():0},T.prototype.addDelaySoldier=function(t,e,o,i,a,n){var r=new B;r.teamID=t,r.seconds=e,r.soldiers=o,r.level=i||[1],r.spawnerCount=a||[1],r.percent=n||[0],this.delaySoldierArray.push(r)},T.prototype.victory=function(){this.inBattle&&(this.battleFinish=!0,this.localBattleImpl.onVictory())},T.prototype.defeat=function(){this.inBattle&&(this.battleFinish=!0,this.localBattleImpl.onDefeat())},T.prototype._randomBattleStartBuff=function(){for(var t=0;t<this.battleStartBuff.length;++t){this.battleStartBuffQuality[t]=Math.floor(3*Math.random())+3;var e=100*Math.random();this.battleStartBuffQuality[t]=e<70?3:e<90?4:5}},T.prototype.selectBattleStartBuff=function(t){var e,o;this.battleStartBuffSelected||(this.battleStartBuffSelected=!0,e=this.localModel.getModule(v.LocalAttribute).attributeSystem.getSlot("battleStartBuff"),o=d.sBattleStartBuffConfig.getEntry(this.battleStartBuff[t]),this.battleBuffArray.push({entry:o,quality:this.battleStartBuffQuality[t]}),e.setPosValue(o.attributeType,o.attributePos,o.attributeValues[this.battleStartBuffQuality[t]-3]),y.sGGame.emit(n.sLocalBattleEvent.buffChanged))},T.prototype.selectAllBattleStartBuff=function(){if(!this.battleStartBuffSelected){this.battleStartBuffSelected=!0;for(var t=this.localModel.getModule(v.LocalAttribute).attributeSystem.getSlot("battleStartBuff"),e=0;e<this.battleStartBuff.length;++e){var o=d.sBattleStartBuffConfig.getEntry(this.battleStartBuff[e]);this.battleBuffArray.push({entry:o,quality:this.battleStartBuffQuality[e]}),t.setPosValue(o.attributeType,o.attributePos,o.attributeValues[this.battleStartBuffQuality[e]-3])}y.sGGame.emit(n.sLocalBattleEvent.buffChanged)}},T.prototype._clearBattleStartBuff=function(){for(var t=this.localModel.getModule(v.LocalAttribute).attributeSystem.getSlot("battleStartBuff"),e=0;e<this.battleStartBuff.length;++e){var o=d.sBattleStartBuffConfig.getEntry(this.battleStartBuff[e]);t.setPosValue(o.attributeType,o.attributePos,0)}this.battleBuffArray=[],y.sGGame.emit(n.sLocalBattleEvent.buffChanged)},T.prototype.getPlayerBaseMaxHP=function(){return this.localBattleImpl.getPlayerBaseMaxHP()},T.prototype.getEnemyBaseMaxHP=function(){return this.localBattleImpl.getEnemyBaseMaxHP()},T.prototype.getSkillCooldown=function(t){return this.skillCooldownDic[t.entry.id]},T.prototype.checkUseLocalSkill=function(t){return 0===this.skillCooldownDic[t.entry.id]?0:1},T.prototype.useLocalSkill=function(t){return this.checkUseLocalSkill(t)||(this.skillMaxCooldownDic[t.entry.id]=Math.floor(1.5*this.skillMaxCooldownDic[t.entry.id]),this.skillCooldownDic[t.entry.id]=this.getSkillCD(t.entry),this.skillTimes++,y.sGGame.emit(n.sLocalBattleEvent.useSkillCard),0)},T.prototype.useSkillCard=function(t){for(var e,o=t.index,i=t.index+1;i<_.GameDefine.battleSkillCardTotal&&(e=this.battleSkillCardArray[i])&&e.skill.entry.id===t.skill.entry.id&&e.index!=_.GameDefine.battleSkillCardTotal;++i)o=e.index;for(i=o;0<=i&&(e=this.battleSkillCardArray[i])&&e.skill.entry.id===t.skill.entry.id&&e.index!=_.GameDefine.battleSkillCardTotal;--i)delete this.battleSkillCardArray[e.index],this.battleSkillCardCount--,y.sGGame.emit(n.sLocalBattleEvent.removeSkillCard,e.index);this._checkSkillCardArray(),this.skillTimes++,y.sGGame.emit(n.sLocalBattleEvent.useSkillCard)},T.prototype.removeSkillCard=function(t){t=this.battleSkillCardArray[t],delete this.battleSkillCardArray[t.index],this.battleSkillCardCount--,y.sGGame.emit(n.sLocalBattleEvent.removeSkillCard,t.index),this._checkSkillCardArray()},T.prototype._checkSkillCardArray=function(){var t=0,e=0,o=0,i=0,a=0;y.sGGame.emit(n.sLocalBattleEvent.resetActiveSkillCard);for(var r=0;r<_.GameDefine.battleSkillCardTotal+1;++r)if(this.battleSkillCardArray[r]){var l=this.battleSkillCardArray[r];if(l.active=!1,l.index=t,delete this.battleSkillCardArray[r],this.battleSkillCardArray[t]=l,t++,e!=l.skill.entry.id)if(i<_.GameDefine.battleSameCountForSkillToUse)e=l.skill.entry.id,o=l.index,i=1;else{for(var c=o;c<o+i;++c)this.battleSkillCardArray[c].active=!0;a++,y.sGGame.emit(n.sLocalBattleEvent.activeSkillCard,o,i,a),e=l.skill.entry.id,o=l.index,i=1}else l.index!==_.GameDefine.battleSkillCardTotal&&i++;l.index!==r&&y.sGGame.emit(n.sLocalBattleEvent.moveSkillCard,l,r)}if(i>=_.GameDefine.battleSameCountForSkillToUse){for(r=o;r<o+i;++r)this.battleSkillCardArray[r].active=!0;y.sGGame.emit(n.sLocalBattleEvent.activeSkillCard,o,i,++a)}},T.prototype._getRandomSkill=function(){var t=this.localModel.getModule(M.LocalSkillPackage);return t=this.debugNoCD?t.debugRandomAllSkill():t.randomSkill(),this.randomSkillCount++,t},T.prototype._refreshRandomBattleSkillCard=function(){var t,e=this._getRandomSkill();e&&((t=new R).skill=e,t.index=-1,this.randomBattleSkillCard=t)},T.prototype._newBattleSkillCard=function(){for(var t=this.randomBattleSkillCard,e=_.GameDefine.battleSkillCardTotal,o=0;o<_.GameDefine.battleSkillCardTotal;++o)if(!this.battleSkillCardArray[o]){e=o;break}e!==_.GameDefine.battleSkillCardTotal&&t&&(t.index=e,this.battleSkillCardArray[e]=t,this.battleSkillCardCount++,y.sGGame.emit(n.sLocalBattleEvent.newSkillCard,t)),this._refreshRandomBattleSkillCard(),y.sGGame.emit(n.sLocalBattleEvent.randomSkillCard),this._checkSkillCardArray()},T.prototype._debugNewBattleSkillCard=function(){for(var t=0;t<2;++t){var e=new R;e.skill=this.randomBattleSkillCard.skill,e.index=-1;for(var o=_.GameDefine.battleSkillCardTotal,i=0;i<_.GameDefine.battleSkillCardTotal;++i)if(!this.battleSkillCardArray[i]){o=i;break}o!==_.GameDefine.battleSkillCardTotal&&e&&(e.index=o,this.battleSkillCardArray[o]=e,this.battleSkillCardCount++,y.sGGame.emit(n.sLocalBattleEvent.newSkillCard,e))}this._refreshRandomBattleSkillCard(),y.sGGame.emit(n.sLocalBattleEvent.randomSkillCard),this._checkSkillCardArray()},T.prototype.getSpawnCardInterval=function(){if(this.debugNoCD)return 1;var t=y.sGGame.localModel.getModule(v.LocalAttribute),e=t.attributeSystem.getValue(f.sPlayerAttributeConfig.config.skillRefreshInterval);return 0===e&&(e=p.sConstConfig.config.spawnCardInterval),Math.round(e/(t.attributeSystem.getValue(f.sPlayerAttributeConfig.config.battleCardIntervalSubPercent)/100))},r=T,n.LocalBattle=r,cc._RF.pop()},{}],local_benefits:[function(t,e,o){"use strict";cc._RF.push(e,"5286baDj8RKPJMzOQUkXjp9","local_benefits");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalBenefits=n.LocalBenefitRecord=n.eLocalBenefitsError=void 0;var l,c,s=a("const_config"),u=a("daily_gift_config"),d=a("gtime"),p=a("ggame"),f=a("ggame_data"),h=a("gmodule"),g=a("local_reward"),y=a("local_stage");function m(){this.oid=0,this.cid=0,this.collectCount=0}function b(){var t=null!==c&&c.apply(this,arguments)||this;return t._dataDirty=!1,t.localModel=null,t}(a=l=n.eLocalBenefitsError||(n.eLocalBenefitsError={}))[a.ok=0]="ok",a[a.timesNotEnough=1]="timesNotEnough",a[a.entryNotExist=2]="entryNotExist",a[a.notOpeningTime=3]="notOpeningTime",a[a.systemNotOpen=4]="systemNotOpen",n.LocalBenefitRecord=m,r(b,c=h.GModule),b.prototype.init=function(t){f.sGGameData.addTable(f.sGGameDataType.local,"benefit",{0:new m}),this.localModel=t},b.prototype.load=function(){this._recordDic=this.localModel.localData.benefit},b.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("benefit",this._recordDic))},b.prototype.start=function(){},b.prototype.stop=function(){},b.prototype.dailyClear=function(){for(var t in this._recordDic)this._recordDic[t].collectCount=0;this._dataDirty=!0},b.prototype.getRecord=function(t){var e=this._recordDic[t];return e||((e=new m).cid=t,e.collectCount=0,this._recordDic[t]=e,this._dataDirty=!0),e},b.prototype.getRemainTimes=function(t){var e=u.sDailyGiftConfig.getEntry(t);if(e)return t=this.getRecord(t),(t=e.times-t.collectCount)<0?0:t},b.prototype.isSystemOpen=function(){return p.sGGame.localModel.getModule(y.LocalStage).isSystemIsOpened(s.sConstConfig.config.benefitsUnlockStage)},b.prototype.checkCollectReward=function(t){if(!this.isSystemOpen())return l.systemNotOpen;var e=u.sDailyGiftConfig.getEntry(t);return e?this.getRemainTimes(t)<=0?l.timesNotEnough:e.openingTimeSection&&!this.checkTimeSection(e.openingTimeSection)?l.notOpeningTime:l.ok:l.entryNotExist},b.prototype.collectReward=function(t){var e=this.checkCollectReward(t);return e?{err:e}:(e=u.sDailyGiftConfig.getEntry(t),this.getRecord(t).collectCount++,e=this.localModel.getModule(g.LocalReward).takeRewardString(e.reward),this._dataDirty=!0,{err:l.ok,data:e})},b.prototype.checkTimeSection=function(t){for(var e=d.sGTime.timestamp(),o=[],i=t.split("-"),a=0;a<i.length;++a){var n=i[a].split(":");o.push(d.sGTime.midnight(e).setHours(parseInt(n[0]),parseInt(n[1])))}return e>=o[0]&&e<o[1]},r=b,n.LocalBenefits=r,cc._RF.pop()},{}],local_building:[function(t,e,o){"use strict";cc._RF.push(e,"7b908EpBpFPFZlK6MbB6Jxu","local_building");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalBuildingPackage=n.LocalBuilding=n.LocalBuildingRecord=n.LocalBuildingPlayerRecord=n.eBuildingType=n.sLocalBuildingEvent=void 0;var l,c=a("local_currency"),s=a("local_info"),u=a("age_config"),d=a("building_config"),p=a("building_upgrade_config"),f=a("const_config"),h=a("currency_config"),g=a("player_attribute_config"),y=a("reward_helper"),m=a("i18n"),b=a("gtime"),_=a("ggame"),v=a("ggame_data"),C=a("gmodule"),P=a("reason_define"),S=a("attribute_slot"),G=a("local_attribute"),M=a("local_reward");function w(){this.oid=0,this.age=0,this.doubleCollectTimestamp=0}function A(){this.oid=0,this.cid=0,this.level=0,this.produceCache=0}n.sLocalBuildingEvent={newAge:"sLocalBuildingEvent.newAge",upgrade:"sLocalBuildingEvent.upgrade",upgradeAge:"sLocalBuildingEvent.upgradeAge",collected:"sLocalBuildingEvent.collected",unlock:"sLocalBuildingEvent.unlock",collectOffline:"sLocalBuildingEvent.collectOffline",collectOfflineByAD:"sLocalBuildingEvent.collectOfflineByAD",cached:"sLocalBuildingEvent.cached"},(a=l=n.eBuildingType||(n.eBuildingType={}))[a.invalid=0]="invalid",a[a.base=1]="base",a[a.granary=2]="granary",a[a.mineFactory=3]="mineFactory",a[a.industry=4]="industry",a[a.energy=5]="energy",a[a.politics=6]="politics",a[a.medical=7]="medical",a[a.amusement=8]="amusement",a[a.culture=9]="culture",a[a.max=10]="max",n.LocalBuildingPlayerRecord=w,n.LocalBuildingRecord=A;var B=(R.prototype.init=function(t,e){this.localModel=t,this.record=e,this.entry=d.sBuildingConfig.getEntry(this.record.cid),this.localBuildingPackage=this.localModel.getModule(T),this.produceDt=0},R.prototype.getAttributeValue=function(){return this.getAttributeLevelValue(this.record.level)},R.prototype.getAttributeLevelValue=function(t){return this.entry.attributePerLevel*t},R.prototype.getLevelStep=function(t){return t<1?0:Math.floor(t/(this.entry.maxLevel/5))+1},R.prototype.getLevel=function(){return this.record.level},R.prototype.getMaxLevel=function(){return this.entry.maxLevel},R.prototype.getUpgradeNeed=function(t){var e=this.localBuildingPackage.getLevelEntry(this,t);return e?e.upgradeNeed:0===(t=null==t?this.getLevel():t)?0:(this.entry.produceParam1+t*Math.floor(.1*this.entry.produceParam1))*Math.pow(t,this.entry.upgradeNeedParam1)*this.entry.upgradeNeedParam2},R.prototype.getProduce=function(t){var e=this.localBuildingPackage.getLevelEntry(this,t);return e?e.produce:0===(t=null==t?this.getLevel():t)?0:this.entry.produceParam1+(t-1)*Math.floor(.1*this.entry.produceParam1)},R.prototype.getProduceCache=function(){return this.record.produceCache},R.prototype.isLevelFull=function(){return this.record.level>=this.entry.maxLevel},R.prototype.isAutoCollectOnline=function(){return 100<=this.record.level},R.prototype.getCurDesc=function(){return this.getDesc(this.record.level)},R.prototype.getNextDesc=function(){return this.getDesc(this.record.level+1)},R.prototype.getDesc=function(t){return this.entry.desc?t>this.entry.maxLevel?"":(t=this.getAttributeLevelValue(t),m.i18n.t(this.entry.desc).replace("${value}",t.toFixed(1))):""},R.prototype.isUnlock=function(){return 0<this.record.level},R.prototype.getCollectPassSeconds=function(){var t=this.produceDt,e=this.getCollectNeedSeconds();return t<e?t:e},R.prototype.getCollectNeedSeconds=function(){return this.entry.produceSeconds},R.prototype.getBuildingType=function(){return this.entry.id%1e3},R.prototype.getBuildingAge=function(){return Math.floor(this.entry.id/1e3)},R);function R(){this.record=null,this.entry=null,this.localBuildingPackage=null,this.produceDt=0}n.LocalBuilding=B;var k,T=(r(L,k=C.GModule),Object.defineProperty(L.prototype,"maxAge",{get:function(){return this._maxAge},enumerable:!1,configurable:!0}),L.prototype.init=function(t){for(var e in v.sGGameData.addTable(v.sGGameDataType.local,"buildingPlayer",new w),v.sGGameData.addTable(v.sGGameDataType.local,"building",{0:new A}),this.localModel=t,p.sBuildingUpgradeConfig.config)e=p.sBuildingUpgradeConfig.getEntry(e),this._buildingLevelEntryDic[e.buildingID]||(this._buildingLevelEntryDic[e.buildingID]={}),this._buildingLevelEntryDic[e.buildingID][e.level]=e},L.prototype.load=function(){for(var t in this._buildingDic={},this.buildingPlayerRecord=this.localModel.localData.buildingPlayer,this.buildingRecordDic=this.localModel.localData.building,d.sBuildingConfig.config){var e=parseInt(t),o=new B;t=this._getBuildingRecord(e),o.init(this.localModel,t),this._buildingDic[e]=o,1001==e&&0==t.level&&(t.level=1,this._dataDirty=!0)}this._maxAge=7,0===this.buildingPlayerRecord.age&&(this.buildingPlayerRecord.age=1,this._dataDirty=!0)},L.prototype.getMaxOfflineHours=function(){return this.localModel.getModule(G.LocalAttribute).getValue(G.eAttributeObjectType.player,0,g.sPlayerAttributeConfig.config.maxOfflineHours)},L.prototype.getMaxOfflineSeconds=function(){return 3600*this.getMaxOfflineHours()},L.prototype.getAttributeValueFromOldAge=function(t){return this.attributeValueFromOldAge&&t?(t=t.entry.attributeType,void 0===this.attributeValueFromOldAge[t]?0:this.attributeValueFromOldAge[t]):0},L.prototype.calcAttributeValueFromOldAge=function(){this.attributeValueFromOldAge={};for(var t=this.getCurrentAge(),e=1;e<t;++e)for(var o=1;o<l.max;++o){var i,a,n=this.getAgeBuilding(e,o);n&&0<n.getLevel()&&(i=n.getAttributeValue(),void 0===(a=this.attributeValueFromOldAge[n.entry.attributeType])&&(a=0),this.attributeValueFromOldAge[n.entry.attributeType]=a+i)}},L.prototype.start=function(){for(var t=this,e=this.getCurrentAge(),o=1;o<=e;++o)for(var i=1;i<l.max;++i){var a=this.getAgeBuilding(o,i);a&&0<a.getLevel()&&this._refreshBuildingAttribute(a,!0)}this.calcAttributeValueFromOldAge(),this._refreshAgeAttribute(!0),_.sGGame.on(s.sLocalInfoEvent.offlineStateChanged,function(e){var o;t.getCurrentAge()<=1||((o=t.getMaxOfflineSeconds())<e&&(e=o),o=Math.floor(t.getTotalCollectPerSecond()*e*f.sConstConfig.config.offlineCollectPercent),t.localModel.getModule(c.LocalCurrency).add(h.sCurrencyConfig.config.buildingUpgradePoint,o,P.eReasonType.collectOfflineUpgradePoint),_.sGGame.emit(n.sLocalBuildingEvent.collectOffline,o,e))},this)},L.prototype.stop=function(){this._buildingDic={},_.sGGame.targetOff(this)},L.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("buildingPlayer",this.buildingPlayerRecord),this.localModel.database.update("building",this.buildingRecordDic))},L.prototype.update=function(t){for(var e=1;e<l.max;++e){var o=this.getCurrentAgeBuilding(e);o&&(o.produceDt+=t,this.tryCache(o),(o.isAutoCollectOnline()||this.hasDoubleCollect())&&this.collect(o))}},L.prototype._getBuildingRecord=function(t){var e=this.buildingRecordDic[t];return e||((e=new A).cid=t,this.buildingRecordDic[t]=e,this._dataDirty=!0),e},L.prototype.getBuilding=function(t){return this._buildingDic[t]},L.prototype.getBuildingID=function(t,e){return 1e3*t+e},L.prototype.getBuildingType=function(t){return t%1e3},L.prototype.getBuildingByType=function(t){return t=this.getBuildingID(this.buildingPlayerRecord.age,t),d.sBuildingConfig.getEntry(t)?this._buildingDic[t]:null},L.prototype.getCurrentAge=function(){return this.buildingPlayerRecord.age},L.prototype.getAgeBuilding=function(t,e){return e=this.getBuildingID(t,e),d.sBuildingConfig.getEntry(e)?this._buildingDic[e]:null},L.prototype.getCurrentAgeBuilding=function(t){return this.getAgeBuilding(this.buildingPlayerRecord.age,t)},L.prototype.getMaxSoldierCount=function(){return this.localModel.getModule(G.LocalAttribute).attributeSystem.getValue(g.sPlayerAttributeConfig.config.battleSoldierCount)+5},L.prototype.getBaseMaxHP=function(){var t=this.localModel.getModule(G.LocalAttribute).attributeSystem.getValue(g.sPlayerAttributeConfig.config.buildingBaseMaxHP);return 0<t?t:100},L.prototype.isAgeFull=function(){return this.buildingPlayerRecord.age>=this._maxAge},L.prototype.getLevelEntry=function(t,e){var o=this._buildingLevelEntryDic[t.entry.id];if(o)return o[e||t.getLevel()]},L.prototype.getBattleScore=function(){var t,e=0,o=this.getCurrentAge();for(t in this._buildingDic){var i=this._buildingDic[t],a=u.sAgeConfig.getEntry(i.entry.age),n=i.getLevel();i.entry.age<=o&&0<n&&(e+=n*a.levelScore)}return e},L.prototype.getTotalCollectPerSecond=function(){for(var t=0,e=this.getCurrentAge(),o=1;o<l.max;++o){var i=this.getAgeBuilding(e,o);i&&(t+=i.getProduce())}return t},L.prototype.checkUpgradeAge=function(){for(var t=1;t<l.max;++t){var e=this.getCurrentAgeBuilding(t);if(e&&!e.isLevelFull())return 1}return 0},L.prototype.upgradeAge=function(){var t=this.checkUpgradeAge();if(t)return t;var e=this.getCurrentAge();this._refreshAgeAttribute(!1),this.buildingPlayerRecord.age=e+1;for(var o=1;o<l.max;++o){var i=this.getCurrentAgeBuilding(o);i&&0===i.entry.unlockLevel&&(i.record.level=1,this._refreshBuildingAttribute(i,!0))}return this._refreshAgeAttribute(!0),this.calcAttributeValueFromOldAge(),this._dataDirty=!0,_.sGGame.emit(n.sLocalBuildingEvent.upgradeAge),t},L.prototype.checkUnlock=function(t){var e=this._buildingDic[t];return e.isUnlock()?1:(t=this.getBuildingType(t),(t=this.getBuildingByType(t-1))&&t.record.level<e.entry.unlockLevel?2:0)},L.prototype.unlock=function(t){var e;return(t=this._buildingDic[t]).isUnlock()?{errorCode:1}:(t.record.level=1,this._refreshBuildingAttribute(t,!0),b.sGTime.timestamp(),t.produceDt=0,this._dataDirty=!0,t.entry.unlockReward&&(e=this.localModel.getModule(M.LocalReward).takeRewardString(t.entry.unlockReward)),_.sGGame.emit(n.sLocalBuildingEvent.unlock,t),{errorCode:0,rewardResult:e})},L.prototype.checkUpgrade=function(t){return(t=this._buildingDic[t]).isLevelFull()||!t.isUnlock()?1:_.sGGame.localModel.getModule(c.LocalCurrency).get(h.sCurrencyConfig.config.buildingUpgradePoint)<t.getUpgradeNeed()?2:0},L.prototype.upgrade=function(t){var e=this.checkUpgrade(t);return e||(e=this._buildingDic[t],this._refreshBuildingAttribute(e,!1),t=e.getUpgradeNeed(),e.record.level+=1,this._refreshBuildingAttribute(e,!0),this._dataDirty=!0,_.sGGame.localModel.getModule(c.LocalCurrency).use(h.sCurrencyConfig.config.buildingUpgradePoint,t,P.eReasonType.upgradeBuilding),_.sGGame.emit(n.sLocalBuildingEvent.upgrade,e),0)},L.prototype.testAllUpgrade=function(){for(var t=1;t<l.max;++t){var e=this.getCurrentAgeBuilding(t);e&&(this._refreshBuildingAttribute(e,!1),e.record.level=e.getMaxLevel(),this._refreshBuildingAttribute(e,!0),this._dataDirty=!0,_.sGGame.emit(n.sLocalBuildingEvent.upgrade,e))}},L.prototype._refreshBuildingAttribute=function(t,e){var o,i;0<t.getLevel()&&(o=this.localModel.getModule(G.LocalAttribute),i=t.entry,t=t.getAttributeValue(),t=e?t:-t,i.attributeObjectType&&o.addPosValue(i.attributeObjectType,i.attributeObjectID,"building",i.attributeType,i.attributePos,t))},L.prototype._refreshAgeAttribute=function(t){var e=this.getCurrentAge();(e=u.sAgeConfig.getEntry(e))&&(e=e.baseMaxHP,e=t?e:-e,this.localModel.getModule(G.LocalAttribute).addPosValue(G.eAttributeObjectType.player,0,"age",g.sPlayerAttributeConfig.config.buildingBaseMaxHP,S.eAttributePos.add,e))},L.prototype.checkCollectWithID=function(t){return(t=this.getBuilding(t))?this.checkCollect(t):3},L.prototype.checkCollect=function(t){return 0==t.record.level?1:t.record.produceCache<=0?2:0},L.prototype.collect=function(t){return this.checkCollect(t)||(this._forceCollect(t),0)},L.prototype._forceCollect=function(t){var e=t.record.produceCache,o=new y.RewardList;return o.add(M.eRewardType.buildingUpgradePoint,e),o=this.localModel.getModule(M.LocalReward).takeRewardList(o,!0,1,P.eReasonType.collectInBuilding),t.record.produceCache=0,this._dataDirty=!0,_.sGGame.emit(n.sLocalBuildingEvent.collected,t,e),o},L.prototype._forceCache=function(t,e){var o=Math.floor(t.getProduce()*e);e=_.sGGame.localModel.getModule(G.LocalAttribute).getValue(G.eAttributeObjectType.player,0,g.sPlayerAttributeConfig.config.techPointExtRewardPercent),o=Math.floor(o*e/100),(e=this.hasDoubleCollect())&&(o*=2),t.record.produceCache+=o,this._dataDirty=!0,_.sGGame.emit(n.sLocalBuildingEvent.cached,t,o,e)},L.prototype.tryCache=function(t){var e=t.getCollectNeedSeconds();0==t.record.level||t.produceDt<e||(this._forceCache(t,e),t.produceDt=0)},L.prototype.checkCollectOfflineUpgradePointByAD=function(t){return t<=0?1:0},L.prototype.collectOfflineUpgradePointByAD=function(t){var e=this.checkCollectOfflineUpgradePointByAD(t);return 0!==e?e:(e=new y.RewardList,this.hasDoubleCollect()&&(t*=2),e.add(M.eRewardType.buildingUpgradePoint,t),e=this.localModel.getModule(M.LocalReward).takeRewardList(e,!0,1,P.eReasonType.collectOfflineUpgradePointWithAD),this._dataDirty=!0,_.sGGame.emit(n.sLocalBuildingEvent.collectOfflineByAD,e),0)},L.prototype.setDoubleCollectByAD=function(){this.buildingPlayerRecord.doubleCollectTimestamp=b.sGTime.timestamp(),this._dataDirty=!0},L.prototype.getDoubleCollectRemainTime=function(){if(0===this.buildingPlayerRecord.doubleCollectTimestamp)return 0;var t=b.sGTime.timestamp()-this.buildingPlayerRecord.doubleCollectTimestamp;return 0<(t=1e3*f.sConstConfig.config.doubleCollectSecondsByAd-t)?t:(this.buildingPlayerRecord.doubleCollectTimestamp=0,this._dataDirty=!0,0)},L.prototype.hasDoubleCollect=function(){return 0<this.getDoubleCollectRemainTime()},L);function L(){var t=null!==k&&k.apply(this,arguments)||this;return t.localModel=null,t.buildingPlayerRecord=null,t.buildingRecordDic=null,t._dataDirty=!1,t._buildingDic={},t._maxAge=0,t._buildingLevelEntryDic={},t}n.LocalBuildingPackage=T,cc._RF.pop()},{}],local_card:[function(t,e,o){"use strict";cc._RF.push(e,"97f00ljn49FWrAK7ax9iiiI","local_card");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalCardPackage=n.LocalCard=n.LocalCardRecord=n.LocalCardPlayerRecord=n.sLocalCardEvent=n.eCardType=void 0;var l,c=a("local_currency"),s=a("card_config"),u=a("card_pull_config"),d=a("card_upgrade_config"),p=a("const_config"),f=a("currency_config"),h=a("player_attribute_config"),g=a("stage_config"),y=a("reward_helper"),m=a("gtime"),b=a("ggame"),_=a("ggame_data"),v=a("gmodule"),C=a("reason_define"),P=a("local_attribute"),S=a("local_building"),G=a("local_reward"),M=a("local_stage");function w(){this.oid=0,this.totalPullTimes=0,this.currencyPullTimes=0,this.adPullTimes=0,this.adPullTimesToday=0,this.normalPullTimestamp=0,this.advancedPullTimestamp=0,this.adUpgradeTimes=0,this.pullCardTimesForBox=0}function A(){this.oid=0,this.cid=0,this.level=0,this.fragment=0,this.fragmentTotal=0,this.unlocked=!1,this.equiped=!1}(a=l=n.eCardType||(n.eCardType={}))[a.invalid=0]="invalid",a[a.disaster=1]="disaster",a[a.tech=2]="tech",a[a.summon=3]="summon",a[a.totem=4]="totem",a[a.melee=5]="melee",a[a.range=6]="range",a[a.air=7]="air",a[a.magic=8]="magic",a[a.max=9]="max",n.sLocalCardEvent={upgrade:"sLocalCardEvent_upgrade",pullCard:"sLocalCardEvent_pullCard",changeEquip:"sLocalCardEvent_changeEquip",unlockCard:"sLocalCardEvent_unlockCard"},n.LocalCardPlayerRecord=w,n.LocalCardRecord=A;var B,R=(k.prototype.init=function(t,e){this.localModel=t,this.record=e,this.entry=s.sCardConfig.getEntry(this.record.cid),this._maxLevel=this.entry.upgradeFragements?this.entry.upgradeFragements.length+1:0},k.prototype.getLevelAttributeValue1=function(t){return 0<t?this.entry.attributeValues1[t-1]:this.entry.attributeValues1[0]},k.prototype.getAttributeValue1=function(){return this.getLevelAttributeValue1(this.record.level)},k.prototype.getNextAttributeValue1=function(){return this.getLevelAttributeValue1(this.record.level+1)},k.prototype.getLevelAttributeValue2=function(t){return this.entry.attributeValues2?0<t?this.entry.attributeValues2[t-1]:this.entry.attributeValues2[0]:0},k.prototype.getAttributeValue2=function(){return this.getLevelAttributeValue2(this.record.level)},k.prototype.getNextAttributeValue2=function(){return this.getLevelAttributeValue2(this.record.level+1)},k.prototype.getLevel=function(){return this.record.level},k.prototype.getMaxLevel=function(){return this._maxLevel},k.prototype.getFragment=function(){return this.record.fragment},k.prototype.getUpgradeNeed=function(){return 0<this.record.level&&this.entry.upgradeFragements&&this.record.level<this._maxLevel?this.entry.upgradeFragements[this.record.level-1]:0},k.prototype.getPointNeed=function(){if(0<this.record.level&&this.record.level<this._maxLevel){var t=d.sCardUpgradeConfig.getEntry(this.record.level);return t?t.price:0}return 0},k.prototype.isLevelFull=function(){return this.record.level>=this._maxLevel},k.prototype.isLevelFullWithLevel=function(t){return t>=this._maxLevel},k.prototype.isActive=function(){return 0<this.record.level},k.prototype.isFragmentReadyUpgrade=function(){return this.isActive()&&this.record.level<this._maxLevel&&this.getFragment()>=this.getUpgradeNeed()},k.prototype.isReadyUpgrade=function(){return this.isActive()&&this.record.level<this._maxLevel&&this.getFragment()>=this.getUpgradeNeed()&&this.getPointNeed()<=b.sGGame.localModel.getModule(c.LocalCurrency).get(f.sCurrencyConfig.config.cardUpgradePoint)},k.prototype.isUnlock=function(){return!(b.sGGame.localModel.getModule(S.LocalBuildingPackage).getCurrentAge()<this.entry.unlockAge)},k.prototype.canRandomCard=function(){return this.isUnlock()||this.isActive()},k.prototype.getUnlockStageEntry=function(){return g.sStageConfig.getEntry(1)},k.prototype.canEquip=function(){if(this.isSoldierCard)return!0;var t=l[this.entry.type];return t==l.disaster||t==l.summon||t==l.tech},k.prototype.isEquiped=function(){return this.canEquip()&&this.record.equiped},k);function k(){this.record=null,this.entry=null,this._maxLevel=0,this.isSoldierCard=!1}function T(){var t=null!==B&&B.apply(this,arguments)||this;return t.localModel=null,t.cardPlayerRecord=null,t.cardRecordDic=null,t._dataDirty=!1,t._cardDic={},t._pullConfigMaxTimes=0,t.attributeSlotName="card",t.equipSkillCardDic={},t.equipSoldierCardDic={},t}n.LocalCard=R,r(T,B=v.GModule),T.prototype.init=function(t){for(var e in _.sGGameData.addTable(_.sGGameDataType.local,"cardPlayer",new w),_.sGGameData.addTable(_.sGGameDataType.local,"card",{0:new A}),this.localModel=t,u.sCardPullConfig.config)e=parseInt(e),this._pullConfigMaxTimes<e&&(this._pullConfigMaxTimes=e)},T.prototype.load=function(){for(var t in this._cardDic={},this.cardPlayerRecord=this.localModel.localData.cardPlayer,this.cardRecordDic=this.localModel.localData.card,s.sCardConfig.config){var e=parseInt(t),o=new R;t=this._getCardRecord(e),o.init(this.localModel,t),this._cardDic[e]=o}},T.prototype.start=function(){for(var t in this._cardDic)(o=this._cardDic[t]).isActive()&&this._refreshAttribute(o,!0);for(var e=0;e<p.sConstConfig.config.initCardIDArray.length;++e){var o,i=p.sConstConfig.config.initCardIDArray[e];i&&(o=this._cardDic[i])&&0==o.getLevel()&&this.addCard(i)}},T.prototype.afterStart=function(){this._checkSoldierEquip(),this._checkSkillEquip()},T.prototype.stop=function(){this._cardDic={},this.equipSkillCardDic={},this.equipSoldierCardDic={}},T.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("cardPlayer",this.cardPlayerRecord),this.localModel.database.update("card",this.cardRecordDic))},T.prototype.dailyClear=function(){this.cardPlayerRecord.adPullTimesToday=0,this.cardPlayerRecord.adUpgradeTimes=0,this._dataDirty=!0},T.prototype._checkSoldierEquip=function(){for(var t in this.equipSoldierCardDic={},s.sCardConfig.config)t=parseInt(t),(t=this._cardDic[t]).isSoldierCard&&t.record.equiped&&(this.equipSoldierCardDic[t.entry.id]=t)},T.prototype._checkSkillEquip=function(){for(var t in this.equipSkillCardDic={},s.sCardConfig.config){var e=parseInt(t);!(o=this._cardDic[e]).isSoldierCard&&o.record.equiped&&(this.equipSkillCardDic[o.entry.type]=o)}for(var t in s.sCardConfig.config){var o;e=parseInt(t),(o=this._cardDic[e]).isSoldierCard||!o.isActive()||this.equipSkillCardDic[o.entry.type]||((this.equipSkillCardDic[o.entry.type]=o).record.equiped=!0,this._dataDirty=!0)}},T.prototype._getCardRecord=function(t){var e=this.cardRecordDic[t];return e||((e=new A).cid=t,e.level=0,this.cardRecordDic[t]=e,this._dataDirty=!0),e},T.prototype.hasAnyCard=function(){for(var t in this._cardDic)if(this._cardDic[t].isActive())return!0;return!1},T.prototype.getCardArray=function(t){var e,o=[];for(e in this._cardDic){var i=this._cardDic[e];t&&i.entry.type!=t||o.push(i)}return o},T.prototype.isPublishedCard=function(){return!0},T.prototype.getSkillCardArray=function(t){var e,o=[];for(e in this._cardDic){var i=this._cardDic[e];(t||i.isSoldierCard)&&i.entry.type!=t||o.push(i)}return o},T.prototype.getSoldierCardArray=function(t){var e,o=[];for(e in this._cardDic){var i=this._cardDic[e];(!t&&i.isSoldierCard||i.entry.type==t)&&this.isPublishedCard(i)&&o.push(i)}return o},T.prototype.getActivedSoldierCardArray=function(){var t,e=[];for(t in this._cardDic){var o=this._cardDic[t];o.isSoldierCard&&o.isActive()&&this.isPublishedCard(o)&&e.push(o)}return e},T.prototype.getActivedSkillCardArray=function(){var t,e=[];for(t in this._cardDic){var o=this._cardDic[t];!o.isSoldierCard&&o.isActive()&&e.push(o)}return e},T.prototype.getCardArrayByAge=function(t){var e,o=[];for(e in this._cardDic){var i=this._cardDic[e];i.entry.unlockAge==t&&o.push(i)}return o},T.prototype.getCard=function(t){return this._cardDic[t]},T.prototype.getBattleScore=function(){var t,e=0;for(t in this._cardDic){var o=this._cardDic[t];o.canEquip()?o.isEquiped()&&(e+=o.entry.scoreByLevel[o.getLevel()-1]):o.isActive()&&(e+=o.entry.scoreByLevel[o.getLevel()-1])}return e},T.prototype.addCard=function(t){var e=this.getCard(t);return 0!==e.getLevel()?1:(e.record.level=1,e.isSoldierCard||this.equipSkillCardDic[e.entry.type]||((this.equipSkillCardDic[e.entry.type]=e).record.equiped=!0,b.sGGame.emit(n.sLocalCardEvent.changeEquip,e)),t=Object.keys(this.equipSoldierCardDic).length,e.isSoldierCard&&t<5&&((this.equipSoldierCardDic[e.entry.id]=e).record.equiped=!0,b.sGGame.emit(n.sLocalCardEvent.changeEquip,e)),this._refreshAttribute(e,!0),this._dataDirty=!0,0)},T.prototype.addAllCard=function(){for(var t in s.sCardConfig.config)(t=s.sCardConfig.config[t])&&this.addCard(t.id)},T.prototype.addCardFragment=function(t,e){(t=this.getCard(t)).record.fragment+=e,t.record.fragmentTotal+=e,this._dataDirty=!0},T.prototype.randomCard=function(t){var e,o=[],i=0;if(t)for(var a in s.sCardConfig.config)(e=this.getCard(parseInt(a))).entry.quality===t&&e.canRandomCard()&&(o.push(e.entry),i+=e.entry.pullWeight);else for(var a in s.sCardConfig.config)(e=this.getCard(parseInt(a))).canRandomCard()&&(o.push(e.entry),i+=e.entry.pullWeight);for(var n,r=Math.random()*i,l=0;l<o.length;++l){var c=o[l];if(r<c.pullWeight){n=c;break}r-=c.pullWeight}return n},T.prototype.randomMaxAgeCard=function(t){var e,o=this.localModel.getModule(S.LocalBuildingPackage).getCurrentAge(),i=[],a=0;if(t)for(var n in s.sCardConfig.config)(e=this.getCard(parseInt(n))).entry.quality===t&&e.canRandomCard()&&e.entry.unlockAge===o&&(i.push(e.entry),a+=e.entry.pullWeight);else for(var n in s.sCardConfig.config)(e=this.getCard(parseInt(n))).canRandomCard()&&e.entry.unlockAge===o&&(i.push(e.entry),a+=e.entry.pullWeight);for(var r,l=Math.random()*a,c=0;c<i.length;++c){var u=i[c];if(l<u.pullWeight){r=u;break}l-=u.pullWeight}return r},T.prototype.isCanRandomCardFragment=function(t,e){for(var o in s.sCardConfig.config){var i=s.sCardConfig.getEntry(o);if(o=this._cardDic[i.id],(!t||i.quality===t)&&(!e||i.unlockAge===e)&&o.isActive())return!0}return!1},T.prototype.randomCardFragment=function(t,e){var o,i=[],a=0;for(o in s.sCardConfig.config){var n=s.sCardConfig.getEntry(o),r=this._cardDic[n.id];t&&n.quality!==t||e&&n.unlockAge!==e||!r.isActive()||(i.push(n),a+=n.pullWeight)}for(var l,c=Math.random()*a,u=0;u<i.length;++u){if(c<(n=i[u]).pullWeight){l=n;break}c-=n.pullWeight}return l},T.prototype.getCardCanUpgrade=function(){for(var t=this.getCardArray(),e=0;e<t.length;++e){var o=t[e];if(0===this.checkUpgrade(o.entry.id))return o}},T.prototype.checkUpgrade=function(t,e){return void 0===e&&(e=!1),(t=this._cardDic[t]).isLevelFull()||!t.isActive()?-1:t.record.fragment<t.getUpgradeNeed()?2:(t=d.sCardUpgradeConfig.getEntry(t.record.level).price,this.localModel.getModule(c.LocalCurrency).get(f.sCurrencyConfig.config.cardUpgradePoint)<t&&(!e||this.getRemainAdUpgradeTimes()<=0)?3:0)},T.prototype.getRemainAdUpgradeTimes=function(){var t=this.getMaxAdUpgradeTimes()-this.cardPlayerRecord.adUpgradeTimes;return t<0?0:t},T.prototype.getMaxAdUpgradeTimes=function(){return 3},T.prototype.upgrade=function(t,e){return this.checkUpgrade(t,e=void 0!==e&&e)||(t=this._cardDic[t],e?this.cardPlayerRecord.adUpgradeTimes++:(e=d.sCardUpgradeConfig.getEntry(t.record.level).price,this.localModel.getModule(c.LocalCurrency).use(f.sCurrencyConfig.config.cardUpgradePoint,e,C.eReasonType.upgradeCard)),t.record.fragment-=t.getUpgradeNeed(),this._dataDirty=!0,this._refreshAttribute(t,!1),t.record.level+=1,this._refreshAttribute(t,!0),b.sGGame.emit(n.sLocalCardEvent.upgrade,t),0)},T.prototype.getPullNeed=function(){var t=this.cardPlayerRecord.currencyPullTimes+1;return t>this._pullConfigMaxTimes&&(t=this._pullConfigMaxTimes),(t=u.sCardPullConfig.getEntry(t))?t.price:999},T.prototype.getAdPullCardTimesDaily=function(){return b.sGGame.localModel.getModule(P.LocalAttribute).getValue(P.eAttributeObjectType.player,0,h.sPlayerAttributeConfig.config.maxRandomCardTimes)},T.prototype.getRemainPullTimes=function(){var t=this.getAdPullCardTimesDaily()-this.cardPlayerRecord.adPullTimesToday;return 0<=t?t:0},T.prototype.isPullOpened=function(){return 1<this.localModel.getModule(S.LocalBuildingPackage).getCurrentAge()},T.prototype.checkPull=function(t){return this.isPullOpened()?t?this.cardPlayerRecord.adPullTimesToday>=this.getAdPullCardTimesDaily()?2:0:this.localModel.getModule(c.LocalCurrency).get(f.sCurrencyConfig.config.pullCardPoint)<this.getPullNeed()?1:0:3},T.prototype.pull=function(t,e){if(o=this.checkPull(t))return e&&e(o),o;t?(this.cardPlayerRecord.adPullTimesToday+=1,this.cardPlayerRecord.adPullTimes+=1):(b.sGGame.localModel.getModule(c.LocalCurrency).use(f.sCurrencyConfig.config.pullCardPoint,this.getPullNeed(),C.eReasonType.pullCard),this.cardPlayerRecord.currencyPullTimes+=1);var o=this.localModel.getModule(G.LocalReward);return o=this.cardPlayerRecord.totalPullTimes<p.sConstConfig.config.firstPullCardID.length?((t=new y.RewardList).add(G.eRewardType.card,p.sConstConfig.config.firstPullCardID[this.cardPlayerRecord.totalPullTimes],1),o.takeRewardList(t,!0,1,C.eReasonType.pullCard)):o.takeRewardString("randomCard/0/1",!0,1,C.eReasonType.pullCard),this.cardPlayerRecord.totalPullTimes+=1,this.cardPlayerRecord.pullCardTimesForBox<p.sConstConfig.config.pullCardTimeForBox&&(this.cardPlayerRecord.pullCardTimesForBox+=1),this._dataDirty=!0,b.sGGame.emit(n.sLocalCardEvent.pullCard,o),e&&e(0,o),0},T.prototype.pullTest=function(){for(var t={},e=0;e<1e3;++e){this.cardPlayerRecord.totalPullTimes+=1;var o=this.localModel.getModule(G.LocalReward).takeRewardString("randomCard/0/1",!0,1,C.eReasonType.pullCard).rewardList.getReward(0);t[(o=this.getCard(o.id)).entry.quality]=t[o.entry.quality]||0,t[o.entry.quality]++}console.log(t)},T.prototype.freeMultiPull=function(t,e){var o=this.localModel.getModule(G.LocalReward).takeRewardString("randomCard/0/"+t,!0,1,C.eReasonType.freeMultiPullCard);return this.cardPlayerRecord.pullCardTimesForBox<p.sConstConfig.config.pullCardTimeForBox&&(this.cardPlayerRecord.pullCardTimesForBox+=t,this.cardPlayerRecord.pullCardTimesForBox>p.sConstConfig.config.pullCardTimeForBox&&(this.cardPlayerRecord.pullCardTimesForBox=p.sConstConfig.config.pullCardTimeForBox)),this.cardPlayerRecord.totalPullTimes+=t,this._dataDirty=!0,b.sGGame.emit(n.sLocalCardEvent.pullCard,o),e&&e(0,o),0},T.prototype.checkPull10Times=function(){return this.isPullOpened()?this.localModel.getModule(c.LocalCurrency).get(f.sCurrencyConfig.config.pullCardPoint)<this.getPull10TimesNeed()?1:0:3},T.prototype.getPull10TimesNeed=function(){return p.sConstConfig.config.pullCard10TimesPrice},T.prototype.pull10Times=function(t){if(o=this.checkPull10Times())return t&&t(o),o;var e=this.localModel.getModule(G.LocalReward).takeRewardString("randomCard/0/10",!0,1,C.eReasonType.pullCard10Times),o=this.getPull10TimesNeed();return this.localModel.getModule(c.LocalCurrency).use(f.sCurrencyConfig.config.pullCardPoint,o,C.eReasonType.pullCard10Times),this.cardPlayerRecord.pullCardTimesForBox<p.sConstConfig.config.pullCardTimeForBox&&(this.cardPlayerRecord.pullCardTimesForBox+=10,this.cardPlayerRecord.pullCardTimesForBox>p.sConstConfig.config.pullCardTimeForBox&&(this.cardPlayerRecord.pullCardTimesForBox=p.sConstConfig.config.pullCardTimeForBox)),this.cardPlayerRecord.totalPullTimes+=10,this._dataDirty=!0,b.sGGame.emit(n.sLocalCardEvent.pullCard,e),t&&t(0,e),0},T.prototype.getNormalFreePullRemainTime=function(){var t=this.cardPlayerRecord.normalPullTimestamp;return 0===t?-1:(t=m.sGTime.timestamp()-t,0<(t=Math.floor((1e3*p.sConstConfig.config.normalSacrificeSeconds-t)/1e3))?t:0)},T.prototype.isStartNormalFreePullUnlock=function(){return!!this.localModel.getModule(M.LocalStage).isSystemIsOpened(p.sConstConfig.config.normalSacrificeUnlockStage)},T.prototype.checkStartNormalFreePull=function(){return this.isStartNormalFreePullUnlock()?0<this.getNormalFreePullRemainTime()?1:0:2},T.prototype.startNormalFreePull=function(t){var e=this.checkStartNormalFreePull();return e?(t&&t(e),e):(this.cardPlayerRecord.normalPullTimestamp=m.sGTime.timestamp(),this.cardPlayerRecord.pullCardTimesForBox<p.sConstConfig.config.pullCardTimeForBox&&(this.cardPlayerRecord.pullCardTimesForBox+=1),this._dataDirty=!0,e=this.localModel.getModule(G.LocalReward).takeRewardString("randomCard/4/1",!0,1,C.eReasonType.normalPullCard),t&&t(0,e),b.sGGame.emit(n.sLocalCardEvent.pullCard,e),0)},T.prototype.getAdvancedFreePullRemainTime=function(){var t=this.cardPlayerRecord.advancedPullTimestamp;return 0===t?-1:(t=m.sGTime.timestamp()-t,0<(t=Math.floor((1e3*p.sConstConfig.config.advancedSacrificeSeconds-t)/1e3))?t:0)},T.prototype.isStartAdvancedFreePullUnlock=function(){return!!this.localModel.getModule(M.LocalStage).isSystemIsOpened(p.sConstConfig.config.advancedSacrificeUnlockStage)},T.prototype.checkStartAdvancedFreePull=function(){return this.isStartAdvancedFreePullUnlock()?0<this.getAdvancedFreePullRemainTime()?1:0:2},T.prototype.startAdvancedFreePull=function(t){var e=this.checkStartAdvancedFreePull();return e?(t&&t(e),e):(this.cardPlayerRecord.advancedPullTimestamp=m.sGTime.timestamp(),this.cardPlayerRecord.pullCardTimesForBox<p.sConstConfig.config.pullCardTimeForBox&&(this.cardPlayerRecord.pullCardTimesForBox+=1),this._dataDirty=!0,e=this.localModel.getModule(G.LocalReward).takeRewardString("randomCard/5/1",!0,1,C.eReasonType.advancePullCard),t&&t(0,e),b.sGGame.emit(n.sLocalCardEvent.pullCard,e),0)},T.prototype._refreshAttribute=function(t,e){var o,i,a;t.isActive()&&(o=this.localModel.getModule(P.LocalAttribute),i=t.entry,a=t.getAttributeValue1(),a=e?a:-a,i.attributeObjectType1&&o.addPosValue(i.attributeObjectType1,t.entry.attributeObjectID1,this.attributeSlotName,i.attributeType1,i.attributePos1,a),a=t.getAttributeValue2(),a=e?a:-a,i.attributeObjectType2&&o.addPosValue(i.attributeObjectType2,t.entry.attributeObjectID2,this.attributeSlotName,i.attributeType2,i.attributePos2,a))},T.prototype.changeSkillEquip=function(t){if(!t||!t.isActive())return 1;var e=this.equipSkillCardDic[t.entry.type];return e&&(e.record.equiped=!1),t.record.equiped=!0,this.equipSkillCardDic[t.entry.type]=t,this._dataDirty=!0,b.sGGame.emit(n.sLocalCardEvent.changeEquip,t),0},T.prototype.addSoldierEquip=function(t){return t&&t.isActive()?5<=Object.keys(this.equipSoldierCardDic).length?2:(t.record.equiped=!0,this.equipSoldierCardDic[t.entry.id]=t,this._dataDirty=!0,b.sGGame.emit(n.sLocalCardEvent.changeEquip,t),0):1},T.prototype.removeSoldierEquip=function(t){return t&&t.isActive()?(t.record.equiped=!1,delete this.equipSoldierCardDic[t.entry.id],this._dataDirty=!0,b.sGGame.emit(n.sLocalCardEvent.changeEquip,t),0):1},T.prototype.checkCollectPullCardTimesBox=function(){return this.cardPlayerRecord.pullCardTimesForBox<p.sConstConfig.config.pullCardTimeForBox?1:0},T.prototype.collectPullCardTimesBox=function(t){var e=this.checkCollectPullCardTimesBox();if(e)return e;this.cardPlayerRecord.pullCardTimesForBox=0,this._dataDirty=!0;var o=this.localModel.getModule(G.LocalReward).takeRewardString("randomMaxAgeCard/5/1",!0,1,C.eReasonType.pullCardTimesBox);return t&&t(0,o),e},r=T,n.LocalCardPackage=r,cc._RF.pop()},{}],local_check_in_7day:[function(t,e,o){"use strict";cc._RF.push(e,"9aef4DMo/tFbrB1PVohXq7y","local_check_in_7day");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.eLocalCheckIn7DayError=n.LocalPlayerCheckIn7DayRecord=n.sLocalCheckIn7DayEvent=void 0;var l,c,s=a("local_info"),u=a("check_in_7_day_config"),d=a("gtime"),p=a("ggame"),f=a("ggame_data"),h=a("gmodule"),g=a("reason_define"),y=a("local_reward");function m(){this.oid=0,this.lastCheckInTime=0,this.dayForChecked=0}function b(){var t=null!==c&&c.apply(this,arguments)||this;return t._data=null,t._dataDirty=!1,t.localModel=null,t}n.sLocalCheckIn7DayEvent={checkIn:"sLocalCheckIn7DayEvent_checkIn"},n.LocalPlayerCheckIn7DayRecord=m,(a=l=n.eLocalCheckIn7DayError||(n.eLocalCheckIn7DayError={}))[a.ok=0]="ok",a[a.illegalDay=1]="illegalDay",r(b,c=h.GModule),b.prototype.init=function(t){f.sGGameData.addTable(f.sGGameDataType.local,"playerCheckIn7Day",new m),this.localModel=t},b.prototype.load=function(){this._data=this.localModel.localData.playerCheckIn7Day},b.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("playerCheckIn7Day",this._data))},b.prototype.getCurrentDay=function(){var t=d.sGTime.timestamp()-d.sGTime.midnight(this._data.lastCheckInTime).getTime();return t=Math.floor(t/864e5),this._data.dayForChecked+(0<t?1:t)},b.prototype.getDayForChecked=function(){return this._data.dayForChecked},b.prototype.isChecked=function(t){return t<=this._data.dayForChecked},b.prototype.checkTodayChecked=function(){var t=this.getCurrentDay();return!u.sCheckIn7DayConfig.getEntry(t)||t<=this._data.dayForChecked?l.illegalDay:l.ok},b.prototype.checkEnd=function(){return!u.sCheckIn7DayConfig.getEntry(this._data.dayForChecked+1)},b.prototype.checkIn=function(){var t,e=this.checkTodayChecked();return 0!=e?{errorCode:e}:(this._data.dayForChecked=this.getCurrentDay(),this._data.lastCheckInTime=d.sGTime.timestamp(),(e=u.sCheckIn7DayConfig.getEntry(this._data.dayForChecked))&&(t=this.localModel.getModule(y.LocalReward).takeRewardString(e.reward,!0,1,g.eReasonType.checkIn7Days)),this.localModel.getModule(s.LocalInfo).getPlayDayCountForReport(),this._dataDirty=!0,p.sGGame.emit(n.sLocalCheckIn7DayEvent.checkIn,this._data.dayForChecked),{errorCode:l.ok,rewardResult:t})},r=b,n.default=r,cc._RF.pop()},{}],local_check_in_daily:[function(t,e,o){"use strict";cc._RF.push(e,"a5af2Hp7AxK9KtjT5EEEXi4","local_check_in_daily");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalPlayerCheckInDailyRecord=n.sLocalCheckInDailyEvent=void 0;var l,c=a("check_in_daily_config"),s=a("local_reward"),u=a("gmodule"),d=a("gtime"),p=a("ggame"),f=a("ggame_data"),h=a("local_info"),g=a("client_config"),y=a("reason_define");function m(){this.oid=0,this.lastCheckInTime=0,this.dayForChecked=0}function b(){var t=null!==l&&l.apply(this,arguments)||this;return t._data=null,t._dataDirty=!1,t.localModel=null,t}n.sLocalCheckInDailyEvent={checkIn:"sLocalCheckInDailyEvent_checkIn"},n.LocalPlayerCheckInDailyRecord=m,r(b,l=u.GModule),b.prototype.init=function(t){f.sGGameData.addTable(f.sGGameDataType.local,"playerCheckInDaily",new m),this.localModel=t},b.prototype.load=function(){this._data=this.localModel.localData.playerCheckInDaily},b.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("playerCheckInDaily",this._data))},b.prototype.dailyClear=function(){var t=d.sGTime.timestamp()-d.sGTime.midnight(this._data.lastCheckInTime).getTime();1<(t=this._data.dayForChecked+Math.floor(t/864e5))-this._data.dayForChecked&&(this._data.dayForChecked=0,this._data.lastCheckInTime=d.sGTime.yesterdayMidnight().getTime(),t=1,this._dataDirty=!0),7<t&&(this._data.dayForChecked=0,this._data.lastCheckInTime=d.sGTime.yesterdayMidnight().getTime(),t=1,this._dataDirty=!0)},b.prototype.getCurrentDay=function(){var t=d.sGTime.timestamp()-d.sGTime.midnight(this._data.lastCheckInTime).getTime();return 1<(t=this._data.dayForChecked+Math.floor(t/864e5))-this._data.dayForChecked&&(this._data.dayForChecked=0,this._data.lastCheckInTime=d.sGTime.yesterdayMidnight().getTime(),t=1,this._dataDirty=!0),7<t&&(this._data.dayForChecked=0,this._data.lastCheckInTime=d.sGTime.yesterdayMidnight().getTime(),t=1,this._dataDirty=!0),t},b.prototype.getDayForChecked=function(){return this._data.dayForChecked},b.prototype.isChecked=function(t){return t<=this._data.dayForChecked},b.prototype.checkTodayChecked=function(){return!g.sClientConfig.config.checkInDailyEnabled||this.getCurrentDay()<=this._data.dayForChecked?1:0},b.prototype.checkIn=function(){var t,e;return 0!=(e=this.checkTodayChecked())?{errorCode:e}:(this._data.dayForChecked=this.getCurrentDay(),this._data.lastCheckInTime=d.sGTime.timestamp(),(e=c.sCheckInDailyConfig.getEntry(this._data.dayForChecked))&&(t=this.localModel.getModule(s.LocalReward).takeRewardString(e.reward,!0,1,y.eReasonType.checkInDaily)),this.localModel.getModule(h.LocalInfo).getPlayDayCountForReport(),this._dataDirty=!0,p.sGGame.emit(n.sLocalCheckInDailyEvent.checkIn),{errorCode:0,rewardResult:t})},r=b,n.default=r,cc._RF.pop()},{}],local_checkin_beginner:[function(t,e,o){"use strict";cc._RF.push(e,"779bfjo8VtHg5IEFQr1yrS1","local_checkin_beginner");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.sLocalCheckinBeginnerEventType=n.LocalCheckinBeginnerRecord=n.LocalPlayerCheckinBeginnerRecord=n.eLocalCheckinError=void 0;var l,c,s=a("local_info"),u=a("checkin_beginner_config"),d=a("event_config"),p=a("ganalytics"),f=a("gtime"),h=a("ggame"),g=a("ggame_data"),y=a("gmodule"),m=a("reason_define"),b=a("local_reward");function _(){this.oid=0,this.lastCheckInTime=0,this.dayForChecked=0}function v(){this.cid=0,this.doubleRewarded=!1}function C(){var t=null!==c&&c.apply(this,arguments)||this;return t._data=null,t._dataDirty=!1,t.localModel=null,t}(a=l=n.eLocalCheckinError||(n.eLocalCheckinError={}))[a.ok=0]="ok",a[a.illegalDay=1]="illegalDay",a[a.alreadyDouble=2]="alreadyDouble",n.LocalPlayerCheckinBeginnerRecord=_,n.LocalCheckinBeginnerRecord=v,n.sLocalCheckinBeginnerEventType={checkin:"sLocalCheckinBeginnerEventType.checkin",patchDouble:"sLocalCheckinBeginnerEventType.patchDouble"},r(C,c=y.GModule),C.prototype.init=function(t){g.sGGameData.addTable(g.sGGameDataType.local,"playerCheckinBeginner",new _),g.sGGameData.addTable(g.sGGameDataType.local,"checkinBeginner",{0:new v}),this.localModel=t},C.prototype.load=function(){this._data=this.localModel.localData.playerCheckinBeginner,this._dayRecordDic=this.localModel.localData.checkinBeginner},C.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("playerCheckinBeginner",this._data),this.localModel.database.update("checkinBeginner",this._dayRecordDic))},C.prototype.getCurrentDay=function(){var t=f.sGTime.timestamp()-f.sGTime.midnight(this._data.lastCheckInTime).getTime();return t=Math.floor(t/864e5),this._data.dayForChecked+(0<t?1:t)},C.prototype.getDayForChecked=function(){return this._data.dayForChecked},C.prototype.isChecked=function(t){return t<=this._data.dayForChecked},C.prototype.checkTodayChecked=function(){var t=this.getCurrentDay();return!u.sCheckinBeginnerConfig.getEntry(t)||t<=this._data.dayForChecked?l.illegalDay:l.ok},C.prototype.checkEnd=function(){var t=this._data.dayForChecked+1;if(u.sCheckinBeginnerConfig.getEntry(t))return!1;for(var e=1;e<t;++e){var o=this.getDayRecord(e);if(!o||!o.doubleRewarded)return!1}return!0},C.prototype.allocDayRecord=function(t){var e=this._dayRecordDic[t];return e||((e=new v).cid=t,this._dayRecordDic[t]=e,this._dataDirty=!0,e)},C.prototype.getDayRecord=function(t){return this._dayRecordDic[t]},C.prototype.checkIn=function(t){var e,o=this.checkTodayChecked();if(0!=o)return{errorCode:o};this._data.dayForChecked=this.getCurrentDay(),this._data.lastCheckInTime=f.sGTime.timestamp(),(o=u.sCheckinBeginnerConfig.getEntry(this._data.dayForChecked))&&(e=this.localModel.getModule(b.LocalReward).takeRewardString(o.reward,!0,t?2:1,m.eReasonType.checkInBeginner)),!t||(i=this.allocDayRecord(this._data.dayForChecked))&&(i.doubleRewarded=!0),this._dataDirty=!0;var i=this.localModel.getModule(s.LocalInfo).getPlayDayCountForReport();return p.sGAnalytics.reportAnalytics(d.sEventConfig.config.checkinBeginner,{days:i}),h.sGGame.emit(n.sLocalCheckinBeginnerEventType.checkin,i),{errorCode:l.ok,rewardResult:e}},C.prototype.checkPatchDoubleReward=function(t){return!u.sCheckinBeginnerConfig.getEntry(t)||t>this._data.dayForChecked?l.illegalDay:(t=this.getDayRecord(t))&&t.doubleRewarded?l.alreadyDouble:l.ok},C.prototype.patchDoubleReward=function(t){var e,o=this.checkPatchDoubleReward(t);return 0!=o?{errorCode:o}:((o=u.sCheckinBeginnerConfig.getEntry(t))&&(e=this.localModel.getModule(b.LocalReward).takeRewardString(o.reward,!0,1,m.eReasonType.checkInBeginner)),(t=this.allocDayRecord(t))&&(t.doubleRewarded=!0),this._dataDirty=!0,t=this.localModel.getModule(s.LocalInfo).getPlayDayCountForReport(),p.sGAnalytics.reportAnalytics(d.sEventConfig.config.checkinBeginner,{days:t}),h.sGGame.emit(n.sLocalCheckinBeginnerEventType.patchDouble,t),{errorCode:l.ok,rewardResult:e})},r=C,n.default=r,cc._RF.pop()},{}],local_config:[function(t,e,o){"use strict";cc._RF.push(e,"e4d25WFQOdPSZ741/R0/QCr","local_config");var i,a=t,n=e,r=o;function l(){this.oid=0,this.adPersonalized=!1,this.beginningShown=!1}i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},n=function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},Object.defineProperty(r,"__esModule",{value:!0}),r.LocalConfig=r.LocalPlayerConfigRecord=void 0;var c,s=a("ggame_data");function u(){var t=null!==c&&c.apply(this,arguments)||this;return t.localModel=null,t.playerConfigRecord=null,t.recordDirty=!1,t}a=a("gmodule"),r.LocalPlayerConfigRecord=l,n(u,c=a.GModule),u.prototype.init=function(t){s.sGGameData.addTable(s.sGGameDataType.local,"config",new l),this.localModel=t},u.prototype.load=function(){this.playerConfigRecord=this.localModel.localData.config},u.prototype.start=function(){},u.prototype.stop=function(){},u.prototype.save=function(){this.recordDirty&&(this.recordDirty=!1,this.localModel.database.update("config",this.playerConfigRecord))},Object.defineProperty(u.prototype,"adPersonalized",{get:function(){return this.playerConfigRecord.adPersonalized},set:function(t){this.playerConfigRecord.adPersonalized=t,this.recordDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"beginningShown",{get:function(){return this.playerConfigRecord.beginningShown},set:function(t){this.playerConfigRecord.beginningShown=t,this.recordDirty=!0},enumerable:!1,configurable:!0}),n=u,r.LocalConfig=n,cc._RF.pop()},{}],local_debug:[function(t,e,o){"use strict";cc._RF.push(e,"d8d1fiZOWNHT7N1vImUqfnw","local_debug");var i,a,n=t,r=e,l=o;function c(){var t=null!==a&&a.apply(this,arguments)||this;return t.localModel=null,t.recordDirty=!1,t}i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},r=function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},Object.defineProperty(l,"__esModule",{value:!0}),l.LocalDebug=void 0,r(c,a=n("gmodule").GModule),c.prototype.init=function(t){this.localModel=t},c.prototype.load=function(){},c.prototype.start=function(){},c.prototype.stop=function(){},c.prototype.save=function(){this.recordDirty&&(this.recordDirty=!1)},r=c,l.LocalDebug=r,cc._RF.pop()},{}],local_fuben:[function(t,e,o){"use strict";cc._RF.push(e,"77a01+QZvZC+Z4ErCKnUeUj","local_fuben");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalFuben=n.enumFubenType=n.LocalFubenPlayerRecord=n.sLocalFubenEvent=void 0;var l,c,s=a("client_config"),u=a("const_config"),d=a("fuben_config"),p=a("fuben_spawner_config"),f=a("reward_helper"),h=a("glog"),g=a("ggame"),y=a("ggame_data"),m=a("gmodule"),b=a("reason_define"),_=a("local_attribute"),v=a("local_card"),C=a("local_reward"),P=a("local_soldier"),S=a("local_stage");function G(){this.oid=0,this.lastPassedFubenIDArray=[0,0],this.currentBattleFubenIDArray=[1001,2001],this.freeSweepTimesArray=[2,2],this.adSweepTimesArray=[2,2]}function M(){var t=null!==c&&c.apply(this,arguments)||this;return t.localModel=null,t.fubenPlayerRecord=null,t._dataDirty=!1,t.currentBattleFubenType=0,t.fubenStartIDArray=[1001,2001],t}n.sLocalFubenEvent={currentFubenChanged:"sLocalFubenEvent.currentPataChanged",lastPassedFubenChanged:"sLocalFubenEvent.lastPassedFubenChanged",collectReward:"sLocalFubenEvent.collectReward",collectDoubleReward:"sLocalFubenEvent.collectDoubleReward",sweep:"sLocalFubenEvent.sweep"},n.LocalFubenPlayerRecord=G,(a=l=n.enumFubenType||(n.enumFubenType={}))[a.fuben1=0]="fuben1",a[a.fuben2=1]="fuben2",a[a.max=2]="max",r(M,c=m.GModule),M.prototype.init=function(t){if(y.sGGameData.addTable(y.sGGameDataType.local,"fubenPlayer",new G),this.localModel=t,s.sClientConfig.config.devMode)for(var e in p.sFubenSpawnerConfig.config)for(var o=p.sFubenSpawnerConfig.getEntry(e),i=0;i<o.length;++i)((n=o[i]).soldiers.length>n.level.length||n.soldiers.length>n.spawnerCount.length)&&h.sGLog.error("\u526f\u672c\u51fa\u5175\u914d\u7f6e\u9519\u8bef "+n.id+"  "+n.seconds+" "+n.soldiers.length+" "+n.level.length+" "+n.spawnerCount.length);for(var a in d.sFubenConfig.config){var n;2e3<=(n=d.sFubenConfig.config[a]).id?n.sortID=n.id-2e3:1e3<=n.id&&(n.sortID=n.id-1e3)}},M.prototype.load=function(){this.localAttribute=this.localModel.getModule(_.LocalAttribute),this.localSoldierPackage=this.localModel.getModule(P.LocalSoldierPackage),this.localCardPackage=this.localModel.getModule(v.LocalCardPackage),this.fubenPlayerRecord=this.localModel.localData.fubenPlayer},M.prototype.start=function(){},M.prototype.stop=function(){},M.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("fubenPlayer",this.fubenPlayerRecord))},M.prototype.dailyClear=function(){this.fubenPlayerRecord.freeSweepTimesArray=[2,2],this.fubenPlayerRecord.adSweepTimesArray=[2,2],this._dataDirty=!0},M.prototype.gotoNext=function(t,e){var o=d.sFubenConfig.getEntry(e);e=(e=d.sFubenConfig.getEntry(e+1))||o,this.fubenPlayerRecord.currentBattleFubenIDArray[t]=e.id,this.fubenPlayerRecord.lastPassedFubenIDArray[t]=o.id,this._dataDirty=!0,g.sGGame.emit(n.sLocalFubenEvent.currentFubenChanged,t,e.id,e.sortID),g.sGGame.emit(n.sLocalFubenEvent.lastPassedFubenChanged,t,o.id,o.sortID)},M.prototype.getCurrentBattleFubenID=function(t){return this.fubenPlayerRecord.currentBattleFubenIDArray[t]},M.prototype.getLastPassedFubenID=function(t){return this.fubenPlayerRecord.lastPassedFubenIDArray[t]},M.prototype.isSystemIsOpened=function(t){return void 0===t&&(t=0),this.localModel.getModule(S.LocalStage).isSystemIsOpened(u.sConstConfig.config.fubenUnlockStageArray[t])},M.prototype.getFreeSweepTimes=function(t){return this.fubenPlayerRecord.freeSweepTimesArray[t]},M.prototype.getADSweepTimes=function(t){return this.fubenPlayerRecord.adSweepTimesArray[t]},M.prototype.checkFreeSweep=function(t){return 0==this.fubenPlayerRecord.freeSweepTimesArray[t=void 0===t?0:t]?1:0==this.getLastPassedFubenID(this.currentBattleFubenType)?2:0},M.prototype.freeSweep=function(t){return this.checkFreeSweep(t=void 0===t?0:t)||(this._randomReward(this.getLastPassedFubenID(t)),this._collectReward(t),this.fubenPlayerRecord.freeSweepTimesArray[t]--,this._dataDirty=!0,g.sGGame.emit(n.sLocalFubenEvent.sweep,t),0)},M.prototype.checkADSweep=function(t){return 0==this.fubenPlayerRecord.adSweepTimesArray[t=void 0===t?0:t]?1:0==this.getLastPassedFubenID(t)?2:0},M.prototype.adSweep=function(t){return this.checkADSweep(t=void 0===t?0:t)||(this._randomReward(this.getLastPassedFubenID(t)),this._collectReward(t),this.fubenPlayerRecord.adSweepTimesArray[t]--,this._dataDirty=!0,g.sGGame.emit(n.sLocalFubenEvent.sweep,t),0)},M.prototype.checkStartBattle=function(t){return t=this.getCurrentBattleFubenID(t=void 0===t?0:t),t=d.sFubenConfig.getEntry(t),this.localModel.getModule(S.LocalStage).isSystemIsOpened(t.condition)?0:1},M.prototype.startBattle=function(t){return this.checkStartBattle(t=void 0===t?0:t)||(this.currentBattleFubenType=t,0)},M.prototype.onVictory=function(){this._randomReward(this.getCurrentBattleFubenID(this.currentBattleFubenType)),this.gotoNext(this.currentBattleFubenType,this.fubenPlayerRecord.currentBattleFubenIDArray[this.currentBattleFubenType]),this._dataDirty=!0},M.prototype._randomReward=function(t){this.rewardList=new f.RewardList;var e=d.sFubenConfig.getEntry(t);e.packID?this.localModel.getModule(C.LocalReward).addPataPackReward(this.rewardList,e.packID,e.rewardCount):(t=this.localModel.getModule(C.LocalReward).getBuildingUpgradePointOverTime(e.rewardCount),this.rewardList.add(C.eRewardType.buildingUpgradePoint,t)),e.pullCardPoint&&this.rewardList.add(C.eRewardType.cardUpgradePoint,e.pullCardPoint)},M.prototype.getRewardList=function(){return this.rewardList},M.prototype.collectReward=function(){this._collectReward(this.currentBattleFubenType)},M.prototype.collectDoubleReward=function(){this._collectDoubleReward(this.currentBattleFubenType)},M.prototype._collectReward=function(t){t=t===l.fuben1?b.eReasonType.fuben1Collect:b.eReasonType.fuben2Collect,this.localModel.getModule(C.LocalReward).takeRewardList(this.rewardList,!0,1,t),g.sGGame.emit(n.sLocalFubenEvent.collectReward)},M.prototype._collectDoubleReward=function(t){t=t===l.fuben1?b.eReasonType.fuben1DoubleCollect:b.eReasonType.fuben2DoubleCollect,this.localModel.getModule(C.LocalReward).takeRewardList(this.rewardList,!0,2,t),g.sGGame.emit(n.sLocalFubenEvent.collectDoubleReward)},r=M,n.LocalFuben=r,cc._RF.pop()},{}],local_pata:[function(t,e,o){"use strict";cc._RF.push(e,"8ff70MmA2dPkKiO4UXUgMCW","local_pata");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalPata=n.LocalPataPlayerRecord=n.HistoryBuff=n.sLocalPataEvent=void 0;var l,c=a("client_config"),s=a("const_config"),u=a("pata_buff_config"),d=a("pata_config"),p=a("pata_reward_config"),f=a("pata_spawner_config"),h=a("player_attribute_config"),g=a("soldier_attribute_config"),y=a("reward_helper"),m=a("glog"),b=a("ggame"),_=a("ggame_data"),v=a("gmodule"),C=a("reason_define"),P=a("local_attribute"),S=a("local_card"),G=a("local_reward"),M=a("local_soldier"),w=a("local_stage");function A(){this.pataID=0,this.buffIDArray=[],this.selectedArray=[]}function B(){this.oid=0,this.currentPassPataID=0,this.currentBattlePataID=1,this.topPassPataID=0,this.soldierArray=[],this.rewardTypeArray=[],this.rewardIDArray=[],this.rewardCountArray=[],this.rewardPataCount=0,this.buffArray=[],this.waitCollectBuffArray=[],this.resetTimes=0,this.spawnSoldierIndexArray=[],this.historyBuffDic={}}function R(){var t=null!==l&&l.apply(this,arguments)||this;return t.localModel=null,t.pataPlayerRecord=null,t._dataDirty=!1,t.attributeTotalWeight=0,t.attributeBuffStartID=101,t.attributeBuffEndID=136,t}n.sLocalPataEvent={currentPataChanged:"sLocalPataEvent.currentPataChanged",currentPassPataChanged:"sLocalPataEvent.currentPassPataChanged",soldierArrayChanged:"sLocalPataEvent.soldierArrayChanged",collectReward:"sLocalPataEvent.collectReward",collectDoubleReward:"sLocalPataEvent.collectDoubleReward"},n.HistoryBuff=A,n.LocalPataPlayerRecord=B,r(R,l=v.GModule),R.prototype.init=function(t){if(_.sGGameData.addTable(_.sGGameDataType.local,"pataPlayer",new B),this.localModel=t,c.sClientConfig.config.devMode)for(var e in f.sPataSpawnerConfig.config)(e=f.sPataSpawnerConfig.getEntry(e)).soldiers||m.sGLog.error("\u722c\u5854\u51fa\u5175\u914d\u7f6e\u4e0d\u5b58\u5728 "+e.id);this.attributeTotalWeight=0;for(var o=this.attributeBuffStartID;o<=this.attributeBuffEndID;++o){var i=u.sPataBuffConfig.getEntry(o);this.attributeTotalWeight+=i.weight}},R.prototype.load=function(){this.localAttribute=this.localModel.getModule(P.LocalAttribute),this.localSoldierPackage=this.localModel.getModule(M.LocalSoldierPackage),this.localCardPackage=this.localModel.getModule(S.LocalCardPackage),this.pataPlayerRecord=this.localModel.localData.pataPlayer,this.pataPlayerRecord.soldierArray instanceof Array||(this.pataPlayerRecord.soldierArray=[]),this.pataPlayerRecord.rewardTypeArray instanceof Array||(this.pataPlayerRecord.rewardTypeArray=[]),this.pataPlayerRecord.rewardIDArray instanceof Array||(this.pataPlayerRecord.rewardIDArray=[]),this.pataPlayerRecord.rewardCountArray instanceof Array||(this.pataPlayerRecord.rewardCountArray=[]),this.pataPlayerRecord.buffArray instanceof Array||(this.pataPlayerRecord.buffArray=[]),this.pataPlayerRecord.waitCollectBuffArray instanceof Array||(this.pataPlayerRecord.waitCollectBuffArray=[]),this.pataPlayerRecord.historyBuffDic||(this.pataPlayerRecord.historyBuffDic={}),this.getCurrentBattlePataID()===this.getCurrentPassPataID()&&d.sPataConfig.getEntry(this.getCurrentBattlePataID()+1)&&(this.pataPlayerRecord.currentBattlePataID=this.getCurrentBattlePataID()+1,this._dataDirty=!0),this.currentBattlePataEntry=d.sPataConfig.getEntry(this.pataPlayerRecord.currentBattlePataID)},R.prototype.start=function(){this.rewardList=new y.RewardList;for(var t=0;t<this.pataPlayerRecord.rewardTypeArray.length;++t)this.rewardList.add(this.pataPlayerRecord.rewardTypeArray[t],this.pataPlayerRecord.rewardIDArray[t],this.pataPlayerRecord.rewardCountArray[t]);for(t=0;t<this.pataPlayerRecord.buffArray.length;++t){var e=this.pataPlayerRecord.buffArray[t];this._refreshAttribute(e,!0)}},R.prototype.stop=function(){},R.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("pataPlayer",this.pataPlayerRecord))},R.prototype.gotoNext=function(t){var e=t+1,o=d.sPataConfig.getEntry(e);this.pataPlayerRecord.currentPassPataID=t,this.pataPlayerRecord.currentBattlePataID=o?e:t,(!this.pataPlayerRecord.topPassPataID||t>this.pataPlayerRecord.topPassPataID)&&(this.pataPlayerRecord.topPassPataID=t),this.currentBattlePataEntry=d.sPataConfig.getEntry(this.pataPlayerRecord.currentBattlePataID),this._dataDirty=!0,b.sGGame.emit(n.sLocalPataEvent.currentPataChanged,this.pataPlayerRecord.currentPassPataID),b.sGGame.emit(n.sLocalPataEvent.currentPassPataChanged,this.pataPlayerRecord.currentBattlePataID)},R.prototype.getCurrentBattlePataID=function(){return this.pataPlayerRecord.currentBattlePataID},R.prototype.getCurrentPassPataID=function(){return this.pataPlayerRecord.currentPassPataID},R.prototype.getTopPassPataID=function(){return this.pataPlayerRecord.topPassPataID},R.prototype.isSystemIsOpened=function(){var t=s.sConstConfig.config.pataUnlockStage;return!!b.sGGame.localModel.getModule(w.LocalStage).isSystemIsOpened(t)},R.prototype.getPataSlotCount=function(){return this.localAttribute.getValue(P.eAttributeObjectType.player,0,h.sPlayerAttributeConfig.config.pataSlotCount)},R.prototype.confirmSoldierArray=function(t){this.pataPlayerRecord.soldierArray=t,this._dataDirty=!0,b.sGGame.emit(n.sLocalPataEvent.soldierArrayChanged)},R.prototype.getSoldierArray=function(){return this.pataPlayerRecord.soldierArray.concat()},R.prototype._randomPataBuff=function(){for(var t=[0,0,0],e=[0,1,2],o=2;0<o;o--){var i,a=Math.floor(Math.random()*(o+1));a!=o&&(i=e[a],e[a]=e[o],e[o]=i)}var n=0;this.getPataSlotCount()<15&&(t[e[n]]=1,n++);var r=2*this.pataPlayerRecord.soldierArray.length+this.attributeTotalWeight;for(Math.random()*r<=4&&(r=this.pataPlayerRecord.soldierArray[Math.floor(Math.random()*this.pataPlayerRecord.soldierArray.length)],(r=this.localSoldierPackage.getSoldier(r)).isPataFullLevel()||(t[e[n]]=r.card.entry.id,n++));n<3;){var l=Math.floor(Math.random()*this.attributeTotalWeight),c=0;for(o=this.attributeBuffStartID;o<=this.attributeBuffEndID;++o){var s=u.sPataBuffConfig.getEntry(o);if(l<=s.weight){c=s.id;break}0==c&&(c=s.id),l-=s.weight}t[e[n]]=c,n++}this.pataPlayerRecord.waitCollectBuffArray=t,this._dataDirty=!0},R.prototype.getPataWaitCollectBuffArray=function(){return this.pataPlayerRecord.waitCollectBuffArray},R.prototype.collectPataBuff=function(t){3!==this.pataPlayerRecord.waitCollectBuffArray.length||t>=this.pataPlayerRecord.waitCollectBuffArray.length||(this.pataPlayerRecord.buffArray.push(this.pataPlayerRecord.waitCollectBuffArray[t]),this._refreshAttribute(this.pataPlayerRecord.waitCollectBuffArray[t],!0),this.saveHistoryBuff(t),this.pataPlayerRecord.waitCollectBuffArray=[],this._dataDirty=!0)},R.prototype.collectPataAllBuff=function(){3===this.pataPlayerRecord.waitCollectBuffArray.length&&(this.pataPlayerRecord.buffArray.push(this.pataPlayerRecord.waitCollectBuffArray[0]),this.pataPlayerRecord.buffArray.push(this.pataPlayerRecord.waitCollectBuffArray[1]),this.pataPlayerRecord.buffArray.push(this.pataPlayerRecord.waitCollectBuffArray[2]),this._refreshAttribute(this.pataPlayerRecord.waitCollectBuffArray[0],!0),this._refreshAttribute(this.pataPlayerRecord.waitCollectBuffArray[1],!0),this._refreshAttribute(this.pataPlayerRecord.waitCollectBuffArray[2],!0),this.saveHistoryBuff(),this.pataPlayerRecord.waitCollectBuffArray=[],this._dataDirty=!0)},R.prototype.saveHistoryBuff=function(t){if(void 0===t&&(t=-1),3===this.pataPlayerRecord.waitCollectBuffArray.length){var e=new A;e.pataID=this.getCurrentPassPataID();for(var o=0;o<3;++o){var i=this.pataPlayerRecord.waitCollectBuffArray[o];e.buffIDArray.push(i),e.selectedArray.push(-1===t||t===o)}this.pataPlayerRecord.historyBuffDic[e.pataID]=e}},R.prototype.getHistoryBuffArray=function(){for(var t=[],e=1;;++e){var o=this.pataPlayerRecord.historyBuffDic[e];if(!o)break;t.push(o)}return t},R.prototype._refreshAttribute=function(t,e){var o=u.sPataBuffConfig.getEntry(t);t=this.localModel.getModule(P.LocalAttribute),e=e?o.attributeValue:-o.attributeValue,o.attributeObjectType&&t.addPosValue(o.attributeObjectType,o.attributeObjectID,"pata",o.attributeType,o.attributePos,e)},R.prototype.getBuffStatSlotCount=function(){return this.localAttribute.getValue(P.eAttributeObjectType.player,0,h.sPlayerAttributeConfig.config.pataSlotCount)-h.sPlayerAttributeConfig.config.pataSlotCount.init},R.prototype.getBuffStatAttributeArray=function(){for(var t=["pataAllSoldierMaxHPAddPercent","pataAllSoldierAttackIntervalAddPercent","pataAllSoldierAttackAddPercent","pataMeleeSoldierMaxHPAddPercent","pataRangeSoldierMaxHPAddPercent","pataAirSoldierMaxHPAddPercent","pataMeleeSoldierAttackAddPercent","pataRangeSoldierAttackAddPercent","pataAirSoldierAttackAddPercent","pataMeleeSoldierAttackIntervalAddPercent","pataRangeSoldierAttackIntervalAddPercent","pataAirSoldierAttackIntervalAddPercent"],e={},o=0;o<t.length;++o){var i=this.localAttribute.getValue(P.eAttributeObjectType.player,0,t[o]);0<i&&(e[t[o]]=i)}return e},R.prototype.getBuffStatAddStar=function(){for(var t={},e=31;e<71;++e){var o=u.sPataBuffConfig.getEntry(e);0<(o=this.localAttribute.getValue(P.eAttributeObjectType.soldier,o.attributeObjectID,g.sSoldierAttributeConfig.config.pataAddStar))&&(t[e]=o)}return t},R.prototype._randomReward=function(){var t=p.sPataRewardConfig.getEntry(this.pataPlayerRecord.currentBattlePataID);if(t){t.buildingUpgradePoint&&this.rewardList.add(G.eRewardType.buildingUpgradePointOverTime,t.buildingUpgradePoint),t.packID?this.localModel.getModule(G.LocalReward).addPataPackReward(this.rewardList,t.packID,t.count):this.rewardList.add(G.eRewardType.cardUpgradePoint,t.count),this.pataPlayerRecord.rewardTypeArray=[],this.pataPlayerRecord.rewardIDArray=[],this.pataPlayerRecord.rewardCountArray=[];for(var e=0;e<this.rewardList.length;++e){var o=this.rewardList.getReward(e);this.pataPlayerRecord.rewardTypeArray.push(o.type),this.pataPlayerRecord.rewardIDArray.push(o.id),this.pataPlayerRecord.rewardCountArray.push(o.count)}this.pataPlayerRecord.rewardPataCount++,this._dataDirty=!0}},R.prototype.collectReward=function(){var t;this.rewardList.length&&(t=this.localModel.getModule(G.LocalReward).takeRewardList(this.rewardList,!0,1,C.eReasonType.collectInPata),this.rewardList.clear(),this.pataPlayerRecord.rewardTypeArray=[],this.pataPlayerRecord.rewardIDArray=[],this.pataPlayerRecord.rewardCountArray=[],this.pataPlayerRecord.rewardPataCount=0,this._dataDirty=!0,b.sGGame.emit(n.sLocalPataEvent.collectReward,t))},R.prototype.collectDoubleReward=function(){var t;this.rewardList.length&&(t=this.localModel.getModule(G.LocalReward).takeRewardList(this.rewardList,!0,2,C.eReasonType.collectInPataWithAD),this.rewardList.clear(),this.pataPlayerRecord.rewardTypeArray=[],this.pataPlayerRecord.rewardIDArray=[],this.pataPlayerRecord.rewardCountArray=[],this.pataPlayerRecord.rewardPataCount=0,this._dataDirty=!0,b.sGGame.emit(n.sLocalPataEvent.collectDoubleReward,t))},R.prototype.getRewardPataCount=function(){return this.pataPlayerRecord.rewardPataCount},R.prototype.dailyClear=function(){this.pataPlayerRecord.resetTimes=0,this._dataDirty=!0},R.prototype.getResetTimes=function(){return this.pataPlayerRecord.resetTimes},R.prototype.resetPata=function(){if(!(0<this.rewardList.length)){this.pataPlayerRecord.resetTimes++;for(var t=0;t<this.pataPlayerRecord.buffArray.length;++t){var e=this.pataPlayerRecord.buffArray[t];this._refreshAttribute(e,!1)}this.pataPlayerRecord.currentPassPataID=0,this.pataPlayerRecord.currentBattlePataID=1,this.pataPlayerRecord.soldierArray=[],this.pataPlayerRecord.buffArray=[],this.pataPlayerRecord.waitCollectBuffArray=[],this.pataPlayerRecord.historyBuffDic={},this._dataDirty=!0,this.currentBattlePataEntry=d.sPataConfig.getEntry(this.pataPlayerRecord.currentBattlePataID)}},R.prototype.checkReadyBattle=function(){return 0},R.prototype.readyBattle=function(){return this.checkReadyBattle()||0},R.prototype.onVictory=function(){this._randomPataBuff(),this._randomReward()},r=R,n.LocalPata=r,cc._RF.pop()},{}],local_quest_achievement:[function(t,e,o){"use strict";cc._RF.push(e,"c0e58SEjbVDyIopBSI38vjA","local_quest_achievement");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalQuestAchievementRecord=n.sQuestAchievementEvent=n.eQuestAchievementError=void 0;var l,c,s=a("local_currency"),u=a("const_config"),d=a("currency_config"),p=a("quest_achievement_config"),f=a("quest_config"),h=a("ggame"),g=a("ggame_data"),y=a("gmodule"),m=a("reason_define"),b=a("local_quest"),_=a("local_reward"),v=a("local_stage");function C(){this.oid=0,this.cid=0,this.questID=0,this.isDone=!1}function P(){var t=null!==c&&c.apply(this,arguments)||this;return t.dataQuestAchievement=null,t._dataDirty=!1,t.localModel=null,t.count=0,t.total=0,t._localQuest=null,t.inited=!1,t.moreQuestTokenRewardEnabled=!1,t}(a=l=n.eQuestAchievementError||(n.eQuestAchievementError={}))[a.configError=-2]="configError",a[a.systemError=-1]="systemError",a[a.noError=0]="noError",a[a.commitErrorUncomplete=1]="commitErrorUncomplete",a[a.commitErrorDone=2]="commitErrorDone",a[a.exchangeQuestTokenErrorNotEnoughQuestToken=3]="exchangeQuestTokenErrorNotEnoughQuestToken",n.sQuestAchievementEvent={completed:"sQuestAchievementEvent_completed"},n.LocalQuestAchievementRecord=C,r(P,c=y.GModule),P.prototype.init=function(t){g.sGGameData.addTable(g.sGGameDataType.local,"questAchievement",{0:new C}),this.localModel=t},P.prototype.load=function(){this.dataQuestAchievement=this.localModel.localData.questAchievement;var t,e=[];for(t in this.dataQuestAchievement){var o=this.dataQuestAchievement[t];p.sQuestAchievementConfig.getEntry(o.cid)||(e[e.length]=o.cid)}for(var i=0,a=e;i<a.length;i++){var n=a[i];delete this.dataQuestAchievement[n]}e.length&&(this._dataDirty=!0),this.count=0,this.total=0,this.inited=!1},P.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("questAchievement",this.dataQuestAchievement))},P.prototype.start=function(){this._localQuest=this.localModel.getModule(b.LocalQuest),this.initAchievement()},P.prototype.stop=function(){h.sGGame.targetOff(this)},P.prototype.isSystemOpen=function(){return this.localModel.getModule(v.LocalStage).isSystemIsOpened(u.sConstConfig.config.storeUnlockStage)},P.prototype.initAchievement=function(){if(!this.inited){this.inited=!0;var t,e=p.sQuestAchievementConfig.getAll();for(t in e){var o=e[t],i=this.getAchievementRecord(o.id);i&&!i.isDone&&(i.questID<o.questBegin||i.questID>o.questEnd)&&(this._localQuest.removeQuest(i.questID),this._localQuest.addQuest(o.questBegin),i.questID=o.questBegin,this._dataDirty=!0)}for(t in this.localModel.localData.questAchievement)this.localModel.localData.questAchievement[t].isDone&&this.count++,this.total++}},P.prototype.getAchievementRecord=function(t){var e=this.dataQuestAchievement[t];if(e)return e;var o=p.sQuestAchievementConfig.getEntry(t);return(e=new C).cid=t,e.questID=o.id,this.dataQuestAchievement[t]=e,this._dataDirty=!0,this._localQuest.addQuest(o.questBegin),e},P.prototype.isAnyThingTodo=function(){var t,e=p.sQuestAchievementConfig.getAll();for(t in e){var o=e[t];if(0==this.checkCommit(o.id))return!0}return!1},P.prototype.checkCommit=function(t){return(t=this.getAchievementRecord(t))?t.isDone?l.commitErrorDone:this._localQuest.isCompleted(t.questID)?0:l.commitErrorUncomplete:l.systemError},P.prototype.commit=function(t){var e=this.checkCommit(t);if(0==e){var o=p.sQuestAchievementConfig.getEntry(t),i=(t=this.getAchievementRecord(t),this._localQuest.commitQuest(t.questID));if(i.entry.id===o.questEnd)t.isDone=!0;else{this._localQuest.removeQuest(t.questID);for(var a=this._localQuest.addQuest(t.questID+1),r=0;r<i.conditions.length;++r)a.conditions[r]&&a.conditions[r].setNumber(i.conditions[r].value);t.questID=a.record.cid}this._dataDirty=!0,h.sGGame.emit(n.sQuestAchievementEvent.completed)}return e},P.prototype.getAchievementReward=function(t){return(t=this.getAchievementRecord(t)).isDone?"":f.sQuestConfig.getEntry(t.questID).reward},P.prototype.checkExchangeQuestToken=function(){return this.localModel.getModule(s.LocalCurrency).get(d.sCurrencyConfig.config.questToken)<u.sConstConfig.config.exchangeQuestTokenPrice?l.exchangeQuestTokenErrorNotEnoughQuestToken:l.noError},P.prototype.exchangeQuestToken=function(){var t=this.checkExchangeQuestToken();return t!==l.noError?t:(this.localModel.getModule(s.LocalCurrency).use(d.sCurrencyConfig.config.questToken,u.sConstConfig.config.exchangeQuestTokenPrice,m.eReasonType.exchangeQuestToken),this.localModel.getModule(_.LocalReward).takeRewardString(u.sConstConfig.config.exchangeQuestTokenReward),this.moreQuestTokenRewardEnabled=!0,l.noError)},P.prototype.getExchangeProgress=function(){var t=this.localModel.getModule(s.LocalCurrency).get(d.sCurrencyConfig.config.questToken);return t>=u.sConstConfig.config.exchangeQuestTokenPrice?1:t/u.sConstConfig.config.exchangeQuestTokenPrice},P.prototype.getExchangeProgressText=function(){return this.localModel.getModule(s.LocalCurrency).get(d.sCurrencyConfig.config.questToken)+"/"+u.sConstConfig.config.exchangeQuestTokenPrice},P.prototype.takeMoreQuestTokenReward=function(){this.moreQuestTokenRewardEnabled&&(this.moreQuestTokenRewardEnabled=!1,this.localModel.getModule(_.LocalReward).takeRewardString(u.sConstConfig.config.exchangeQuestTokenReward,!0,u.sConstConfig.config.exchangeQuestTokenMoreTimes-1))},r=P,n.default=r,cc._RF.pop()},{}],local_quest_activity:[function(t,e,o){"use strict";cc._RF.push(e,"dfdb6hHkGtGoaenIXdSMH85","local_quest_activity");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalQuestActivityRecord=n.sQuestActivityEvent=n.sQuestActivityError=void 0;var l,c=a("quest_activity_config"),s=a("gtime"),u=a("ggame"),d=a("ggame_data"),p=a("gmodule"),f=a("reason_define"),h=a("local_check_in_7day"),g=a("local_quest"),y=a("local_reward");function m(){this.oid=0,this.cid=0,this.isDone=!1,this.startTick=0,this.finishTick=0,this.isViewed=!1}function b(){var t=null!==l&&l.apply(this,arguments)||this;return t.dataQuestActivity=null,t._dataDirty=!1,t.localModel=null,t.count=0,t.total=0,t._localQuest=null,t}n.sQuestActivityError={configError:-2,systemError:-1,noError:0,commitErrorUncomplete:1,commitErrorDone:2},n.sQuestActivityEvent={completed:"sQuestActivityEvent_completed",questCommited:"sQuestActivityEvent_questCompleted"},n.LocalQuestActivityRecord=m,r(b,l=p.GModule),b.prototype.init=function(t){d.sGGameData.addTable(d.sGGameDataType.local,"questActivity",{0:new m}),this.localModel=t},b.prototype.load=function(){this.dataQuestActivity=this.localModel.localData.questActivity;var t,e=[];for(t in this.dataQuestActivity){var o=this.dataQuestActivity[t];c.sQuestActivityConfig.getEntry(o.cid)||(e[e.length]=o.cid)}for(var i=0,a=e;i<a.length;i++){var n=a[i];delete this.dataQuestActivity[n]}e.length&&(this._dataDirty=!0)},b.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("questActivity",this.dataQuestActivity))},b.prototype.start=function(){var t=this;this._localQuest=this.localModel.getModule(g.LocalQuest);var e,o=c.sQuestActivityConfig.getAll();for(e in o){var i=o[e];this.getActivityRecord(i.id)}for(e in this.localModel.localData.questActivity)this.localModel.localData.questActivity[e].isDone&&this.count++,this.total++;u.sGGame.on(h.sLocalCheckIn7DayEvent.checkIn,function(e){2===e&&t.active(1)})},b.prototype.stop=function(){u.sGGame.targetOff(this)},b.prototype.getActivityRecord=function(t){var e=this.dataQuestActivity[t],o=c.sQuestActivityConfig.getEntry(t);return e||((e=new m).cid=t,this.dataQuestActivity[t]=e,this._dataDirty=!0),o.autoActive&&0===e.startTick&&void 0!==o.duration&&void 0!==o.start&&this._active(e),e},b.prototype._active=function(t){var e=c.sQuestActivityConfig.getEntry(t.cid),o=Math.floor(s.sGTime.timestamp()/1e3);if(t&&e&&0===t.startTick&&void 0!==e.duration&&void 0!==e.start){if(t.startTick=o+86400*e.start,t.finishTick=t.startTick+86400*e.duration,e.questBegin)for(var i=e.questBegin;i<=e.questEnd;++i)this._localQuest.addQuest(i);this._dataDirty=!0}return t},b.prototype.active=function(t){t=this.getActivityRecord(t),this._active(t)},b.prototype.isViewed=function(t){return!!(t=this.getActivityRecord(t))&&t.isViewed},b.prototype.view=function(t){(t=this.getActivityRecord(t))&&(t.isViewed=!0,this._dataDirty=!0)},b.prototype.isAnyThingTodo=function(){var t,e=c.sQuestActivityConfig.getAll();for(t in e){var o=e[t];if(0==this.checkCommit(o.id))return!0}return!1},b.prototype.checkCommit=function(t){var e=this.getActivityRecord(t);if(!e)return n.sQuestActivityError.systemError;if(e.isDone)return n.sQuestActivityError.commitErrorDone;var o=c.sQuestActivityConfig.getEntry(t);if(!o.questBegin)return n.sQuestActivityError.systemError;for(var i=o.questBegin;i<=o.questEnd;++i){var a=this._localQuest.getQuest(i);if(a&&!a.record.commited)return n.sQuestActivityError.commitErrorUncomplete}return 0},b.prototype.commit=function(t){var e=this.checkCommit(t);if(0!=e)return{errorCode:e};for(var o=c.sQuestActivityConfig.getEntry(t),i=this.getActivityRecord(t),a=o.questBegin;a<=o.questEnd;++a)this._localQuest.removeQuest(a);return t=this.localModel.getModule(y.LocalReward).takeRewardString(o.reward,!0,1,f.eReasonType.commitQuest),i.isDone=!0,this._dataDirty=!0,u.sGGame.emit(n.sQuestActivityEvent.completed),{errorCode:e,rewardResult:t}},b.prototype.getActivityReward=function(t){return this.getActivityRecord(t).isDone?"":c.sQuestActivityConfig.getEntry(t).reward},b.prototype.isStart=function(t){if(!(o=this.getActivityRecord(t)))return!1;if(o.isDone)return!1;if(!o.startTick)return!1;var e=Math.floor(s.sGTime.timestamp()/1e3),o=(t=o.startTick,o.finishTick);return t<=e&&e<=o},b.prototype.getRemainSeconds=function(t){var e=this.getActivityRecord(t);return e?(t=Math.floor(s.sGTime.timestamp()/1e3),e=e.finishTick,0<(t=Math.floor(e-t))?t:0):0},b.prototype.getQuest=function(t,e){return this.getActivityRecord(t).isDone?null:(t=c.sQuestActivityConfig.getEntry(t)).questBegin?(e=t.questBegin+e,this._localQuest.getQuest(e)):null},b.prototype.checkCommitQuest=function(t,e){return(e=this.getQuest(t,e))?e.isCompleted()?e.record.commited?n.sQuestActivityError.commitErrorDone:0:n.sQuestActivityError.commitErrorUncomplete:n.sQuestActivityError.systemError},b.prototype.getActivityID=function(t){for(var e in c.sQuestActivityConfig.config)if(t>=(e=c.sQuestActivityConfig.getEntry(e)).questBegin&&t<=e.questEnd)return e.id;return 0},b.prototype.getActivityQuestIndex=function(t,e){return(t=c.sQuestActivityConfig.getEntry(t))?e-t.questBegin:-1},b.prototype.commitQuest=function(t,e){var o=this.checkCommitQuest(t,e);return 0!==o?o:(e=c.sQuestActivityConfig.getEntry(t).questBegin+e,this._localQuest.commitQuest(e),u.sGGame.emit(n.sQuestActivityEvent.questCommited),0)},b.prototype.getQuestCompleteCount=function(t){if(!this.getActivityRecord(t))return 0;var e=c.sQuestActivityConfig.getEntry(t);if(!e.questBegin)return 0;for(var o=0,i=e.questBegin;i<=e.questEnd;++i){var a=this._localQuest.getQuest(i);a&&a.record.commited&&(o+=1)}return o},b.prototype.getQuestTotal=function(t){return this.getActivityRecord(t)&&(t=c.sQuestActivityConfig.getEntry(t)).questBegin?t.questEnd-t.questBegin+1:0},r=b,n.default=r,cc._RF.pop()},{}],local_quest_condition:[function(t,e,o){"use strict";cc._RF.push(e,"85c650acblGpZSP3g5UpZH3","local_quest_condition");var i=t,a=o;Object.defineProperty(a,"__esModule",{value:!0}),a.LocalQuestCondition=a.Condition=a.sQuestConditionEvent=a.ConditionEntry=a.eConditionType=void 0;var n,r=i("decimal"),l=i("gdecimal"),c=i("glog"),s=i("ggame"),u=i("local_quest_stat");(i=n=a.eConditionType||(a.eConditionType={}))[i.invalid=0]="invalid",i[i.passStage=1]="passStage",i[i.unlockBuilding=2]="unlockBuilding",i[i.upgradeBuilding=3]="upgradeBuilding",i[i.collectBuildingUpgradePointTimes=4]="collectBuildingUpgradePointTimes",i[i.joinStage=5]="joinStage",i[i.passStageTimes=6]="passStageTimes",i[i.upgradeBuildingTimes=7]="upgradeBuildingTimes",i[i.pullCardTimes=8]="pullCardTimes",i[i.useSkillTimes=9]="useSkillTimes",i[i.rewardedVideoAdTimes=10]="rewardedVideoAdTimes",i[i.passFubenTimes=11]="passFubenTimes",i[i.passPataTimes=12]="passPataTimes",i[i.statInvalid=13]="statInvalid",i[i.statPlayOnlineSeconds=14]="statPlayOnlineSeconds",i[i.statPlaySecondsSinceFirstLogin=15]="statPlaySecondsSinceFirstLogin",i[i.statTopStage=16]="statTopStage",i[i.statPassStageTimes=17]="statPassStageTimes",i[i.statUpgradeBuildingTimes=18]="statUpgradeBuildingTimes",i[i.statPullCardTimes=19]="statPullCardTimes",i[i.statUseSkillTimes=20]="statUseSkillTimes",i[i.statUnlockCardCount=21]="statUnlockCardCount",i[i.statRewardedVideoAdTimes=22]="statRewardedVideoAdTimes",i[i.statTopFuben0=23]="statTopFuben0",i[i.statTopFuben1=24]="statTopFuben1",i[i.statTopPata=25]="statTopPata",a.ConditionEntry=function(){},a.sQuestConditionEvent={valueChanged:"sQuestConditionEvent_valueChanged"};var d=(p.prototype.paramMatch=function(t){for(var e in this.params)if(!this.params[e].equals(t[e]))return!1;return!0},p.prototype.addNumber=function(t){t=l.sGDecimal.convertToDecimal(t),this.value=this.value.add(t),this.isCompleted=this.value.greaterThanOrEqualTo(this.requirement),this.callback&&this.callback(this.value)},p.prototype.setNumber=function(t){this.value=l.sGDecimal.convertToDecimal(t),this.isCompleted=this.value.greaterThanOrEqualTo(this.requirement),this.callback&&this.callback(this.value)},p.prototype.getNumber=function(){return this.value.greaterThanOrEqualTo(this.requirement)?this.requirement:this.value},p.prototype.getRequirement=function(){return this.requirement},p);function p(t,e){if(this.callback=null,this.params={},this.isCompleted=!1,this.value=new r.Decimal(0),this.requirement=new r.Decimal(0),this.step=0,this.entry=t,this.callback=e,e=this.entry.conditionRequirement||1,this.requirement=new r.Decimal(e),this.isCompleted=this.value.greaterThanOrEqualTo(this.requirement||"1"),this.entry.conditionParams)for(var o=this.entry.conditionParams.split("/"),i=0;i<o.length;i+=2){var a=o[i],n=new r.Decimal(o[i+1]);this.params[a]=n}}function f(){this.conditions={},this.localModel=null}a.Condition=d,f.prototype.init=function(t){this.localModel=t},f.prototype.load=function(){this.conditions={}},f.prototype._getDefaultNumber=function(t,e){return e=e||{},(t=this.getTypeFromString(t))>n.statInvalid?this.localModel.getModule(u.LocalQuestStat).getValue(u.eQuestStat[n[t]]):this.defaultNumberCallback?this.defaultNumberCallback(t,e):0},f.prototype.addCondition=function(t,e,o){var i=new d(e,o);return i&&(t.lessThanOrEqualTo(0)?i.setNumber(this._getDefaultNumber(e.conditionType,i.params)):i.setNumber(t),(o=this.getTypeFromString(i.entry.conditionType))?((t=this.conditions[o])||(t=new Map,this.conditions[o]=t),t.set(i,i)):c.sGLog.error("condition type is not exists {type="+e.conditionType)),i},f.prototype.removeCondition=function(t){var e=this.getTypeFromString(t.entry.conditionType);!e||(e=this.conditions[e])&&e.delete(t)},f.prototype.addNumber=function(t,e,o){var i;e<=0||(t=this.getTypeFromString(t),(i=this.conditions[t])&&(i.forEach(function(t){o&&!t.paramMatch(o)||t.addNumber(e)}),s.sGGame.emit(a.sQuestConditionEvent.valueChanged,t)))},f.prototype.setNumber=function(t,e,o){var i;e<0||(t=this.getTypeFromString(t),(i=this.conditions[t])&&(i.forEach(function(t){o&&!t.paramMatch(o)||t.setNumber(e)}),s.sGGame.emit(a.sQuestConditionEvent.valueChanged,t)))},f.prototype.getTypeFromString=function(t){return"string"==typeof t?n[t]:t},i=f,a.LocalQuestCondition=i,cc._RF.pop()},{}],local_quest_daily:[function(t,e,o){"use strict";cc._RF.push(e,"e06daJg96VGjItvMz7+4NnI","local_quest_daily");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalDailyQuest=n.LocalQuestDailyRecord=n.LocalPlayerQuestDailyRecord=n.sDailyQuestEvent=n.sDailyQuestErrorName=n.sDailyQuestError=void 0;var l,c=a("const_config"),s=a("quest_config"),u=a("quest_daily_box_config"),d=a("quest_daily_config"),p=a("reward_helper"),f=a("enum_helper"),h=a("ggame"),g=a("ggame_data"),y=a("gmodule"),m=a("reason_define"),b=a("local_quest"),_=a("local_reward"),v=a("local_stage");function C(){this.oid=0,this.dayDailyQuestPoint=0,this.weekDailyQuestPoint=0,this.chestStep=0}function P(){this.oid=0,this.cid=0,this.questID=0,this.isDone=!1}function S(){var t=null!==l&&l.apply(this,arguments)||this;return t.dataPlayerDailyQuest=null,t.dataDailyQuest=null,t._dataDirty=!1,t.localModel=null,t._localQuest=null,t._chestCount=0,t.inited=!1,t}n.sDailyQuestError={configError:-2,systemError:-1,noError:0,commitErrorUncomplete:1,commitErrorDone:2},n.sDailyQuestErrorName=f.EnumHelper.value2Name(n.sDailyQuestError),n.sDailyQuestEvent={dailyQuestComplete:"sDailyQuestEvent_dailyQuestComplete",dailyRewardCollect:"sDailyQuestEvent_dailyRewardCollect"},n.LocalPlayerQuestDailyRecord=C,n.LocalQuestDailyRecord=P,r(S,l=y.GModule),S.prototype.init=function(t){for(var e in g.sGGameData.addTable(g.sGGameDataType.local,"playerQuestDaily",new C),g.sGGameData.addTable(g.sGGameDataType.local,"questDaily",{0:new P}),this.localModel=t,u.sQuestDailyBoxConfig.config)this._chestCount++},S.prototype.load=function(){this.dataDailyQuest=this.localModel.localData.questDaily,this.dataPlayerDailyQuest=this.localModel.localData.playerQuestDaily;var t,e=[];for(t in this.dataDailyQuest){var o=this.dataDailyQuest[t];d.sQuestDailyConfig.getEntry(o.cid)||(e[e.length]=o.cid)}for(var i=0,a=e;i<a.length;i++){var n=a[i];delete this.dataDailyQuest[n]}e.length&&(this._dataDirty=!0),this.inited=!1},S.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("questDaily",this.dataDailyQuest),this.localModel.database.update("playerQuestDaily",this.dataPlayerDailyQuest))},S.prototype.start=function(){var t=this;this._localQuest=this.localModel.getModule(b.LocalQuest),this.tryInitDaily(),this.inited||h.sGGame.on(v.sLocalStageEvent.currentPassStageChanged,function(){t.tryInitDaily()},this)},S.prototype.stop=function(){h.sGGame.targetOff(this)},S.prototype.isSystemOpen=function(){return this.localModel.getModule(v.LocalStage).isSystemIsOpened(c.sConstConfig.config.storeUnlockStage)},S.prototype.tryInitDaily=function(){this.isSystemOpen()&&this.initDaily()},S.prototype.initDaily=function(){var t,e=d.sQuestDailyConfig.getAll();for(t in e){var o=e[t],i=this.addDailyQuest(o.id);!i.isDone&&(i.questID<o.questBegin||i.questID>o.questEnd)&&(this._localQuest.removeQuest(i.questID),this._localQuest.addQuest(o.questBegin),i.questID=o.questBegin,this._dataDirty=!0)}},S.prototype.addDailyQuest=function(t){var e=this.dataDailyQuest[t];if(e)return this.dataDailyQuest[t];var o=d.sQuestDailyConfig.getEntry(t);return(e=new P).cid=t,e.questID=o.id,this.dataDailyQuest[t]=e,this._dataDirty=!0,this._localQuest.addQuest(o.questBegin),e},S.prototype.getDailyQuest=function(t){return this.dataDailyQuest[t]},S.prototype.checkCommit=function(t){return(t=this.getDailyQuest(t))?t.isDone?n.sDailyQuestError.commitErrorDone:this._localQuest.isCompleted(t.questID)?0:n.sDailyQuestError.commitErrorUncomplete:n.sDailyQuestError.systemError},S.prototype.commit=function(t){var e=this.checkCommit(t);if(0==e){var o=d.sQuestDailyConfig.getEntry(t);if(t=this.getDailyQuest(t)){var i=this._localQuest.commitQuest(t.questID);if(i.entry.id===o.questEnd)t.isDone=!0;else{this._localQuest.removeQuest(t.questID);for(var a=this._localQuest.addQuest(t.questID+1),r=0;r<i.conditions.length;++r)a.conditions[r]&&a.conditions[r].setNumber(i.conditions[r].value);t.questID=a.record.cid}this._dataDirty=!0}h.sGGame.emit(n.sDailyQuestEvent.dailyQuestComplete)}return e},S.prototype.getDailyQuestReward=function(t){return!(t=this.getDailyQuest(t))||t.isDone?"":s.sQuestConfig.getEntry(t.questID).reward},S.prototype.dailyClear=function(){var t,e=d.sQuestDailyConfig.getAll();for(t in e){var o=e[t],i=this.getDailyQuest(o.id);i&&(this._localQuest.removeQuest(i.questID),o=this._localQuest.addQuest(o.questBegin),i.questID=o.record.cid,i.isDone=!1)}this.dataPlayerDailyQuest.dayDailyQuestPoint=0,this.dataPlayerDailyQuest.chestStep=0,this._dataDirty=!0},S.prototype.getChestReward=function(){var t=new p.RewardList,e=u.sQuestDailyBoxConfig.getEntry(this.dataPlayerDailyQuest.chestStep);return e&&t.addList(p.RewardList.createFromString(e.reward)),t},S.prototype.getChestRequire=function(){var t=u.sQuestDailyBoxConfig.getEntry(this.dataPlayerDailyQuest.chestStep);return t?t.point:0},S.prototype.getChestTotal=function(){return this._chestCount},S.prototype.checkCollectChest=function(){if(this.dataPlayerDailyQuest.chestStep===this.getChestTotal())return 1;var t=u.sQuestDailyBoxConfig.getEntry(this.dataPlayerDailyQuest.chestStep);return!t||this.dataPlayerDailyQuest.dayDailyQuestPoint<t.point?2:0},S.prototype.collectChest=function(){var t=this.checkCollectChest();return t||(t=this.getChestReward(),this.localModel.getModule(_.LocalReward).takeRewardList(t,!0,1,m.eReasonType.questDailyChest),this.dataPlayerDailyQuest.chestStep++,this._dataDirty=!0,h.sGGame.emit(n.sDailyQuestEvent.dailyRewardCollect),0)},S.prototype.hasAnyThingTodo=function(){var t,e=d.sQuestDailyConfig.getAll();for(t in e){var o=e[t];if(0===this.checkCommit(o.id))return!0}return 0===this.checkCollectChest()},S.prototype.addDailyPoint=function(t){t=t.toNumber(),this.dataPlayerDailyQuest.dayDailyQuestPoint+=t,this.dataPlayerDailyQuest.weekDailyQuestPoint+=t,this._dataDirty=!0},r=S,n.LocalDailyQuest=r,cc._RF.pop()},{}],local_quest_event:[function(t,e,o){"use strict";cc._RF.push(e,"1a4aebaIPpPx58pBshKAGn3","local_quest_event");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalQuestEvent=void 0;var l,c=a("local_ad"),s=a("local_currency"),u=a("building_config"),d=a("decimal"),p=a("ggame"),f=a("gmodule"),h=a("local_battle"),g=a("local_battle_fuben"),y=a("local_battle_pata"),m=a("local_battle_stage"),b=a("local_building"),_=a("local_card"),v=a("local_check_in_daily"),C=a("local_fuben"),P=a("local_pata"),S=a("local_quest"),G=a("local_quest_condition"),M=a("local_quest_stat"),w=a("local_reward_slot_machine"),A=a("local_stage");function B(){var t=null!==l&&l.apply(this,arguments)||this;return t.localModel=null,t._localQuestStat=null,t._localQuestCondition=null,t}r(B,l=f.GModule),B.prototype.init=function(t){var e=this;this.localModel=t,this._localQuestStat=t.getModule(M.LocalQuestStat),this._localQuestCondition=t.getModule(S.LocalQuest).localQuestCondition,p.sGGame.on(s.sLocalCurrencyEvent.changed,function(t,o,i){e.onCurrencyChanged(t,o,i)},this),p.sGGame.on(w.sLocalSlotMachineEvent.turntableEnd,function(){e.onTurntable()},this),p.sGGame.on(v.sLocalCheckInDailyEvent.checkIn,function(){e.onCheckin()},this),p.sGGame.on(A.sLocalStageEvent.currentPassStageChanged,function(t){e.onBattlePassStageChanged(t)},this),p.sGGame.on(m.sLocalBattleStageEvent.start,function(t){e.onBattleStageStart(t)},this),p.sGGame.on(b.sLocalBuildingEvent.unlock,function(t){e.onBuildingUnlocked(t)},this),p.sGGame.on(b.sLocalBuildingEvent.upgrade,function(t){e.onBuildingUpgraded(t)},this),p.sGGame.on(b.sLocalBuildingEvent.collected,function(){e.onCollectBuildingUpgradePoint()},this),p.sGGame.on(m.sLocalBattleStageEvent.victory,function(){e.onBattleVictory()},this),p.sGGame.on(A.sLocalStageEvent.sweep,function(){e.onBattleSweep()},this),p.sGGame.on(_.sLocalCardEvent.pullCard,function(){e.onPullCard()},this),p.sGGame.on(h.sLocalBattleEvent.useSkillCard,function(){e.onUseSkillCard()},this),p.sGGame.on(_.sLocalCardEvent.unlockCard,function(){e.onUnlockCard()},this),p.sGGame.on(c.sLocalPlayerAdEvent.rewardedVideoAdTimesChanged,function(){e.onRewardedVideoAdTimesChanged()},this),p.sGGame.on(g.sLocalBattleFubenEvent.victory,function(t){e.onBattleFubenVictory(t)},this),p.sGGame.on(C.sLocalFubenEvent.sweep,function(t){e.onBattleFubenVictory(t)},this),p.sGGame.on(C.sLocalFubenEvent.lastPassedFubenChanged,function(t,o,i){e.onBattlePassFubenChanged(t,o,i)},this),p.sGGame.on(y.sLocalBattlePataEvent.victory,function(){e.onBattlePataVictory()},this),p.sGGame.on(P.sLocalPataEvent.currentPassPataChanged,function(t){e.onBattlePassPataChanged(t)},this)},B.prototype.start=function(){var t=this;this._localQuestCondition.defaultNumberCallback=function(e,o){if(e===G.eConditionType.passStage)return new d.Decimal(t.localModel.getModule(A.LocalStage).getCurrentPassStageID());if(e===G.eConditionType.upgradeBuilding){if(i=t.localModel.getModule(b.LocalBuildingPackage).getBuilding(o.id.toNumber()))return new d.Decimal(i.getLevel())}else if(e===G.eConditionType.unlockBuilding){var i;if(i=t.localModel.getModule(b.LocalBuildingPackage).getBuilding(o.id.toNumber()))return new d.Decimal(0<i.getLevel()?1:0)}return new d.Decimal(0)},this._fixQuestStat()},B.prototype._fixQuestStat=function(){var t=this.localModel.getModule(A.LocalStage);t&&(i=t.getCurrentPassStageID(),this._localQuestCondition.setNumber(G.eConditionType.passStage,i));var e=this.localModel.getModule(b.LocalBuildingPackage);if(e)for(var o in u.sBuildingConfig.config)o=u.sBuildingConfig.config[o],(o=e.getBuilding(o.id))&&(this._localQuestCondition.setNumber(G.eConditionType.upgradeBuilding,o.getLevel(),{id:new d.Decimal(o.entry.id)}),this._localQuestCondition.setNumber(G.eConditionType.unlockBuilding,0<o.getLevel()?1:0,{id:new d.Decimal(o.entry.id)}));var i=this.localModel.getModule(_.LocalCardPackage);if(i){for(var a=0,n=i.getCardArray(),r=0;r<n.length;++r){var l=n[r];l&&l.isUnlock()&&a++}this._localQuestStat.setValue(M.eQuestStat.statUnlockCardCount,a),this._localQuestCondition.setNumber(G.eConditionType.statUnlockCardCount,a)}},B.prototype.onCurrencyChanged=function(){},B.prototype.onCheckin=function(){},B.prototype.onTurntable=function(){},B.prototype.onBattlePassFubenChanged=function(t,e,o){this._localQuestStat.getValue(M.eQuestStat.statTopFuben0+t).toNumber()>=o||(this._localQuestStat.setValue(M.eQuestStat.statTopFuben0+t,o),this._localQuestCondition.setNumber(G.eConditionType.statTopFuben0+t,o))},B.prototype.onBattlePassPataChanged=function(t){this._localQuestStat.getValue(M.eQuestStat.statTopPata).toNumber()>=t||(this._localQuestStat.setValue(M.eQuestStat.statTopPata,t),this._localQuestCondition.setNumber(G.eConditionType.statTopPata,t))},B.prototype.onBattlePassStageChanged=function(t){this._localQuestCondition.setNumber(G.eConditionType.passStage,t,{})},B.prototype.onBattleStageStart=function(t){this._localQuestCondition.setNumber(G.eConditionType.joinStage,1,{id:new d.Decimal(t)})},B.prototype.onBuildingUnlocked=function(t){this._localQuestCondition.setNumber(G.eConditionType.unlockBuilding,1,{id:new d.Decimal(t.entry.id)})},B.prototype.onBuildingUpgraded=function(t){this._localQuestCondition.setNumber(G.eConditionType.upgradeBuilding,t.getLevel(),{id:new d.Decimal(t.entry.id)}),this._localQuestCondition.addNumber(G.eConditionType.upgradeBuildingTimes,1),t=this._localQuestStat.getValue(M.eQuestStat.statUpgradeBuildingTimes).toNumber()+1,this._localQuestStat.setValue(M.eQuestStat.statUpgradeBuildingTimes,t),this._localQuestCondition.setNumber(G.eConditionType.statUpgradeBuildingTimes,t)},B.prototype.onCollectBuildingUpgradePoint=function(){this._localQuestCondition.addNumber(G.eConditionType.collectBuildingUpgradePointTimes,1,{})},B.prototype.onBattleFubenVictory=function(t){this._localQuestCondition.addNumber(G.eConditionType.passFubenTimes,1,{fubenType:new d.Decimal(t)})},B.prototype.onBattlePataVictory=function(){this._localQuestCondition.addNumber(G.eConditionType.passPataTimes,1)},B.prototype.onBattleVictory=function(){this._localQuestCondition.addNumber(G.eConditionType.passStageTimes,1);var t=this._localQuestStat.getValue(M.eQuestStat.statPassStageTimes).toNumber()+1;this._localQuestStat.setValue(M.eQuestStat.statPassStageTimes,t),this._localQuestCondition.setNumber(G.eConditionType.statPassStageTimes,t)},B.prototype.onBattleSweep=function(){this._localQuestCondition.addNumber(G.eConditionType.passStageTimes,1);var t=this._localQuestStat.getValue(M.eQuestStat.statPassStageTimes).toNumber()+1;this._localQuestStat.setValue(M.eQuestStat.statPassStageTimes,t),this._localQuestCondition.setNumber(G.eConditionType.statPassStageTimes,t)},B.prototype.onPullCard=function(){this._localQuestCondition.addNumber(G.eConditionType.pullCardTimes,1);var t=this._localQuestStat.getValue(M.eQuestStat.statPullCardTimes).toNumber()+1;this._localQuestStat.setValue(M.eQuestStat.statPullCardTimes,t),this._localQuestCondition.setNumber(G.eConditionType.statPullCardTimes,t)},B.prototype.onUseSkillCard=function(){this._localQuestCondition.addNumber(G.eConditionType.useSkillTimes,1);var t=this._localQuestStat.getValue(M.eQuestStat.statUseSkillTimes).toNumber()+1;this._localQuestStat.setValue(M.eQuestStat.statUseSkillTimes,t),this._localQuestCondition.setNumber(G.eConditionType.statUseSkillTimes,t)},B.prototype.onUnlockCard=function(){var t=this._localQuestStat.getValue(M.eQuestStat.statUnlockCardCount).toNumber()+1;this._localQuestStat.setValue(M.eQuestStat.statUnlockCardCount,t),this._localQuestCondition.setNumber(G.eConditionType.statUnlockCardCount,t)},B.prototype.onRewardedVideoAdTimesChanged=function(){this._localQuestCondition.addNumber(G.eConditionType.rewardedVideoAdTimes,1);var t=this._localQuestStat.getValue(M.eQuestStat.statRewardedVideoAdTimes).toNumber()+1;this._localQuestStat.setValue(M.eQuestStat.statRewardedVideoAdTimes,t),this._localQuestCondition.setNumber(G.eConditionType.statRewardedVideoAdTimes,t)},r=B,n.LocalQuestEvent=r,cc._RF.pop()},{}],local_quest_main:[function(t,e,o){"use strict";cc._RF.push(e,"6a4df+2J7lDQ58Z04FmTL+/","local_quest_main");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalPlayerQuestMainRecord=n.sQuestMainEvent=n.sQuestMainError=void 0;var l,c=a("const_config"),s=a("quest_config"),u=a("quest_main_config"),d=a("ggame"),p=a("ggame_data"),f=a("gmodule"),h=a("local_quest"),g=a("local_stage");function y(){this.oid=0,this.cid=0,this.entryID=0,this.questID=0,this.isDone=!1}function m(){var t=null!==l&&l.apply(this,arguments)||this;return t.dataPlayerQuestMain=null,t._dataDirty=!1,t.localModel=null,t._localQuest=null,t}n.sQuestMainError={configError:-2,systemError:-1,noError:0,commitErrorUncomplete:1,commitErrorDone:2},n.sQuestMainEvent={completed:"sQuestMainEvent_completed"},n.LocalPlayerQuestMainRecord=y,r(m,l=f.GModule),m.prototype.init=function(t){p.sGGameData.addTable(p.sGGameDataType.local,"playerQuestMain",new y),this.localModel=t,this._localQuest=this.localModel.getModule(h.LocalQuest)},m.prototype.load=function(){this.dataPlayerQuestMain=this.localModel.localData.playerQuestMain},m.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("playerQuestMain",this.dataPlayerQuestMain))},m.prototype.start=function(){var t,e,o=this.dataPlayerQuestMain;o.isDone||(0===o.entryID?(o.entryID=1,t=u.sQuestMainConfig.getEntry(o.entryID),this._localQuest.addQuest(t.questID),o.questID=t.questID,this._dataDirty=!0):(t=u.sQuestMainConfig.getEntry(o.entryID))?t.questID!==o.questID&&(this._localQuest.removeQuest(o.questID),this._localQuest.addQuest(t.questID),o.questID=t.questID,this._dataDirty=!0):o.isDone=!0),o.isDone&&(e=o.entryID+1,(t=u.sQuestMainConfig.getEntry(e))&&(o.isDone=!1,o.entryID=e,e=u.sQuestMainConfig.getEntry(o.entryID),this._localQuest.addQuest(e.questID),o.questID=e.questID,this._dataDirty=!0)),this._dataDirty=!0},m.prototype.isAnythingToDo=function(){return 0===this.checkCommit()},m.prototype.checkCommit=function(){var t=this.dataPlayerQuestMain;return t?t.isDone?n.sQuestMainError.commitErrorDone:this._localQuest.isCompleted(t.questID)?0:n.sQuestMainError.commitErrorUncomplete:n.sQuestMainError.systemError},m.prototype.commit=function(){var t,e,o,i=this.checkCommit();return 0==i&&(t=this.dataPlayerQuestMain,e=this._localQuest.commitQuest(t.questID),this._localQuest.removeQuest(t.questID),o=t.entryID+1,u.sQuestMainConfig.getEntry(o)?(t.entryID=o,o=u.sQuestMainConfig.getEntry(t.entryID),this._localQuest.addQuest(o.questID),t.questID=o.questID):t.isDone=!0,this._dataDirty=!0,d.sGGame.emit(n.sQuestMainEvent.completed,e.entry.id)),i},m.prototype.getQuestMainReward=function(){var t=this.dataPlayerQuestMain;return t.isDone?"":s.sQuestConfig.getEntry(t.questID).reward},m.prototype.getQuestMainEntry=function(){var t=this.dataPlayerQuestMain;return t.isDone?null:s.sQuestConfig.getEntry(t.questID)},m.prototype.getQuestMainID=function(){var t=this.dataPlayerQuestMain;return t.isDone?0:t.questID},m.prototype.isQuestMainDone=function(){return this.dataPlayerQuestMain.isDone},m.prototype.isQuestMainOpen=function(){return this.localModel.getModule(g.LocalStage).getCurrentBattleStageID()>=c.sConstConfig.config.mainQuestOpenStage},r=m,n.default=r,cc._RF.pop()},{}],local_quest_stage:[function(t,e,o){"use strict";cc._RF.push(e,"b1b03Eq9b9H1LfY9fUJlK5I","local_quest_stage");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalPlayerQuestStageRecord=n.eQuestStageState=n.sQuestStageEvent=n.sQuestStageError=void 0;var l,c,s=a("quest_config"),u=a("quest_stage_config"),d=a("decimal"),p=a("ggame"),f=a("ggame_data"),h=a("gmodule"),g=a("local_quest");function y(){this.oid=0,this.entryID=0,this.questID=0,this.isDone=!1}function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.dataPlayerQuestStage=null,t._dataDirty=!1,t.localModel=null,t._localQuest=null,t}n.sQuestStageError={configError:-2,systemError:-1,noError:0,commitErrorUncomplete:1,commitErrorDone:2},n.sQuestStageEvent={completed:"sQuestStageEvent_completed"},(a=l=n.eQuestStageState||(n.eQuestStageState={}))[a.done=0]="done",a[a.accept=1]="accept",a[a.unaccept=2]="unaccept",n.LocalPlayerQuestStageRecord=y,r(m,c=h.GModule),m.prototype.init=function(t){f.sGGameData.addTable(f.sGGameDataType.local,"playerQuestStage",new y),this.localModel=t},m.prototype.load=function(){this.dataPlayerQuestStage=this.localModel.localData.playerQuestStage},m.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("playerQuestStage",this.dataPlayerQuestStage))},m.prototype.start=function(){this._localQuest=this.localModel.getModule(g.LocalQuest);var t,e,o=this.dataPlayerQuestStage;0===o.entryID?(o.entryID=1,t=u.sQuestStageConfig.getEntry(o.entryID),this._localQuest.addQuest(t.questID),o.questID=t.questID,this._dataDirty=!0):(t=u.sQuestStageConfig.getEntry(o.entryID))&&t.questID!==o.questID&&(this._localQuest.removeQuest(o.questID),this._localQuest.addQuest(t.questID),o.questID=t.questID,this._dataDirty=!0),o.isDone&&(e=o.entryID+1,(t=u.sQuestStageConfig.getEntry(e))&&(o.isDone=!1,o.entryID=e,e=u.sQuestStageConfig.getEntry(o.entryID),this._localQuest.addQuest(e.questID),o.questID=e.questID,this._dataDirty=!0)),this._dataDirty=!0},m.prototype.isAnythingToDo=function(){return 0===this.checkCommit()},m.prototype.checkCommit=function(){var t=this.dataPlayerQuestStage;return t?t.isDone?n.sQuestStageError.commitErrorDone:this._localQuest.isCompleted(t.questID)?0:n.sQuestStageError.commitErrorUncomplete:n.sQuestStageError.systemError},m.prototype.commit=function(){var t,e,o=this.checkCommit();return 0==o&&(t=this.dataPlayerQuestStage,this._localQuest.commitQuest(t.questID),this._localQuest.removeQuest(t.questID),e=t.entryID+1,u.sQuestStageConfig.getEntry(e)?(t.entryID=e,e=u.sQuestStageConfig.getEntry(t.entryID),this._localQuest.addQuest(e.questID),t.questID=e.questID):t.isDone=!0,this._dataDirty=!0,p.sGGame.emit(n.sQuestStageEvent.completed)),o},m.prototype.getCurrentQuestReward=function(){var t=this.dataPlayerQuestStage;return t.isDone?"":s.sQuestConfig.getEntry(t.questID).reward},m.prototype.getCurrentQuestEntry=function(){var t=this.dataPlayerQuestStage;return t.isDone?null:s.sQuestConfig.getEntry(t.questID)},m.prototype.getCurrentQuestStageEntry=function(){var t=this.dataPlayerQuestStage;return t.isDone?null:u.sQuestStageConfig.getEntry(t.entryID)},m.prototype.getRequirement=function(){var t=this.dataPlayerQuestStage;return t.isDone?new d.Decimal(0):(t=s.sQuestConfig.getEntry(t.questID).conditions[0],new d.Decimal(t.conditionRequirement||1))},m.prototype.getQuestStageState=function(t){var e=this.dataPlayerQuestStage;return e.isDone||t<e.entryID?l.done:t==e.entryID?l.accept:l.unaccept},r=m,n.default=r,cc._RF.pop()},{}],local_quest_stat:[function(t,e,o){"use strict";cc._RF.push(e,"2b902p7iitExZwXcFTb3CJw","local_quest_stat");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalQuestStat=n.LocalQuestStatRecord=n.eQuestStat=n.sQuestStatEvent=void 0;var l,c,s=a("local_info"),u=a("decimal"),d=a("i18n"),p=a("gdecimal"),f=a("gtime"),h=a("ggame"),g=a("ggame_data"),y=a("gmodule");function m(){this.oid=0,this.cid=0,this.value="0"}function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.dataQuestStat=null,t._dataDirty=!1,t.localModel=null,t}n.sQuestStatEvent={valueChanged:"sQuestStatEvent_valueChanged"},(a=l=n.eQuestStat||(n.eQuestStat={}))[a.statInvalid=0]="statInvalid",a[a.statPlayOnlineSeconds=1]="statPlayOnlineSeconds",a[a.statPlaySecondsSinceFirstLogin=2]="statPlaySecondsSinceFirstLogin",a[a.statTopStage=3]="statTopStage",a[a.statPassStageTimes=4]="statPassStageTimes",a[a.statUpgradeBuildingTimes=5]="statUpgradeBuildingTimes",a[a.statPullCardTimes=6]="statPullCardTimes",a[a.statUseSkillTimes=7]="statUseSkillTimes",a[a.statUnlockCardCount=8]="statUnlockCardCount",a[a.statRewardedVideoAdTimes=9]="statRewardedVideoAdTimes",a[a.statTopFuben0=10]="statTopFuben0",a[a.statTopFuben1=11]="statTopFuben1",a[a.statTopPata=12]="statTopPata",n.LocalQuestStatRecord=m,r(b,c=y.GModule),b.prototype.init=function(t){g.sGGameData.addTable(g.sGGameDataType.local,"questStat",{0:new m}),this.localModel=t},b.prototype.load=function(){this.dataQuestStat=this.localModel.localData.questStat},b.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("questStat",this.dataQuestStat))},b.prototype.getValue=function(t){if((t=this.getTypeFromString(t))===l.statPlayOnlineSeconds)return new u.Decimal(this.localModel.getModule(s.LocalInfo).getOnlineSeconds());if(t===l.statPlaySecondsSinceFirstLogin)return new u.Decimal(this.localModel.getModule(s.LocalInfo).getSecondsSinceFirstLogin());if(this.dataQuestStat[t])return new u.Decimal(this.dataQuestStat[t].value);var e=new m;return e.cid=t,this.dataQuestStat[t]=e,this._dataDirty=!0,new u.Decimal(0)},b.prototype.setTopValue=function(t,e){t=this.getTypeFromString(t),"number"!=typeof e&&"string"!=typeof e||(e=new u.Decimal(e));var o=this.getValue(t);return e.lessThanOrEqualTo(o)?o:(this.dataQuestStat[t].value=e.toPrecision(10),this._dataDirty=!0,h.sGGame.emit(n.sQuestStatEvent.valueChanged,t),t===l.statTopStage&&this._reportTopStage(e),this.getValue(t))},b.prototype.setValue=function(t,e){t=this.getTypeFromString(t),"number"!=typeof e&&"string"!=typeof e||(e=new u.Decimal(e));var o=this.getValue(t);return e.equals(o)?o:(this.dataQuestStat[t].value=e.toPrecision(10),this._dataDirty=!0,h.sGGame.emit(n.sQuestStatEvent.valueChanged,t),this.getValue(t))},b.prototype.addValue=function(t,e){t=this.getTypeFromString(t),"number"!=typeof e&&"string"!=typeof e||(e=new u.Decimal(e));var o=this.getValue(t);return e.lessThan(0)?o:(this.dataQuestStat[t].value=o.add(e).toPrecision(10),this._dataDirty=!0,h.sGGame.emit(n.sQuestStatEvent.valueChanged,t),this.getValue(t))},b.prototype.getTypeFromString=function(t){return"string"==typeof t?l[t]:t},b.prototype.getStringValue=function(t){var e;return(t=this.getTypeFromString(t))===l.statPlayOnlineSeconds?(e=this.localModel.getModule(s.LocalInfo).getOnlineSeconds(),f.sGTime.toTimeSpanString(e,!0)):t===l.statPlaySecondsSinceFirstLogin?(e=this.localModel.getModule(s.LocalInfo).getSecondsSinceFirstLogin())<86400?"0 "+d.i18n.t("time.day"):f.sGTime.toTimeSpanString2(e):(t=this.getValue(t),p.sGDecimal.toHuman(t))},b.prototype._reportTopStage=function(t){t.greaterThan(1e5)||t.toNumber()},r=b,n.LocalQuestStat=r,cc._RF.pop()},{}],local_quest:[function(t,e,o){"use strict";cc._RF.push(e,"d5bc6lbV0xHP42c4UeAI+xe","local_quest");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalQuest=n.LocalQuestRecord=n.Quest=n.sQuestEvent=n.sQuestError=void 0;var l=a("quest1_config"),c=a("quest2_config"),s=a("quest3_config"),u=a("quest4_config"),d=a("quest_config"),p=a("decimal"),f=a("gdecimal"),h=a("glog"),g=a("ggame"),y=a("ggame_data"),m=a("gmodule"),b=a("reason_define"),_=a("local_quest_condition"),v=a("local_reward");n.sQuestError={configError:-2,systemError:-1,noError:0,commitErrorUncomplete:1,commitErrorDone:2},n.sQuestEvent={conditionChanged:"sQuestEvent_conditionChanged",autoCommit:"sQuestEvent_autoCommit"};var C,P=(S.prototype.isCompleted=function(){for(var t=0;t<this.conditions.length;++t)if(!this.conditions[t].isCompleted)return!1;return!0},S.prototype.tryAutoCommit=function(){if(!this.autoCommit)return 0;for(var t=0;this.isCompleted();){for(var e=0;e<this.conditions.length;++e)this.conditions[e].value=this.conditions[e].value.sub(this.conditions[e].requirement),this.conditions[e].isCompleted=this.conditions[e].value.greaterThanOrEqualTo(this.conditions[e].requirement);t++}return t},S.prototype.getProgress=function(t){var e=this.conditions[t];return e?(t=e.getNumber(),e=e.getRequirement(),f.sGDecimal.getProgress(t,e)):0},S.prototype.getProgressString=function(t){var e=this.conditions[t];return e?(t=e.getNumber(),e=e.getRequirement(),f.sGDecimal.toHuman(t)+"/"+f.sGDecimal.toHuman(e)):"0/0"},S.prototype.getCondtionNumber=function(t){return(t=this.conditions[t])?t.getNumber():new p.Decimal(0)},S.prototype.getCondtionRequirement=function(t){return(t=this.conditions[t])?t.getRequirement():new p.Decimal(0)},S.prototype.getConditionParams=function(t){if(t=this.conditions[t])return t.params},S.prototype.getConditionEntry=function(t){return this.entry.conditions[t]},S);function S(){this.entry=null,this.conditions=[],this.record=null,this.autoCommit=!1}function G(){this.oid=0,this.cid=0,this.conditions=["0"],this.commited=!1,this.times=0}function M(){var t=null!==C&&C.apply(this,arguments)||this;return t.dataQuest=null,t._dataDirty=!1,t.questMap=new Map,t.localModel=null,t.localQuestCondition=new _.LocalQuestCondition,t}n.Quest=P,n.LocalQuestRecord=G,r(M,C=m.GModule),M.prototype.init=function(t){for(var e in this.localQuestCondition.init(t),y.sGGameData.addTable(y.sGGameDataType.local,"quest",{0:new G}),this.localModel=t,l.sQuest1Config.config){var o=l.sQuest1Config.getEntry(e);d.sQuestConfig.config[o.id]=o}for(var e in c.sQuest2Config.config)o=c.sQuest2Config.getEntry(e),d.sQuestConfig.config[o.id]=o;for(var e in s.sQuest3Config.config)o=s.sQuest3Config.getEntry(e),d.sQuestConfig.config[o.id]=o;for(var e in u.sQuest4Config.config)o=u.sQuest4Config.getEntry(e),d.sQuestConfig.config[o.id]=o},M.prototype.load=function(){this.localQuestCondition.load(),this.questMap.clear(),this.dataQuest=this.localModel.localData.quest;var t=[];for(o in this.dataQuest){var e=this.dataQuest[o];d.sQuestConfig.getEntry(e.cid)||(t[t.length]=e.cid)}for(var o,i=0,a=t;i<a.length;i++){var n=a[i];delete this.dataQuest[n]}for(o in t.length&&(this._dataDirty=!0),this.dataQuest)(e=this.dataQuest[o])&&e.cid&&this._newAndAddQuest(e)},M.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("quest",this.dataQuest))},M.prototype._newAndAddQuest=function(t){var e=this,o=new P;o.entry=d.sQuestConfig.getEntry(t.cid),o.record=t;for(var i=this,a=0;a<o.entry.conditions.length;++a)!function(a){var r=i.localModel.getModule(M).localQuestCondition.addCondition(new p.Decimal(t.conditions[a]),o.entry.conditions[a],function(i){t.conditions[a]=i.toPrecision(10),e.tryAutoCommit(o),e._dataDirty=!0,g.sGGame.emit(n.sQuestEvent.conditionChanged,t.cid)});o.conditions.push(r)}(a);return this.questMap.set(t.cid,o),o},M.prototype.tryAutoCommit=function(t){if(t.autoCommit){for(var e=t.tryAutoCommit(),o=0;o<e;++o)this.localModel.getModule(v.LocalReward).takeRewardString(t.entry.reward,!0,1,b.eReasonType.commitQuest);0<e&&(t.record.times+=e,this._dataDirty=!0,g.sGGame.emit(n.sQuestEvent.autoCommit))}},M.prototype.addQuest=function(t){if(!d.sQuestConfig.getEntry(t))return h.sGLog.error("entry is not existed { 'quest':'"+t+"' } "),null;var e=this.questMap.get(t);return e||((e=new G).cid=t,this.dataQuest[e.cid]=e,this._dataDirty=!0,this._newAndAddQuest(e))},M.prototype.removeQuest=function(t){h.sGLog.log("remove quest",t);var e=this.questMap.get(t);if(e){for(var o=0;o<e.entry.conditions.length;++o)this.localModel.getModule(M).localQuestCondition.removeCondition(e.conditions[o]);delete this.dataQuest[t],this.questMap.delete(t),this._dataDirty=!0}},M.prototype.isCompleted=function(t){return!!(t=this.questMap.get(t))&&t.isCompleted()},M.prototype.checkCommitQuest=function(t){return(t=this.questMap.get(t))?t.isCompleted()?!0===t.record.commited?n.sQuestError.commitErrorDone:n.sQuestError.noError:n.sQuestError.commitErrorUncomplete:n.sQuestError.systemError},M.prototype.commitQuest=function(t){return h.sGLog.log("commit quest",t),(t=this.questMap.get(t))&&t.isCompleted()?(t.record.commited=!0,this.localModel.getModule(v.LocalReward).takeRewardString(t.entry.reward,!0,1,b.eReasonType.commitQuest),this._dataDirty=!0,t):null},M.prototype.getQuest=function(t){return this.questMap.get(t)},M.prototype.resetQuest=function(t){h.sGLog.log("resetQuest",t);var e=this.questMap.get(t);if(!e)return null;e.entry=d.sQuestConfig.getEntry(t);for(var o=0;o<e.entry.conditions.length;++o)e.conditions[o].setNumber(0);return e.record.commited=!1,this._dataDirty=!0,e},r=M,n.LocalQuest=r,cc._RF.pop()},{}],local_reward_slot_machine:[function(t,e,o){"use strict";cc._RF.push(e,"879f9q+WmRCeqyUn2CrtAIt","local_reward_slot_machine");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalPlayerRewardSlotMachineRecord=n.eLocalRewardSlotMachineTurnType=n.sLocalSlotMachineEvent=void 0;var l,c=a("player_attribute_config"),s=a("slot_machine_config"),u=a("reward_helper"),d=a("gtime"),p=a("ggame"),f=a("ggame_data"),h=a("gmodule"),g=a("reason_define"),y=a("local_attribute"),m=a("local_card"),b=a("local_reward");function _(){this.oid=0,this.turnTimes=0,this.turnTimesToday=0,this.remainTimes=1,this.timesRecoverStartTimestamp=0}function v(){var t=null!==l&&l.apply(this,arguments)||this;return t._data=null,t._dataDirty=!1,t._currentRewardList=new u.RewardList,t.totalChance=0,t.slotMachineEntryArray=[],t.localModel=null,t}n.sLocalSlotMachineEvent={recoverTimes:"sLocalSlotMachineEvent.recoverTimes",turntableEnd:"sLocalSlotMachineEvent.turntableEnd"},(a=n.eLocalRewardSlotMachineTurnType||(n.eLocalRewardSlotMachineTurnType={}))[a.nil=0]="nil",a[a.free=1]="free",a[a.encourage=2]="encourage",n.LocalPlayerRewardSlotMachineRecord=_,r(v,l=h.GModule),v.prototype.init=function(t){for(var e in f.sGGameData.addTable(f.sGGameDataType.local,"playerSlotMachine",new _),this.localModel=t,s.sSlotMachineConfig.config)e=s.sSlotMachineConfig.getEntry(e),this.totalChance+=e.chance,this.slotMachineEntryArray.push(e);this.slotMachineEntryArray.sort(function(t,e){return e.sortID-t.sortID})},v.prototype.load=function(){this._data=this.localModel.localData.playerSlotMachine},v.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("playerSlotMachine",this._data))},Object.defineProperty(v.prototype,"maxTurnTableAccumulativeTimes",{get:function(){return this.localModel.getModule(y.LocalAttribute).getValue(y.eAttributeObjectType.player,0,c.sPlayerAttributeConfig.config.maxTurnTableAccumulativeTimes)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"turnTableRecoverInterval",{get:function(){return this.localModel.getModule(y.LocalAttribute).getValue(y.eAttributeObjectType.player,0,c.sPlayerAttributeConfig.config.turnTableRecoverInterval)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"maxTurnTableFreeTimes",{get:function(){return this.localModel.getModule(y.LocalAttribute).getValue(y.eAttributeObjectType.player,0,c.sPlayerAttributeConfig.config.maxTurnTableFreeTimes)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"maxTurnTableAdTimes",{get:function(){return this.localModel.getModule(y.LocalAttribute).getValue(y.eAttributeObjectType.player,0,c.sPlayerAttributeConfig.config.maxTurnTableAdTimes)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"maxTurnTableTimes",{get:function(){return this.maxTurnTableFreeTimes+this.maxTurnTableAdTimes},enumerable:!1,configurable:!0}),v.prototype.update=function(){var t=d.sGTime.timestamp();0===this._data.timesRecoverStartTimestamp?this._data.remainTimes<this.maxTurnTableAccumulativeTimes&&this._data.turnTimesToday<this.maxTurnTableTimes&&(this._data.timesRecoverStartTimestamp=t):(t-this._data.timesRecoverStartTimestamp)/1e3>this.turnTableRecoverInterval&&this.addRemainTimes(t)},v.prototype.addRemainTimes=function(t){void 0===t&&(this.dailyClear(),t=d.sGTime.timestamp()),this._data.remainTimes<this.maxTurnTableAccumulativeTimes&&(this._data.remainTimes+=1,this._data.remainTimes>=this.maxTurnTableAccumulativeTimes||this._data.turnTimesToday>=this.maxTurnTableTimes?this._data.timesRecoverStartTimestamp=0:this._data.timesRecoverStartTimestamp=t,this._dataDirty=!0,p.sGGame.emit(n.sLocalSlotMachineEvent.recoverTimes))},v.prototype.dailyClear=function(){this._data.turnTimesToday=0,this._data.remainTimes=1,this._dataDirty=!0},v.prototype.getRecoverRemainSeconds=function(){if(0===this._data.timesRecoverStartTimestamp)return 0;var t=d.sGTime.timestamp()-this._data.timesRecoverStartTimestamp;return t=Math.ceil(t/1e3),this.turnTableRecoverInterval-t+1},v.prototype.getRemainTimes=function(){return this._data.remainTimes},v.prototype.getRemainTimesToday=function(){return this.maxTurnTableTimes-this._data.turnTimesToday},v.prototype.isAd=function(){return this._data.turnTimesToday>=this.maxTurnTableFreeTimes},v.prototype.canRandomReward=function(t){var e=this.localModel.getModule(m.LocalCardPackage);return!((t=u.RewardList.createFromString(t.reward).getReward(0))&&t.type===b.eRewardType.randomCardFragment&&!e.isCanRandomCardFragment(t.id))},v.prototype.randomRewardIndex=function(){for(var t=0,e=Math.random()*this.totalChance,o=0,i=0;i<this.slotMachineEntryArray.length;++i){var a=this.slotMachineEntryArray[i];if(e<a.chance){if(e=0,!this.canRandomReward(a)){if(++o>this.slotMachineEntryArray.length)break;i===this.slotMachineEntryArray.length-1&&(i=-1);continue}t=i;break}e-=a.chance}return t},v.prototype.getEntry=function(t){return this.slotMachineEntryArray[t]},v.prototype.takeRewardIndex=function(t){return t<0||t>=this.slotMachineEntryArray.length?-1:(this._currentRewardList=new u.RewardList,!(t=this.slotMachineEntryArray[t])||(t=this.localModel.getModule(b.LocalReward).takeRewardString(t.reward,!0,1,g.eReasonType.slotMmachine))&&this._currentRewardList.addList(t.rewardList),this._data.turnTimesToday=this._data.turnTimesToday+1,this._data.turnTimes=this._data.turnTimes+1,this._data.remainTimes=this._data.remainTimes-1,this._dataDirty=!0,p.sGGame.emit(n.sLocalSlotMachineEvent.turntableEnd),0)},v.prototype.getAdReward=function(){return this._currentRewardList},v.prototype.hasAnythingToDo=function(){return 0<this.getRemainTimes()},v.prototype.takeRandomRewardIndex=function(){var t=this.randomRewardIndex();return(t<0||t>=this.slotMachineEntryArray.length)&&(t=0),this._currentRewardList=new u.RewardList,t=this.slotMachineEntryArray[t],(t=this.localModel.getModule(b.LocalReward).takeRewardString(t.reward,!0,1,g.eReasonType.slotMmachine))&&this._currentRewardList.addList(t.rewardList),t},r=v,n.default=r,cc._RF.pop()},{}],local_reward:[function(t,e,o){"use strict";cc._RF.push(e,"7f15fTNU6VOcLV/TzTXV4v9","local_reward");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalReward=n.LocalRewardResult=n.eRewardType=void 0;var l,c=a("local_currency"),s=a("card_config"),u=a("currency_config"),d=a("reward_helper"),p=a("gmodule"),f=a("local_battle"),h=a("local_stage"),g=a("local_card"),y=a("local_vip"),m=a("local_building"),b=a("pata_pack_config");(a=l=n.eRewardType||(n.eRewardType={}))[a.invalid=0]="invalid",a[a.buildingUpgradePoint=1]="buildingUpgradePoint",a[a.cardUpgradePoint=2]="cardUpgradePoint",a[a.pullCardPoint=3]="pullCardPoint",a[a.actionPoint=4]="actionPoint",a[a.cardFragment=5]="cardFragment",a[a.card=6]="card",a[a.card2Fragment=7]="card2Fragment",a[a.randomCard=8]="randomCard",a[a.vipExp=9]="vipExp",a[a.randomCardFragment=10]="randomCardFragment",a[a.activeDoubleSpeed=11]="activeDoubleSpeed",a[a.activeSweep=12]="activeSweep",a[a.questToken=13]="questToken",a[a.randomMaxAgeCard=14]="randomMaxAgeCard",a[a.buildingUpgradePointOverTime=15]="buildingUpgradePointOverTime",a[a.cardFragmentPack=16]="cardFragmentPack";var _,v=(C.prototype.getRewardString=function(){return this.rewardList.toString()},C.prototype.addResult=function(t){this.rewardList.addList(t.rewardList);for(var e=0;e<t.runeRecordIDArray.length;++e)this.runeRecordIDArray.push(t.runeRecordIDArray[e]);for(e=0;e<t.artifactRecordIDArray.length;++e)this.artifactRecordIDArray.push(t.artifactRecordIDArray[e]);for(e=0;e<t.petRecordIDArray.length;++e)this.petRecordIDArray.push(t.petRecordIDArray[e])},C);function C(){this.rewardList=new d.RewardList,this.runeRecordIDArray=[],this.artifactRecordIDArray=[],this.petRecordIDArray=[]}function P(){var t=null!==_&&_.apply(this,arguments)||this;return t.localModel=null,t}n.LocalRewardResult=v,r(P,_=p.GModule),P.prototype.init=function(t){this.localModel=t;for(var e=l.invalid+1;;++e){var o=l[e];if(!o)break;d.RewardList.registerRewardTypeInfo(o,l[o])}},P.prototype.reset=function(){},P.prototype.takeRewardString=function(t,e,o,i){void 0===e&&(e=!0),void 0===o&&(o=1),void 0===i&&(i=void 0);var a=new d.RewardList;return a.fromString(t),null===a?null:this.takeRewardList(a,e,o,i)},P.prototype.getBuildingUpgradePointOverTime=function(t){return this.localModel.getModule(m.LocalBuildingPackage).getTotalCollectPerSecond()*t},P.prototype.takeRewardList=function(t,e,o,i){void 0===e&&(e=!0),void 0===i&&(i=void 0);var a=null;(o=void 0===o?1:o)&&1!==o?((a=new d.RewardList).addList(t),a.multiply(o)):a=t;for(var n=a.getArray(),r=new v,l=0;l<n.length;++l){var c=n[l];this._take(c.type,c.id,c.count,c.extend,e,r,i)}return r},P.prototype._take=function(t,e,o,i,a,n,r){if(n=n||new v,e=e||0,t===l.buildingUpgradePoint||t===l.cardUpgradePoint||t===l.pullCardPoint||t===l.actionPoint||t===l.questToken)this.localModel.getModule(c.LocalCurrency).add(u.sCurrencyConfig.getEntry(l[t]),o,r),n.rewardList.add(t,e,o);else if(t===l.buildingUpgradePointOverTime){var d=this.getBuildingUpgradePointOverTime(o);this.localModel.getModule(c.LocalCurrency).add(u.sCurrencyConfig.config.buildingUpgradePoint,d,r),n.rewardList.add(l.buildingUpgradePoint,e,d)}else if(t===l.vipExp)this.localModel.getModule(y.LocalVIP).addExp(o),n.rewardList.add(t,e,o);else if(t===l.card)for(var p=(C=this.localModel.getModule(g.LocalCardPackage)).getCard(e),m=s.sCardConfig.getEntry(e),b=0;b<o;++b){var _;0===p.getLevel()?(C.addCard(m.id),n.rewardList.addUnqniue(l.card,m.id,1)):(_=m.cardToFragments,C.addCardFragment(m.id,_),n.rewardList.addUnqniue(l.card2Fragment,m.id,_))}else if(t===l.randomCard){var C=this.localModel.getModule(g.LocalCardPackage),P=e;for(b=0;b<o;++b)m=C.randomCard(P),0===(p=C.getCard(m.id)).getLevel()?(C.addCard(m.id),n.rewardList.addUnqniue(l.card,m.id,1)):(_=m.cardToFragments,C.addCardFragment(m.id,_),n.rewardList.addUnqniue(l.card2Fragment,m.id,_))}else if(t===l.randomMaxAgeCard)for(C=this.localModel.getModule(g.LocalCardPackage),P=e,b=0;b<o;++b)m=C.randomMaxAgeCard(P),0===(p=C.getCard(m.id)).getLevel()?(C.addCard(m.id),n.rewardList.addUnqniue(l.card,m.id,1)):(_=m.cardToFragments,C.addCardFragment(m.id,_),n.rewardList.addUnqniue(l.card2Fragment,m.id,_));else t===l.randomCardFragment?(P=e,(m=(C=this.localModel.getModule(g.LocalCardPackage)).randomCardFragment(P))&&(C.addCardFragment(m.id,o),n.rewardList.addUnqniue(l.cardFragment,m.id,o))):t===l.cardFragment?(C=this.localModel.getModule(g.LocalCardPackage),m=s.sCardConfig.getEntry(e),C.addCardFragment(m.id,o),n.rewardList.addUnqniue(l.cardFragment,m.id,o)):t===l.activeDoubleSpeed?(this.localModel.getModule(f.LocalBattle).activeDoubleSpeed(),n.rewardList.addUnqniue(l.activeDoubleSpeed,0,1)):t===l.activeSweep?(this.localModel.getModule(h.LocalStage).activeSweep(),n.rewardList.addUnqniue(l.activeSweep,0,1)):t===l.cardFragmentPack&&this.addPataPackReward(n.rewardList,e,o);return n},P.prototype.addPataPackReward=function(t,e,o){var i,a=b.sPataPackConfig.getEntry(e);a&&(i=this.localModel.getModule(g.LocalCardPackage),e=a.ages[Math.floor(Math.random()*a.ages.length)],a=a.qualitys[Math.floor(Math.random()*a.qualitys.length)],i=i.isCanRandomCardFragment(a,e)?i.randomCardFragment(a,e):i.isCanRandomCardFragment(0,e)?i.randomCardFragment(0,e):i.randomCardFragment(),t.add(l.cardFragment,i.id,o))},r=P,n.LocalReward=r,cc._RF.pop()},{}],local_skill:[function(t,e,o){"use strict";cc._RF.push(e,"b9871rG0A5OQIiCX26B3JLy","local_skill");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalSkillPackage=n.LocalSkill=void 0;var l,c=a("skill_attribute_config"),s=a("skill_config"),u=a("ggame"),d=a("gmodule"),p=a("attribute_slot"),f=a("attribute_system"),h=a("local_card"),g=(Object.defineProperty(y.prototype,"active",{get:function(){return 0<this.card.record.level},enumerable:!1,configurable:!0}),y.prototype.init=function(t,e){this.localModel=t,this.entry=s.sSkillConfig.getEntry(e),this.attributeSystem=new f.AttributeSystem,this.attributeSystem.init(c.sSkillAttributeConfig),e=this.attributeSystem.getSlot("init"),this.entry.attr1&&e.addPosValue(c.sSkillAttributeConfig.config.attr1,p.eAttributePos.init,this.entry.attr1),this.entry.attr2&&e.addPosValue(c.sSkillAttributeConfig.config.attr2,p.eAttributePos.init,this.entry.attr2),this.entry.attr3&&e.addPosValue(c.sSkillAttributeConfig.config.attr3,p.eAttributePos.init,this.entry.attr3)},y.prototype.getAttr1=function(){return this.attributeSystem.getValue(c.sSkillAttributeConfig.config.attr1)},y.prototype.getAttr2=function(){return this.attributeSystem.getValue(c.sSkillAttributeConfig.config.attr2)},y.prototype.getAttr3=function(){return this.attributeSystem.getValue(c.sSkillAttributeConfig.config.attr3)},y.prototype.getAttr4=function(){return this.attributeSystem.getValue(c.sSkillAttributeConfig.config.attr4)},y);function y(){this.entry=null,this.card=null}function m(){var t=null!==l&&l.apply(this,arguments)||this;return t.localModel=null,t._skillDic={},t}n.LocalSkill=g,r(m,l=d.GModule),m.prototype.init=function(t){this.localModel=t},m.prototype.load=function(){for(var t in this._skillDic={},s.sSkillConfig.config){var e=parseInt(t);(t=new g).init(this.localModel,e),this._skillDic[e]=t}},m.prototype.start=function(){for(var t in this._skillDic){var e=this._skillDic[t];t=u.sGGame.localModel.getModule(h.LocalCardPackage).getCard(e.entry.cardID),e.card=t}},m.prototype.stop=function(){this._skillDic={}},m.prototype.save=function(){},m.prototype.getSkill=function(t){return this._skillDic[t]},m.prototype.randomSkill=function(){var t,e=[];for(t in this._skillDic){var o=this._skillDic[t];o.active&&o.card.record.equiped&&e.push(o)}if(0<e.length)return e[Math.floor(Math.random()*e.length)]},m.prototype.debugRandomAllSkill=function(){var t,e=[];for(t in this._skillDic){var o=this._skillDic[t];e.push(o)}if(0<e.length)return e[Math.floor(Math.random()*e.length)]},m.prototype.hasActiveSkill=function(){for(var t in this._skillDic)if(this._skillDic[t].active)return!0;return!1},m.prototype.getSkillArrayEquiped=function(){var t,e=[];for(t in this._skillDic){var o=this._skillDic[t];o.active&&o.card.record.equiped&&e.push(o)}return e},r=m,n.LocalSkillPackage=r,cc._RF.pop()},{}],local_soldier:[function(t,e,o){"use strict";cc._RF.push(e,"f2b7eh35WhLFZUnU40LuXy8","local_soldier");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalSoldierPackage=n.LocalSoldier=void 0;var l,c=a("soldier_attribute_config"),s=a("soldier_config"),u=a("ggame"),d=a("gmodule"),p=a("attribute_slot"),f=a("attribute_system"),h=a("local_card"),g=(Object.defineProperty(y.prototype,"active",{get:function(){return 0<this.card.record.level},enumerable:!1,configurable:!0}),y.prototype.init=function(t){this.entry=s.sSoldierConfig.getEntry(t),this.attributeSystem=new f.AttributeSystem,this.attributeSystem.init(c.sSoldierAttributeConfig),(t=this.attributeSystem.getSlot("init")).setPosValue(c.sSoldierAttributeConfig.config.attack,p.eAttributePos.init,0),t.setPosValue(c.sSoldierAttributeConfig.config.maxHP,p.eAttributePos.init,0),t.setPosValue(c.sSoldierAttributeConfig.config.attackInterval,p.eAttributePos.init,this.entry.attackInterval),t.setPosValue(c.sSoldierAttributeConfig.config.moveSpeed,p.eAttributePos.init,this.entry.moveSpeed)},y.prototype.getLevelAttributeSystem=function(t){var e=new f.AttributeSystem;e.init(c.sSoldierAttributeConfig);var o,i=e.getSlot("init");return i.setPosValue(c.sSoldierAttributeConfig.config.attack,p.eAttributePos.init,0),i.setPosValue(c.sSoldierAttributeConfig.config.maxHP,p.eAttributePos.init,0),i.setPosValue(c.sSoldierAttributeConfig.config.attackInterval,p.eAttributePos.init,this.entry.attackInterval),i.setPosValue(c.sSoldierAttributeConfig.config.moveSpeed,p.eAttributePos.init,this.entry.moveSpeed),0<t&&this.card&&(o=this.card.getLevelAttributeValue1(t),i=this.card.getLevelAttributeValue2(t),t=e.getSlot("card"),this.card.entry.attributeType1&&t.addPosValue(this.card.entry.attributeType1,this.card.entry.attributePos1,o),this.card.entry.attributeType2&&t.addPosValue(this.card.entry.attributeType2,this.card.entry.attributePos2,i)),e},y.prototype.getLevel=function(){return this.card.record.level},y.prototype.getPataLevel=function(){return this.attributeSystem.getValue(c.sSoldierAttributeConfig.config.pataAddStar)+this.card.record.level},y.prototype.isFullLevel=function(){return this.card.isLevelFull()},y.prototype.isPataFullLevel=function(){return this.card.isLevelFullWithLevel(this.getPataLevel())},y);function y(){this.entry=null,this.card=null}function m(){var t=null!==l&&l.apply(this,arguments)||this;return t.localModel=null,t._soldierDic={},t}n.LocalSoldier=g,r(m,l=d.GModule),m.prototype.init=function(t){this.localModel=t},m.prototype.load=function(){for(var t in this._soldierDic={},s.sSoldierConfig.config){var e=parseInt(t);(t=new g).init(e),this._soldierDic[e]=t}},m.prototype.start=function(){for(var t in this._soldierDic){var e=this._soldierDic[t];(t=u.sGGame.localModel.getModule(h.LocalCardPackage).getCard(e.entry.cardID)).isSoldierCard=!0,e.card=t}},m.prototype.stop=function(){this._soldierDic={}},m.prototype.save=function(){},m.prototype.getSoldier=function(t){return this._soldierDic[t]},m.prototype.getSoldierByCard=function(t){for(var e in this._soldierDic)if((e=this._soldierDic[e]).card.entry.id===t)return e;return null},m.prototype.getSoldierArrayEquiped=function(){var t,e=[];for(t in this._soldierDic){var o=this._soldierDic[t];o.active&&o.card.record.equiped&&e.push(o)}return e},m.prototype.getSoldierArrayByAge=function(t){var e,o=[];for(e in this._soldierDic){var i=this._soldierDic[e];i.card.entry.unlockAge===t&&o.push(i)}return o},m.prototype.getSoldierActiveCount=function(){var t,e=0;for(t in this._soldierDic){var o=this._soldierDic[t];o&&o.active&&e++}return e},m.prototype.getActiveSoldierArray=function(){var t,e=[];for(t in this._soldierDic){var o=this._soldierDic[t];o.card.isActive()&&e.push(o)}return e},r=m,n.LocalSoldierPackage=r,cc._RF.pop()},{}],local_stage:[function(t,e,o){"use strict";cc._RF.push(e,"dd73c6hxMNEJa3BXcu+5WgD","local_stage");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalStage=n.BattleBuff=n.BattleExtendReward=n.LocalBattleSkillCard=n.LocalStagePlayerRecord=n.sLocalStageEvent=void 0;var l,c=a("local_currency"),s=a("client_config"),u=a("const_config"),d=a("currency_config"),p=a("stage_config"),f=a("stage_spawner_config"),h=a("reward_helper"),g=a("glog"),y=a("gtime"),m=a("ggame"),b=a("ggame_data"),_=a("gmodule"),v=a("game_define"),C=a("reason_define"),P=a("local_building"),S=a("local_card"),G=a("local_reward"),M=a("local_skill");function w(){this.oid=0,this.currentPassStageID=1,this.currentBattleStageID=1,this.sweepEnabled=!1,this.sweepExpirationTime=0,this.treasureChestStageID=0}function A(){this.type=G.eRewardType.invalid,this.id=0,this.count=0,this.mul=0,this.hasTaken=!1}function B(){var t=null!==l&&l.apply(this,arguments)||this;return t.localModel=null,t.stagePlayerRecord=null,t._dataDirty=!1,t.isEnterNewAgeWorldMap=!1,t.baseCardUpgradePoint=0,t.baseBuildingUpgradePoint=0,t.extendRewardArray=null,t.victoryRandomCardIndex=-1,t}n.sLocalStageEvent={collectOneVictoryRandomReward:"sLocalStageEvent.collectOneVictoryRandomReward",collectAllVictoryRReward:"sLocalStageEvent.collectAllVictoryRReward",collectDoubleVictoryRReward:"sLocalStageEvent.collectDoubleVictoryRReward",currentStageChanged:"sLocalStageEvent.currentStageChanged",currentPassStageChanged:"sLocalStageEvent.currentPassStageChanged",currentTreasureChestStageIDChanged:"sLocalStageEvent.currentTreasureChestStageIDChanged",activeSweep:"sLocalStageEvent.activeSweep",effectSweep:"sLocalStageEvent.effectSweep",sweep:"sLocalStageEvent.sweep"},n.LocalStagePlayerRecord=w,n.LocalBattleSkillCard=function(){this.active=!1},n.BattleExtendReward=A,n.BattleBuff=function(){},r(B,l=_.GModule),Object.defineProperty(B.prototype,"currentPassStageID",{get:function(){return this.stagePlayerRecord.currentPassStageID},set:function(t){this.stagePlayerRecord.currentPassStageID=t,this.currentPassStageEntry=p.sStageConfig.getEntry(t),this._dataDirty=!0,m.sGGame.emit(n.sLocalStageEvent.currentPassStageChanged,t)},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"currentBattleStageID",{get:function(){return this.stagePlayerRecord.currentBattleStageID},set:function(t){this.stagePlayerRecord.currentBattleStageID=t,this.currentBattleStageEntry=p.sStageConfig.getEntry(t),1===this.currentBattleStageEntry.agePosID&&(this.isEnterNewAgeWorldMap=!0),this._dataDirty=!0,m.sGGame.emit(n.sLocalStageEvent.currentStageChanged,t)},enumerable:!1,configurable:!0}),B.prototype.init=function(t){b.sGGameData.addTable(b.sGGameDataType.local,"stagePlayer",new w),this.localModel=t,this.localSkillPackage=t.getModule(M.LocalSkillPackage);for(var e=p.sStageConfig.getEntry(1),o=1,i=[0,0,0,0,0,0,0,0,0,0];e;)e.sortID=o++,i[e.age]=i[e.age]+1,e.agePosID=i[e.age],e.hasTreasureChest=e.agePosID%5==0&&1<e.age,e=p.sStageConfig.getEntry(e.nextID);if(s.sClientConfig.config.devMode)for(var a in f.sStageSpawnerConfig.config)for(var n=f.sStageSpawnerConfig.getEntry(a),r=0;r<n.length;++r){var l=n[r];(l.soldiers.length>l.level.length||l.soldiers.length>l.spawnerCount.length)&&g.sGLog.error("\u5173\u5361\u51fa\u5175\u914d\u7f6e\u9519\u8bef "+l.id+"  "+l.seconds+" "+l.soldiers.length+" "+l.level.length+" "+l.spawnerCount.length)}},B.prototype.load=function(){this.stagePlayerRecord=this.localModel.localData.stagePlayer,this.currentPassStageEntry=p.sStageConfig.getEntry(this.stagePlayerRecord.currentPassStageID),this.currentBattleStageEntry=p.sStageConfig.getEntry(this.stagePlayerRecord.currentBattleStageID),this.initTreasureChest()},B.prototype.start=function(){},B.prototype.stop=function(){},B.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("stagePlayer",this.stagePlayerRecord))},B.prototype.checkStartStage=function(){return this.localModel.getModule(c.LocalCurrency).get(d.sCurrencyConfig.config.actionPoint)<u.sConstConfig.config.battleActionPoint?1:0},B.prototype.getCurrentBattleStageID=function(){return this.stagePlayerRecord.currentBattleStageID},B.prototype.getCurrentPassStageID=function(){return this.stagePlayerRecord.currentPassStageID},B.prototype.checkSweep=function(){return this.getSweepRemainEffectiveTime()<=0?1:this.localModel.getModule(c.LocalCurrency).get(d.sCurrencyConfig.config.actionPoint)<u.sConstConfig.config.battleActionPoint?2:0},B.prototype.sweep=function(){var t=this.checkSweep();return t||(this.extendRewardArray=this._getRandomExtendReward(!0),this.baseCardUpgradePoint=this.currentBattleStageEntry.baseCardUpgradePoint,this.baseBuildingUpgradePoint=this.localModel.getModule(G.LocalReward).getBuildingUpgradePointOverTime(this.currentBattleStageEntry.baseBuildingUpgradePointOverTime),this.victoryRandomCardIndex=-1,(t=this.localModel.getModule(c.LocalCurrency))&&(t.use(d.sCurrencyConfig.config.actionPoint,u.sConstConfig.config.battleActionPoint,C.eReasonType.battleSweep),t.add(d.sCurrencyConfig.config.cardUpgradePoint,this.baseCardUpgradePoint,C.eReasonType.battleSweep),t.add(d.sCurrencyConfig.config.buildingUpgradePoint,this.baseBuildingUpgradePoint,C.eReasonType.battleSweep)),m.sGGame.emit(n.sLocalStageEvent.sweep,this.stagePlayerRecord.currentBattleStageID),0)},B.prototype._getRandomExtendReward=function(t){var e=[],o=this.currentBattleStageEntry;if(!t&&o.firstReward){if(r=h.RewardList.createFromString(o.firstReward))for(var i=this.localModel.getModule(G.LocalReward).takeRewardList(r,!0,1,C.eReasonType.battleExtendReward),a=0;a<i.rewardList.length;++a){var n=i.rewardList.getReward(a);n&&((u=new A).type=n.type,u.count=n.count,u.mul=1,u.hasTaken=!0,e.push(u))}}else{var r,l=6;for((r=(t=this.localModel.getModule(S.LocalCardPackage)).isCanRandomCardFragment())&&((u=new A).type=G.eRewardType.cardFragment,u.id=t.randomCardFragment().id,u.count=o.fragment,u.mul=Math.floor(3*Math.random())+1,e.push(u),l--);0<l;){var c=Math.floor(Math.random()*v.GameDefine.battleExtendRewardTypeArray.length),s=v.GameDefine.battleExtendRewardTypeArray[c],u=new A;c=G.eRewardType[s],s=o[s],c===G.eRewardType.buildingUpgradePointOverTime&&(c=G.eRewardType.buildingUpgradePoint,s=this.localModel.getModule(P.LocalBuildingPackage).getTotalCollectPerSecond()*s),u.type=c,u.count=s,u.mul=Math.floor(3*Math.random())+1,e.push(u),l--}r&&(r=e[t=Math.floor(Math.random()*e.length)],e[t]=e[0],e[0]=r)}return e},B.prototype.isSystemIsOpened=function(t){return t=p.sStageConfig.getEntry(t),!(this.currentPassStageEntry.sortID<t.sortID)},B.prototype.activeSweep=function(){this.stagePlayerRecord.sweepEnabled||(this.stagePlayerRecord.sweepEnabled=!0,this._dataDirty=!0,m.sGGame.emit(n.sLocalStageEvent.activeSweep))},Object.defineProperty(B.prototype,"sweepEnabled",{get:function(){return this.stagePlayerRecord.sweepEnabled},enumerable:!1,configurable:!0}),B.prototype.effectSweep=function(){this.stagePlayerRecord.sweepEnabled&&(this.stagePlayerRecord.sweepExpirationTime=y.sGTime.timestamp()+1e3*u.sConstConfig.config.sweepEffectiveDuration,this._dataDirty=!0,m.sGGame.emit(n.sLocalStageEvent.effectSweep))},B.prototype.getSweepRemainEffectiveTime=function(){return!this.stagePlayerRecord.sweepEnabled||this.stagePlayerRecord.sweepExpirationTime<y.sGTime.timestamp()?0:this.stagePlayerRecord.sweepExpirationTime-y.sGTime.timestamp()},B.prototype.collectOneVictoryRandomReward=function(t){this.victoryRandomCardIndex=t;var e,o=this.extendRewardArray[this.victoryRandomCardIndex];o.hasTaken||(o.hasTaken=!0,(e=new h.RewardList).add(o.type,o.id,o.count*o.mul),this.localModel.getModule(G.LocalReward).takeRewardList(e,!0,1,C.eReasonType.battleExtendReward)),m.sGGame.emit(n.sLocalStageEvent.collectOneVictoryRandomReward,t)},B.prototype.collectAllVictoryReward=function(){for(var t,e=new h.RewardList,o=0;o<6;++o)o!=this.victoryRandomCardIndex&&((t=this.extendRewardArray[o]).hasTaken||e.add(t.type,t.id,t.count*t.mul));this.localModel.getModule(G.LocalReward).takeRewardList(e,!0,1,C.eReasonType.battleExtendReward),m.sGGame.emit(n.sLocalStageEvent.collectAllVictoryRReward)},B.prototype.canCollectDoubleVictoryReward=function(){return this.stagePlayerRecord.currentBattleStageID>u.sConstConfig.config.collectDoubleVictoryRewardStage},B.prototype.collectDoubleVictoryReward=function(){if(this.canCollectDoubleVictoryReward()){0<this.baseCardUpgradePoint&&this.localModel.getModule(c.LocalCurrency).add(d.sCurrencyConfig.config.cardUpgradePoint,2*this.baseCardUpgradePoint,C.eReasonType.battleVictory),0<this.baseBuildingUpgradePoint&&this.localModel.getModule(c.LocalCurrency).add(d.sCurrencyConfig.config.buildingUpgradePoint,2*this.baseBuildingUpgradePoint,C.eReasonType.battleVictory);for(var t=new h.RewardList,e=0;e<this.extendRewardArray.length;++e){var o=this.extendRewardArray[e];t.add(o.type,o.id,o.count*o.mul)}this.localModel.getModule(G.LocalReward).takeRewardList(t,!0,2,C.eReasonType.battleExtendReward),m.sGGame.emit(n.sLocalStageEvent.collectDoubleVictoryRReward)}},B.prototype.initTreasureChest=function(){this.currentTreasureChestStageID=this.getNextTreasureChestStageID(),this.treasureBoxRewardList=void 0},B.prototype.getNextTreasureChestStageID=function(){for(var t,e=1;;++e){var o=this.stagePlayerRecord.treasureChestStageID+e,i=p.sStageConfig.getEntry(o);if(!i)break;if(i.hasTreasureChest){t=o;break}}return t},B.prototype.getCurrentTreasureChestStageID=function(){return this.currentTreasureChestStageID},B.prototype.getTreasureChestRewardList=function(){return this.treasureBoxRewardList||(this.treasureBoxRewardList=h.RewardList.createFromString(u.sConstConfig.config.treasureChestReward)),this.treasureBoxRewardList},B.prototype.checkTakeTreasureChest=function(){return this.currentTreasureChestStageID?this.currentPassStageID<this.currentTreasureChestStageID?2:0:1},B.prototype.takeTreasureChest=function(){if(0==this.checkTakeTreasureChest())return this.stagePlayerRecord.treasureChestStageID=this.currentTreasureChestStageID,this._dataDirty=!0,this.currentTreasureChestStageID=this.getNextTreasureChestStageID(),m.sGGame.emit(n.sLocalStageEvent.currentTreasureChestStageIDChanged,this.currentTreasureChestStageID),this.localModel.getModule(G.LocalReward).takeRewardList(this.getTreasureChestRewardList())},r=B,n.LocalStage=r,cc._RF.pop()},{}],local_store:[function(t,e,o){"use strict";cc._RF.push(e,"e3f17JduiZEI6DueyxQgHha","local_store");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalStorePlacementRecord=n.LocalPlayerStoreRecord=n.eStoreError=n.sLocalStoreEvent=n.ePlacementType=n.ePayType=void 0;var l,c,s,u,d=a("local_currency"),p=a("currency_config"),f=a("store_const_config"),h=a("store_goods_config"),g=a("store_goods_placement_config"),y=a("store_refresh_goods_config"),m=a("gtime"),b=a("ggame"),_=a("ggame_data"),v=a("gmodule"),C=a("reason_define"),P=a("local_card"),S=a("local_reward");function G(){this.oid=0,this.lastAutoRefreshTimestamp=0,this.manualRefreshTimes=0,this.todayManualRefreshTimes=0}function M(){this.oid=0,this.cid=0,this.goodsID=0,this.stockLimit=0,this.stockNumber=0,this.buyTotalTimes=0,this.lastBuyTimestamp=0,this.rewardString=""}function w(){var t=null!==u&&u.apply(this,arguments)||this;return t._dataPlayerStore=null,t._dataStorePlacement=null,t._dataDirty=!1,t.localModel=null,t}(a=l=n.ePayType||(n.ePayType={}))[a.free=1]="free",a[a.ad=2]="ad",a[a.gem=3]="gem",a[a.rmb=4]="rmb",(a=c=n.ePlacementType||(n.ePlacementType={}))[a.normal=0]="normal",a[a.refresh=1]="refresh",n.sLocalStoreEvent={refreshPlacement:"sLocalStoreEvent_refreshPlacement",refreshStore:"sLocalStoreEvent_refreshStore",buyGoods:"sLocalStoreEvent_buyGoods"},(a=s=n.eStoreError||(n.eStoreError={}))[a.ok=0]="ok",a[a.noGoodsInPlacement=1]="noGoodsInPlacement",a[a.stockEmpty=2]="stockEmpty",a[a.goodsInCD=3]="goodsInCD",a[a.notEnoughGems=4]="notEnoughGems",a[a.encourageFail=5]="encourageFail",a[a.purchaseFail=6]="purchaseFail",n.LocalPlayerStoreRecord=G,n.LocalStorePlacementRecord=M,r(w,u=v.GModule),w.prototype.init=function(t){_.sGGameData.addTable(_.sGGameDataType.local,"playerStore",new G),_.sGGameData.addTable(_.sGGameDataType.local,"storePlacement",{0:new M}),this.localModel=t},w.prototype.load=function(){this._dataPlayerStore=this.localModel.localData.playerStore,this._dataStorePlacement=this.localModel.localData.storePlacement,this._dataPlayerStore.lastAutoRefreshTimestamp||(this._dataPlayerStore.lastAutoRefreshTimestamp=m.sGTime.midnight(m.sGTime.timestamp()).getTime(),this._dataDirty=!0)},w.prototype.start=function(){for(var t in g.sStoreGoodsPlacementConfig.config){var e,o=g.sStoreGoodsPlacementConfig.getEntry(t),i=this.getPlacement(o.id);i||((i=new M).cid=o.id,e=(c[o.type]===c.refresh?(t=y.sStoreRefreshGoodsConfig.getEntry(o.goodsid))[Math.floor(Math.random()*t.length)]:o).goodsid,this._initStorePlacementRecord(i,e),this._dataStorePlacement[o.id]=i)}},w.prototype.stop=function(){b.sGGame.targetOff(this)},w.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("playerStore",this._dataPlayerStore),this.localModel.database.update("storePlacement",this._dataStorePlacement))},w.prototype.update1=function(){this.getRefreshCooldown()||this._refreshStore(!0)},w.prototype._initStorePlacementRecord=function(t,e){var o=h.sStoreGoodsConfig.getEntry(e);if("reward"===o.goodsType)t.goodsID=o.id,t.stockLimit=o.stockLimit,t.stockNumber=o.stockLimit,t.rewardString=o.rewardString;else if("randomFragment"===o.goodsType){t.goodsID=o.id,t.stockLimit=o.stockLimit,t.stockNumber=o.stockLimit;for(var i=b.sGGame.localModel.getModule(P.LocalCardPackage),a=void 0,n=0;n<3&&(a=3+(o.quality+n)%3,!i.isCanRandomCardFragment(a));++n);(e=i.randomCardFragment(a))?t.rewardString="cardFragment/"+e.id+"/"+o.rewardString:(e=i.randomCardFragment(),t.rewardString="cardFragment/"+e.id+"/"+o.rewardString)}t.lastBuyTimestamp=0,l[o.payType]===l.free&&(t.lastBuyTimestamp=m.sGTime.timestamp()-1e3*o.cooldown+18e5)},w.prototype.hasStockLimit=function(t){return!(!(t=this._dataStorePlacement[t])||!t.stockLimit)},w.prototype.getStockNumber=function(t){return(t=this._dataStorePlacement[t])&&t.stockLimit?t.stockNumber:-1},w.prototype.getBuyCooldown=function(t){var e=this._dataStorePlacement[t];return e?(t=h.sStoreGoodsConfig.getEntry(e.goodsID),e=m.sGTime.timestamp()-e.lastBuyTimestamp,(t=1e3*t.cooldown)<=e?0:t-e):0},w.prototype.getPlacement=function(t){return this._dataStorePlacement[t]},w.prototype.getRefreshCooldown=function(){var t=m.sGTime.timestamp()-this._dataPlayerStore.lastAutoRefreshTimestamp,e=1e3*f.sStoreConstConfig.config.refreshInterval;return e<=t?0:e-t},w.prototype.checkBuyGoods=function(t){var e=this._dataStorePlacement[t];return e?e.stockLimit&&0===e.stockNumber?s.stockEmpty:(t=h.sStoreGoodsConfig.getEntry(e.goodsID),m.sGTime.timestamp()-e.lastBuyTimestamp<1e3*t.cooldown?s.goodsInCD:l[t.payType]===l.gem&&this.localModel.getModule(d.LocalCurrency).get(p.sCurrencyConfig.config.pullCardPoint)<t.price?s.notEnoughGems:s.ok):s.noGoodsInPlacement},w.prototype.buyGoods=function(t){if(o=this.checkBuyGoods(t))return o;var e=this._dataStorePlacement[t],o=h.sStoreGoodsConfig.getEntry(e.goodsID);return(t=l[o.payType])===l.gem?(this.localModel.getModule(d.LocalCurrency).use(p.sCurrencyConfig.config.pullCardPoint,o.price,C.eReasonType.buyGoods),this.buyGoodsComplete(e,o)):t===l.ad||t===l.rmb||this.buyGoodsComplete(e,o),0},w.prototype.buyGoodsComplete=function(t,e){t.lastBuyTimestamp=m.sGTime.timestamp(),t.stockLimit&&0<t.stockNumber&&t.stockNumber--;var o=this.localModel.getModule(S.LocalReward).takeRewardString(t.rewardString);b.sGGame.emit(n.sLocalStoreEvent.buyGoods,e,o),t.buyTotalTimes++,e.nextGoods&&0===t.stockNumber&&this._initStorePlacementRecord(t,e.nextGoods),b.sGGame.emit(n.sLocalStoreEvent.refreshPlacement,t.cid),this._dataDirty=!0},w.prototype.checkManualRefresh=function(){return 0},w.prototype.manualRefresh=function(){return this.checkManualRefresh()||(this._refreshStore(!1),this._dataPlayerStore.manualRefreshTimes++,this._dataPlayerStore.todayManualRefreshTimes++,this._dataDirty=!0,0)},w.prototype._refreshStore=function(t){for(var e in g.sStoreGoodsPlacementConfig.config){var o=g.sStoreGoodsPlacementConfig.getEntry(e);if((t||201!==o.id)&&c[o.type]===c.refresh){for(var i=y.sStoreRefreshGoodsConfig.getEntry(o.goodsid),a=0,r=0;r<i.length;++r)a+=i[r].weight;var l=Math.random()*a,s=void 0;for(r=0;r<i.length&&!(l<=(s=i[r]).weight);++r)l-=s.weight;var u=h.sStoreGoodsConfig.getEntry(s.goodsid);e=this.getPlacement(o.id),this._initStorePlacementRecord(e,u.id),b.sGGame.emit(n.sLocalStoreEvent.refreshPlacement,o.id)}}t&&(this._dataPlayerStore.lastAutoRefreshTimestamp=m.sGTime.midnight(m.sGTime.timestamp()).getTime()),this._dataDirty=!0,b.sGGame.emit(n.sLocalStoreEvent.refreshStore)},w.prototype.getInAppPlacement=function(t){for(var e in this._dataStorePlacement){var o=this._dataStorePlacement[e];if(o&&o.goodsID&&(e=h.sStoreGoodsConfig.config[e])&&"rmb"===e.payType&&e.inAppID===t)return{storePlacement:o,goodsEntry:e}}return null},w.prototype.getTodayMaunalTimes=function(){return this._dataPlayerStore.todayManualRefreshTimes},w.prototype.dailyClear=function(){this._dataPlayerStore.todayManualRefreshTimes=0,this._dataDirty=!0},r=w,n.default=r,cc._RF.pop()},{}],local_tech:[function(t,e,o){"use strict";cc._RF.push(e,"92762SqSaRFubTIaHA7Vlki","local_tech");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalTechPackage=n.LocalTech=n.LocalTechRecord=n.LocalTechPlayerRecord=n.sLocalTechEvent=void 0;var l,c=a("const_config"),s=a("tech_config"),u=a("reward_helper"),d=a("gtime"),p=a("ggame"),f=a("ggame_data"),h=a("gmodule"),g=a("reason_define"),y=a("local_stage"),m=a("local_reward"),b=a("local_building"),_=a("local_battle");function v(){this.oid=0,this.airDropCollectTimestamp=0}function C(){this.oid=0,this.cid=0,this.level=0}function P(){this.record=null,this.entry=null,this._maxLevel=0}function S(){var t=null!==l&&l.apply(this,arguments)||this;return t.localModel=null,t.techPlayerRecord=null,t._dataDirty=!1,t.attributeSlotName="tech",t.localBattle=null,t}n.sLocalTechEvent={collectAirDrop:"sLocalTechEvent.collectAirDrop",airDropDisapear:"sLocalTechEvent.airDropDisapear"},n.LocalTechPlayerRecord=v,n.LocalTechRecord=C,P.prototype.init=function(t,e){this.localModel=t,this.record=e,this.entry=s.sTechConfig.getEntry(this.record.cid),this._maxLevel=this.entry.upgradePointNeedArray.length},P.prototype.getAttributeValue=function(){return 0<this.record.level?this.entry.attributeValues[this.record.level-1]:this.entry.attributeValues[0]},P.prototype.getLevel=function(){return this.record.level},P.prototype.getMaxLevel=function(){return this._maxLevel},P.prototype.getUpgradeNeed=function(){return this.record.level<this._maxLevel?this.entry.upgradePointNeedArray[this.record.level]:0},P.prototype.isLevelFull=function(){return this.record.level>=this._maxLevel},a=P,n.LocalTech=a,r(S,l=h.GModule),S.prototype.init=function(t){f.sGGameData.addTable(f.sGGameDataType.local,"techPlayer",new v),f.sGGameData.addTable(f.sGGameDataType.local,"tech",{0:new C}),this.localModel=t},S.prototype.load=function(){this.techPlayerRecord=this.localModel.localData.techPlayer},S.prototype.start=function(){this.localBattle=p.sGGame.localModel.getModule(_.LocalBattle)},S.prototype.stop=function(){},S.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("techPlayer",this.techPlayerRecord))},S.prototype.update=function(t){this.hasAirDrop()&&(this.localBattle.inBattle?this.techPlayerRecord.airDropCollectTimestamp+=1e3*t:this.remainTimeOfAirDrop()<0&&(t=d.sGTime.timestamp(),this.techPlayerRecord.airDropCollectTimestamp=t,this._dataDirty=!0,p.sGGame.emit(n.sLocalTechEvent.airDropDisapear)))},S.prototype.hasAirDrop=function(){var t=d.sGTime.timestamp(),e=p.sGGame.localModel.getModule(y.LocalStage).isSystemIsOpened(c.sConstConfig.config.techAirDropSystemOpenStage);return t-=this.techPlayerRecord.airDropCollectTimestamp,e&&t>1e3*c.sConstConfig.config.techAirDropInterval},S.prototype.remainTimeOfAirDrop=function(){var t=d.sGTime.timestamp()-this.techPlayerRecord.airDropCollectTimestamp-1e3*c.sConstConfig.config.techAirDropInterval;return 0<=t?Math.floor(60-t/1e3):60},S.prototype.checkCollectAirDrop=function(t){return t||this.hasAirDrop()?0:1},S.prototype.collectAirDrop=function(t,e){var o=d.sGTime.timestamp();return this.techPlayerRecord.airDropCollectTimestamp=o,this._dataDirty=!0,o=this.getAirDropValue(),t&&(o*=5),(t=new u.RewardList).add(m.eRewardType.buildingUpgradePoint,o),t=this.localModel.getModule(m.LocalReward).takeRewardList(t,!0,1,g.eReasonType.airDrop),e&&e(0,t),p.sGGame.emit(n.sLocalTechEvent.collectAirDrop),0},S.prototype.getAirDropValue=function(){return 60*this.localModel.getModule(b.LocalBuildingPackage).getTotalCollectPerSecond()*c.sConstConfig.config.techAirDropMul},r=S,n.LocalTechPackage=r,cc._RF.pop()},{}],local_template:[function(t,e,o){"use strict";cc._RF.push(e,"6afbdOhzCJGR5Q0psUpL910","local_template");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function l(){this.oid=0,this.age=0}Object.defineProperty(n,"__esModule",{value:!0}),n.LocalTemplatePackage=n.LocalTemplate=n.LocalTemplateRecord=n.LocalTemplatePlayerRecord=void 0;var c,s=a("ggame_data"),u=a("gmodule");function d(){this.oid=0,this.cid=0,this.level=0}function p(){this.record=null}function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.localModel=null,t.cardPlayerRecord=null,t.cardRecordDic=null,t._dataDirty=!1,t._cardDic={},t}n.LocalTemplatePlayerRecord=l,n.LocalTemplateRecord=d,p.prototype.init=function(t,e){this.localModel=t,this.record=e},a=p,n.LocalTemplate=a,r(f,c=u.GModule),f.prototype.init=function(t){s.sGGameData.addTable(s.sGGameDataType.local,"cardPlayer",new l),s.sGGameData.addTable(s.sGGameDataType.local,"card",{0:new d}),this.localModel=t},f.prototype.load=function(){this.cardPlayerRecord=this.localModel.localData.cardPlayer,this.cardRecordDic=this.localModel.localData.card},f.prototype.start=function(){},f.prototype.stop=function(){this._cardDic={}},f.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this.localModel.database.update("cardPlayer",this.cardPlayerRecord),this.localModel.database.update("card",this.cardRecordDic))},f.prototype._getTemplateRecord=function(t){var e=this.cardRecordDic[t];return e||((e=new d).cid=t,this.cardRecordDic[t]=e,this._dataDirty=!0),e},f.prototype.getTemplate=function(t){return this._cardDic[t]},r=f,n.LocalTemplatePackage=r,cc._RF.pop()},{}],local_vip:[function(t,e,o){"use strict";cc._RF.push(e,"3c438bjEH9Jxq0x9vYjh/4r","local_vip");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.LocalVIP=n.LocalVIPPlayerRecord=n.sLocalVIPEvent=void 0;var l,c=a("local_ad"),s=a("const_config"),u=a("event_config"),d=a("player_attribute_config"),p=a("vip_config"),f=a("ganalytics"),h=a("ggame"),g=a("ggame_data"),y=a("gmodule"),m=a("reason_define"),b=a("attribute_slot"),_=a("local_attribute"),v=a("local_reward");function C(){this.oid=0,this.level=0,this.exp=0,this.adVIPCollected=!1}function P(){var t=null!==l&&l.apply(this,arguments)||this;return t._localModel=null,t._playerRecord=null,t._dataDirty=!1,t.attributeSlotName="vip",t}n.sLocalVIPEvent={levelChanged:"sLocalVIPEvent.levelChanged",expChanged:"sLocalVIPEvent.expChanged",collectVipADReward:"sLocalVIPEvent.collectVipADReward"},n.LocalVIPPlayerRecord=C,r(P,l=y.GModule),P.prototype.init=function(t){g.sGGameData.addTable(g.sGGameDataType.local,"vipPlayer",new C),this._localModel=t},P.prototype.load=function(){this._playerRecord=this._localModel.localData.vipPlayer,this._dataDirty=!0},P.prototype.start=function(){var t=this;this._currentVIPEntry=p.sVipConfig.getEntry(this._playerRecord.level),this._nextVIPEntry=p.sVipConfig.getEntry(this._playerRecord.level+1),this.addAttribute(),h.sGGame.on(c.sLocalPlayerAdEvent.rewardedVideoAdTimesChanged,function(){t.addExp(s.sConstConfig.config.vipExpFromAd)},this)},P.prototype.stop=function(){h.sGGame.targetOff(this)},P.prototype.save=function(){this._dataDirty&&(this._dataDirty=!1,this._localModel.database.update("vipPlayer",this._playerRecord))},P.prototype.getCurrentLevel=function(){return this._playerRecord.level},P.prototype.getCurrentExp=function(){return this._playerRecord.exp},P.prototype.getCurrentEntry=function(){return this._currentVIPEntry},P.prototype.getNextEntry=function(){return this._nextVIPEntry},P.prototype.addExp=function(t){if(this._nextVIPEntry&&!(t<0)){for(var e=this._playerRecord.exp+t,o=this._playerRecord.level,i=this._nextVIPEntry;e>=i.exp;)if(e-=i.exp,!(i=p.sVipConfig.getEntry(++o+1))){e=0;break}this._playerRecord.exp=e,this._dataDirty=!0,this.setLevel(o),h.sGGame.emit(n.sLocalVIPEvent.expChanged,e)}},P.prototype.setLevel=function(t){this._playerRecord.level!==t&&(this._playerRecord.level=t,this._dataDirty=!0,this.removeAttribute(),this._currentVIPEntry=p.sVipConfig.getEntry(t),this.addAttribute(),this._nextVIPEntry=p.sVipConfig.getEntry(t+1),h.sGGame.emit(n.sLocalVIPEvent.levelChanged,t),f.sGAnalytics.reportAnalytics(u.sEventConfig.config.vipLevelUp,{level:t.toString()}))},P.prototype.removeAttribute=function(){this._currentVIPEntry&&this._localModel.getModule(_.LocalAttribute).clear(_.eAttributeObjectType.player,0,this.attributeSlotName)},P.prototype.addAttribute=function(){var t;this._currentVIPEntry&&((t=this._localModel.getModule(_.LocalAttribute)).addPosValue(_.eAttributeObjectType.player,0,this.attributeSlotName,d.sPlayerAttributeConfig.config.maxActionCurrency,b.eAttributePos.add,this._currentVIPEntry.moreActionCurrency),t.addPosValue(_.eAttributeObjectType.player,0,this.attributeSlotName,d.sPlayerAttributeConfig.config.maxTurnTableFreeTimes,b.eAttributePos.add,this._currentVIPEntry.moreTurnTableFreeTimes),t.addPosValue(_.eAttributeObjectType.player,0,this.attributeSlotName,d.sPlayerAttributeConfig.config.maxTurnTableAdTimes,b.eAttributePos.add,this._currentVIPEntry.moreTurnTableAdTimes),t.addPosValue(_.eAttributeObjectType.player,0,this.attributeSlotName,d.sPlayerAttributeConfig.config.maxBuyActionCurrencyTimes,b.eAttributePos.add,this._currentVIPEntry.moreBuyActionCurrencyTimes),t.addPosValue(_.eAttributeObjectType.player,0,this.attributeSlotName,d.sPlayerAttributeConfig.config.maxRandomCardTimes,b.eAttributePos.add,this._currentVIPEntry.moreRandomCardTimes),t.addPosValue(_.eAttributeObjectType.player,0,this.attributeSlotName,d.sPlayerAttributeConfig.config.maxOfflineHours,b.eAttributePos.add,this._currentVIPEntry.moreOfflineHours))},P.prototype.isADVIPCollected=function(){return this._playerRecord.adVIPCollected},P.prototype.checkCollectADVIPReward=function(){return this._playerRecord.adVIPCollected?1:0},P.prototype.collectADVIPReward=function(t){var e=this.checkCollectADVIPReward();if(e)return t&&t(e),e;this._playerRecord.adVIPCollected=!0,this._dataDirty=!0;var o=h.sGGame.localModel.getModule(v.LocalReward).takeRewardString(s.sConstConfig.config.adVipReward,!0,1,m.eReasonType.adVip);return t&&t(e,o),h.sGGame.emit(n.sLocalVIPEvent.collectVipADReward),e},r=P,n.LocalVIP=r,cc._RF.pop()},{}],main_home_bottom_ui:[function(t,e,o){"use strict";cc._RF.push(e,"6fe2azLhx9IyJtHfUTjW587","main_home_bottom_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("age_config"),u=a("gnode"),d=a("ggame"),p=a("local_building"),f=(h=cc._decorator).ccclass,h=(a=h.property,h.menu);function g(){var t=null!==c&&c.apply(this,arguments)||this;return t.root=null,t.homeNode=null,t}r(g,c=cc.Component),g.prototype.onLoad=function(){},g.prototype.onEnable=function(){var t,e=this;this.homeNode||(t=d.sGGame.localModel.getModule(p.LocalBuildingPackage).getCurrentAge(),(t=s.sAgeConfig.getEntry(t))&&this.root&&u.sGNode.createNode(t.homePrefab,this.root,function(t){e.homeNode=t},this)),d.sGGame.on(p.sLocalBuildingEvent.upgradeAge,function(){e.homeNode&&(u.sGNode.destoryNode(e.homeNode),e.homeNode=void 0)},this)},g.prototype.onDisable=function(){u.sGNode.targetOff(this)},l([a(cc.Node)],g.prototype,"root",void 0),h=l([f,h("Game/UI/MainHomeBottomUI")],g),n.default=h,cc._RF.pop()},{}],main_home_function_ui:[function(t,e,o){"use strict";cc._RF.push(e,"5a2a8lHjidA9rr7qgm52WcK","main_home_function_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reddot"),u=a("audio_config"),d=a("gaudio"),p=a("gnode"),f=a("gview_model"),h=a("vm_check_in"),g=a("vm_quest"),y=a("vm_store"),m=a("vm_vip"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu);function v(){var t=null!==c&&c.apply(this,arguments)||this;return t.anim=null,t.root=null,t.button=null,t.closeNode=null,t.openNode=null,t.additionNode=null,t._isOpen=!1,t._isShown=!1,t.totalDt=0,t}r(v,c=cc.Component),Object.defineProperty(v.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!1,configurable:!0}),v.prototype.onLoad=function(){var t=this;this.button&&(p.sGNode.addUniqueComponent(this.button,s.default).init(function(){return t.hasReddot()},"reddot"),this.button.node.on("click",function(){d.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),t._isOpen?t.closeUI():t.openUI()}))},v.prototype.onEnable=function(){this._isOpen=!1,this.anim&&this.anim.play("function_arrow_standby_anim"),this.refresh()},v.prototype.onDisable=function(){p.sGNode.targetOff(this)},v.prototype.refresh=function(){this._isShown||(this._isShown=this.canShow(),this.button&&(this.button.node.active=this._isShown),this.additionNode&&(this.additionNode.active=this._isShown))},v.prototype.update=function(t){this.totalDt+=t,1<=this.totalDt&&(this.totalDt=0,this.refresh())},v.prototype.canShow=function(){var t=f.sGViewModel.getModule(m.VMVIP);return!!(t.canShowButton()||f.sGViewModel.getModule(h.VMCheckIn).canShowButton()||t.canShowFirstAdButton()||t.canShowDoubleCollectButton()||f.sGViewModel.getModule(y.VMStore).canShowButton()||f.sGViewModel.getModule(g.VMQuest).canShowQuestButton())},v.prototype.hasReddot=function(){var t=f.sGViewModel.getModule(m.VMVIP);return!!(t.canShowButton()&&t.hasVIPReddot()||(t=f.sGViewModel.getModule(h.VMCheckIn)).canShowButton()&&t.hasAnythingToDo()||(t=f.sGViewModel.getModule(y.VMStore)).canShowButton()&&0==t.checkAnyThingToDo()||(t=f.sGViewModel.getModule(g.VMQuest)).canShowQuestButton()&&t.hasAnyQuestCanCommit())},v.prototype.openUI=function(){this.anim&&this.anim.play("function_arrow_oepn_anim"),this._isOpen=!0},v.prototype.closeUI=function(){this.anim&&this.anim.play("function_arrow_back_anim"),this._isOpen=!1},l([a({displayName:"\u8fdb\u51fa\u52a8\u753b",type:cc.Animation})],v.prototype,"anim",void 0),l([a({displayName:"\u6839\u8282\u70b9",type:cc.Node})],v.prototype,"root",void 0),l([a({displayName:"\u70b9\u51fb\u6309\u94ae",type:cc.Button})],v.prototype,"button",void 0),l([a({displayName:"\u7f29\u8fdb\u5c55\u793a\u8282\u70b9",type:cc.Node})],v.prototype,"closeNode",void 0),l([a({displayName:"\u5c55\u5f00\u5c55\u793a\u8282\u70b9",type:cc.Node})],v.prototype,"openNode",void 0),l([a({displayName:"\u9644\u5c5e\u8282\u70b9",type:cc.Node})],v.prototype,"additionNode",void 0),_=l([b,_("Game/UI/MainHomeFunctionUI")],v),n.default=_,cc._RF.pop()},{}],main_home_ui:[function(t,e,o){"use strict";cc._RF.push(e,"e5e9fTMuCVDZb2EGRLLIISQ","main_home_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var c,s=a("gview_model"),u=a("vm_benefit");function d(){return null!==c&&c.apply(this,arguments)||this}a=(n=cc._decorator).ccclass,n.property,n=n.menu,l(d,c=cc.Component),d.prototype.onLoad=function(){},d.prototype.update=function(){s.sGViewModel.getModule(u.VMBenefit).tryCompleteBenefit()},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/UI/MainHomeUI")],d),r.default=n,cc._RF.pop()},{}],main_tab_ui:[function(t,e,o){"use strict";cc._RF.push(e,"08d84yHSXROG57lmeC9TO58","main_tab_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.eMainTabType=void 0;var s=a("reddot"),u=a("audio_config"),d=a("gui"),p=a("gaudio"),f=a("gnode"),h=a("ggame"),g=a("gview_model"),y=a("vm_battle"),m=a("vm_building"),b=a("vm_card"),_=a("vm_check_in"),v=a("vm_quest"),C=a("vm_vip");(G=r.eMainTabType||(r.eMainTabType={}))[G.home=0]="home",G[G.worldMap=1]="worldMap",G[G.pullCard=2]="pullCard",G[G.cardPackage=3]="cardPackage",a=(n=cc._decorator).ccclass;var P,S,G=n.property;function M(){var t=null!==P&&P.apply(this,arguments)||this;return t.tabToggleContainer=null,t.tabPrefabArray=[],t.tabRoot=null,t.tabNodeDic=[],t}n=n.menu,l(M,P=cc.Component),(S=M).prototype.onLoad=function(){var t=this;if(this.tabToggleContainer)for(var e=this.tabToggleContainer.toggleItems.length,o=this,i=0;i<e;++i)!function(e){var i=o.tabToggleContainer.toggleItems[e];i&&(i.node.on("toggle",function(){p.sGAudio.playEffect(u.sAudioConfig.config.switchTab),t._refreshTabs(e)},o),f.sGNode.addUniqueComponent(i.node,s.default).init(function(){return e!=t.currentTabIndex&&(0===e?g.sGViewModel.getModule(m.VMBuilding).hasAnyBuildingReddot()||g.sGViewModel.getModule(v.VMQuest).canShowQuestButton()&&g.sGViewModel.getModule(v.VMQuest).hasAnyQuestCanCommit()||g.sGViewModel.getModule(C.VMVIP).canShowButton()&&g.sGViewModel.getModule(C.VMVIP).hasVIPReddot()||g.sGViewModel.getModule(_.VMCheckIn).hasAnythingToDo():1===e?g.sGViewModel.getModule(y.VMBattle).hasFubenAnythingToDo():2===e?g.sGViewModel.getModule(b.VMCard).pullHasReddot()||g.sGViewModel.getModule(b.VMCard).freePullHasReddot():3===e&&(g.sGViewModel.getModule(b.VMCard).skillCardPackageHasReddot()||g.sGViewModel.getModule(b.VMCard).soldierCardPackageHasReddot()))},"Background/reddot"))}(i)},M.prototype.onEnable=function(){var t=0;void 0!==S.lastTabIndex&&(t=S.lastTabIndex),this.openTab(t),p.sGAudio.playEffect(u.sAudioConfig.config.popUI),S.singleton=this},M.prototype.onDisable=function(){f.sGNode.targetOff(this),h.sGGame.targetOff(this),S.singleton=void 0},M.prototype.openTab=function(t){void 0!==t&&(this.tabToggleContainer&&this.tabToggleContainer.toggleItems[t].check(),this._refreshTabs(t))},M.prototype._refreshTabs=function(t){var e,o;this.currentTabIndex!==t&&(this.currentTabIndex=t,S.lastTabIndex=t,(e=this.tabNodeDic[t])?(this.currentTabNode&&(this.currentTabNode.active=!1),this.currentTabNode=e,d.sGUI.renameTopName(this.currentTabNode.name),this.currentTabNode&&(this.currentTabNode.active=!0)):(o=this.tabPrefabArray[t])&&(this.currentTabNode&&(this.currentTabNode.active=!1),e=cc.instantiate(o),this.tabNodeDic[t]=e,this.currentTabNode=e,d.sGUI.renameTopName(this.currentTabNode.name),this.tabRoot.addChild(e),f.sGNode.updateWidgetImmediately(e)))},c([G({tooltip:"\u5206\u9875",type:cc.ToggleContainer})],M.prototype,"tabToggleContainer",void 0),c([G({type:cc.Prefab,tooltip:"\u5206\u9875\u9884\u5236\u4ef6\u6570\u7ec4"})],M.prototype,"tabPrefabArray",void 0),c([G({type:cc.Node,tooltip:"\u529f\u80fd\u9875\u7684\u8282\u70b9"})],M.prototype,"tabRoot",void 0),n=S=c([a,n("Game/Main/MainTabUI")],M),r.default=n,cc._RF.pop()},{}],main_ui:[function(t,e,o){"use strict";cc._RF.push(e,"46c3e708vVPtah6eM0quGx3","main_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reddot"),u=a("const_config"),d=a("stage_config"),p=a("i18n"),f=a("gui"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_stage"),b=a("vm_battle"),_=a("vm_vip"),v=a("gaudio"),C=a("audio_config"),P=(S=cc._decorator).ccclass,S=(a=S.property,S.menu);function G(){var t=null!==c&&c.apply(this,arguments)||this;return t.buttonSetting=null,t.stageLabel=null,t.lockSweepLabel=null,t.sweepButton=null,t.lockSweepNode=null,t.vipButton=null,t.passTimeDt1=1,t}r(G,c=cc.Component),G.prototype.onLoad=function(){var t=this;this.buttonSetting&&this.buttonSetting.node.on("click",function(){t.onClickButtonSetting()}),this.sweepButton&&this.sweepButton.node.on("click",function(){t.onSweep()}),this.vipButton&&this.vipButton.addComponent(s.default).init(function(){return y.sGViewModel.getModule(_.VMVIP).hasVIPReddot()},"root/reddot")},G.prototype.onEnable=function(){var t=g.sGGame.localModel.getModule(m.LocalStage),e=u.sConstConfig.config.unlockSweep,o=d.sStageConfig.getEntry(e),i=t.currentBattleStageEntry;t=t.currentPassStageEntry,this.stageLabel&&(this.stageLabel.string=i.name),this.lockSweepLabel&&(e=d.sStageConfig.getEntry(e),this.lockSweepLabel.string=p.i18n.t("tip.unlockSweep").replace("${value}",e.name),this.lockSweepLabel.node.active=t.sortID<o.sortID),this.lockSweepNode&&(this.lockSweepNode.active=t.sortID<o.sortID),this.buttonSetting&&(this.buttonSetting.node.active=5<=i.id)},G.prototype.onDisable=function(){h.sGNode.targetOff(this)},G.prototype.update=function(t){var e;this.passTimeDt1+=t,1<this.passTimeDt1&&(this.passTimeDt1=0,t=(e=g.sGGame.localModel.getModule(m.LocalStage)).isSystemIsOpened(u.sConstConfig.config.unlockSweep),e=e.isSystemIsOpened(u.sConstConfig.config.checkInPopUnlockStage),this.lockSweepLabel&&(this.lockSweepLabel.node.active=!t),this.lockSweepNode&&(this.lockSweepNode.active=!t),this.vipButton&&(this.vipButton.node.active=e))},G.prototype.onClickButtonSetting=function(){f.sGUI.openDialogUI("prefabs/ui/set_up2",this)},G.prototype.onBattle=function(){y.sGViewModel.getModule(b.VMBattle).enterBattleStage(),v.sGAudio.playEffect(C.sAudioConfig.config.joinBattle)},G.prototype.onSweep=function(){y.sGViewModel.getModule(b.VMBattle).openSweepUI()},l([a({displayName:"\u8bbe\u7f6e\u6309\u94ae",type:cc.Button})],G.prototype,"buttonSetting",void 0),l([a(cc.Label)],G.prototype,"stageLabel",void 0),l([a(cc.Label)],G.prototype,"lockSweepLabel",void 0),l([a(cc.Button)],G.prototype,"sweepButton",void 0),l([a(cc.Node)],G.prototype,"lockSweepNode",void 0),l([a(cc.Button)],G.prototype,"vipButton",void 0),S=l([P,S("Game/UI/MainUI")],G),n.default=S,cc._RF.pop()},{}],map_background_hscroll:[function(t,e,o){"use strict";cc._RF.push(e,"03193xPYHVMwpXTBYEQ/BFa","map_background_hscroll");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("gnode"),u=a("map_define"),d=(p=cc._decorator).ccclass,p=(a=p.property,p.menu);function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.blocks=[],t.editorDisplayBlock=null,t.blockSize=new cc.Size(640,960),t.blockPoolArray=[],t.lastStartPos=NaN,t.lastEndPos=NaN,t}r(f,c=cc.Component),f.prototype.onLoad=function(){this.displayBlockList={};var t,e=this.blocks.length;0<e&&0!==(t=cc.instantiate(this.blocks[0])).getContentSize().width&&(this.blockSize=t.getContentSize()),this.blockPoolArray=[];for(var o=0;o<e;o++){var i=new cc.NodePool;this.blockPoolArray.push(i)}this.screenWidth=cc.winSize.width},f.prototype.onEnable=function(){var t=this;cc.director.on(u.sMapEvent.lateUpdate,function(e,o){t.customLateUpdate(o)},this),this.editorDisplayBlock&&(this.editorDisplayBlock.active=!1)},f.prototype.onDisable=function(){cc.director.targetOff(this)},f.prototype.customLateUpdate=function(t){var e=this.blocks.length;if(0!==e){var o=s.sGNode.convertToWorldSpaceAR(t.mapCamera.camera.node),i=(t=s.sGNode.convertToNodeSpaceAR(this.node,o),o=cc.v2(t.x-this.screenWidth/2-100,0),t=cc.v2(t.x+this.screenWidth/2+100,0),o=Math.floor(o.x/this.blockSize.width),Math.floor(t.x/this.blockSize.width));if(this.lastStartPos!=o||this.lastEndPos!=i){this.lastStartPos=o,this.lastEndPos=i;var a=this.displayBlockList;this.displayBlockList=Object.create(null);for(var n,r=o;r<=i;r++){var l=Math.floor(Math.random()*e),c=a[r];c?(this.displayBlockList[r]=c,delete a[r]):(c=(c=this.blockPoolArray[l].get())||cc.instantiate(this.blocks[l]),this.displayBlockList[r]={block:c,index:l},this.node.addChild(c),l=cc.v2(r*this.blockSize.width,0),l=s.sGNode.convertToWorldSpace(this.node,l),l=s.sGNode.convertToNodeSpaceAR(this.node,l),c.setPosition(l))}for(n in a){var u=a[n];this.blockPoolArray[u.index].put(u.block),u.block.removeFromParent()}}}},l([a({type:[cc.Prefab],tooltip:"\u9884\u8bbe\u7684\u5730\u56fe\u5757"})],f.prototype,"blocks",void 0),l([a({type:cc.Node,tooltip:"\u7f16\u8f91\u5668\u4e0a\u663e\u793a\u7684\u8282\u70b9\uff0c\u65b9\u4fbf\u67e5\u770b\uff0c\u903b\u8f91\u4e2d\u4f1a\u9690\u85cf"})],f.prototype,"editorDisplayBlock",void 0),p=l([d,p("View/Map/MapBackgroundBlockHScroll")],f),n.default=p,cc._RF.pop()},{}],map_background_parallax_layer:[function(t,e,o){"use strict";cc._RF.push(e,"98e88geoJhPV5iHs1QXzWz7","map_background_parallax_layer");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("gnode"),u=a("map_define"),d=(p=cc._decorator).ccclass,p=(a=p.property,p.menu);function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.layerRelativeScale=.2,t}r(f,c=cc.Component),f.prototype.onEnable=function(){var t=this;cc.director.on(u.sMapEvent.lateUpdate,function(e,o){t._customLateUpdate(o)},this)},f.prototype.onDisable=function(){cc.director.targetOff(this)},f.prototype._customLateUpdate=function(t){var e=s.sGNode.convertToWorldSpaceAR(t.mapCamera.camera.node);e=s.sGNode.convertToNodeSpaceAR(t.mapRoot,e),t=t.mapCamera.camera.node.getContentSize(),t=(t=cc.v2(e.x-t.width/2,e.y-t.height/2)).sub(t.mul(this.layerRelativeScale)),this.node.setPosition(t)},l([a({tooltip:"\u5c42\u8282\u70b9\u76f8\u5bf9\u767e\u5206\u6bd4\u504f\u79fb"})],f.prototype,"layerRelativeScale",void 0),p=l([d,p("View/Map/MapBackgroundLayer")],f),n.default=p,cc._RF.pop()},{}],map_background_vscroll:[function(t,e,o){"use strict";cc._RF.push(e,"23705ETIPtNr7FCa7ZAvrPE","map_background_vscroll");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("gnode"),u=a("map_define"),d=(p=cc._decorator).ccclass,p=(a=p.property,p.menu);function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.blocks=[],t.editorDisplayBlock=null,t.blockSize=new cc.Size(640,960),t.blockPoolArray=[],t.lastStartPos=NaN,t.lastEndPos=NaN,t}r(f,c=cc.Component),f.prototype.onLoad=function(){this.displayBlockList={};var t,e=this.blocks.length;0<e&&0!==(t=cc.instantiate(this.blocks[0])).getContentSize().height&&(this.blockSize=t.getContentSize()),this.blockPoolArray=[];for(var o=0;o<e;o++){var i=new cc.NodePool;this.blockPoolArray.push(i)}this.screenHeight=cc.winSize.height},f.prototype.onEnable=function(){var t=this;cc.director.on(u.sMapEvent.lateUpdate,function(e,o){t.customLateUpdate(o)},this),this.editorDisplayBlock&&(this.editorDisplayBlock.active=!1)},f.prototype.onDisable=function(){cc.director.targetOff(this)},f.prototype.customLateUpdate=function(t){var e=this.blocks.length;if(0!==e){var o=s.sGNode.convertToWorldSpaceAR(t.mapCamera.camera.node),i=(t=s.sGNode.convertToNodeSpaceAR(this.node,o),o=cc.v2(t.y-this.screenHeight/2-100,0),t=cc.v2(t.y+this.screenHeight/2+100,0),o=Math.floor(o.y/this.blockSize.height),Math.floor(t.y/this.blockSize.height));if(this.lastStartPos!=o||this.lastEndPos!=i){this.lastStartPos=o,this.lastEndPos=i;var a=this.displayBlockList;this.displayBlockList=Object.create(null);for(var n,r=o;r<=i;r++){var l=Math.floor(Math.random()*e),c=a[r];c?(this.displayBlockList[r]=c,delete a[r]):(c=(c=this.blockPoolArray[l].get())||cc.instantiate(this.blocks[l]),this.displayBlockList[r]={block:c,index:l},this.node.addChild(c),l=cc.v2(0,r*this.blockSize.height),l=s.sGNode.convertToWorldSpace(this.node,l),l=s.sGNode.convertToNodeSpaceAR(this.node,l),c.setPosition(l))}for(n in a){var u=a[n];this.blockPoolArray[u.index].put(u.block),u.block.removeFromParent()}}}},l([a({type:[cc.Prefab],tooltip:"\u9884\u8bbe\u7684\u5730\u56fe\u5757"})],f.prototype,"blocks",void 0),l([a({type:cc.Node,tooltip:"\u7f16\u8f91\u5668\u4e0a\u663e\u793a\u7684\u8282\u70b9\uff0c\u65b9\u4fbf\u67e5\u770b\uff0c\u903b\u8f91\u4e2d\u4f1a\u9690\u85cf"})],f.prototype,"editorDisplayBlock",void 0),p=l([d,p("View/Map/MapBackgroundBlockVScroll")],f),n.default=p,cc._RF.pop()},{}],map_camera:[function(t,e,o){"use strict";cc._RF.push(e,"08df7OTpVdOYrvceseieM/V","map_camera");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("gnode"),u=a("map_define"),d=(p=cc._decorator).ccclass,p=(a=p.property,p.menu);function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.cameraRoot=null,t.camera=null,t.defaultTargetOffsetNode=null,t.defaultTargetOffset=cc.v2(),t.targetOffset=cc.v2(),t.lockTargetNode=null,t.lockTargetPos=cc.v2(),t.smooth=!1,t.fixedRadius=100,t.smoothRadius=200,t.smoothSpeed=2,t.mapLockZone=null,t.mapCameraLockZone=null,t.cameraDirty=!1,t.onEnableCalled=!1,t.callback=null,t._targetSpeed=null,t.cameraOriginalOffset=null,t.shakeMin=-8,t.shakeMax=8,t}r(f,c=cc.Component),f.prototype.onLoad=function(){this.cameraOriginalOffset=this.camera.node.getPosition()},f.prototype.onEnable=function(){var t,e,o=this;s.sGNode.updateWidgetImmediately(this.cameraRoot),this.cameraOriginalOffset=this.camera.node.getPosition(),this.defaultTargetOffsetNode&&(t=s.sGNode.convertToWorldSpaceAR(this.defaultTargetOffsetNode,cc.v2()),e=s.sGNode.convertToWorldSpaceAR(this.cameraRoot,cc.v2()),this.defaultTargetOffset=e.sub(t),this.defaultTargetOffsetNode.active=!1,this.targetOffset=this.defaultTargetOffset),this.mapLockZone||this.setMapLockZone(cc.rect(-1e307,-1e307,2e307,2e307)),this.lockTargetNode?this.cameraRoot.setPosition(this._fixPosition(this.lockTargetNode.getPosition())):this.lockTargetPos&&this.cameraRoot.setPosition(this._fixPosition(this.lockTargetPos)),this.onEnableCalled=!0,cc.director.on(u.sMapEvent.afterUpdate,function(t){o._customAfterUpdate(t)},this)},f.prototype.onDisable=function(){this.onEnableCalled=!1,cc.director.targetOff(this)},f.prototype.setTargetOffset=function(t){this.targetOffset=t.clone()},f.prototype.onArrive=function(){this.callback&&(this.callback(),this.callback=null)},f.prototype.lockTarget=function(t,e){this.onArrive(),this.lockTargetNode=t,!e&&this.lockTargetNode&&this.onEnableCalled&&this.cameraRoot.setPosition(this._fixPosition(this.lockTargetNode.getPosition()))},f.prototype.lockPos=function(t,e,o){this.onArrive(),this.lockTargetPos=this.cameraRoot.getParent().convertToNodeSpaceAR(t),!e&&this.onEnableCalled&&this.cameraRoot.setPosition(this._fixPosition(this.lockTargetPos)),this.callback=o},f.prototype.lockDeltaPos=function(t,e){this.onArrive(),this.lockTargetPos=this.cameraRoot.getPosition().add(t),!e&&this.onEnableCalled&&this.cameraRoot.setPosition(this._fixPosition(this.lockTargetPos))},f.prototype.lockSpeed=function(t){this._targetSpeed=t},f.prototype.setMapLockZone=function(t){this.mapLockZone=t,this.cameraDirty=!0,this.updateLockZone()},f.prototype._customAfterUpdate=function(t){this.lockTargetNode&&(this.lockTargetPos=this.lockTargetNode.getPosition()),this.lockTargetPos=this.lockTargetPos.add(this.targetOffset),this.lockTargetPos=this._fixPosition(this.lockTargetPos),this.lockTargetPos&&(this.smooth?this._updateSmooth(t):this._updateNormal(t))},f.prototype.updateLockZone=function(){var t,e;this.mapLockZone?(t=this.camera.node.getContentSize(),(e=cc.size(0,0)).width=t.width*this.camera.node.scale,e.height=t.height*this.camera.node.scale,(t=cc.rect()).x=this.mapLockZone.x+e.width/2,t.y=this.mapLockZone.y+e.height/2,t.width=this.mapLockZone.width-e.width/2,t.height=this.mapLockZone.height-e.height/2,t.width=0<t.width?t.width:0,t.height=0<t.height?t.height:0,e=this.cameraOriginalOffset,this.mapCameraLockZone=t,this.mapCameraLockZone.x-=e.x,this.mapCameraLockZone.y-=e.y):this.mapCameraLockZone=null},f.prototype._fixPosition=function(t){if(!this.mapCameraLockZone||!this.camera||null==t)return t;var e=this.mapCameraLockZone;return(t=t.clone()).x<e.x?(t.x=e.x,this.lockTargetPos.x=t.x):t.x>e.x+e.width&&(t.x=e.x+e.width,this.lockTargetPos.x=t.x),t.y<e.y?(t.y=e.y,this.lockTargetPos.y=t.y):t.y>e.y+e.height&&(t.y=e.y+e.height,this.lockTargetPos.y=t.y),t},f.prototype._updateSmooth=function(t){var e,o,i,a;this._targetSpeed?(this.cameraRoot.x+=t*this._targetSpeed.x,this.cameraRoot.y+=t*this._targetSpeed.y):(o=this.cameraRoot.getPosition(),e=(a=this.lockTargetPos.sub(o)).mag(),o=a.normalize(),0<e?e>this.smoothRadius?(i=this.lockTargetPos.sub(o.mul(this.smoothRadius)),this.cameraRoot.x=i.x,this.cameraRoot.y=i.y,this.onArrive()):this.fixedRadius<e&&e<=this.smoothRadius?(a=(e-this.fixedRadius)*this.smoothSpeed,e<10&&(a=10,this.onArrive()),e<(t*=a)?(i=this.lockTargetPos.sub(o.mul(this.fixedRadius)),this.cameraRoot.x=i.x,this.cameraRoot.y=i.y,this.onArrive()):(i=o.mul(t),Math.abs(i.x)<1e-6&&Math.abs(i.y)<1e-6?this.onArrive():(this.cameraRoot.x+=i.x,this.cameraRoot.y+=i.y))):this.onArrive():this.onArrive())},f.prototype._updateNormal=function(){this.cameraRoot.x=this.lockTargetPos.x,this.cameraRoot.y=this.lockTargetPos.y,this.onArrive()},f.prototype.shake=function(t,e){var o=this;void 0===e&&(e=15);for(var i=-(t=void 0===t?5:t),a=t,n=-t,r=t,l=[],c=0;c<e;c++)l[l.length]=cc.callFunc(function(){o.camera.node.x=o.cameraOriginalOffset.x+i+Math.random()*(a-i),o.camera.node.y=o.cameraOriginalOffset.y+n+Math.random()*(r-n)},this,!0),l[l.length]=cc.delayTime(.01);l[l.length]=cc.callFunc(function(){o.camera.node.x=o.cameraOriginalOffset.x,o.camera.node.y=o.cameraOriginalOffset.y}),t=cc.sequence(l),this.camera.node.runAction(cc.speed(t,1))},l([a({type:cc.Node,tooltip:"\u5728\u5730\u56fe\u5750\u6807\u7cfb\u4e0b\u7684 MapCamera \u6839\u8282\u70b9"})],f.prototype,"cameraRoot",void 0),l([a({type:cc.Camera,tooltip:"\u6444\u50cf\u673a"})],f.prototype,"camera",void 0),l([a({type:cc.Node,tooltip:"\u9501\u5b9a\u76ee\u6807\u5728\u5c4f\u5e55\u4e2d\u7684\u4f4d\u7f6e"})],f.prototype,"defaultTargetOffsetNode",void 0),l([a({tooltip:"true \u5e73\u6ed1\u79fb\u52a8\u6a21\u5f0f, false \u8ddf\u968f\u79fb\u52a8\u6a21\u5f0f"})],f.prototype,"smooth",void 0),l([a({tooltip:"\u5e73\u6ed1\u79fb\u52a8\u6a21\u5f0f\u4e0b\u591a\u5c11\u8303\u56f4\u5185\u4e0d\u7528\u52a8\u6444\u50cf\u673a"})],f.prototype,"fixedRadius",void 0),l([a({tooltip:"\u5e73\u6ed1\u79fb\u52a8\u6a21\u5f0f\u4e0b\u591a\u5c11\u8303\u56f4\u5185\u6162\u6162\u52a8\u6444\u50cf\u673a\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u8ddd\u79bb\u5c31\u76f4\u63a5\u8ddf\u955c\u5934"})],f.prototype,"smoothRadius",void 0),l([a({tooltip:"\u955c\u5934\u79fb\u52a8\u7cfb\u6570\uff0c\u76ee\u6807\u5355\u6b21\u79fb\u52a8\u8ddd\u79bb\u8d8a\u5927\uff0c\u5c31\u9700\u8981\u8d8a\u5927\u7684\u56de\u62c9\u901f\u7387"})],f.prototype,"smoothSpeed",void 0),l([a],f.prototype,"shakeMin",void 0),l([a],f.prototype,"shakeMax",void 0),p=l([d,p("Game/Map/MapCamera")],f),n.default=p,cc._RF.pop()},{}],map_define:[function(t,e,o){"use strict";cc._RF.push(e,"3d82ewZeb1GpaXo4geFmgJ6","map_define");var i=o;Object.defineProperty(i,"__esModule",{value:!0}),i.sMapEvent=void 0,i.sMapEvent={beforeUpdate:"sMapEvent_beforeUpdate",update:"sMapEvent_update",afterUpdate:"sMapEvent_afterUpdate",lateUpdate:"sMapEvent_lateUpdate"},cc._RF.pop()},{}],map_manager:[function(t,e,o){"use strict";cc._RF.push(e,"6c52f9d2GtNooUr+lE10NLf","map_manager");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.MAX_MAP_VALUE=void 0;var c,s=a("gnode"),u=a("map_camera"),d=a("map_define"),p=(f=cc._decorator).ccclass,f=(a=f.property,f.menu);function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.mapCamera=null,t.mapRoot=null,t.mapRootOriPos=null,t.mapBGNode=null,t.currentMapPath="",t}n.MAX_MAP_VALUE=1e100,r(h,c=cc.Component),h.prototype.onLoad=function(){this.mapRootOriPos=this.mapRoot.getPosition().clone()},h.prototype.onEnable=function(){},h.prototype.onDisable=function(){this.mapBGNode&&(s.sGNode.destoryNode(this.node),this.mapBGNode=null),cc.director.targetOff(this),s.sGNode.targetOff(this)},h.prototype.update=function(t){cc.director.emit(d.sMapEvent.beforeUpdate,t),cc.director.emit(d.sMapEvent.update,t),cc.director.emit(d.sMapEvent.afterUpdate,t),cc.director.emit(d.sMapEvent.lateUpdate,t,this,this.mapCamera)},h.prototype.changeMap=function(t,e){var o=this;this.currentMapPath!=t?(this.currentMapPath=t,this.mapBGNode&&(s.sGNode.destoryNode(this.mapBGNode),this.mapBGNode=null),s.sGNode.createNode(t,null,function(t){e&&e(),t&&(o.mapBGNode=t,o.mapRoot.addChild(o.mapBGNode,-1e3))},this)):e&&e()},l([a(u.default)],h.prototype,"mapCamera",void 0),l([a(cc.Node)],h.prototype,"mapRoot",void 0),f=l([p,f("View/Map/MapManager")],h),n.default=f,cc._RF.pop()},{}],map_scrollview:[function(t,e,o){"use strict";cc._RF.push(e,"9d6caJP221DkZ08AJXu5K/c","map_scrollview");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.sMapScrollViewEvent=void 0;var c,s=a("vm_guide"),u=a("gtime"),d=a("ggame"),p=a("gview_model"),f=a("map_camera"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.camera=null,t.nodeTouch=null,t._touchBeginTick=0,t._isMoving=!1,t._clickCallback=null,t.isLocked=!1,t}n.sMapScrollViewEvent={touchStart:"sMapScrollViewEvent.touchStart",touchEnd:"sMapScrollViewEvent.touchEnd"},r(y,c=cc.Component),y.prototype.init=function(t){this._clickCallback=t},y.prototype.onLoad=function(){this.nodeTouch&&(this.nodeTouch.on(cc.Node.EventType.TOUCH_START,this._onTouchStart.bind(this)),this.nodeTouch.on(cc.Node.EventType.TOUCH_END,this._onTouchEnd.bind(this)),this.nodeTouch.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel.bind(this)),this.nodeTouch.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove.bind(this)))},y.prototype._onTouchStart=function(t){p.sGViewModel.getModule(s.VMGuide).isGuideLockScrollView()||this.isLocked||(this._isMoving=!1,this._lastTouchPos=t.getLocation(),this._touchBeginTick=u.sGTime.timestamp(),d.sGGame.emit(n.sMapScrollViewEvent.touchStart))},y.prototype._onTouchMove=function(t){var e,o,i;!this._lastTouchPos||p.sGViewModel.getModule(s.VMGuide).isGuideLockScrollView()||this.isLocked||(o=(e=t.getLocation()).sub(this._lastTouchPos),!this._isMoving&&100<o.magSqr()&&(this._isMoving=!0),this._isMoving&&(i=(u.sGTime.timestamp()-this._touchBeginTick)/1e3,this._fadeSpeed=i<1e-5?t.getDelta().normalize().mul(100):t.getDelta().div(i),this._fadeSpeed.negSelf(),this._lastTouchPos=e,this.camera.lockDeltaPos(o.neg())))},y.prototype._onTouchEnd=function(t){var e;this._isMoving||(e=cc.v2(),this.camera.camera.getScreenToWorldPoint(t.getLocation(),e),this._clickCallback&&this._clickCallback(e)),this._onTouchCancel(t)},y.prototype._onTouchCancel=function(){this._lastTouchPos&&(this._isMoving&&this.camera.lockDeltaPos(this._fadeSpeed,!0),this._fadeSpeed=void 0,this._lastTouchPos=void 0,this._isMoving=!1,d.sGGame.emit(n.sMapScrollViewEvent.touchEnd))},l([a({type:f.default,tooltip:"\u6444\u50cf\u673a"})],y.prototype,"camera",void 0),l([a({type:cc.Node,tooltip:"\u89e6\u6478\u677f"})],y.prototype,"nodeTouch",void 0),g=l([h,g("Game/Map/MapScrollView")],y),n.default=g,cc._RF.pop()},{}],move_man:[function(t,e,o){"use strict";cc._RF.push(e,"ecb4biX9t5Ba72EVB+4Znmg","move_man");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.sAnimationScales=r.sAnimationNames=void 0;var s,u,d=a("age_config"),p=a("gnode"),f=a("ggame"),h=a("local_building");function g(t,e){this.pathIndex=0,this.position=cc.v2(),this.pathIndex=t,this.position=e.clone()}(m=s=s||{})[m.idle=0]="idle",m[m.pathMove=1]="pathMove",(n=u=u||{})[n.invalid=0]="invalid",n[n.animStand0=1]="animStand0",n[n.animStand1=2]="animStand1",n[n.animStand2=3]="animStand2",n[n.animStand3=4]="animStand3",n[n.animRun0=5]="animRun0",n[n.animRun1=6]="animRun1",n[n.animRun2=7]="animRun2",n[n.animRun3=8]="animRun3",r.sAnimationNames=["animation0","animation0","animation0","animation0","animation0","animation2","animation3","animation2","animation1"],r.sAnimationScales=[1,-1,1,1,1,-1,1,1,1];var y,m=(a=cc._decorator).ccclass;function b(){var t=null!==y&&y.apply(this,arguments)||this;return t.moveSpeed=30,t.pathRoot=null,t.skinRoot=null,t.skinAnimation=null,t.pathNodeArray=[],t.keyPointInfoArray=[],t.currentIndex=0,t.dir=cc.v2(),t.aiState=s.idle,t.animState=u.invalid,t.idlePassTime=0,t.idleKeepTime=0,t.movePath=[],t.startPoint=null,t.targetPoint=null,t.moveTotal=0,t.moveDistance=0,t.inited=!1,t.manMoveSpeed=0,t}n=a.property,a=a.menu,l(b,y=cc.Component),b.prototype.onLoad=function(){this.pathNodeArray=[],this.keyPointInfoArray=[];for(var t=0;;++t){var e=this.pathRoot.getChildByName("point"+(t+1));if(!e)break;this.pathNodeArray.push(e);for(var o=0;;++o){var i=e.getChildByName("key"+(o+1));if(!i)break;i=p.sGNode.convertToWorldSpaceAR(e,i.getPosition()),i=p.sGNode.convertToNodeSpaceAR(this.pathRoot,i),this.keyPointInfoArray.push(new g(t,i))}}},b.prototype.onEnable=function(){var t=this,e=f.sGGame.localModel.getModule(h.LocalBuildingPackage).getCurrentAge();e=[(e=d.sAgeConfig.getEntry(e)).man1,e.man2][Math.floor(2*Math.random())],p.sGNode.createNode(e,function(e){e&&(t.skinRoot=e,t.skinRoot.parent=t.node,(e=t.skinRoot.getChildByName("animation"))&&(t.skinAnimation=e.getComponent(cc.Animation),t._refreshSkin()))}),this._initKeyPoint()},b.prototype.onDisable=function(){p.sGNode.targetOff(this),f.sGGame.targetOff(this),this.skinRoot&&(p.sGNode.destoryNode(this.skinRoot),this.skinRoot=null,this.skinAnimation=null)},b.prototype.update=function(t){switch(this.aiState){case s.idle:this._updateAIIdle(t);break;case s.pathMove:this._updateAIMove(t)}},b.prototype._randomKeyPoint=function(){if(0===this.keyPointInfoArray.length)return null;var t=Math.floor(Math.random()*this.keyPointInfoArray.length);return this.keyPointInfoArray[t]},b.prototype._initKeyPoint=function(){var t;this.inited||(this.inited=!0,(t=this._randomKeyPoint())&&(this.node.setPosition(t.position),this.node.zIndex=cc.macro.MAX_ZINDEX-2e4-Math.floor(this.node.y),this.currentIndex=t.pathIndex,this._aiIdle(cc.v2(-1,0))))},b.prototype._randomMoveToKeyPoint=function(){var t=this._randomKeyPoint();if(t&&this.currentIndex!=t.pathIndex){if(this.currentIndex>t.pathIndex){for(var e=this.currentIndex;e>=t.pathIndex;--e){var o=this.pathNodeArray[e];this.movePath.push(o.getPosition())}this.movePath.push(t.position)}else{for(e=this.currentIndex;e<=t.pathIndex;++e)o=this.pathNodeArray[e],this.movePath.push(o.getPosition());this.movePath.push(t.position)}this.currentIndex=t.pathIndex,this.manMoveSpeed=this.moveSpeed+20*Math.random(),this._moveNextPoint()}},b.prototype.getDir8=function(t){return t=(t=0===t.x&&0===t.y?cc.v2(1,0):t).angle(cc.v2(0,1)),Math.floor(t/45)%8},b.prototype.getDir4=function(t){return t=(t=0===t.x&&0===t.y?cc.v2(1,0):t).signAngle(cc.v2(1,0)),315<(t=(t=cc.misc.radiansToDegrees(t))<0?360+t:t)&&(t-=360),t+=45,Math.floor(t/90)%4},b.prototype._moveNextPoint=function(){var t;0<this.movePath.length?(t=this.movePath[0],this.movePath.shift(),this._aiMove(t)):(this.idlePassTime=0,this.idleKeepTime=5*Math.random()+3,this._aiIdle(this.dir))},b.prototype._updateAIMove=function(t){this.moveDistance+=this.manMoveSpeed*t,this.moveDistance<this.moveTotal?(t=this.targetPoint.sub(this.startPoint),t=this.startPoint.add(t.normalize().mul(this.moveDistance)),this.node.setPosition(t),this.node.zIndex=cc.macro.MAX_ZINDEX-2e4-Math.floor(this.node.y)):(this.node.setPosition(this.targetPoint),this.node.zIndex=cc.macro.MAX_ZINDEX-2e4-Math.floor(this.node.y),this._moveNextPoint())},b.prototype._updateAIIdle=function(t){this.idlePassTime+=t,this.idlePassTime>this.idleKeepTime&&(this.idlePassTime=0,this._randomMoveToKeyPoint())},b.prototype._aiMove=function(t){this.startPoint=this.node.getPosition(),this.targetPoint=t,this.moveDistance=0,this.moveTotal=this.targetPoint.sub(this.startPoint).mag(),t=this.targetPoint.sub(this.startPoint),this.aiState=s.pathMove,this.dir=cc.v2(t.x,t.y),t=this.getDir4(this.dir),(t=u["animRun"+t])!==this.animState&&(this.animState=t,this._refreshSkin())},b.prototype._aiIdle=function(t){this.startPoint=null,this.targetPoint=null,this.aiState=s.idle,this.dir=cc.v2(t.x,t.y),t=this.getDir4(this.dir),(t=u["animStand"+t])!==this.animState&&(this.animState=t,this._refreshSkin())},b.prototype._refreshSkin=function(){var t=r.sAnimationNames[this.animState],e=r.sAnimationScales[this.animState];this.skinAnimation&&(this.skinAnimation.play(t),this.skinAnimation.node.scaleX=e)},c([n],b.prototype,"moveSpeed",void 0),c([n(cc.Node)],b.prototype,"pathRoot",void 0),a=c([m,a("Game/UI/MoveMan")],b),r.default=a,cc._RF.pop()},{}],move_object:[function(t,e,o){"use strict";cc._RF.push(e,"b8e58SwP7hG3Zb99kUkwN0u","move_object");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var s,u=a("gnode"),d=a("ggame");function p(){var t=null!==s&&s.apply(this,arguments)||this;return t.moveSpeed=100,t.moveToLeft=!0,t.root=null,t.rootWidth=200,t.nodeWidth=200,t.actionRunning=!1,t.actionSeconds=2,t}a=(n=cc._decorator).ccclass,n=n.property,l(p,s=cc.Component),p.prototype.start=function(){this.root&&(this.rootWidth=this.root.getContentSize().width),this.nodeWidth=this.node.getContentSize().width},p.prototype.update=function(t){var e,o,i,a;this.root&&(t=this.moveSpeed*t,this.moveToLeft?(this.node.x-=t,e=this.node.getParent().convertToWorldSpaceAR(this.node.getPosition()),u.sGNode.convertToNodeSpace(this.root,e).x+this.nodeWidth<0&&(this.node.opacity=0,o=cc.fadeIn(this.actionSeconds),this.node.runAction(cc.speed(o,d.sGGame.timeScale)),i=u.sGNode.convertToWorldSpace(this.root,cc.v2(this.rootWidth-this.nodeWidth,0)),a=this.node.getParent().convertToNodeSpaceAR(i),this.node.x=a.x)):(this.node.x+=t,e=this.node.getParent().convertToWorldSpaceAR(this.node.getPosition()),u.sGNode.convertToNodeSpace(this.root,e).x+this.nodeWidth>this.rootWidth&&(this.node.opacity=0,o=cc.fadeIn(this.actionSeconds),this.node.runAction(cc.speed(o,d.sGGame.timeScale)),i=u.sGNode.convertToWorldSpace(this.root,cc.v2(-this.nodeWidth,0)),a=this.node.getParent().convertToNodeSpaceAR(i),this.node.x=a.x)))},c([n],p.prototype,"moveSpeed",void 0),c([n],p.prototype,"moveToLeft",void 0),c([n(cc.Node)],p.prototype,"root",void 0),a=c([a],p),r.default=a,cc._RF.pop()},{}],new_world_map_tip_ui:[function(t,e,o){"use strict";cc._RF.push(e,"9654c0sIrZJTK9oYeWm+zp9","new_world_map_tip_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("age_config"),u=a("i18n"),d=a("gnode"),p=a("ggame"),f=a("local_stage"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.iconSprite=null,t.nameLabel=null,t.titleLabel=null,t.closeButton=null,t}r(y,c=cc.Component),y.prototype.onLoad=function(){var t=this;this.closeButton&&this.closeButton.node.on("click",function(){d.sGNode.destoryNode(t.node)})},y.prototype.onEnable=function(){var t=p.sGGame.localModel.getModule(f.LocalStage).currentBattleStageEntry.age,e=s.sAgeConfig.getEntry(t);this.iconSprite&&d.sGNode.setSprite(this.iconSprite,e.icon,this),this.nameLabel&&(this.nameLabel.string=u.i18n.t(e.name)),this.titleLabel&&(t=(t=u.i18n.t("tips.newWolrdMap")).replace("${value}",u.i18n.t(e.name)),this.titleLabel.string=t)},y.prototype.onDisable=function(){p.sGGame.targetOff(this),d.sGNode.targetOff(this)},l([a(cc.Sprite)],y.prototype,"iconSprite",void 0),l([a(cc.Label)],y.prototype,"nameLabel",void 0),l([a(cc.Label)],y.prototype,"titleLabel",void 0),l([a(cc.Button)],y.prototype,"closeButton",void 0),g=l([h,g("Game/Stage/NewWorldMapTipUI")],y),n.default=g,cc._RF.pop()},{}],offline_reward_ui:[function(t,e,o){"use strict";cc._RF.push(e,"8f25dhaYQxL/pis4K/WmCEm","offline_reward_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("local_currency"),u=a("encourage_icon_ui"),d=a("vm_encourage"),p=a("audio_config"),f=a("currency_config"),h=a("encourage_config"),g=a("scroll_number"),y=a("i18n"),m=a("gaudio"),b=a("gnode"),_=a("gtime"),v=a("ggame"),C=a("gview_model"),P=a("local_building"),S=a("local_vip"),G=(M=cc._decorator).ccclass,M=(a=M.property,M.menu);function w(){var t=null!==c&&c.apply(this,arguments)||this;return t.offlineBuildingPoint=null,t.offlineTimeLabel=null,t.maxOfflineTimeLabel=null,t.currentBuildingPoint=null,t.collectButton=null,t.adCollectButton=null,t.confirmButton=null,t.vipTipNode=null,t.encourageIconUI=null,t.encourageType=d.eEncourageType.closed,t.offlineBuildingPointScrollNumber=null,t.currentBuildingPointScrollNumber=null,t.offlineCollectedBuildingUpgradePoint=null,t.offlineDuration=0,t}r(w,c=cc.Component),w.prototype.init=function(t,e){this.offlineCollectedBuildingUpgradePoint=t,this.offlineDuration=e,this.enabledInHierarchy&&this._refresh(1)},w.prototype.onLoad=function(){var t=this;this.collectButton&&this.collectButton.node.on("click",function(){m.sGAudio.playEffect(p.sAudioConfig.config.reward),b.sGNode.destoryNode(t.node)}),this.confirmButton&&this.confirmButton.node.on("click",function(){m.sGAudio.playEffect(p.sAudioConfig.config.reward),b.sGNode.destoryNode(t.node)}),this.adCollectButton&&this.adCollectButton.node.on("click",function(){C.sGViewModel.getModule(d.VMEncourage).encourage(h.sEncourageConfig.config.collectDoubleOfflineReward,t.encourageType,function(){m.sGAudio.playEffect(p.sAudioConfig.config.reward),v.sGGame.localModel.getModule(P.LocalBuildingPackage).collectOfflineUpgradePointByAD(t.offlineCollectedBuildingUpgradePoint),t._refresh(2)})})},w.prototype.onEnable=function(){this.encourageType=C.sGViewModel.getModule(d.VMEncourage).preEncourage(h.sEncourageConfig.config.collectDoubleOfflineReward),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType),this.offlineBuildingPoint&&(this.offlineBuildingPointScrollNumber=b.sGNode.addUniqueComponent(this.offlineBuildingPoint.node,g.default)),this.currentBuildingPoint&&(this.currentBuildingPointScrollNumber=b.sGNode.addUniqueComponent(this.currentBuildingPoint.node,g.default)),this._refresh(1)},w.prototype.onDisable=function(){b.sGNode.targetOff(this),v.sGGame.targetOff(this)},w.prototype._refresh=function(t){var e;this.offlineBuildingPointScrollNumber&&this.offlineBuildingPointScrollNumber.setNumber(this.offlineCollectedBuildingUpgradePoint*t,2===t),this.currentBuildingPointScrollNumber&&(e=v.sGGame.localModel.getModule(s.LocalCurrency).get(f.sCurrencyConfig.config.buildingUpgradePoint),this.currentBuildingPointScrollNumber.setNumber(e,2===t)),this.offlineTimeLabel&&(this.offlineTimeLabel.string=_.sGTime.toTimeSpanString(this.offlineDuration)),this.maxOfflineTimeLabel&&(this.maxOfflineTimeLabel.string=y.i18n.t("offlineReward.maxOfflineHours").replace("${value}",v.sGGame.localModel.getModule(P.LocalBuildingPackage).getMaxOfflineHours().toString())),this.collectButton&&(this.collectButton.node.active=1===t),this.adCollectButton&&(this.adCollectButton.node.active=1===t),this.confirmButton&&(this.confirmButton.node.active=2===t),this.vipTipNode&&(this.vipTipNode.active=null!=v.sGGame.localModel.getModule(S.LocalVIP).getNextEntry())},l([a(cc.Label)],w.prototype,"offlineBuildingPoint",void 0),l([a(cc.Label)],w.prototype,"offlineTimeLabel",void 0),l([a(cc.Label)],w.prototype,"maxOfflineTimeLabel",void 0),l([a(cc.Label)],w.prototype,"currentBuildingPoint",void 0),l([a(cc.Button)],w.prototype,"collectButton",void 0),l([a(cc.Button)],w.prototype,"adCollectButton",void 0),l([a(cc.Button)],w.prototype,"confirmButton",void 0),l([a(cc.Node)],w.prototype,"vipTipNode",void 0),l([a(u.default)],w.prototype,"encourageIconUI",void 0),M=l([G,M("Game/Building/OfflineRewardUI")],w),n.default=M,cc._RF.pop()},{}],pata_battle_monitor_ui:[function(t,e,o){"use strict";cc._RF.push(e,"89358G9l9tBL6p9nNEs72XL","pata_battle_monitor_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("age_config"),u=a("scroll_process_bar"),d=a("glog"),p=a("gnode"),f=a("gtime"),h=a("ggame"),g=a("gview_model"),y=a("local_battle"),m=a("local_pata"),b=a("vm_battle"),_=a("vm_building"),v=a("battle_manager"),C=a("battle_soldier_progress_tip_ui"),P=a("soldier"),S=(G=cc._decorator).ccclass,G=(a=G.property,G.menu);function M(){var t=null!==c&&c.apply(this,arguments)||this;return t.playerProgressBar=null,t.enemyProgressBar=null,t.battleNode=null,t.battlePataLabel=null,t.battleTimeLabel=null,t.battleSoldierCountLabel=null,t.speedx1Button=null,t.speedx2Button=null,t.battleBGRoot=null,t.battleUIRoot=null,t.soldierProgressTipRoot=null,t.soldierProgressTipPrefab=null,t.battleBGNode=null,t.barLength=0,t.isFinished=!1,t.totalDt=0,t.battleSoldierProgressTipUIDic={},t}r(M,c=cc.Component),M.prototype.onLoad=function(){var t=this;this.localBattle=h.sGGame.localModel.getModule(y.LocalBattle),this.playerProgressBar&&(this.playerScrollProgressBar=p.sGNode.addUniqueComponent(this.playerProgressBar.node,u.default),this.barLength=this.playerProgressBar.totalLength),this.enemyProgressBar&&(this.enemyScrollProgressBar=p.sGNode.addUniqueComponent(this.enemyProgressBar.node,u.default)),this.speedx1Button&&this.speedx1Button.node.on("click",function(){t.setSpeed(1)}),this.speedx2Button&&this.speedx2Button.node.on("click",function(){var e=t.localBattle.getDoubleSpeedRemainEffectiveTime();0==e?(t.localBattle.pause(),g.sGViewModel.getModule(_.VMBuilding).openDoubleCollectUI(function(e){h.sGGame.localModel.getModule(y.LocalBattle).resume(),e&&(t.localBattle.effectDoubleSpeed(),t.setSpeed(1.6))},t)):(d.sGLog.info("doubleSpeedRemainEffectiveTime:",f.sGTime.toTimeSpanString(e/1e3)),t.setSpeed(1.6))})},M.prototype.onEnable=function(){var t=this;this._refresh();var e,o=h.sGGame.localModel.getModule(m.LocalPata);this.battlePataLabel&&(e=o.currentBattlePataEntry,this.battlePataLabel.string=e.name),h.sGGame.on(y.sLocalBattleEvent.activeDoubleSpeed,function(){t.refreshSpeed()},this),this.battleBGRoot&&(o=o.currentBattlePataEntry.age,o=s.sAgeConfig.getEntry(o),p.sGNode.createNode(o.battleBackground,function(e){t.battleBGNode=e,t.battleBGNode.parent=t.battleBGRoot},this)),this.refreshSpeed(),p.sGNode.createNode("prefabs/ui/battle_buff_status",this.battleUIRoot,function(e){e&&(e.active=!t.localBattle.battleFinish)},this),h.sGGame.on(y.sLocalBattleEvent.finished,this.onBattleFinished.bind(this),this),this.initSoldierProgress()},M.prototype.onBattleFinished=function(){this.battleUIRoot&&(this.battleUIRoot.active=!1)},M.prototype.onDisable=function(){p.sGNode.targetOff(this),h.sGGame.targetOff(this),this.battleBGNode&&(p.sGNode.destoryNode(this.battleBGNode),this.battleBGNode=null)},M.prototype.update=function(t){this._refresh(),this.totalDt+=t,1<=this.totalDt&&(this.totalDt=0,1<this.localBattle.battleTimeScale&&this.localBattle.getDoubleSpeedRemainEffectiveTime()<=0&&this.setSpeed(1))},M.prototype.setSpeed=function(t){this.localBattle.battleTimeScale=t,this.refreshSpeed()},M.prototype.refreshSpeed=function(){var t=this.localBattle.battleTimeScale;this.speedx1Button&&(this.speedx1Button.node.active=1!==t&&this.localBattle.doubleSpeedEnabled),this.speedx2Button&&(this.speedx2Button.node.active=1.6!==t&&this.localBattle.doubleSpeedEnabled)},M.prototype._refresh=function(){var t,e,o,i,a,n=g.sGViewModel.getModule(b.VMBattle);n.battleManager?(t=n.battleManager.getFirstSoldier(y.enumTeam.player),e=n.battleManager.getFirstSoldier(y.enumTeam.enemy),o=(o=t&&t.attackState!==P.enumSoldierAttackState.idle)||e&&e.attackState!==P.enumSoldierAttackState.idle,i=-this.barLength/2,t?(i+=(a=Math.abs(t.node.getPosition().sub(n.battleManager.spawnPositionOfPlayer).x))/n.battleManager.totalLength*this.barLength,this.playerScrollProgressBar&&this.playerScrollProgressBar.setProgress(a/n.battleManager.totalLength)):this.playerScrollProgressBar&&this.playerScrollProgressBar.setProgress(0),e?(a=Math.abs(e.node.getPosition().sub(n.battleManager.spawnPositionOfEnemy).x),this.enemyScrollProgressBar&&this.enemyScrollProgressBar.setProgress(a/n.battleManager.totalLength)):this.enemyScrollProgressBar&&this.enemyScrollProgressBar.setProgress(0),this.battleNode&&(this.battleNode.x=i,this.battleNode.active=o),this.battleTimeLabel&&(this.battleTimeLabel.string=f.sGTime.toTimeSpanString(n.battleManager.passTime)),this.battleSoldierCountLabel&&(this.battleSoldierCountLabel.string="0/0"),this.refreshSoldierProgress()):(this.playerScrollProgressBar&&this.playerScrollProgressBar.setProgress(0),this.enemyScrollProgressBar&&this.enemyScrollProgressBar.setProgress(0))},M.prototype.initSoldierProgress=function(){var t=this;h.sGGame.on(v.sBattleManagerEvent.destroySoldier,function(e){var o=t.battleSoldierProgressTipUIDic[e.unit.unitID];o&&(p.sGNode.destoryNode(o.node),delete t.battleSoldierProgressTipUIDic[e.unit.unitID])},this)},M.prototype.refreshSoldierProgress=function(){if(this.soldierProgressTipRoot&&this.soldierProgressTipPrefab){var t=g.sGViewModel.getModule(b.VMBattle);if(t.battleManager){for(var e in t.battleManager.playerSoldierDic)this.refreshSoldierProgressTip(t.battleManager.playerSoldierDic[e]);for(var e in t.battleManager.enemySoldierDic)this.refreshSoldierProgressTip(t.battleManager.enemySoldierDic[e])}}},M.prototype.refreshSoldierProgressTip=function(t){var e,o=g.sGViewModel.getModule(b.VMBattle),i=this.battleSoldierProgressTipUIDic[t.unit.unitID];i||(e=cc.instantiate(this.soldierProgressTipPrefab))&&((i=e.getComponent(C.default))&&(i.init(t),this.battleSoldierProgressTipUIDic[t.unit.unitID]=i),this.soldierProgressTipRoot.addChild(e)),o=(t.unit.teamID===y.enumTeam.player?Math.abs(t.node.getPosition().sub(o.battleManager.spawnPositionOfPlayer).x):Math.abs(t.node.getPosition().sub(o.battleManager.spawnPositionOfEnemy).x))/o.battleManager.totalLength*this.playerScrollProgressBar.progressbar.totalLength,t.unit.teamID===y.enumTeam.player?i.node.x=o:i.node.x=this.soldierProgressTipRoot.getContentSize().width-o},l([a(cc.ProgressBar)],M.prototype,"playerProgressBar",void 0),l([a(cc.ProgressBar)],M.prototype,"enemyProgressBar",void 0),l([a(cc.Node)],M.prototype,"battleNode",void 0),l([a(cc.Label)],M.prototype,"battlePataLabel",void 0),l([a(cc.Label)],M.prototype,"battleTimeLabel",void 0),l([a(cc.Label)],M.prototype,"battleSoldierCountLabel",void 0),l([a({type:cc.Button,tooltip:"1\u500d\u901f"})],M.prototype,"speedx1Button",void 0),l([a({type:cc.Button,tooltip:"2\u500d\u901f"})],M.prototype,"speedx2Button",void 0),l([a(cc.Node)],M.prototype,"battleBGRoot",void 0),l([a(cc.Node)],M.prototype,"battleUIRoot",void 0),l([a({displayName:"\u58eb\u5175\u8fdb\u5ea6\u6302\u8282\u70b9",type:cc.Node})],M.prototype,"soldierProgressTipRoot",void 0),l([a({displayName:"\u58eb\u5175\u8fdb\u5ea6\u5c55\u793a\u9884\u5236\u4ef6",type:cc.Prefab})],M.prototype,"soldierProgressTipPrefab",void 0),G=l([S,G("Game/Pata/PataBattleMonitorUI")],M),n.default=G,cc._RF.pop()},{}],pata_battle_victory_ui:[function(t,e,o){"use strict";cc._RF.push(e,"13cafoPEz5KmIIMFcB7fn7r","pata_battle_victory_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("card_config"),f=a("encourage_config"),h=a("pata_buff_config"),g=a("i18n"),y=a("gaudio"),m=a("gnode"),b=a("ggame"),_=a("gview_model"),v=a("local_attribute"),C=a("local_pata"),P=a("local_soldier"),S=a("vm_reward"),G=(M=cc._decorator).ccclass,M=(a=M.property,M.menu);function w(){var t=null!==c&&c.apply(this,arguments)||this;return t.buffRootArray=[],t.collectAllBuffButton=null,t.closeButton=null,t.closeButton2=null,t.encourageIconUI=null,t.localPata=null,t.waitCollectPataBuffArray=[],t.collectIndex=-1,t}r(w,c=cc.Component),w.prototype.init=function(t){this.callback=t},w.prototype.onLoad=function(){var t=this;this.closeButton&&(this.closeButton.node.active=!0,this.closeButton.node.on("click",function(){y.sGAudio.playEffect(d.sAudioConfig.config.reward),t.callback&&t.callback()})),this.closeButton2&&(this.closeButton2.node.active=!1,this.closeButton2.node.on("click",function(){y.sGAudio.playEffect(d.sAudioConfig.config.reward),t.callback&&t.callback()})),this.collectAllBuffButton&&this.collectAllBuffButton.node.on("click",function(){_.sGViewModel.getModule(u.VMEncourage).encourage(f.sEncourageConfig.config.collectAllPataBattleBuff,t.encourageType,function(){t.localPata.collectPataAllBuff(),t.collectIndex=999,t.refresh()})});for(var e=this,o=0;o<this.buffRootArray.length;++o)!function(o){var i=e.buffRootArray[o];(i=cc.find("button_receive",i))&&i.on("click",function(){t.localPata.collectPataBuff(o),t.collectIndex=o,t.refresh()})}(o)},w.prototype.onEnable=function(){this.localPata=b.sGGame.localModel.getModule(C.LocalPata),this.waitCollectPataBuffArray=this.localPata.getPataWaitCollectBuffArray().concat(),this.encourageType=_.sGViewModel.getModule(u.VMEncourage).preEncourage(f.sEncourageConfig.config.collectAllPataBattleBuff),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType),this.refresh()},w.prototype.onDisable=function(){m.sGNode.targetOff(this)},w.prototype.refresh=function(){this.closeButton&&(this.closeButton.node.active=!1),this.collectAllBuffButton&&(this.collectAllBuffButton.node.active=-1===this.collectIndex),this.closeButton2&&(this.closeButton2.node.active=0<=this.collectIndex);for(var t=0;t<this.buffRootArray.length;++t)this.refreshBuffRoot(t)},w.prototype.refreshBuffRoot=function(t){var e,o=this.waitCollectPataBuffArray[t],i=h.sPataBuffConfig.getEntry(o),a=i.quality,n=this.buffRootArray[t],r=cc.find("icon_bottom/quality_root",n),l=cc.find("icon_bottom/icon",n),c=cc.find("info/Label_attribute",n),s=cc.find("tag",n),u=cc.find("untag",n),d=cc.find("button_receive",n);if(c&&(e=g.i18n.t(i.desc),31<=i.id&&i.id<=70&&(o=p.sCardConfig.getEntry(i.id),e=g.i18n.t(o.name)+e),c.getComponent(cc.Label).string=e,c.color=_.sGViewModel.getModule(S.VMReward).getQualityColor(a)),l&&m.sGNode.setSprite(l.getComponent(cc.Sprite),i.icon,this),(n=cc.find("icon_bottom/soldierIcon",n))&&(n.active=v.eAttributeObjectType[i.attributeObjectType]===v.eAttributeObjectType.soldier,!n.active||(i=b.sGGame.localModel.getModule(P.LocalSoldierPackage).getSoldier(i.attributeObjectID))&&m.sGNode.setSprite(n.getComponent(cc.Sprite),i.card.entry.icon,this)),r)for(var f=1;;++f){var y=r.getChildByName("quality"+f);if(!y)break;y.active=f+2===a}s&&(s.active=999===this.collectIndex||this.collectIndex===t),u&&(u.active=-1!==this.collectIndex&&999!==this.collectIndex&&this.collectIndex!==t),d&&(d.active=-1===this.collectIndex)},l([a(cc.Node)],w.prototype,"buffRootArray",void 0),l([a(cc.Button)],w.prototype,"collectAllBuffButton",void 0),l([a(cc.Button)],w.prototype,"closeButton",void 0),l([a(cc.Button)],w.prototype,"closeButton2",void 0),l([a(s.default)],w.prototype,"encourageIconUI",void 0),M=l([G,M("Game/Pata/PataBattleVictoryUI")],w),n.default=M,cc._RF.pop()},{}],pata_buff_history_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"538d6r4Ut1Hb7JHbow3S1G+","pata_buff_history_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("card_config"),u=a("pata_buff_config"),d=a("i18n"),p=a("fast_scrollview_cell"),f=a("gnode"),h=a("ggame"),g=a("gview_model"),y=a("local_attribute"),m=a("local_soldier"),b=a("vm_reward"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.buffRootArray=[],t.fastScrollViewCell=null,t}r(C,c=cc.Component),C.prototype.onLoad=function(){this.fastScrollViewCell=this.getComponent(p.FastScrollViewCell)},C.prototype.onEnable=function(){this.historyBuff=this.fastScrollViewCell.data,this._refresh()},C.prototype.onDisable=function(){h.sGGame.targetOff(this)},C.prototype._refresh=function(){if(this.historyBuff){var t;this.nameLabel&&(t=(t=d.i18n.t("pata.name")).replace("${value}",this.historyBuff.pataID.toString()),this.nameLabel.string=t);for(var e=0;e<this.buffRootArray.length;++e)this.refreshBuffRoot(e)}},C.prototype.refreshBuffRoot=function(t){var e=this.historyBuff.buffIDArray[t],o=this.historyBuff.selectedArray[t],i=u.sPataBuffConfig.getEntry(e),a=i.quality,n=this.buffRootArray[t],r=cc.find("icon_bottom/quality_root",n),l=cc.find("icon_bottom/icon",n),c=cc.find("Label_attribute",n),p=cc.find("tag",n),_=cc.find("untag",n);if(c&&(e=d.i18n.t(i.desc),31<=i.id&&i.id<=70&&(t=s.sCardConfig.getEntry(i.id),e=d.i18n.t(t.name)+e),c.getComponent(cc.Label).string=e,c.color=g.sGViewModel.getModule(b.VMReward).getQualityColor(a)),l&&f.sGNode.setSprite(l.getComponent(cc.Sprite),i.icon,this),(n=cc.find("icon_bottom/soldierIcon",n))&&(n.active=y.eAttributeObjectType[i.attributeObjectType]===y.eAttributeObjectType.soldier,!n.active||(i=h.sGGame.localModel.getModule(m.LocalSoldierPackage).getSoldier(i.attributeObjectID))&&f.sGNode.setSprite(n.getComponent(cc.Sprite),i.card.entry.icon,this)),r)for(var v=1;;++v){var C=r.getChildByName("quality"+v);if(!C)break;C.active=v+2===a}p&&(p.active=o),_&&(_.active=!o)},l([a({type:cc.Label,tooltip:"\u5173\u5361"})],C.prototype,"nameLabel",void 0),l([a(cc.Node)],C.prototype,"buffRootArray",void 0),v=l([_,v("Game/Pata/PataBuffHistoryIconUI")],C),n.default=v,cc._RF.pop()},{}],pata_buff_history_ui:[function(t,e,o){"use strict";cc._RF.push(e,"384751zoHBBAa6MNkXr1DIr","pata_buff_history_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("fast_scrollview"),d=a("gaudio"),p=a("ggame"),f=a("local_pata"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.nodeEmpty=null,t.fastScrollView=null,t}r(y,c=cc.Component),y.prototype.onLoad=function(){this.fastScrollView=this.getComponent(u.FastScrollView)},y.prototype.onEnable=function(){this.localPata=p.sGGame.localModel.getModule(f.LocalPata),d.sGAudio.playEffect(s.sAudioConfig.config.popUI),this._refresh()},y.prototype.onDisable=function(){},y.prototype._refresh=function(){var t=this.localPata.getHistoryBuffArray();this.nodeEmpty&&(this.nodeEmpty.active=t.length<=0),this.fastScrollView.clear(!0);for(var e=0;e<t.length;++e){var o=t[e];this.fastScrollView.pushCell(o)}this.fastScrollView.initPosition()},l([a(cc.Node)],y.prototype,"nodeEmpty",void 0),g=l([h,g("Game/Pata/PataBuffHistoryUI")],y),n.default=g,cc._RF.pop()},{}],pata_buff_stat_cell_ui:[function(t,e,o){"use strict";cc._RF.push(e,"ad747MXLDNK06JeAEzsinlb","pata_buff_stat_cell_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("fast_scrollview_cell"),u=a("ggame"),d=(p=cc._decorator).ccclass,p=(a=p.property,p.menu);function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.valueLabel=null,t.fastScrollViewCell=null,t}r(f,c=cc.Component),f.prototype.onLoad=function(){this.fastScrollViewCell=this.getComponent(s.FastScrollViewCell)},f.prototype.onEnable=function(){this.buffStatInfo=this.fastScrollViewCell.data,this._refresh()},f.prototype.onDisable=function(){u.sGGame.targetOff(this)},f.prototype._refresh=function(){this.buffStatInfo&&(this.nameLabel&&(this.nameLabel.string=this.buffStatInfo.name),this.valueLabel&&(this.valueLabel.string=this.buffStatInfo.value))},l([a({type:cc.Label,tooltip:"\u540d\u5b57"})],f.prototype,"nameLabel",void 0),l([a({type:cc.Label,tooltip:"\u503c"})],f.prototype,"valueLabel",void 0),p=l([d,p("Game/Pata/PataBuffStatCellUI")],f),n.default=p,cc._RF.pop()},{}],pata_buff_stat_ui:[function(t,e,o){"use strict";cc._RF.push(e,"98fc4iGvLhGF7W29bXBL8ai","pata_buff_stat_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};function c(){}Object.defineProperty(n,"__esModule",{value:!0}),n.BuffStatInfo=void 0;var s,u=a("audio_config"),d=a("card_config"),p=a("player_attribute_config"),f=a("i18n"),h=a("fast_scrollview"),g=a("gaudio"),y=a("ggame"),m=a("local_pata"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu);function v(){var t=null!==s&&s.apply(this,arguments)||this;return t.nodeEmpty=null,t.fastScrollView=null,t}n.BuffStatInfo=c,r(v,s=cc.Component),v.prototype.onLoad=function(){this.fastScrollView=this.getComponent(h.FastScrollView)},v.prototype.onEnable=function(){this.localPata=y.sGGame.localModel.getModule(m.LocalPata),g.sGAudio.playEffect(u.sAudioConfig.config.popUI),this._refresh()},v.prototype.onDisable=function(){},v.prototype._refresh=function(){var t=[],e=this.localPata.getBuffStatSlotCount();0<e&&this.addStatInfo(t,f.i18n.t(p.sPlayerAttributeConfig.config.pataSlotCount.name),"+"+e),this.nodeEmpty&&(this.nodeEmpty.active=e<=0);var o=this.localPata.getBuffStatAttributeArray();for(n in o){var i=o[n],a=p.sPlayerAttributeConfig.getEntry(n);this.addStatInfo(t,f.i18n.t(a.name),"+"+i+"%")}var n,r=this.localPata.getBuffStatAddStar();for(n in r){i=r[n];var l=d.sCardConfig.getEntry(n);this.addStatInfo(t,f.i18n.t(l.name),"+"+i+f.i18n.t("unit.star"))}this.fastScrollView.clear(!0);for(var c=0;c<t.length;++c)this.fastScrollView.pushCell(t[c]);this.fastScrollView.initPosition()},v.prototype.addStatInfo=function(t,e,o){var i=new c;i.name=e,i.value=o,t.push(i)},l([a(cc.Node)],v.prototype,"nodeEmpty",void 0),_=l([b,_("Game/Pata/PataBuffStatUI")],v),n.default=_,cc._RF.pop()},{}],pata_buff_tab_ui:[function(t,e,o){"use strict";cc._RF.push(e,"9ba6c3G8cRPmoW1cDEHSAKr","pata_buff_tab_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.ePataBuffTabType=void 0;var s=a("reddot"),u=a("audio_config"),d=a("gui"),p=a("gaudio"),f=a("gnode"),h=a("ggame"),g=a("gview_model"),y=a("vm_building"),m=a("vm_card"),b=a("vm_check_in"),_=a("vm_quest"),v=a("vm_vip");(P=r.ePataBuffTabType||(r.ePataBuffTabType={}))[P.history=0]="history",P[P.worldMap=1]="worldMap",a=(n=cc._decorator).ccclass;var C,P=n.property;function S(){var t=null!==C&&C.apply(this,arguments)||this;return t.tabToggleContainer=null,t.tabPrefabArray=[],t.tabRoot=null,t.tabNodeDic=[],t}n=n.menu,l(S,C=cc.Component),S.prototype.onLoad=function(){var t=this;if(this.tabToggleContainer)for(var e=this.tabToggleContainer.toggleItems.length,o=this,i=0;i<e;++i)!function(e){var i=o.tabToggleContainer.toggleItems[e];i&&(i.node.on("toggle",function(){p.sGAudio.playEffect(u.sAudioConfig.config.switchTab),t._refreshTabs(e)},o),f.sGNode.addUniqueComponent(i.node,s.default).init(function(){return e!=t.currentTabIndex&&(0===e?g.sGViewModel.getModule(y.VMBuilding).hasAnyBuildingReddot()||g.sGViewModel.getModule(_.VMQuest).canShowQuestButton()&&g.sGViewModel.getModule(_.VMQuest).hasAnyQuestCanCommit()||g.sGViewModel.getModule(v.VMVIP).canShowButton()&&g.sGViewModel.getModule(v.VMVIP).hasVIPReddot()||g.sGViewModel.getModule(b.VMCheckIn).hasAnythingToDo():1!==e&&(2===e?g.sGViewModel.getModule(m.VMCard).pullHasReddot()||g.sGViewModel.getModule(m.VMCard).freePullHasReddot():3===e&&(g.sGViewModel.getModule(m.VMCard).skillCardPackageHasReddot()||g.sGViewModel.getModule(m.VMCard).soldierCardPackageHasReddot())))},"Background/reddot"))}(i)},S.prototype.onEnable=function(){this.openTab(0),p.sGAudio.playEffect(u.sAudioConfig.config.popUI)},S.prototype.onDisable=function(){f.sGNode.targetOff(this),h.sGGame.targetOff(this)},S.prototype.openTab=function(t){void 0!==t&&(this.tabToggleContainer&&this.tabToggleContainer.toggleItems[t].check(),this._refreshTabs(t))},S.prototype._refreshTabs=function(t){var e,o;this.currentTabIndex!==t&&(this.currentTabIndex=t,(e=this.tabNodeDic[t])?(this.currentTabNode&&(this.currentTabNode.active=!1),this.currentTabNode=e,d.sGUI.renameTopName(this.currentTabNode.name),this.currentTabNode&&(this.currentTabNode.active=!0)):(o=this.tabPrefabArray[t])&&(this.currentTabNode&&(this.currentTabNode.active=!1),e=cc.instantiate(o),this.tabNodeDic[t]=e,this.currentTabNode=e,d.sGUI.renameTopName(this.currentTabNode.name),this.tabRoot.addChild(e),f.sGNode.updateWidgetImmediately(e)))},c([P({tooltip:"\u5206\u9875",type:cc.ToggleContainer})],S.prototype,"tabToggleContainer",void 0),c([P({type:cc.Prefab,tooltip:"\u5206\u9875\u9884\u5236\u4ef6\u6570\u7ec4"})],S.prototype,"tabPrefabArray",void 0),c([P({type:cc.Node,tooltip:"\u529f\u80fd\u9875\u7684\u8282\u70b9"})],S.prototype,"tabRoot",void 0),n=c([a,n("Game/Pata/PataBuffTabUI")],S),r.default=n,cc._RF.pop()},{}],pata_button_root_ui:[function(t,e,o){"use strict";cc._RF.push(e,"1d67a1sDGZCup/FJrfLrqPh","pata_button_root_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gui"),d=a("gaudio"),p=a("ggame"),f=a("gview_model"),h=a("vm_battle"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu);function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t}r(m,c=cc.Component),m.prototype.onLoad=function(){this.button&&this.button.node.on("click",this.onOpenButtonClick.bind(this))},m.prototype.onEnable=function(){this.refresh()},m.prototype.onDisable=function(){p.sGGame.targetOff(this)},m.prototype.onOpenButtonClick=function(){d.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),u.sGUI.openDialogUI("prefabs/ui/dungeon_bottom_pop")},m.prototype.refresh=function(){this.button&&(this.button.node.active=f.sGViewModel.getModule(h.VMBattle).isPataOpened())},l([a(cc.Button)],m.prototype,"button",void 0),y=l([g,y("Game/Pata/PataButtonRootUI")],m),n.default=y,cc._RF.pop()},{}],pata_enemy_soldier_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"5e45eKLkOJMGb9+Y8USmyFp","pata_enemy_soldier_icon_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("card_config"),d=a("pata_spawner_config"),p=a("soldier_config"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("local_pata"),m=a("local_soldier");function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.soldierRoot=null,t.soldierIconSprite=null,t.qualityNodeArray=[],t.starLabel=null,t.addNode=null,t.lockNode=null,t.soldierIndex=-1,t.soldierArray=[],t.callback=null,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,l(b,c=cc.Component),b.prototype.init=function(t,e,o){this.soldierIndex=e,this.soldierArray=t,this.callback=o,this.enabledInHierarchy&&this._refresh()},b.prototype.onLoad=function(){var t=this;this.localPata=g.sGGame.localModel.getModule(y.LocalPata),this.localSoldierPackage=g.sGGame.localModel.getModule(m.LocalSoldierPackage),this.addNode=cc.find("bg/add",this.node),this.lockNode=cc.find("bg/lock",this.node),this.soldierRoot=cc.find("have_skill_root",this.node),this.soldierIconSprite=h.sGNode.findComponent(this.soldierRoot,"icon",cc.Sprite);for(var e=cc.find("quality_root",this.soldierRoot),o=1;o<4;o++){var i=cc.find("quality"+o,e);this.qualityNodeArray.push(i)}this.starLabel=h.sGNode.findComponent(this.soldierRoot,"star_root/ui144/label_number",cc.Label),this.node&&this.node.on("click",function(){t.soldierIndex,t.callback&&t.callback(t.soldierIndex)})},b.prototype.onEnable=function(){this.localPata=g.sGGame.localModel.getModule(y.LocalPata),f.sGAudio.playEffect(s.sAudioConfig.config.popUI),this._refresh()},b.prototype.onDisable=function(){},b.prototype._refresh=function(){var t,e,o,i;-1!=this.soldierIndex&&((t=this.soldierIndex<this.soldierArray.length)&&(o=this.localPata.getCurrentBattlePataID(),i=(e=d.sPataSpawnerConfig.getEntry(o)).soldiers[this.soldierIndex],o=this.soldierIndex<e.level.length?e.level[this.soldierIndex]:1,this.soldierIndex<e.level.length&&e.level[this.soldierIndex],this.soldierIndex<e.level.length&&e.level[this.soldierIndex],i=p.sSoldierConfig.getEntry(i),i=u.sCardConfig.getEntry(i.cardID),this.soldierIconSprite&&h.sGNode.setSprite(this.soldierIconSprite,i.icon),this.starLabel&&(this.starLabel.string=o.toString())),this.addNode&&(this.addNode.active=!t),this.lockNode&&(this.lockNode.active=!t),this.soldierRoot&&(this.soldierRoot.active=t))},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Pata/PataEnemeySoldierIconUI")],b),r.default=n,cc._RF.pop()},{}],pata_enemy_soldier_ui:[function(t,e,o){"use strict";cc._RF.push(e,"e02cbHAk/lAFKAZLCscoo6/","pata_enemy_soldier_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("pata_spawner_config"),d=a("gaudio"),p=a("gnode"),f=a("ggame"),h=a("local_card"),g=a("local_pata"),y=a("local_soldier"),m=a("pata_enemy_soldier_icon_ui"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu);function v(){var t=null!==c&&c.apply(this,arguments)||this;return t.confirmButton=null,t.soldierRoot=null,t.currentLabel=null,t.soldierArray=[],t}r(v,c=cc.Component),v.prototype.onLoad=function(){var t=this;this.confirmButton&&this.confirmButton.node.on("click",function(){p.sGNode.destoryNode(t.node)})},v.prototype.onEnable=function(){this.localPata=f.sGGame.localModel.getModule(g.LocalPata),this.localSoldierPackage=f.sGGame.localModel.getModule(y.LocalSoldierPackage),this.localCardPackage=f.sGGame.localModel.getModule(h.LocalCardPackage);var t=this.localPata.getCurrentBattlePataID();t=u.sPataSpawnerConfig.getEntry(t),this.soldierArray=t.soldiers,d.sGAudio.playEffect(s.sAudioConfig.config.popUI),this._refresh()},v.prototype.onDisable=function(){},v.prototype._refresh=function(){if(this.currentLabel&&(this.currentLabel.string=this.localPata.currentBattlePataEntry.id.toString()),this.soldierRoot)for(var t=0;t<this.soldierRoot.children.length;++t){var e=this.soldierRoot.children[t];p.sGNode.addUniqueComponent(e,m.default).init(this.soldierArray,t,function(){})}},l([a({type:cc.Button,tooltip:"\u786e\u5b9a\u6309\u94ae"})],v.prototype,"confirmButton",void 0),l([a({type:cc.Node,tooltip:"\u5f53\u524d\u9635\u5bb9"})],v.prototype,"soldierRoot",void 0),l([a({type:cc.Label,tooltip:"\u5f53\u524d\u5c42\u6570"})],v.prototype,"currentLabel",void 0),_=l([b,_("Game/Pata/PataEnemySoldierUI")],v),n.default=_,cc._RF.pop()},{}],pata_main_player_soldier_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"9023e0fUuJCpa+26eT6nh36","pata_main_player_soldier_icon_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gaudio"),d=a("gnode"),p=a("ggame"),f=a("local_pata"),h=a("local_soldier");function g(){var t=null!==c&&c.apply(this,arguments)||this;return t.soldierRoot=null,t.soldierIconSprite=null,t.qualityNodeArray=[],t.starLabel=null,t.addNode=null,t.lockNode=null,t.soldierIndex=-1,t.soldierArray=[],t.callback=null,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,l(g,c=cc.Component),g.prototype.init=function(t,e,o){this.soldierIndex=e,this.soldierArray=t,this.callback=o,this.enabledInHierarchy&&this._refresh()},g.prototype.onLoad=function(){var t=this;this.localPata=p.sGGame.localModel.getModule(f.LocalPata),this.localSoldierPackage=p.sGGame.localModel.getModule(h.LocalSoldierPackage),this.addNode=cc.find("bg/add",this.node),this.lockNode=cc.find("bg/lock",this.node),this.soldierRoot=cc.find("have_skill_root",this.node),this.soldierIconSprite=d.sGNode.findComponent(this.soldierRoot,"icon",cc.Sprite);for(var e=cc.find("quality_root",this.soldierRoot),o=1;o<4;o++){var i=cc.find("quality"+o,e);this.qualityNodeArray.push(i)}this.starLabel=d.sGNode.findComponent(this.soldierRoot,"star_root/ui144/label_number",cc.Label),this.node&&this.node.on("click",function(){t.soldierIndex<t.localPata.getPataSlotCount()&&t.callback&&t.callback(t.soldierIndex)})},g.prototype.onEnable=function(){this.localPata=p.sGGame.localModel.getModule(f.LocalPata),u.sGAudio.playEffect(s.sAudioConfig.config.popUI),this._refresh()},g.prototype.onDisable=function(){},g.prototype._refresh=function(){var t,e,o;-1!=this.soldierIndex&&(t=this.soldierIndex<this.soldierArray.length,e=this.localPata.getPataSlotCount(),t&&(o=this.soldierArray[this.soldierIndex],o=this.localSoldierPackage.getSoldier(o),this.soldierIconSprite&&d.sGNode.setSprite(this.soldierIconSprite,o.card.entry.icon),this.starLabel&&(this.starLabel.string=o.getPataLevel().toString())),this.addNode&&(this.addNode.active=!t&&this.soldierIndex<e),this.lockNode&&(this.lockNode.active=!t&&this.soldierIndex>=e),this.soldierRoot&&(this.soldierRoot.active=t))},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Pata/PataMainPlayerSoldierIconUI")],g),r.default=n,cc._RF.pop()},{}],pata_main_ui:[function(t,e,o){"use strict";cc._RF.push(e,"35886H4nBFOyaXHu8Npglrt","pata_main_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reddot"),u=a("vm_guide"),d=a("vm_ui"),p=a("audio_config"),f=a("pata_config"),h=a("pata_pack_config"),g=a("pata_reward_config"),y=a("i18n"),m=a("gui"),b=a("gaudio"),_=a("gnode"),v=a("ggame"),C=a("gview_model"),P=a("local_pata"),S=a("local_reward"),G=a("vm_battle"),M=a("vm_reward"),w=a("pata_battle_victory_ui"),A=a("pata_main_player_soldier_icon_ui"),B=a("pata_reset_ui"),R=a("pata_soldier_setting_ui"),k=(T=cc._decorator).ccclass,T=(a=T.property,T.menu);function L(){var t=null!==c&&c.apply(this,arguments)||this;return t.startButton=null,t.resetButton=null,t.enemySoldierButton=null,t.rewardButton=null,t.buffButton=null,t.currentLabel=null,t.topLabel=null,t.rewardRoot=null,t.rewardCountLabel=null,t.soldierRoot=null,t.passAllNode=null,t.shownWaitBuffArray=!1,t}r(L,c=cc.Component),L.prototype.onLoad=function(){var t=this;this.localPata=v.sGGame.localModel.getModule(P.LocalPata),this.startButton&&this.startButton.node.on("click",function(){0===t.localPata.getSoldierArray().length?m.sGUI.openDialogUI("prefabs/ui/dungeon_team_change",function(e){e.getComponent(R.default).init(function(){0<t.localPata.getSoldierArray().length?(_.sGNode.destoryNode(t.node),C.sGViewModel.getModule(G.VMBattle).enterBattlePata(),b.sGAudio.playEffect(p.sAudioConfig.config.joinBattle)):C.sGViewModel.getModule(d.VMUI).addMessageTip(y.i18n.t("tips.pataSoldierIsEmpty"))})}):(C.sGViewModel.getModule(G.VMBattle).enterBattlePata(),b.sGAudio.playEffect(p.sAudioConfig.config.joinBattle))}),this.resetButton&&this.resetButton.node.on("click",function(){var e,o;0<t.localPata.rewardList.length?C.sGViewModel.getModule(d.VMUI).openMessageBoxOKUI(y.i18n.t("tips.resetNeedEmptyReward"),function(){m.sGUI.openDialogUI("prefabs/ui/dungeon_reward_bottom_pop")}):0<t.localPata.getResetTimes()?m.sGUI.openDialogUI("prefabs/ui/dungeon_enemy_cz",function(e){e.getComponent(B.default).init(function(){t.localPata.resetPata(),t._refresh(),C.sGViewModel.getModule(d.VMUI).addMessageTip(y.i18n.t("tips.resetOK"))})}):(e=(e=y.i18n.t("pata.name")).replace("${value}",t.localPata.currentBattlePataEntry.id.toString()),o=(o=y.i18n.t("tips.confirmResetPata")).replace("${value}",e),C.sGViewModel.getModule(d.VMUI).openMessageBoxOKCancelUI(o,function(e){e&&(t.localPata.resetPata(),t._refresh(),C.sGViewModel.getModule(d.VMUI).addMessageTip(y.i18n.t("tips.resetOK")))}))}),this.enemySoldierButton&&this.enemySoldierButton.node.on("click",function(){m.sGUI.openDialogUI("prefabs/ui/dungeon_enemy_team")}),this.buffButton&&this.buffButton.node.on("click",function(){m.sGUI.openDialogUI("prefabs/ui/dungeon_buff_bottom")}),this.rewardButton&&(this.rewardButton.node.on("click",function(){m.sGUI.openDialogUI("prefabs/ui/dungeon_reward_bottom_pop")}),this.rewardButton.addComponent(s.default).init(function(){return 0<t.localPata.rewardList.length},"Background/reddot"))},L.prototype.onEnable=function(){var t=this;this.localPata=v.sGGame.localModel.getModule(P.LocalPata),b.sGAudio.playEffect(p.sAudioConfig.config.popUI),this._refresh(),v.sGGame.on(P.sLocalPataEvent.soldierArrayChanged,function(){t._refresh()},this),v.sGGame.on(P.sLocalPataEvent.collectReward,function(){t.rewardButton&&(t.rewardButton.node.active=0<t.localPata.rewardList.length)},this),v.sGGame.on(P.sLocalPataEvent.collectDoubleReward,function(){t.rewardButton&&(t.rewardButton.node.active=0<t.localPata.rewardList.length)},this),this.shownWaitBuffArray=!1},L.prototype.onDisable=function(){v.sGGame.targetOff(this)},L.prototype.update=function(){!this.shownWaitBuffArray&&!C.sGViewModel.getModule(u.VMGuide).isGuideOpened()&&0<this.localPata.getPataWaitCollectBuffArray().length&&(this.shownWaitBuffArray=!0,m.sGUI.openDialogUI("prefabs/ui/dungeon_settlement_win2",function(t){var e=t.getComponent(w.default);e&&e.init(function(){_.sGNode.destoryNode(t)})}))},L.prototype._refresh=function(){var t,e;if(this.currentLabel&&(e=(e=y.i18n.t("pata.name")).replace("${value}",this.localPata.currentBattlePataEntry.id.toString()),this.currentLabel.string=e),this.topLabel&&(t=this.localPata.getTopPassPataID(),(t=f.sPataConfig.getEntry(t))?(this.topLabel.node.parent.active=!0,e=(e=y.i18n.t("pata.name")).replace("${value}",t.id.toString()),this.topLabel.string=e):this.topLabel.node.parent.active=!1),this.soldierRoot)for(var o=0;o<this.soldierRoot.children.length;++o){var i=this.soldierRoot.children[o];_.sGNode.addUniqueComponent(i,A.default).init(this.localPata.getSoldierArray(),o,function(){m.sGUI.openDialogUI("prefabs/ui/dungeon_team_change",function(t){t.getComponent(R.default).init(function(){_.sGNode.destoryNode(t)})})})}if(this.rewardCountLabel&&(e=this.localPata.getRewardPataCount(),this.rewardCountLabel.string=(e=99<e?99:e).toString()),this.startButton&&(this.startButton.node.active=this.localPata.getCurrentBattlePataID()!==this.localPata.getCurrentPassPataID()),this.passAllNode&&(this.passAllNode.active=this.localPata.getCurrentBattlePataID()===this.localPata.getCurrentPassPataID()),this.rewardRoot){var a=g.sPataRewardConfig.getEntry(this.localPata.currentBattlePataEntry.id);for(o=0;o<this.rewardRoot.children.length;++o){i=this.rewardRoot.children[o];var n,r,l=_.sGNode.findComponent(i,"icon",cc.Sprite),c=_.sGNode.findComponent(i,"label_number",cc.Label);0===o?(r=C.sGViewModel.getModule(M.VMReward),l&&(n=r.getIcon(S.eRewardType.buildingUpgradePointOverTime,0),_.sGNode.setSprite(l,n)),c&&(c.string=r.getCount(S.eRewardType.buildingUpgradePointOverTime,a.buildingUpgradePoint))):1===o?(r=h.sPataPackConfig.getEntry(a.packID),l&&(r?_.sGNode.setSprite(l,r.icon):(n=C.sGViewModel.getModule(M.VMReward).getIcon(S.eRewardType.cardUpgradePoint,0),_.sGNode.setSprite(l,n))),c&&(c.string=r?y.i18n.t(r.name)+" x"+a.count:" x"+a.count)):i.active=!1}}},l([a({type:cc.Button,tooltip:"\u5f00\u59cb\u6218\u6597"})],L.prototype,"startButton",void 0),l([a({type:cc.Button,tooltip:"\u91cd\u7f6e"})],L.prototype,"resetButton",void 0),l([a({type:cc.Button,tooltip:"\u67e5\u770b\u654c\u65b9\u9635\u5bb9"})],L.prototype,"enemySoldierButton",void 0),l([a({type:cc.Button,tooltip:"\u5173\u5361\u5956\u52b1"})],L.prototype,"rewardButton",void 0),l([a({type:cc.Button,tooltip:"\u589e\u76ca\u9884\u89c8"})],L.prototype,"buffButton",void 0),l([a({type:cc.Label,tooltip:"\u5f53\u524d\u5c42\u6570"})],L.prototype,"currentLabel",void 0),l([a({type:cc.Label,tooltip:"\u6700\u9ad8\u5c42\u6570"})],L.prototype,"topLabel",void 0),l([a({type:cc.Node,tooltip:"\u5f53\u524d\u5956\u52b1"})],L.prototype,"rewardRoot",void 0),l([a({type:cc.Label,tooltip:"\u5956\u52b1\u6570\u91cf"})],L.prototype,"rewardCountLabel",void 0),l([a({type:cc.Node,tooltip:"\u6211\u65b9\u5c0f\u5175"})],L.prototype,"soldierRoot",void 0),l([a({type:cc.Node,tooltip:"\u901a\u5173\u6240\u6709\u5c42"})],L.prototype,"passAllNode",void 0),T=l([k,T("Game/Pata/PataMainUI")],L),n.default=T,cc._RF.pop()},{}],pata_reset_ui:[function(t,e,o){"use strict";cc._RF.push(e,"676a3OkmFRKcYbF7zA3IvpV","pata_reset_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("encourage_config"),f=a("i18n"),h=a("gaudio"),g=a("gnode"),y=a("ggame"),m=a("gview_model"),b=a("local_pata"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.confirmButton=null,t.currentLabel=null,t.encourageIconUI=null,t.soldierSelectedArray=[],t.soldierWaitSelectArray=[],t.soldierWaitSelectedNodeArray=[],t.confirmCallback=null,t}r(C,c=cc.Component),C.prototype.init=function(t){this.confirmCallback=t},C.prototype.onLoad=function(){var t=this;this.confirmButton&&this.confirmButton.node.on("click",function(){m.sGViewModel.getModule(u.VMEncourage).encourage(p.sEncourageConfig.config.collectDoublePataReward,t.encourageType,function(){t.localPata.resetPata(),g.sGNode.destoryNode(t.node),t.confirmCallback&&t.confirmCallback()})})},C.prototype.onEnable=function(){this.localPata=y.sGGame.localModel.getModule(b.LocalPata),this.encourageType=m.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.collectDoublePataReward),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType),h.sGAudio.playEffect(d.sAudioConfig.config.popUI),this._refresh()},C.prototype.onDisable=function(){for(var t=0;t<this.soldierWaitSelectedNodeArray.length;++t){var e=this.soldierWaitSelectedNodeArray[t];g.sGNode.destoryNode(e)}},C.prototype._refresh=function(){var t;this.currentLabel&&(t=(t=f.i18n.t("pata.name")).replace("${value}",this.localPata.currentBattlePataEntry.id.toString()),this.currentLabel.string=t)},l([a({type:cc.Button,tooltip:"\u786e\u5b9a\u6309\u94ae"})],C.prototype,"confirmButton",void 0),l([a({type:cc.Label,tooltip:"\u5f53\u524d\u5c42\u6570"})],C.prototype,"currentLabel",void 0),l([a(s.default)],C.prototype,"encourageIconUI",void 0),v=l([_,v("Game/Pata/PataResetUI")],C),n.default=v,cc._RF.pop()},{}],pata_reward_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"ab4c6q4WstJX5RGs12w2DXV","pata_reward_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reward_helper"),u=a("fast_scrollview_cell"),d=a("gnode"),p=a("ggame"),f=a("gview_model"),h=a("local_pata"),g=a("local_reward"),y=a("vm_reward"),m=(b=cc._decorator).ccclass,b=(a=b.property,b.menu);function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.iconSprite=null,t.numberLabel=null,t.fragmentNode=null,t.collectedNode=null,t.fastScrollViewCell=null,t}r(_,c=cc.Component),_.prototype.onLoad=function(){this.fastScrollViewCell=this.getComponent(u.FastScrollViewCell)},_.prototype.onEnable=function(){var t=this,e=this.fastScrollViewCell.data;this.displayReward=new s.Reward,this.displayReward.type=e.type,this.displayReward.id=e.id,this.displayReward.count=e.count,this._refresh(),p.sGGame.on(h.sLocalPataEvent.collectDoubleReward,function(e){t.displayReward.count=2*t.displayReward.count,t.displayReward.type!==g.eRewardType.buildingUpgradePointOverTime||(o=e.rewardList.findReward(g.eRewardType.buildingUpgradePoint))&&(t.displayReward.count=o.count,t.displayReward.type=o.type);var o=f.sGViewModel.getModule(y.VMReward);t.numberLabel&&(t.numberLabel.string=o.getCount(t.displayReward.type,t.displayReward.count),cc.tween(t.numberLabel.node).set({scale:5}).to(.2,{scale:1}).delay(.5).call(function(){cc.tween(t.numberLabel.node).repeatForever(cc.tween().to(.5,{scale:1.2}).to(.5,{scale:1})).start()}).start()),t.collectedNode&&(t.collectedNode.active=!0)},this),p.sGGame.on(h.sLocalPataEvent.collectReward,function(e){t.displayReward.count=t.displayReward.count,t.displayReward.type!==g.eRewardType.buildingUpgradePointOverTime||(o=e.rewardList.findReward(g.eRewardType.buildingUpgradePoint))&&(t.displayReward.count=o.count,t.displayReward.type=o.type);var o=f.sGViewModel.getModule(y.VMReward);t.numberLabel&&(t.numberLabel.string=o.getCount(t.displayReward.type,t.displayReward.count)),t.collectedNode&&(t.collectedNode.active=!0)},this)},_.prototype.onDisable=function(){p.sGGame.targetOff(this)},_.prototype._refresh=function(){var t,e;this.displayReward&&(t=f.sGViewModel.getModule(y.VMReward),this.numberLabel&&(this.numberLabel.string=t.getCount(this.displayReward.type,this.displayReward.count)),this.iconSprite&&(e=t.getIcon(this.displayReward.type,this.displayReward.id),d.sGNode.setSprite(this.iconSprite,e)),this.fragmentNode&&(this.fragmentNode.active=t.isFragment(this.displayReward.type)),this.collectedNode&&(this.collectedNode.active=!1))},l([a({type:cc.Sprite,tooltip:"\u56fe\u6807"})],_.prototype,"iconSprite",void 0),l([a({type:cc.Label,tooltip:"\u6570\u91cf"})],_.prototype,"numberLabel",void 0),l([a({type:cc.Node,tooltip:"\u788e\u7247\u76d6\u677f"})],_.prototype,"fragmentNode",void 0),l([a({type:cc.Node,tooltip:"\u5df2\u9886\u53d6"})],_.prototype,"collectedNode",void 0),b=l([m,b("Game/Pata/PataRewardIconUI")],_),n.default=b,cc._RF.pop()},{}],pata_reward_ui:[function(t,e,o){"use strict";cc._RF.push(e,"06b0275fwtIJ48aRMJQJ6H2","pata_reward_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("encourage_config"),f=a("fast_scrollview"),h=a("gaudio"),g=a("gnode"),y=a("ggame"),m=a("gview_model"),b=a("local_pata"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.collectButton=null,t.adCollectButton=null,t.confirmButton=null,t.emptyTipNode=null,t.doubleCollectTipNode=null,t.collectedNode=null,t.encourageIconUI=null,t.fastScrollView=null,t}r(C,c=cc.Component),C.prototype.onLoad=function(){var t=this;this.fastScrollView=this.getComponent(f.FastScrollView),this.collectButton&&this.collectButton.node.on("click",function(){h.sGAudio.playEffect(d.sAudioConfig.config.reward),t.localPata.collectReward(),t.collectButton&&(t.collectButton.node.active=!1),t.adCollectButton&&(t.adCollectButton.node.active=!1),t.confirmButton&&(t.confirmButton.node.active=!0),t.collectedNode&&(t.collectedNode.active=!0)}),this.adCollectButton&&this.adCollectButton.node.on("click",function(){m.sGViewModel.getModule(u.VMEncourage).encourage(p.sEncourageConfig.config.collectDoublePataReward,t.encourageType,function(){h.sGAudio.playEffect(d.sAudioConfig.config.reward),t.localPata.collectDoubleReward(),t.collectButton&&(t.collectButton.node.active=!1),t.adCollectButton&&(t.adCollectButton.node.active=!1),t.confirmButton&&(t.confirmButton.node.active=!0),t.collectedNode&&(t.collectedNode.active=!0),t.doubleCollectTipNode&&(t.doubleCollectTipNode.active=!0,cc.tween(t.doubleCollectTipNode).repeatForever(cc.tween().to(.5,{scale:1.2}).to(.5,{scale:1})).start())})}),this.confirmButton&&this.confirmButton.node.on("click",function(){g.sGNode.destoryNode(t.node)})},C.prototype.onEnable=function(){this.localPata=y.sGGame.localModel.getModule(b.LocalPata),this.encourageType=m.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.collectDoublePataReward),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType),this.fastScrollView=this.getComponent(f.FastScrollView);var t=this.localPata.rewardList;this.collectButton&&(this.collectButton.interactable=!!t.length),this.adCollectButton&&(this.adCollectButton.interactable=!!t.length),this.emptyTipNode&&(this.emptyTipNode.active=!t.length),this.doubleCollectTipNode&&(this.doubleCollectTipNode.active=!1),this.confirmButton&&(this.confirmButton.node.active=!1),this.collectedNode&&(this.collectedNode.active=!1),h.sGAudio.playEffect(d.sAudioConfig.config.popUI),this._refresh()},C.prototype.onDisable=function(){},C.prototype._refresh=function(){var t=this.localPata.rewardList;this.fastScrollView.clear(!0);for(var e=0;e<t.length;++e){var o=t.getReward(e);this.fastScrollView.pushCell(o)}this.fastScrollView.initPosition()},l([a({type:cc.Button,tooltip:"\u9886\u53d6"})],C.prototype,"collectButton",void 0),l([a({type:cc.Button,tooltip:"\u5e7f\u544a\u9886\u53d6"})],C.prototype,"adCollectButton",void 0),l([a({type:cc.Button,tooltip:"\u5e7f\u544a\u540e\u786e\u5b9a"})],C.prototype,"confirmButton",void 0),l([a({type:cc.Node,tooltip:"\u7a7a\u5956\u52b1\u63d0\u793a"})],C.prototype,"emptyTipNode",void 0),l([a({type:cc.Node,tooltip:"\u53cc\u500d\u5956\u52b1\u63d0\u793a"})],C.prototype,"doubleCollectTipNode",void 0),l([a({type:cc.Node,tooltip:"\u5df2\u9886\u53d6"})],C.prototype,"collectedNode",void 0),l([a(s.default)],C.prototype,"encourageIconUI",void 0),v=l([_,v("Game/Pata/PataRewardUI")],C),n.default=v,cc._RF.pop()},{}],pata_soldier_setting_ui:[function(t,e,o){"use strict";cc._RF.push(e,"e4632FF1wZFioDqQ6lZLixt","pata_soldier_setting_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("vm_ui"),u=a("audio_config"),d=a("i18n"),p=a("gaudio"),f=a("gnode"),h=a("ggame"),g=a("gview_model"),y=a("local_card"),m=a("local_pata"),b=a("local_soldier"),_=a("card_icon_ui"),v=a("pata_main_player_soldier_icon_ui"),C=(P=cc._decorator).ccclass,P=(a=P.property,P.menu);function S(){var t=null!==c&&c.apply(this,arguments)||this;return t.confirmButton=null,t.closeButton=null,t.soldierSelectedRoot=null,t.soldierWaitSelectRoot=null,t.waitSelectIconPrefab=null,t.soldierSelectedArray=[],t.soldierWaitSelectArray=[],t.soldierWaitSelectedNodeArray=[],t.confirmCallback=null,t}r(S,c=cc.Component),S.prototype.init=function(t){this.confirmCallback=t},S.prototype.onLoad=function(){var t=this;this.confirmButton&&this.confirmButton.node.on("click",function(){t.localPata.confirmSoldierArray(t.soldierSelectedArray),t.confirmCallback&&t.confirmCallback()}),this.closeButton&&this.closeButton.node.on("click",function(){f.sGNode.destoryNode(t.node)})},S.prototype.onEnable=function(){this.localPata=h.sGGame.localModel.getModule(m.LocalPata),this.localSoldierPackage=h.sGGame.localModel.getModule(b.LocalSoldierPackage),this.localCardPackage=h.sGGame.localModel.getModule(y.LocalCardPackage),this.soldierSelectedArray=this.localPata.getSoldierArray(),this.soldierWaitSelectArray=[];for(var t=this.localSoldierPackage.getActiveSoldierArray(),e=0;e<t.length;++e)-1===this.soldierSelectedArray.indexOf(t[e].entry.id)&&this.soldierWaitSelectArray.push(t[e].entry.id);p.sGAudio.playEffect(u.sAudioConfig.config.popUI),this._refresh()},S.prototype.onDisable=function(){for(var t=0;t<this.soldierWaitSelectedNodeArray.length;++t){var e=this.soldierWaitSelectedNodeArray[t];f.sGNode.destoryNode(e)}},S.prototype._refresh=function(){var t=this;if(this.soldierSelectedRoot)for(var e=0;e<this.soldierSelectedRoot.children.length;++e){var o=this.soldierSelectedRoot.children[e];f.sGNode.addUniqueComponent(o,v.default).init(this.soldierSelectedArray,e,function(e){e<t.soldierSelectedArray.length&&(t.soldierWaitSelectArray.push(t.soldierSelectedArray[e]),t.soldierSelectedArray.splice(e,1),t._refresh())})}if(this.soldierWaitSelectRoot){var i=this;for(e=0;e<this.soldierWaitSelectArray.length;++e)!function(e){var o=e,a=i.soldierWaitSelectArray[e];(e=i.soldierWaitSelectedNodeArray[e])?e.active=!0:(e=cc.instantiate(i.waitSelectIconPrefab),i.soldierWaitSelectRoot.addChild(e),i.soldierWaitSelectedNodeArray.push(e)),e=e.getComponent(_.default),a=i.localSoldierPackage.getSoldier(a),e.init(a.card,function(){var e=t.localPata.getPataSlotCount();o<t.soldierWaitSelectArray.length&&(t.soldierSelectedArray.length<e?(t.soldierSelectedArray.push(t.soldierWaitSelectArray[o]),t.soldierWaitSelectArray.splice(o,1)):e<15&&g.sGViewModel.getModule(s.VMUI).addMessageTip(d.i18n.t("tips.needMorePataSlot"))),t._refresh()})}(e);for(e=this.soldierWaitSelectArray.length;e<this.soldierWaitSelectedNodeArray.length;++e)(o=this.soldierWaitSelectedNodeArray[e]).active=!1}},l([a({type:cc.Button,tooltip:"\u786e\u5b9a\u6309\u94ae"})],S.prototype,"confirmButton",void 0),l([a({type:cc.Button,tooltip:"\u5173\u95ed\u6309\u94ae"})],S.prototype,"closeButton",void 0),l([a({type:cc.Node,tooltip:"\u5f53\u524d\u9635\u5bb9"})],S.prototype,"soldierSelectedRoot",void 0),l([a({type:cc.Node,tooltip:"\u5f85\u9009\u62e9\u7684\u9635\u5bb9"})],S.prototype,"soldierWaitSelectRoot",void 0),l([a({type:cc.Prefab,tooltip:"\u56fe\u6807\u9884\u5236\u4ef6"})],S.prototype,"waitSelectIconPrefab",void 0),P=l([C,P("Game/Pata/PataSoldierSettingUI")],S),n.default=P,cc._RF.pop()},{}],promote_tip_ui:[function(t,e,o){"use strict";cc._RF.push(e,"ea8a0CoSNhAqIZjtot+DqAh","promote_tip_ui");var i,a=e,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=(u=cc._decorator).ccclass,u=(a=u.property,u.menu);function d(){var t=null!==c&&c.apply(this,arguments)||this;return t.label=null,t}r(d,c=cc.Component),d.prototype.init=function(t){this.label&&(this.label.string=t)},l([a(cc.Label)],d.prototype,"label",void 0),u=l([s,u("Game/UI/PromoteTipUI")],d),n.default=u,cc._RF.pop()},{}],pull_card_times_box_ui:[function(t,e,o){"use strict";cc._RF.push(e,"ff497GeSqJEAoPJdwFg4j52","pull_card_times_box_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("const_config"),u=a("gnode"),d=a("ggame"),p=a("gview_model"),f=a("local_card"),h=a("vm_reward"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu);function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.timesLabel=null,t.notFinishNodeArray=[],t.finishNodeArray=[],t.progressBar=null,t.collectButton=null,t}r(m,c=cc.Component),m.prototype.onLoad=function(){var t=this;this.collectButton&&this.collectButton.node.on("click",function(){d.sGGame.localModel.getModule(f.LocalCardPackage).collectPullCardTimesBox(function(e,o){e||(p.sGViewModel.getModule(h.VMReward).openRewardResult(o.rewardList,function(){}),t._refresh())})})},m.prototype.start=function(){},m.prototype.onEnable=function(){var t=this;d.sGGame.on(f.sLocalCardEvent.pullCard,function(){t._refresh()},this),this._refresh()},m.prototype.onDisable=function(){d.sGGame.targetOff(this),u.sGNode.targetOff(this)},m.prototype._refresh=function(){var t=d.sGGame.localModel.getModule(f.LocalCardPackage).cardPlayerRecord.pullCardTimesForBox,e=s.sConstConfig.config.pullCardTimeForBox;this.timesLabel&&(this.timesLabel.string=t+"/"+e),this.progressBar&&(this.progressBar.progress=t/e);for(var o,i=e<=t,a=0;a<this.notFinishNodeArray.length;++a)(o=this.notFinishNodeArray[a])&&(o.active=!i);for(a=0;a<this.finishNodeArray.length;++a)(o=this.finishNodeArray[a])&&(o.active=i)},l([a(cc.Label)],m.prototype,"timesLabel",void 0),l([a(cc.Node)],m.prototype,"notFinishNodeArray",void 0),l([a(cc.Node)],m.prototype,"finishNodeArray",void 0),l([a(cc.ProgressBar)],m.prototype,"progressBar",void 0),l([a(cc.Button)],m.prototype,"collectButton",void 0),y=l([g,y("Game/Card/PullCardTimesBoxUI")],m),n.default=y,cc._RF.pop()},{}],quest_achievement_cell_ui:[function(t,e,o){"use strict";cc._RF.push(e,"46d39Tej+pO4okeVykErpt2","quest_achievement_cell_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("quest_config"),d=a("reward_helper"),p=a("fast_scrollview_cell"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_quest"),b=a("local_quest_achievement"),_=a("local_quest_condition"),v=a("local_quest_stat"),C=a("vm_quest"),P=a("vm_reward"),S=(G=cc._decorator).ccclass,G=(a=G.property,G.menu);function M(){var t=null!==c&&c.apply(this,arguments)||this;return t.rewardIconSprite=null,t.rewardCountLabel=null,t.descLabel=null,t.commitButton=null,t.finishedNode=null,t.progressLabel=null,t.progressBar=null,t}r(M,c=cc.Component),M.prototype.reset=function(t){this.achievementRecord=t},M.prototype.onLoad=function(){var t=this;this.fastScrollviewCell=this.getComponent(p.FastScrollViewCell),this.commitButton&&this.commitButton.node.on("click",function(){f.sGAudio.playEffect(s.sAudioConfig.config.reward);var e=g.sGGame.localModel.getModule(b.default).getAchievementReward(t.achievementRecord.cid);g.sGGame.localModel.getModule(b.default).commit(t.achievementRecord.cid),t.refresh();var o=d.RewardList.createFromString(e);o.fromString(e),y.sGViewModel.getModule(P.VMReward).openRewardResult(o)},this)},M.prototype.onEnable=function(){var t=this;this.fastScrollviewCell&&this.reset(this.fastScrollviewCell.data),this.refresh(),g.sGGame.on(v.sQuestStatEvent.valueChanged,function(e){var o=u.sQuestConfig.getEntry(t.achievementRecord.questID).conditions[0];o&&e==_.eConditionType[o.conditionType]&&t.refresh()},this)},M.prototype.onDisable=function(){g.sGGame.targetOff(this),h.sGNode.targetOff(this)},M.prototype.refresh=function(){var t=g.sGGame.localModel.getModule(b.default).checkCommit(this.achievementRecord.cid),e=g.sGGame.localModel.getModule(m.LocalQuest).getQuest(this.achievementRecord.questID),o=d.RewardList.createFromString(e.entry.reward).getReward(0);this.rewardIconSprite&&h.sGNode.setSprite(this.rewardIconSprite,y.sGViewModel.getModule(P.VMReward).getIcon(o.type,o.id),this),this.rewardCountLabel&&(this.rewardCountLabel.string="x"+o.count.toString()),this.descLabel&&(this.descLabel.string=y.sGViewModel.getModule(C.VMQuest).getQuestDesc(e)),this.finishedNode&&(this.finishedNode.active=this.achievementRecord.isDone),this.commitButton&&(this.commitButton.node.active=!this.achievementRecord.isDone,this.commitButton.interactable=0===t),this.progressLabel&&(this.progressLabel.string=e.getProgressString(0)),this.progressBar&&(this.progressBar.progress=e.getProgress(0))},l([a({displayName:"\u5956\u52b1\u56fe\u6807",type:cc.Sprite})],M.prototype,"rewardIconSprite",void 0),l([a({displayName:"\u5956\u52b1\u6570\u91cf",type:cc.Label})],M.prototype,"rewardCountLabel",void 0),l([a({displayName:"\u4efb\u52a1\u5185\u5bb9",type:cc.Label})],M.prototype,"descLabel",void 0),l([a({displayName:"\u9886\u53d6\u6309\u94ae",type:cc.Button})],M.prototype,"commitButton",void 0),l([a({displayName:"\u5df2\u5b8c\u6210\u8282\u70b9",type:cc.Node})],M.prototype,"finishedNode",void 0),l([a({displayName:"\u8fdb\u5ea6\u6587\u672c",type:cc.Label})],M.prototype,"progressLabel",void 0),l([a({displayName:"\u8fdb\u5ea6\u6761",type:cc.ProgressBar})],M.prototype,"progressBar",void 0),G=l([S,G("Game/Quest/QuestAchievementCellUI")],M),n.default=G,cc._RF.pop()},{}],quest_achievement_ui:[function(t,e,o){"use strict";cc._RF.push(e,"6c79eD0OG5DObv8JyQML9KK","quest_achievement_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("quest_achievement_config"),u=a("fast_scrollview"),d=a("gnode"),p=a("ggame"),f=a("local_quest_achievement"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.fastScrollView=null,t.totalProgressLabel=null,t}r(y,c=cc.Component),y.prototype.init=function(){},y.prototype.onLoad=function(){if(this.fastScrollView){var t,e=p.sGGame.localModel.getModule(f.default);for(t in s.sQuestAchievementConfig.config){var o=s.sQuestAchievementConfig.config[t];o&&this.fastScrollView.pushCell(e.getAchievementRecord(o.id))}}},y.prototype.onEnable=function(){var t=this;p.sGGame.on(f.sQuestAchievementEvent.completed,function(){t._refresh(),t._refreshScrollview()},this),this._refresh(),this._refreshScrollview()},y.prototype.onDisable=function(){p.sGGame.targetOff(this),d.sGNode.targetOff(this)},y.prototype._refresh=function(){this.totalProgressLabel&&(this.totalProgressLabel.string=p.sGGame.localModel.getModule(f.default).count+"/"+p.sGGame.localModel.getModule(f.default).total)},y.prototype._refreshScrollview=function(){var t;this.fastScrollView&&(t=p.sGGame.localModel.getModule(f.default),this.fastScrollView.clear(!1),this.fastScrollView.cellDataList.sort(function(e,o){var i=o.data,a=e.data;return(o=t.checkCommit(i.cid))!=(e=t.checkCommit(a.cid))?e-o:a.cid-i.cid}),this.fastScrollView.initPosition())},l([a({displayName:"\u6eda\u52a8\u5c42",type:u.FastScrollView})],y.prototype,"fastScrollView",void 0),l([a({displayName:"\u603b\u8fdb\u5ea6",type:cc.Label})],y.prototype,"totalProgressLabel",void 0),g=l([h,g("Game/Quest/QuestAchievementUI")],y),n.default=g,cc._RF.pop()},{}],quest_button_ui:[function(t,e,o){"use strict";cc._RF.push(e,"ec689/wWdNI5p4fzdi9Bv2t","quest_button_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reddot"),u=a("gui"),d=a("gnode"),p=a("ggame"),f=a("gview_model"),h=a("game_define"),g=a("local_quest_main"),y=a("vm_quest"),m=(b=cc._decorator).ccclass,b=(a=b.property,b.menu);function _(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t._totalDt=0,t.hasAnyThingToDo=!1,t}r(_,c=cc.Component),_.prototype.onLoad=function(){var t=this;this.button&&(this.button.node.on("click",function(){u.sGUI.openDialogUI(h.GameDefine.prefabQuest)}),d.sGNode.addUniqueComponent(this.button,s.default).init(function(){return t.isAnythingToDo()}))},_.prototype.onEnable=function(){this.button&&(this.button.node.active=f.sGViewModel.getModule(y.VMQuest).canShowQuestButton()),this.updateHasAnyThingToDo()},_.prototype.update=function(t){this._totalDt+=t,1<=this._totalDt&&(this._totalDt=0,this.button&&!this.button.node.active&&(this.button.node.active=p.sGGame.localModel.getModule(g.default).isQuestMainDone()),this.updateHasAnyThingToDo())},_.prototype.isAnythingToDo=function(){return f.sGViewModel.getModule(y.VMQuest).hasAnyQuestCanCommit()},_.prototype.updateHasAnyThingToDo=function(){var t=this.isAnythingToDo();t!==this.hasAnyThingToDo&&(this.hasAnyThingToDo=t)},l([a({displayName:"",type:cc.Button})],_.prototype,"button",void 0),b=l([m,b("Game/Quest/QuestButtonUI")],_),n.default=b,cc._RF.pop()},{}],quest_daily_cell_ui:[function(t,e,o){"use strict";cc._RF.push(e,"617b3P8CCRNcJXo2j+wWwjn","quest_daily_cell_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("quest_config"),d=a("reward_helper"),p=a("fast_scrollview_cell"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_quest"),b=a("local_quest_condition"),_=a("local_quest_daily"),v=a("local_quest_stat"),C=a("vm_quest"),P=a("vm_reward"),S=(G=cc._decorator).ccclass,G=(a=G.property,G.menu);function M(){var t=null!==c&&c.apply(this,arguments)||this;return t.rewardIconSprite=null,t.rewardCountLabel=null,t.descLabel=null,t.commitButton=null,t.finishedNode=null,t.progressLabel=null,t.progressBar=null,t}r(M,c=cc.Component),M.prototype.reset=function(t){this.dailyRecord=t},M.prototype.onLoad=function(){var t=this;this.fastScrollviewCell=this.getComponent(p.FastScrollViewCell),this.commitButton&&this.commitButton.node.on("click",function(){f.sGAudio.playEffect(s.sAudioConfig.config.reward);var e=g.sGGame.localModel.getModule(_.LocalDailyQuest),o=e.getDailyQuestReward(t.dailyRecord.cid);e.commit(t.dailyRecord.cid),t.refresh(),(e=d.RewardList.createFromString(o)).fromString(o),y.sGViewModel.getModule(P.VMReward).openRewardResult(e)},this)},M.prototype.onEnable=function(){var t=this;this.fastScrollviewCell&&this.reset(this.fastScrollviewCell.data),this.refresh(),g.sGGame.on(v.sQuestStatEvent.valueChanged,function(e){var o=u.sQuestConfig.getEntry(t.dailyRecord.questID).conditions[0];o&&e==b.eConditionType[o.conditionType]&&t.refresh()},this)},M.prototype.onDisable=function(){g.sGGame.targetOff(this),h.sGNode.targetOff(this)},M.prototype.refresh=function(){var t=g.sGGame.localModel.getModule(_.LocalDailyQuest).checkCommit(this.dailyRecord.cid),e=g.sGGame.localModel.getModule(m.LocalQuest).getQuest(this.dailyRecord.questID),o=d.RewardList.createFromString(e.entry.reward).getReward(0);this.rewardIconSprite&&h.sGNode.setSprite(this.rewardIconSprite,y.sGViewModel.getModule(P.VMReward).getIcon(o.type,o.id),this),this.rewardCountLabel&&(this.rewardCountLabel.string="x"+o.count.toString()),this.descLabel&&(this.descLabel.string=y.sGViewModel.getModule(C.VMQuest).getQuestDesc(e)),this.finishedNode&&(this.finishedNode.active=this.dailyRecord.isDone),this.commitButton&&(this.commitButton.node.active=!this.dailyRecord.isDone,this.commitButton.interactable=0===t),this.progressLabel&&(this.progressLabel.string=e.getProgressString(0)),this.progressBar&&(this.progressBar.progress=e.getProgress(0))},l([a({displayName:"\u5956\u52b1\u56fe\u6807",type:cc.Sprite})],M.prototype,"rewardIconSprite",void 0),l([a({displayName:"\u5956\u52b1\u6570\u91cf",type:cc.Label})],M.prototype,"rewardCountLabel",void 0),l([a({displayName:"\u4efb\u52a1\u5185\u5bb9",type:cc.Label})],M.prototype,"descLabel",void 0),l([a({displayName:"\u9886\u53d6\u6309\u94ae",type:cc.Button})],M.prototype,"commitButton",void 0),l([a({displayName:"\u5df2\u5b8c\u6210\u8282\u70b9",type:cc.Node})],M.prototype,"finishedNode",void 0),l([a({displayName:"\u8fdb\u5ea6\u6587\u672c",type:cc.Label})],M.prototype,"progressLabel",void 0),l([a({displayName:"\u8fdb\u5ea6\u6761",type:cc.ProgressBar})],M.prototype,"progressBar",void 0),G=l([S,G("Game/Quest/QuestDailyCellUI")],M),n.default=G,cc._RF.pop()},{}],quest_daily_ui:[function(t,e,o){"use strict";cc._RF.push(e,"74ef3IYekJNw5B44AyE+jwG","quest_daily_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("quest_daily_config"),u=a("fast_scrollview"),d=a("gnode"),p=a("ggame"),f=a("local_quest_daily"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.fastScrollView=null,t}r(y,c=cc.Component),y.prototype.init=function(){},y.prototype.onLoad=function(){if(this.fastScrollView){var t,e=p.sGGame.localModel.getModule(f.LocalDailyQuest);for(t in s.sQuestDailyConfig.config){var o=s.sQuestDailyConfig.config[t];o&&this.fastScrollView.pushCell(e.getDailyQuest(o.id))}}},y.prototype.onEnable=function(){var t=this;p.sGGame.on(f.sDailyQuestEvent.dailyQuestComplete,function(){t._refreshScrollview()},this),this._refreshScrollview()},y.prototype.onDisable=function(){p.sGGame.targetOff(this),d.sGNode.targetOff(this)},y.prototype._refreshScrollview=function(){var t;this.fastScrollView&&(t=p.sGGame.localModel.getModule(f.LocalDailyQuest),this.fastScrollView.clear(!1),this.fastScrollView.cellDataList.sort(function(e,o){var i=o.data,a=e.data;return(o=t.checkCommit(i.cid))!=(e=t.checkCommit(a.cid))?e-o:a.cid-i.cid}),this.fastScrollView.initPosition())},l([a({displayName:"\u6eda\u52a8\u5c42",type:u.FastScrollView})],y.prototype,"fastScrollView",void 0),g=l([h,g("Game/Quest/QuestDailyUI")],y),n.default=g,cc._RF.pop()},{}],quest_main_complete_ui:[function(t,e,o){"use strict";cc._RF.push(e,"8ee68hQxj9PzLMJIQ2myKBe","quest_main_complete_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("reward_helper"),d=a("gaudio"),p=a("gnode"),f=a("ggame"),h=a("gview_model"),g=a("local_quest"),y=a("local_quest_main"),m=a("vm_quest"),b=a("vm_reward"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.questDescLabel=null,t.questRewardLabel=null,t.questRewardSprite=null,t.commitButton=null,t}r(C,c=cc.Component),C.prototype.onLoad=function(){var t=this;this.localQuestMain=f.sGGame.localModel.getModule(y.default),this.localQuest=f.sGGame.localModel.getModule(g.LocalQuest),this.commitButton&&this.commitButton.node.on("click",function(){d.sGAudio.playEffect(s.sAudioConfig.config.reward);var e=t.commitCallback;h.sGViewModel.getModule(m.VMQuest).commitQuestMain(function(){e&&e()}),p.sGNode.destoryNode(t.node)},this)},C.prototype.onEnable=function(){d.sGAudio.playEffect(s.sAudioConfig.config.victory),p.sGNode.updateWidgetImmediately(this.node),this.refresh()},C.prototype.onDisable=function(){f.sGGame.targetOff(this),p.sGNode.targetOff(this)},C.prototype.refresh=function(){var t,e,o=this.localQuestMain.getQuestMainEntry();o?(e=this.localQuest.getQuest(o.id),t=h.sGViewModel.getModule(m.VMQuest),this.questDescLabel&&(this.questDescLabel.string=t.getQuestDesc(e)),this.questRewardLabel&&(this.questRewardLabel.string=t.getQuestReward(e)),this.questRewardSprite&&(e=u.RewardList.createFromString(o.reward).getReward(0),p.sGNode.setSprite(this.questRewardSprite,e?h.sGViewModel.getModule(b.VMReward).getIcon(e.type,e.id):o.icon,this))):p.sGNode.destoryNode(this.node)},l([a({displayName:"\u4efb\u52a1\u5185\u5bb9",type:cc.Label})],C.prototype,"questDescLabel",void 0),l([a({displayName:"\u4efb\u52a1\u5956\u52b1",type:cc.Label})],C.prototype,"questRewardLabel",void 0),l([a({displayName:"\u4efb\u52a1\u5956\u52b1\u56fe\u6807",type:cc.Sprite})],C.prototype,"questRewardSprite",void 0),l([a({displayName:"\u9886\u53d6\u6309\u94ae",type:cc.Button})],C.prototype,"commitButton",void 0),v=l([_,v("Game/UI/QuestMainUI")],C),n.default=v,cc._RF.pop()},{}],quest_main_pop_ui:[function(t,e,o){"use strict";cc._RF.push(e,"283b0DmH/dPcZAQNObSOtQE","quest_main_pop_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("reward_helper"),d=a("gaudio"),p=a("gnode"),f=a("ggame"),h=a("gview_model"),g=a("local_quest"),y=a("local_quest_main"),m=a("vm_quest"),b=a("vm_reward"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.questDescLabel=null,t.questProgressLabel=null,t.questProgressBar=null,t.questRewardLabel=null,t.questRewardSprite=null,t.gotoButton=null,t}r(C,c=cc.Component),C.prototype.onLoad=function(){var t=this;this.localQuestMain=f.sGGame.localModel.getModule(y.default),this.localQuest=f.sGGame.localModel.getModule(g.LocalQuest),this.gotoButton&&this.gotoButton.node.on("click",function(){d.sGAudio.playEffect(s.sAudioConfig.config.buttonClick);var e=t.localQuest.getQuest(t.localQuestMain.getQuestMainID());e&&(p.sGNode.destoryNode(t.node),h.sGViewModel.getModule(m.VMQuest).goto(e))},this)},C.prototype.onEnable=function(){var t=this;p.sGNode.updateWidgetImmediately(this.node),f.sGGame.on(y.sQuestMainEvent.completed,function(){t.refresh()},this),f.sGGame.on(g.sQuestEvent.conditionChanged,function(e){t.localQuestMain.getQuestMainID()==e&&t.refresh()},this),this.refresh()},C.prototype.onDisable=function(){f.sGGame.targetOff(this),p.sGNode.targetOff(this)},C.prototype.refresh=function(){var t,e,o=this.localQuestMain.getQuestMainEntry();o?(t=this.localQuest.getQuest(o.id),e=h.sGViewModel.getModule(m.VMQuest),this.questDescLabel&&(this.questDescLabel.string=e.getQuestDesc(t)),this.questRewardLabel&&(this.questRewardLabel.string=e.getQuestReward(t)),this.questProgressLabel&&(this.questProgressLabel.string=t.getProgressString(0)),this.questProgressBar&&(this.questProgressBar.progress=t.getProgress(0)),this.questRewardSprite&&(e=u.RewardList.createFromString(o.reward).getReward(0),p.sGNode.setSprite(this.questRewardSprite,e?h.sGViewModel.getModule(b.VMReward).getIcon(e.type,e.id):o.icon,this)),this.gotoButton&&(this.gotoButton.node.active=h.sGViewModel.getModule(m.VMQuest).hasGoto(t))):p.sGNode.destoryNode(this.node)},l([a({displayName:"\u4efb\u52a1\u5185\u5bb9",type:cc.Label})],C.prototype,"questDescLabel",void 0),l([a({displayName:"\u4efb\u52a1\u8fdb\u5ea6",type:cc.Label})],C.prototype,"questProgressLabel",void 0),l([a({displayName:"\u4efb\u52a1\u8fdb\u5ea6\u8fdb\u5ea6\u6761",type:cc.ProgressBar})],C.prototype,"questProgressBar",void 0),l([a({displayName:"\u4efb\u52a1\u5956\u52b1",type:cc.Label})],C.prototype,"questRewardLabel",void 0),l([a({displayName:"\u4efb\u52a1\u5956\u52b1\u56fe\u6807",type:cc.Sprite})],C.prototype,"questRewardSprite",void 0),l([a({displayName:"\u524d\u5f80\u6309\u94ae",type:cc.Button})],C.prototype,"gotoButton",void 0),v=l([_,v("Game/UI/QuestMainPopUI")],C),n.default=v,cc._RF.pop()},{}],quest_main_ui:[function(t,e,o){"use strict";cc._RF.push(e,"b9a4flMvxhH1KINfrNGRg74","quest_main_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("reward_helper"),d=a("gaudio"),p=a("gnode"),f=a("ggame"),h=a("gview_model"),g=a("local_quest"),y=a("local_quest_main"),m=a("vm_quest"),b=a("vm_reward"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.rootNode=null,t.questDescLabel=null,t.questProgressBar=null,t.questProgressLabel=null,t.questRewardLabel=null,t.questRewardSprite=null,t.animation=null,t.detailButton=null,t.completeButton=null,t.gotoButton=null,t.isPop=!1,t.popTime=0,t}r(C,c=cc.Component),C.prototype.onLoad=function(){var t=this;this.localQuestMain=f.sGGame.localModel.getModule(y.default),this.localQuest=f.sGGame.localModel.getModule(g.LocalQuest),this.detailButton&&this.detailButton.node.on("click",function(){},this),this.completeButton&&this.completeButton.node.on("click",function(){d.sGAudio.playEffect(s.sAudioConfig.config.reward),d.sGAudio.playEffect(s.sAudioConfig.config.completeQuestMain),h.sGViewModel.getModule(m.VMQuest).commitQuestMain(void 0)},this),this.gotoButton&&this.gotoButton.node.on("click",function(){d.sGAudio.playEffect(s.sAudioConfig.config.buttonClick);var e=t.localQuest.getQuest(t.localQuestMain.getQuestMainID());e&&h.sGViewModel.getModule(m.VMQuest).goto(e)},this)},C.prototype.onEnable=function(){var t=this;p.sGNode.updateWidgetImmediately(this.node),f.sGGame.on(y.sQuestMainEvent.completed,function(){t.refresh()},this),f.sGGame.on(g.sQuestEvent.conditionChanged,function(e){t.localQuestMain.getQuestMainID()==e&&t.refresh()},this),this.refresh(),this.isPop=!1},C.prototype.onDisable=function(){f.sGGame.targetOff(this),p.sGNode.targetOff(this)},C.prototype.update=function(){},C.prototype.switchPopState=function(){this.isPop?this.playBackAnimation():this.playPopAnimation()},C.prototype.playPopAnimation=function(){this.isPop||(this.isPop=!0,this.popTime=0,this.animation&&this.animation.play("main_task_pop_anim"))},C.prototype.playBackAnimation=function(){this.isPop&&(this.isPop=!1,this.animation&&this.animation.play("main_task_back_anim"))},C.prototype.refresh=function(){var t,e,o=this.localQuestMain.getQuestMainEntry();this.rootNode&&(this.rootNode.active=!!o&&this.localQuestMain.isQuestMainOpen()),o&&(t=h.sGViewModel.getModule(m.VMQuest),e=this.localQuest.getQuest(o.id),this.questDescLabel&&(this.questDescLabel.string=t.getQuestDesc(e)),this.questRewardLabel&&(this.questRewardLabel.string=t.getQuestReward(e)),this.questProgressBar&&(this.questProgressBar.progress=e.getProgress(0)),this.questProgressLabel&&(this.questProgressLabel.string=e.getProgressString(0)),this.questRewardSprite&&(t=u.RewardList.createFromString(o.reward).getReward(0),p.sGNode.setSprite(this.questRewardSprite,t?h.sGViewModel.getModule(b.VMReward).getIcon(t.type,t.id):o.icon,this)),o=e.isCompleted(),e=h.sGViewModel.getModule(m.VMQuest).hasGoto(e),this.completeButton&&(this.completeButton.node.active=o||!e,this.completeButton.interactable=o),this.gotoButton&&(this.gotoButton.node.active=!o&&e))},l([a({displayName:"\u5c55\u793a\u8282\u70b9",type:cc.Node})],C.prototype,"rootNode",void 0),l([a({displayName:"\u4efb\u52a1\u5185\u5bb9",type:cc.Label})],C.prototype,"questDescLabel",void 0),l([a({displayName:"\u4efb\u52a1\u8fdb\u5ea6\u6761",type:cc.ProgressBar})],C.prototype,"questProgressBar",void 0),l([a({displayName:"\u4efb\u52a1\u8fdb\u5ea6\u6587\u672c",type:cc.Label})],C.prototype,"questProgressLabel",void 0),l([a({displayName:"\u4efb\u52a1\u5956\u52b1",type:cc.Label})],C.prototype,"questRewardLabel",void 0),l([a({displayName:"\u4efb\u52a1\u5956\u52b1\u56fe\u6807",type:cc.Sprite})],C.prototype,"questRewardSprite",void 0),l([a({displayName:"\u4efb\u52a1\u754c\u9762\u52a8\u753b",type:cc.Animation})],C.prototype,"animation",void 0),l([a({displayName:"\u8be6\u60c5\u6309\u94ae",type:cc.Button})],C.prototype,"detailButton",void 0),l([a({displayName:"\u9886\u53d6\u6309\u94ae",type:cc.Button})],C.prototype,"completeButton",void 0),l([a({displayName:"\u524d\u5f80\u6309\u94ae",type:cc.Button})],C.prototype,"gotoButton",void 0),v=l([_,v("Game/UI/QuestMainUI")],C),n.default=v,cc._RF.pop()},{}],quest_root_ui:[function(t,e,o){"use strict";cc._RF.push(e,"db07fzAvS5A+by24QGxHorN","quest_root_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.eQuestTabType=void 0;var s,u,d=a("reddot"),p=a("audio_config"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("local_quest_achievement"),m=a("local_quest_daily"),b=cc._decorator,_=b.ccclass;function v(){var t=null!==u&&u.apply(this,arguments)||this;return t.tabToggleContainer=null,t.tabRootNode=null,t.tabPrefabArray=[],t.reddotNodeArray=[],t.tabType=s.daily,t.tabNodeDic={},t}n=b.property,a=b.menu,(b=s=r.eQuestTabType||(r.eQuestTabType={}))[b.daily=0]="daily",b[b.achievement=1]="achievement",l(v,u=cc.Component),v.prototype.init=function(t){this.tabType=t},v.prototype.onLoad=function(){var t=this;if(this.tabToggleContainer){var e,o=this;for(e in this.tabToggleContainer.toggleItems)!function(e){o.tabToggleContainer.toggleItems[e].node.on("toggle",function(){f.sGAudio.playEffect(p.sAudioConfig.config.switchTab),t.switchTab(parseInt(e))})}(e)}this.reddotNodeArray[s.achievement]&&h.sGNode.addUniqueComponent(this.reddotNodeArray[s.achievement],d.default).init(function(){return t.tabType!=s.achievement&&g.sGGame.localModel.getModule(y.default).isAnyThingTodo()}),this.reddotNodeArray[s.daily]&&h.sGNode.addUniqueComponent(this.reddotNodeArray[s.daily],d.default).init(function(){return t.tabType!=s.daily&&g.sGGame.localModel.getModule(m.LocalDailyQuest).hasAnyThingTodo()})},v.prototype.onEnable=function(){if(f.sGAudio.playEffect(p.sAudioConfig.config.popUI),this.tabToggleContainer)for(var t in this.tabToggleContainer.toggleItems)parseInt(t)===this.tabType&&this.tabToggleContainer.toggleItems[t].check();this.refreshTab()},v.prototype.onDisable=function(){g.sGGame.targetOff(this),h.sGNode.targetOff(this)},v.prototype.switchTab=function(t){this.tabType!==t&&(this.tabType=t,this.refreshTab())},v.prototype.refreshTab=function(){if(this.tabRootNode){this.currentTabNode&&(this.currentTabNode.active=!1);var t=this.tabNodeDic[this.tabType];if(t)t.active=!0;else{var e=this.tabPrefabArray[this.tabType];if(!e)return;t=cc.instantiate(e),this.tabRootNode.addChild(t)}this.currentTabNode=t}},c([n({displayName:"\u6807\u7b7e\u9875\u5207\u6362\u8282\u70b9",type:cc.ToggleContainer})],v.prototype,"tabToggleContainer",void 0),c([n({displayName:"\u6807\u7b7e\u9875\u5c55\u793a\u8282\u70b9",type:cc.Node})],v.prototype,"tabRootNode",void 0),c([n({displayName:"\u6807\u7b7e\u9875\u9884\u5236\u4ef6",type:cc.Prefab})],v.prototype,"tabPrefabArray",void 0),c([n({displayName:"\u7ea2\u70b9",type:cc.Node})],v.prototype,"reddotNodeArray",void 0),a=c([_,a("Game/Quest/QuestRootUI")],v),r.default=a,cc._RF.pop()},{}],quest_token_reward_ui:[function(t,e,o){"use strict";cc._RF.push(e,"f77f3kkYo9DfbUGIvt7yEYJ","quest_token_reward_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("local_currency"),u=a("audio_config"),d=a("const_config"),p=a("encourage_config"),f=a("reward_helper"),h=a("gaudio"),g=a("gnode"),y=a("ggame"),m=a("gview_model"),b=a("local_quest_achievement"),_=a("vm_reward"),v=(C=cc._decorator).ccclass,C=(a=C.property,C.menu);function P(){var t=null!==c&&c.apply(this,arguments)||this;return t.rewardIconSprite=null,t.rewardCountLabel=null,t.priceLabel=null,t.priceProgressLabel=null,t.priceProgressBar=null,t.takeRewardButton=null,t}r(P,c=cc.Component),P.prototype.init=function(){},P.prototype.onLoad=function(){var t=this;this.reward=f.RewardList.createFromString(d.sConstConfig.config.exchangeQuestTokenReward).getReward(0),this.takeRewardButton&&this.takeRewardButton.node.on("click",function(){h.sGAudio.playEffect(u.sAudioConfig.config.reward),y.sGGame.localModel.getModule(b.default).exchangeQuestToken(),t.refresh(),m.sGViewModel.getModule(_.VMReward).openRewardCurrency(t.reward,p.sEncourageConfig.config.moreQuestTokenReward)})},P.prototype.onEnable=function(){var t=this;this.refresh(),y.sGGame.on(s.sLocalCurrencyEvent.changed,function(){t.refresh()},this)},P.prototype.onDisable=function(){y.sGGame.targetOff(this),g.sGNode.targetOff(this)},P.prototype.refresh=function(){var t=this.reward;this.rewardIconSprite&&g.sGNode.setSprite(this.rewardIconSprite,m.sGViewModel.getModule(_.VMReward).getIcon(t.type,t.id),this),this.rewardCountLabel&&(this.rewardCountLabel.string="x"+t.count.toString()),t=y.sGGame.localModel.getModule(b.default),this.priceProgressLabel&&(this.priceProgressLabel.string=t.getExchangeProgressText()),t=t.getExchangeProgress(),this.priceProgressBar&&(this.priceProgressBar.progress=t),this.priceLabel&&(this.priceLabel.string=d.sConstConfig.config.exchangeQuestTokenPrice.toString()),this.takeRewardButton&&(this.takeRewardButton.interactable=1==t)},l([a({displayName:"\u5956\u52b1\u56fe\u6807",type:cc.Sprite})],P.prototype,"rewardIconSprite",void 0),l([a({displayName:"\u5956\u52b1\u6570\u91cf",type:cc.Label})],P.prototype,"rewardCountLabel",void 0),l([a({displayName:"\u5956\u52b1\u4ef7\u683c",type:cc.Label})],P.prototype,"priceLabel",void 0),l([a({displayName:"\u8fdb\u5ea6\u6587\u672c",type:cc.Label})],P.prototype,"priceProgressLabel",void 0),l([a({displayName:"\u603b\u8fdb\u5ea6",type:cc.ProgressBar})],P.prototype,"priceProgressBar",void 0),l([a({displayName:"\u9886\u53d6\u6309\u94ae",type:cc.Button})],P.prototype,"takeRewardButton",void 0),C=l([v,C("Game/Quest/QuestTokenRewardUI")],P),n.default=C,cc._RF.pop()},{}],reason_define:[function(t,e,o){"use strict";cc._RF.push(e,"70e19pGdW5OQrOO5DbxaWjE","reason_define");var i=o;Object.defineProperty(i,"__esModule",{value:!0}),i.eReasonType=void 0,(i=i.eReasonType||(i.eReasonType={}))[i.recover=0]="recover",i[i.adVip=1]="adVip",i[i.slotMmachine=2]="slotMmachine",i[i.encourage=3]="encourage",i[i.battleVictory=4]="battleVictory",i[i.battleSweep=5]="battleSweep",i[i.battleExtendReward=6]="battleExtendReward",i[i.questDailyChest=7]="questDailyChest",i[i.commitQuest=8]="commitQuest",i[i.airDrop=9]="airDrop",i[i.checkIn7Days=10]="checkIn7Days",i[i.checkInDaily=11]="checkInDaily",i[i.checkInBeginner=12]="checkInBeginner",i[i.upgradeBuilding=13]="upgradeBuilding",i[i.pullCard=14]="pullCard",i[i.pullCard10Times=15]="pullCard10Times",i[i.upgradeTech=16]="upgradeTech",i[i.freeMultiPullCard=17]="freeMultiPullCard",i[i.normalPullCard=18]="normalPullCard",i[i.advancePullCard=19]="advancePullCard",i[i.unlockCard=20]="unlockCard",i[i.collectInBuilding=21]="collectInBuilding",i[i.collectOfflineUpgradePointWithAD=22]="collectOfflineUpgradePointWithAD",i[i.collectOfflineUpgradePoint=23]="collectOfflineUpgradePoint",i[i.collectInPata=24]="collectInPata",i[i.collectInPataWithAD=25]="collectInPataWithAD",i[i.upgradeCard=26]="upgradeCard",i[i.test=27]="test",i[i.exchangeQuestToken=28]="exchangeQuestToken",i[i.moreQuestTokenReward=29]="moreQuestTokenReward",i[i.pullCardTimesBox=30]="pullCardTimesBox",i[i.buyGoods=31]="buyGoods",i[i.fuben1Collect=32]="fuben1Collect",i[i.fuben2Collect=33]="fuben2Collect",i[i.fuben1DoubleCollect=34]="fuben1DoubleCollect",i[i.fuben2DoubleCollect=35]="fuben2DoubleCollect",cc._RF.pop()},{}],reward_card10_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"49b5erQKD5IIqX/Z8mUwNbz","reward_card10_icon_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("i18n"),u=a("gnode"),d=a("ggame"),p=a("local_card"),f=a("local_reward"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.cardRoot=null,t.card2FragmentRoot=null,t.anim=null,t}r(y,c=cc.Component),y.prototype.init=function(t){this.reward=t},y.prototype.onLoad=function(){},y.prototype.update=function(){},y.prototype.onEnable=function(){this._refresh()},y.prototype.onDisable=function(){u.sGNode.targetOff(this)},y.prototype.playAnimation=function(t){this.reward.type===f.eRewardType.card?t&&t():this.reward.type===f.eRewardType.card2Fragment&&u.sGNode.playAnimation(this.node,"get10_goods_icon_anim",function(){t&&t()})},y.prototype._refresh=function(){this.card2FragmentRoot&&(this.card2FragmentRoot.scale=0),this.reward.type===f.eRewardType.card?this._setCardIcon():this.reward.type===f.eRewardType.card2Fragment&&(this._setCardIcon(),this._setCardToFragmentIcon())},y.prototype._setCardIcon=function(){var t,e,o,i;this.cardRoot&&(e=this.reward,t=d.sGGame.localModel.getModule(p.LocalCardPackage).getCard(e.id),(o=u.sGNode.findComponent(this.cardRoot,"icon2",cc.Sprite))&&u.sGNode.setSprite(o,t.entry.bigIcon,this),(i=u.sGNode.findComponent(this.cardRoot,"Label_name",cc.Label))&&(i.string=s.i18n.t(t.entry.name)),e=cc.find("quality_root/quality1",this.cardRoot),o=cc.find("quality_root/quality2",this.cardRoot),i=cc.find("quality_root/quality3",this.cardRoot),e&&(e.active=3===t.entry.quality),o&&(o.active=4===t.entry.quality),i&&(i.active=5===t.entry.quality))},y.prototype._setCardToFragmentIcon=function(){var t,e,o,i,a;this.card2FragmentRoot&&(t=this.reward,a=d.sGGame.localModel.getModule(p.LocalCardPackage).getCard(t.id),(o=u.sGNode.findComponent(this.card2FragmentRoot,"icon2",cc.Sprite))&&u.sGNode.setSprite(o,a.entry.bigIcon,this),(i=u.sGNode.findComponent(this.card2FragmentRoot,"Label_name",cc.Label))&&(i.string=s.i18n.t(a.entry.name)),e=cc.find("quality_root/quality1",this.card2FragmentRoot),o=cc.find("quality_root/quality2",this.card2FragmentRoot),i=cc.find("quality_root/quality3",this.card2FragmentRoot),e&&(e.active=3===a.entry.quality),o&&(o.active=4===a.entry.quality),i&&(i.active=5===a.entry.quality),(a=u.sGNode.findComponent(this.card2FragmentRoot,"Label_number",cc.Label))&&(a.string="x"+t.count))},l([a(cc.Node)],y.prototype,"cardRoot",void 0),l([a(cc.Node)],y.prototype,"card2FragmentRoot",void 0),g=l([h,g("Game/Reward/RewardCard10IconUI")],y),n.default=g,cc._RF.pop()},{}],reward_card10_ui:[function(t,e,o){"use strict";cc._RF.push(e,"145e2jWfONIWL/TiS3kroue","reward_card10_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("spine_controller"),d=a("gaudio"),p=a("gnode"),f=a("reward_card10_icon_ui"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.cardIconPrefab=null,t.cardIconRoot=null,t.closeButton=null,t.anim=null,t.cardFlipSpine=null,t.closeCallback=null,t.cardIconUIArray=[],t}r(y,c=cc.Component),y.prototype.init=function(t,e){this.rewardList=t,this.closeCallback=e},y.prototype.onLoad=function(){var t=this;this.closeButton&&this.closeButton.node.on("click",function(){d.sGAudio.playEffect(s.sAudioConfig.config.reward),t.closeCallback&&t.closeCallback(),p.sGNode.destoryNode(t.node)})},y.prototype.update=function(){},y.prototype.onEnable=function(){var t=this;this.cardIconUIArray=[];for(var e,o=1;o<=10;o++){var i=this.cardIconRoot.getChildByName("icon_root"+o);if(!i)break;var a,n=cc.instantiate(this.cardIconPrefab);n&&((a=n.getComponent(f.default)).init(this.rewardList.getReward(o-1)),i.addChild(n),this.cardIconUIArray.push(a))}this.cardFlipSpine&&(this.anim&&(this.anim.node.active=!1),this.cardFlipSpine.node.active=!0,(e=this.cardFlipSpine.getComponent(u.default))&&(e.setEvent("end",function(){t.anim&&(t.anim.node.active=!0)}),e.setCompleteListener(function(){t.anim&&(t.anim.node.active=!0),t.cardFlipSpine.node.active=!1,d.sGAudio.playEffect(s.sAudioConfig.config.reward),t.playAnimation(),t.cardFlipSpine.setCompleteListener(null)})),this.cardFlipSpine.findAnimation("animation1")?this.cardFlipSpine.setAnimation(0,"animation1",!1):this.cardFlipSpine.findAnimation("open")&&this.cardFlipSpine.setAnimation(0,"open",!1))},y.prototype.onDisable=function(){p.sGNode.targetOff(this)},y.prototype.playAnimation=function(){var t=this;this.anim?(d.sGAudio.playEffect(s.sAudioConfig.config.reward),p.sGNode.playAnimation(this.anim.node,0,function(){for(var e=t.cardIconPlayFinishCount=0;e<t.cardIconUIArray.length;++e){var o=t.cardIconUIArray[e];o&&o.playAnimation(function(){t.cardIconPlayFinishCount++,t.cardIconPlayFinishCount===t.cardIconUIArray.length&&t.onAnimtionFinish()})}})):this.onAnimtionFinish()},y.prototype.onAnimtionFinish=function(){},l([a(cc.Prefab)],y.prototype,"cardIconPrefab",void 0),l([a(cc.Node)],y.prototype,"cardIconRoot",void 0),l([a(cc.Button)],y.prototype,"closeButton",void 0),l([a(cc.Animation)],y.prototype,"anim",void 0),l([a(sp.Skeleton)],y.prototype,"cardFlipSpine",void 0),g=l([h,g("Game/Reward/RewardCard10UI")],y),n.default=g,cc._RF.pop()},{}],reward_currency_ui:[function(t,e,o){"use strict";cc._RF.push(e,"c9edcoyn4tGl5vF9wHhUWl3","reward_currency_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("scroll_number"),u=a("gnode"),d=(p=cc._decorator).ccclass,p=(a=p.property,p.menu);function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.flyNodeRoot=null,t.valueLabel=null,t.anim=null,t.iconRootArray=[],t.inited=!1,t.scrollNumber=null,t.fromWorldPos=null,t}r(f,c=cc.Component),f.prototype.init=function(t,e,o,i){this.fromWorldPos=t,this.fromNumber=o,this.toNumber=i,this.currencyEntry=e,this.inited=!0,this.enabledInHierarchy&&this.flyToIcon()},f.prototype.onLoad=function(){},f.prototype.onEnable=function(){this.valueLabel&&(this.scrollNumber=u.sGNode.addUniqueComponent(this.valueLabel,s.default)),u.sGNode.updateWidgetImmediately(this.node),this.flyToIcon()},f.prototype.onDisable=function(){u.sGNode.targetOff(this)},f.prototype.flyToIcon=function(){var t=this;if(this.anim&&this.inited){for(var e=0;e<this.iconRootArray.length;++e){var o=this.iconRootArray[e];o&&u.sGNode.setSprite(o,this.currencyEntry.flyIcon,this)}this.anim.play(),this.anim.sample(this.anim.currentClip.name),this.anim.on("finished",function(){u.sGNode.destoryNode(t.node)},this),this.scrollNumber&&this.scrollNumber.setNumber(this.fromNumber,!1);var i=this;for(e=1;"break"!==function(e){var o=i.flyNodeRoot.getChildByName("node"+e);if(!o)return"break";var a=u.sGNode.convertToNodeSpaceAR(o.parent,i.fromWorldPos);o.setPosition(a),o.active=!0,o.scale=.5;var n=cc.v2(),r=Math.floor(n.x-a.x);e=Math.floor(n.y-a.y),e=cc.v2(a.x+(Math.random()*r*2-r),a.y+Math.random()*e/2+e/4),cc.tween(o).bezierTo(1,a,e,n).call(function(){t.scrollNumber&&t.scrollNumber.setNumber(t.toNumber,!0),o.active=!1}).start()}(e);++e);}},l([a(cc.Node)],f.prototype,"flyNodeRoot",void 0),l([a(cc.Label)],f.prototype,"valueLabel",void 0),l([a(cc.Animation)],f.prototype,"anim",void 0),l([a(cc.Sprite)],f.prototype,"iconRootArray",void 0),p=l([d,p("Game/Reward/RewardCurrencyUI")],f),n.default=p,cc._RF.pop()},{}],reward_ui:[function(t,e,o){"use strict";cc._RF.push(e,"94eb6IUYytHEZTsUysiIlGm","reward_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var s,u=a("audio_config"),d=a("spine_controller"),p=a("i18n"),f=a("gaudio"),h=a("glog"),g=a("gnode"),y=a("gnumber"),m=a("ggame"),b=a("gview_model"),_=a("local_card"),v=a("local_reward"),C=a("vm_card"),P=cc._decorator,S=P.ccclass,G=(n=P.property,a=P.menu,(P={})[v.eRewardType.buildingUpgradePoint]="buildingUpgradePoint",P[v.eRewardType.cardUpgradePoint]="cardUpgradePoint",P[v.eRewardType.pullCardPoint]="pullCardPoint",P[v.eRewardType.cardFragment]="cardFragment",P[v.eRewardType.card]="card",P[v.eRewardType.card2Fragment]="card2Fragment",P[v.eRewardType.randomCard]="randomCard",P[v.eRewardType.questToken]="questToken",P);function M(){var t=null!==s&&s.apply(this,arguments)||this;return t.currencyIconRoot=null,t.rewardLabel=null,t.closeButton=null,t.cardFlipSpine=null,t.closeCallback=null,t.animationCanSkip=null,t}l(M,s=cc.Component),M.prototype.init=function(t,e){this.reward=t,this.closeCallback=e},M.prototype.onLoad=function(){this.closeButton&&this.closeButton.on("click",this.onClickClose.bind(this))},M.prototype.update=function(){},M.prototype.onEnable=function(){this.cardFlipSpine&&(this.cardFlipSpine.node.active=!1),this._refresh()},M.prototype.onDisable=function(){g.sGNode.targetOff(this)},M.prototype._refresh=function(){var t=G[this.reward.type],e=this.reward.count;switch(this.closeButton&&(this.closeButton.active=!0),h.sGLog.debug("_playRewardAnimation",t,e),this.reward.type){case v.eRewardType.buildingUpgradePoint:case v.eRewardType.cardUpgradePoint:case v.eRewardType.pullCardPoint:case v.eRewardType.questToken:this.rewardLabel&&(this.rewardLabel.node.active=!0,this.rewardLabel.string="x"+y.sGNumber.toHuman(e));break;case v.eRewardType.card:this.rewardLabel&&(this.rewardLabel.node.active=!1),this._setCardIcon();break;case v.eRewardType.cardFragment:this.rewardLabel&&(this.rewardLabel.node.active=!0,this.rewardLabel.string="x"+e.toString()),this._setCardFragmentIcon();break;case v.eRewardType.card2Fragment:this.rewardLabel&&(this.rewardLabel.node.active=!0,this.rewardLabel.string="x"+e.toString()),this._setCardToFragmentIcon();break;default:this.rewardLabel&&(this.rewardLabel.node.active=!0,this.rewardLabel.string="x"+e.toString())}!this.currencyIconRoot||(t=this.currencyIconRoot.getChildByName(t))&&g.sGNode.playAnimation(t)},M.prototype._setCardIcon=function(){var t=this,e=(G[this.reward.type],m.sGGame.localModel.getModule(_.LocalCardPackage).getCard(this.reward.id)),o=this.currencyIconRoot,i=g.sGNode.findComponent(o,"card_bottom_root/bottom/skill_icon",cc.Sprite);i&&g.sGNode.setSprite(i,e.entry.bigIcon,this);var a=g.sGNode.findComponent(o,"card_bottom_root/bottom/layout/label_name",cc.Label);a&&(a.string=p.i18n.t(e.entry.name));var n=g.sGNode.findComponent(o,"card_bottom_root/bottom/layout/label_card_attribute",cc.Label);n&&(n.string=b.sGViewModel.getModule(C.VMCard).getDesc(e.entry.id)),i=cc.find("card_bottom_root/bottom/quality_root/quality1",o),a=cc.find("card_bottom_root/bottom/quality_root/quality2",o),n=cc.find("card_bottom_root/bottom/quality_root/quality3",o),i&&(i.active=3===e.entry.quality),a&&(a.active=4===e.entry.quality),n&&(n.active=5===e.entry.quality);var r=g.sGNode.findComponent(o,"card_bottom_root/light_root",sp.Skeleton);if(r)switch(e.entry.quality){case 3:r.setAnimation(0,"lan",!0);break;case 4:r.setAnimation(0,"zi",!0);break;case 5:r.setAnimation(0,"cheng",!0);break;default:r.setAnimation(0,"lan",!0)}for(var l=cc.find("card_bottom_root/age_bg",o),c=0;c<6;c++){var s=cc.find("age"+(c+1),l);s&&(s.active=0===c?e.entry.unlockAge<3:e.entry.unlockAge===c+2)}this.cardFlipSpine?(o.active=!1,this.cardFlipSpine.node.active=!0,(n=this.cardFlipSpine.getComponent(d.default))&&(n.setEvent("end",function(){o.active=!0}),n.setCompleteListener(function(){o.active=!0,t.cardFlipSpine.node.active=!1,f.sGAudio.playEffect(u.sAudioConfig.config.reward),t.animationCanSkip=o.getComponent(cc.Animation),g.sGNode.playAnimation(o,"function_gold_hand_open_animation_bottom_anim"),t.cardFlipSpine.setCompleteListener(null)})),this.cardFlipSpine.findAnimation("animation1")?this.cardFlipSpine.setAnimation(0,"animation1",!1):this.cardFlipSpine.findAnimation("open")&&this.cardFlipSpine.setAnimation(0,"open",!1)):(f.sGAudio.playEffect(u.sAudioConfig.config.reward),this.animationCanSkip=o.getComponent(cc.Animation),g.sGNode.playAnimation(o,"function_gold_hand_open_animation_bottom_anim"))},M.prototype._setCardToFragmentIcon=function(){var t=this,e=(G[this.reward.type],m.sGGame.localModel.getModule(_.LocalCardPackage).getCard(this.reward.id)),o=this.currencyIconRoot,i=g.sGNode.findComponent(o,"card_bottom_root/bottom/skill_icon",cc.Sprite);i&&g.sGNode.setSprite(i,e.entry.bigIcon,this);var a=g.sGNode.findComponent(o,"card_bottom_root/bottom/layout/label_name",cc.Label);a&&(a.string=p.i18n.t(e.entry.name));var n=g.sGNode.findComponent(o,"card_bottom_root/bottom/layout/label_card_attribute",cc.Label);n&&(n.string=b.sGViewModel.getModule(C.VMCard).getDesc(e.entry.id)),i=cc.find("card_bottom_root/bottom/quality_root/quality1",o),a=cc.find("card_bottom_root/bottom/quality_root/quality2",o),n=cc.find("card_bottom_root/bottom/quality_root/quality3",o),i&&(i.active=3===e.entry.quality),a&&(a.active=4===e.entry.quality),n&&(n.active=5===e.entry.quality);var r=g.sGNode.findComponent(o,"card_bottom_root/light_root",sp.Skeleton);if(r)switch(e.entry.quality){case 3:r.setAnimation(0,"lan",!0);break;case 4:r.setAnimation(0,"zi",!0);break;case 5:r.setAnimation(0,"cheng",!0);break;default:r.setAnimation(0,"lan",!0)}i=cc.find("sp_root/icon_root/icon_sp_bottom/quality_root/quality1",o),a=cc.find("sp_root/icon_root/icon_sp_bottom/quality_root/quality2",o),n=cc.find("sp_root/icon_root/icon_sp_bottom/quality_root/quality3",o),i&&(i.active=3===e.entry.quality),a&&(a.active=4===e.entry.quality),n&&(n.active=5===e.entry.quality),(n=g.sGNode.findComponent(o,"sp_root/icon_root/icon_sp_bottom/icon",cc.Sprite))&&g.sGNode.setSprite(n,e.entry.bigIcon,this),(n=g.sGNode.findComponent(o,"sp_root/icon_root/label_number",cc.Label))&&(n.string="x"+this.reward.count);var l=g.sGNode.findComponent(o,"sp_root/icon_root/light_root",sp.Skeleton);if(l)switch(e.entry.quality){case 3:l.setAnimation(0,"suipianlan",!0);break;case 4:l.setAnimation(0,"suipianzi",!0);break;case 5:l.setAnimation(0,"suipiancheng",!0);break;default:l.setAnimation(0,"suipianlan",!0)}this.cardFlipSpine?(o.active=!1,this.cardFlipSpine.node.active=!0,(e=this.cardFlipSpine.getComponent(d.default))&&(e.setEvent("end",function(){o.active=!0}),e.setCompleteListener(function(){o.active=!0,t.cardFlipSpine.node.active=!1,f.sGAudio.playEffect(u.sAudioConfig.config.reward),t.animationCanSkip=o.getComponent(cc.Animation),g.sGNode.playAnimation(o,"card_exchange_sp_anim"),t.cardFlipSpine.setCompleteListener(null)})),this.cardFlipSpine.findAnimation("animation1")?this.cardFlipSpine.setAnimation(0,"animation1",!1):this.cardFlipSpine.findAnimation("open")&&this.cardFlipSpine.setAnimation(0,"open",!1)):(f.sGAudio.playEffect(u.sAudioConfig.config.reward),this.animationCanSkip=o.getComponent(cc.Animation),g.sGNode.playAnimation(o,"card_exchange_sp_anim"))},M.prototype._setCardFragmentIcon=function(){G[this.reward.type];var t=m.sGGame.localModel.getModule(_.LocalCardPackage).getCard(this.reward.id),e=this.currencyIconRoot,o=g.sGNode.findComponent(e,"card_bottom_root/bottom/skill_icon",cc.Sprite);o&&g.sGNode.setSprite(o,t.entry.bigIcon,this);var i=g.sGNode.findComponent(e,"card_bottom_root/bottom/layout/label_name",cc.Label);i&&(i.string=p.i18n.t(t.entry.name));var a=g.sGNode.findComponent(e,"card_bottom_root/bottom/layout/label_card_attribute",cc.Label);a&&(a.string=b.sGViewModel.getModule(C.VMCard).getDesc(t.entry.id)),o=cc.find("card_bottom_root/bottom/quality_root/quality1",e),i=cc.find("card_bottom_root/bottom/quality_root/quality2",e),a=cc.find("card_bottom_root/bottom/quality_root/quality3",e),o&&(o.active=3===t.entry.quality),i&&(i.active=4===t.entry.quality),a&&(a.active=5===t.entry.quality);var n=g.sGNode.findComponent(e,"card_bottom_root/light_root",sp.Skeleton);if(n)switch(t.entry.quality){case 3:n.setAnimation(0,"lan",!0);break;case 4:n.setAnimation(0,"zi",!0);break;case 5:n.setAnimation(0,"cheng",!0);break;default:n.setAnimation(0,"lan",!0)}o=cc.find("sp_root/icon_root/icon_sp_bottom/quality_root/quality1",e),i=cc.find("sp_root/icon_root/icon_sp_bottom/quality_root/quality2",e),a=cc.find("sp_root/icon_root/icon_sp_bottom/quality_root/quality3",e),o&&(o.active=3===t.entry.quality),i&&(i.active=4===t.entry.quality),a&&(a.active=5===t.entry.quality);var r=g.sGNode.findComponent(e,"sp_root/icon_root/light_root",sp.Skeleton);if(r)switch(t.entry.quality){case 3:r.setAnimation(0,"suipianlan",!0);break;case 4:r.setAnimation(0,"suipianzi",!0);break;case 5:r.setAnimation(0,"suipiancheng",!0);break;default:r.setAnimation(0,"suipianlan",!0)}(a=g.sGNode.findComponent(e,"sp_root/icon_root/icon_sp_bottom/icon",cc.Sprite))&&g.sGNode.setSprite(a,t.entry.bigIcon,this),(t=g.sGNode.findComponent(e,"sp_root/icon_root/label_number",cc.Label))&&(t.string="+"+this.reward.count),this.animationCanSkip=e.getComponent(cc.Animation),g.sGNode.playAnimation(e,"card_exchange_sp_anim")},M.prototype.onSkipAnimation=function(){this.playAnimation2End()},M.prototype.playAnimation2End=function(){this.animationCanSkip&&this.animationCanSkip.currentClip&&this.animationCanSkip.setCurrentTime(this.animationCanSkip.currentClip.duration)},M.prototype.onClickClose=function(){f.sGAudio.playEffect(u.sAudioConfig.config.reward),this.closeCallback&&this.closeCallback(),g.sGNode.destoryNode(this.node)},c([n(cc.Node)],M.prototype,"currencyIconRoot",void 0),c([n(cc.Label)],M.prototype,"rewardLabel",void 0),c([n(cc.Node)],M.prototype,"closeButton",void 0),c([n(sp.Skeleton)],M.prototype,"cardFlipSpine",void 0),a=c([S,a("Game/Reward/RewardUI")],M),r.default=a,cc._RF.pop()},{}],setting_ui:[function(t,e,o){"use strict";cc._RF.push(e,"69744KMskBFSJj6Z2Ozss7G","setting_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("client_config"),d=a("gui"),p=a("gaudio"),f=a("thirdplatform_util"),h=a("ggame"),g=a("local_config"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.musicSwitchButton=null,t.musicOpenedSprite=null,t.musicClosedSprite=null,t.soundSwitchButton=null,t.soundOpenedSprite=null,t.soundClosedSprite=null,t.buttonPrivate=null,t}r(b,c=cc.Component),b.prototype.onLoad=function(){var t=this;this.musicSwitchButton&&this.musicSwitchButton.node.on("click",function(){p.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),p.sGAudio.musicEnable=!p.sGAudio.musicEnable,t.refreshAudio()}),this.soundSwitchButton&&this.soundSwitchButton.node.on("click",function(){p.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),p.sGAudio.soundEnable=!p.sGAudio.soundEnable,t.refreshAudio()}),this.buttonPrivate&&this.buttonPrivate.node.on("click",this.onClickButtonPrivate.bind(this))},b.prototype.onEnable=function(){this.refreshAudio(),this.buttonPrivate&&(this.buttonPrivate.node.active=!!u.sClientConfig.config.privacyURL||u.sClientConfig.config.has3rdPlatformPrivacy),p.sGAudio.playEffect(s.sAudioConfig.config.popUI)},b.prototype.refreshAudio=function(){this.musicOpenedSprite&&(this.musicOpenedSprite.node.active=p.sGAudio.musicEnable),this.musicClosedSprite&&(this.musicClosedSprite.node.active=!p.sGAudio.musicEnable),this.soundOpenedSprite&&(this.soundOpenedSprite.node.active=p.sGAudio.soundEnable),this.soundClosedSprite&&(this.soundClosedSprite.node.active=!p.sGAudio.soundEnable)},b.prototype.onClickButtonPrivate=function(){p.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),u.sClientConfig.config.has3rdPlatformPrivacy?f.sThirdPlatformUtil.showPrivacy():f.sThirdPlatformUtil.openURL(u.sClientConfig.config.privacyURL)},b.prototype.onClickButtonAgreement=function(){p.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),f.sThirdPlatformUtil.openURL(u.sClientConfig.config.termsURL)},b.prototype.onClickButtonInfo=function(){p.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),d.sGUI.openDialogUI("prefabs/ui/user_info",this)},b.prototype.onToggleAdPersonalized=function(t){p.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),h.sGGame.localModel.getModule(g.LocalConfig).adPersonalized=t.isChecked},l([a(cc.Button)],b.prototype,"musicSwitchButton",void 0),l([a(cc.Sprite)],b.prototype,"musicOpenedSprite",void 0),l([a(cc.Sprite)],b.prototype,"musicClosedSprite",void 0),l([a(cc.Button)],b.prototype,"soundSwitchButton",void 0),l([a(cc.Sprite)],b.prototype,"soundOpenedSprite",void 0),l([a(cc.Sprite)],b.prototype,"soundClosedSprite",void 0),l([a({displayName:"\u9690\u79c1\u6761\u6b3e\u6309\u94ae",type:cc.Button})],b.prototype,"buttonPrivate",void 0),m=l([y,m("Game/UI/SettingUI")],b),n.default=m,cc._RF.pop()},{}],slot_machine_button_ui:[function(t,e,o){"use strict";cc._RF.push(e,"189b2ni0jlNaaM3CJ3JARAd","slot_machine_button_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var s,u=a("reddot"),d=a("audio_config"),p=a("gaudio"),f=a("gnode"),h=a("gtime"),g=a("ggame"),y=a("gview_model"),m=a("local_reward_slot_machine"),b=a("vm_slot_machine");function _(){var t=null!==s&&s.apply(this,arguments)||this;return t.buttonClick=null,t.timeLabel=null,t.titleLabel=null,t._totalDt=0,t}a=(n=cc._decorator).ccclass,n=n.property,l(_,s=cc.Component),_.prototype.onLoad=function(){this.buttonClick||(this.buttonClick=this.node.getComponent(cc.Button)),this.buttonClick&&(this.buttonClick.node.on("click",function(){p.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),y.sGViewModel.getModule(b.VMSlotMachine).openSlotMachine()},this),f.sGNode.addUniqueComponent(this.buttonClick,u.default).init(function(){return g.sGGame.localModel.getModule(m.default).hasAnythingToDo()}))},_.prototype.onEnable=function(){this._refresh()},_.prototype.onDisable=function(){f.sGNode.targetOff(this)},_.prototype.update=function(t){this._totalDt+=t,.2<=this._totalDt&&(this._totalDt=0,this._refresh())},_.prototype._refresh=function(){var t=y.sGViewModel.getModule(b.VMSlotMachine).canShow();this.buttonClick&&(this.buttonClick.node.active=t),t&&(t=g.sGGame.localModel.getModule(m.default).getRecoverRemainSeconds(),this.timeLabel&&(this.timeLabel.node.active=0<t,0<t&&(this.timeLabel.string=h.sGTime.toTimeSpanString(t))),this.titleLabel&&(this.titleLabel.node.active=t<=0))},c([n({tooltip:"\u70b9\u51fb\u6309\u94ae",type:cc.Button})],_.prototype,"buttonClick",void 0),c([n({tooltip:"\u65f6\u95f4",type:cc.Label})],_.prototype,"timeLabel",void 0),c([n({tooltip:"\u6807\u9898",type:cc.Label})],_.prototype,"titleLabel",void 0),a=c([a],_),r.default=a,cc._RF.pop()},{}],slot_machine_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"1b12dmxwc9O3IN4d98/B7xy","slot_machine_icon_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var s,u=a("reward_helper"),d=a("gnode"),p=a("gview_model"),f=a("vm_reward");function h(){var t=null!==s&&s.apply(this,arguments)||this;return t.spriteIcon=null,t.labelCount=null,t.nodeGet=null,t}a=(n=cc._decorator).ccclass,n=n.property,l(h,s=cc.Component),h.prototype.onDisable=function(){d.sGNode.targetOff(this)},h.prototype.setIsGet=function(t){this.nodeGet&&(this.nodeGet.active=t)},h.prototype.reset=function(t){this.spriteIcon&&d.sGNode.setSprite(this.spriteIcon,t.icon,this),this.labelCount&&(t=(t=u.RewardList.createFromString(t.reward))?t.getReward(0):void 0,this.labelCount.string=p.sGViewModel.getModule(f.VMReward).getCount(t.type,t.count))},c([n({tooltip:"\u56fe\u6807",type:cc.Sprite})],h.prototype,"spriteIcon",void 0),c([n({tooltip:"\u6570\u91cf",type:cc.Label})],h.prototype,"labelCount",void 0),c([n({tooltip:"\u9009\u4e2d\u6807\u8bb0",type:cc.Node})],h.prototype,"nodeGet",void 0),a=c([a],h),r.default=a,cc._RF.pop()},{}],slot_machine_ui:[function(t,e,o){"use strict";cc._RF.push(e,"caa32iimu5H1ZpMjt2UNHsG","slot_machine_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var s,u=a("local_info"),d=a("encourage_icon_ui"),p=a("vm_encourage"),f=a("vm_ui"),h=a("audio_config"),g=a("client_config"),y=a("encourage_config"),m=a("event_config"),b=a("i18n"),_=a("ganalytics"),v=a("gaudio"),C=a("gnode"),P=a("gtime"),S=a("ggame"),G=a("gview_model"),M=a("local_reward_slot_machine"),w=a("vm_reward"),A=a("slot_machine_icon_ui");function B(){var t=null!==s&&s.apply(this,arguments)||this;return t.closeButton=null,t.selectRoot=null,t.goodRoot=null,t.animRoot=null,t.animNode=null,t.startButton=null,t.getRoot=null,t.centerRoot=null,t.iconPrefab=null,t.maskNode=null,t.notEnoughTimesEncourageIconUI=null,t.recoverRemainTimeLabel=null,t.recoverRemainTimesTodayLabel=null,t.startLabelNode=null,t.selectIndex=0,t.turnning=!1,t.selectNodes=[],t.iconNodes=[],t.stepElapsed=0,t.stepInterval=[.1,.05,.3],t.stepIndex=0,t.phase=0,t.phaseIndexs=[],t.stepSelectIndex=[],t.updateDt01=0,t.adRewardIcon=null,t}a=(n=cc._decorator).ccclass,n=n.property,l(B,s=cc.Component),B.prototype.onLoad=function(){var t=this;this.closeButton&&this.closeButton.node.on("click",function(){v.sGAudio.playEffect(h.sAudioConfig.config.buttonClick),C.sGNode.destoryNode(t.node)});for(var e=1,o=cc.find("select_bottom"+e,this.selectRoot),i=cc.find("goods_bottom"+e,this.goodRoot);o&&i;){this.selectNodes.push(o),o.active=!1;var a=this.iconNodes[e-1];a||(a=cc.instantiate(this.iconPrefab),this.iconNodes[e-1]=a,i.addChild(a)),this.refreshGood(e-1,a),e++,o=cc.find("select_bottom"+e,this.selectRoot),i=cc.find("goods_bottom"+e,this.goodRoot)}this.startButton&&this.startButton.node.on("click",function(){t.tryStartTurn()}),this.selectIndex=Math.floor(Math.random()*this.selectNodes.length),g.sClientConfig.config.devMode&&this.recoverRemainTimesTodayLabel&&(C.sGNode.addUniqueComponent(this.recoverRemainTimesTodayLabel,cc.Button),this.recoverRemainTimesTodayLabel.node.on("click",function(){S.sGGame.localModel.getModule(M.default).addRemainTimes()}))},B.prototype.start=function(){},B.prototype.onEnable=function(){this.animNode&&(this.animNode.active=!1),this.getRoot&&(this.getRoot.active=!1),this.centerRoot&&(this.centerRoot.active=!0),this.selectRoot&&(this.selectRoot.active=!0),this.selectNodes[this.selectIndex]&&(this.selectNodes[this.selectIndex].active=!0),this.maskNode&&(this.maskNode.active=!1),this.refresh(),this.refreshGoodGet()},B.prototype.onDisable=function(){S.sGGame.targetOff(this),C.sGNode.targetOff(this)},B.prototype.update=function(t){if(this.updateDt01+=t,.1<this.updateDt01&&(this.updateDt01=0,this.refresh()),this.turnning&&(this.stepElapsed+=t,this.stepElapsed>this.stepInterval[this.phase])){for(var e=0,o=this.stepSelectIndex;e<o.length;e++){var i=o[e];i%=this.selectNodes.length,this.selectNodes[i].opacity=255,this.selectNodes[i].active=!1}this.stepIndex++,this.stepIndex>this.phaseIndexs[2]?(this.phase=0,this.turnning=!1,this.reward()):(v.sGAudio.playEffect(h.sAudioConfig.config.slotMachineTurn),this.stepIndex>this.phaseIndexs[1]?(this.phase=2,this.stepSelectIndex.shift(),this.stepSelectIndex.shift()):this.stepIndex>this.phaseIndexs[0]?(this.phase=1,this.stepSelectIndex.shift()):this.phase=0,this.stepSelectIndex.push(this.stepIndex));for(var a=1,n=0,r=this.stepSelectIndex;n<r.length;n++)i=r[n],i%=this.selectNodes.length,this.selectNodes[i].opacity=a/this.stepSelectIndex.length*255,this.selectNodes[i].active=!0,a++;this.stepElapsed=0}},B.prototype.refresh=function(){var t=S.sGGame.localModel.getModule(M.default),e=t.getRecoverRemainSeconds(),o=t.getRemainTimes(),i=t.getRemainTimesToday();this.startButton&&(this.startButton.interactable=0<i&&0<o),this.recoverRemainTimeLabel&&(this.recoverRemainTimeLabel.node.parent.active=0<i&&0===o,0<e&&(this.recoverRemainTimeLabel.string=P.sGTime.toTimeSpanString(e))),this.recoverRemainTimesTodayLabel&&(this.recoverRemainTimesTodayLabel.string=i.toString()),this.startLabelNode&&(this.startLabelNode.active=0<o||0===i),t.isAd()?(null==this.notEnoughTimesEncourageType&&(this.notEnoughTimesEncourageType=G.sGViewModel.getModule(p.VMEncourage).preEncourage(y.sEncourageConfig.config.turnTable)),this.notEnoughTimesEncourageIconUI&&this.notEnoughTimesEncourageIconUI.setEncourageType(this.notEnoughTimesEncourageType)):(this.notEnoughTimesEncourageType=void 0,this.notEnoughTimesEncourageIconUI&&this.notEnoughTimesEncourageIconUI.setEncourageType(p.eEncourageType.closed))},B.prototype.startTurn=function(){var t,e,o;this.turnning||(e=S.sGGame.localModel.getModule(u.LocalInfo).getPlayDayCountForReport(),o=S.sGGame.localModel.getModule(M.default).getRemainTimes(),_.sGAnalytics.reportAnalytics(m.sEventConfig.config.turnTableStart,{days:e,times:o.toString()}),t=S.sGGame.localModel.getModule(M.default).randomRewardIndex()%this.selectNodes.length,this.turnning=!0,this.stepIndex=this.selectIndex,this.stepElapsed=0,this.phase=0,e=this.selectIndex+4,(o=t+2*this.selectNodes.length)-e<2*this.selectNodes.length&&(o+=this.selectNodes.length),this.phaseIndexs=[e,o-4,o],this.stepSelectIndex=[],this.stepSelectIndex.push(this.stepIndex),this.selectIndex=t,this.maskNode&&(this.maskNode.active=!0),this.startButton&&(this.startButton.interactable=!1),this.refresh(),this.getRoot&&(this.getRoot.active=!1),this.centerRoot&&(this.centerRoot.active=!0),this.refreshGoodGet())},B.prototype.refreshGood=function(t,e){t=S.sGGame.localModel.getModule(M.default).slotMachineEntryArray[t],(e=e.getComponent(A.default))&&e.reset(t)},B.prototype.refreshGoodGet=function(t){for(var e=0;e<this.iconNodes.length;++e){var o=this.iconNodes[e];!o||(o=o.getComponent(A.default))&&o.setIsGet(e===t)}},B.prototype.reward=function(){this.getRoot&&(this.refreshGood(this.selectIndex,this.getRoot,!0),this.getRoot.active=!0),this.centerRoot&&(this.centerRoot.active=!1),this.refreshGoodGet(this.selectIndex),this.adRewardIcon&&(this.adRewardIcon.active=!1);var t=S.sGGame.localModel.getModule(M.default);t.takeRewardIndex(this.selectIndex),this.maskNode&&(this.maskNode.active=!1),this.startButton&&(this.startButton.interactable=!0),this.refresh();var e=t.getAdReward();t.getEntry(this.selectIndex),G.sGViewModel.getModule(w.VMReward).openRewardResult(e)},B.prototype.tryStartTurn=function(){var t,e=this,o=S.sGGame.localModel.getModule(M.default);0<o.getRemainTimes()?(t=function(){e.startTurn(),e.refresh()},o.isAd()?void 0!==this.notEnoughTimesEncourageType&&G.sGViewModel.getModule(p.VMEncourage).encourage(y.sEncourageConfig.config.turnTable,this.notEnoughTimesEncourageType,t):t()):(t=b.i18n.t("slotMachine.timesIsEmpty"),G.sGViewModel.getModule(f.VMUI).addMessageTip(t))},c([n(cc.Button)],B.prototype,"closeButton",void 0),c([n(cc.Node)],B.prototype,"selectRoot",void 0),c([n(cc.Node)],B.prototype,"goodRoot",void 0),c([n(cc.Node)],B.prototype,"animRoot",void 0),c([n(cc.Node)],B.prototype,"animNode",void 0),c([n(cc.Button)],B.prototype,"startButton",void 0),c([n(cc.Node)],B.prototype,"getRoot",void 0),c([n(cc.Node)],B.prototype,"centerRoot",void 0),c([n(cc.Prefab)],B.prototype,"iconPrefab",void 0),c([n(cc.Node)],B.prototype,"maskNode",void 0),c([n(d.default)],B.prototype,"notEnoughTimesEncourageIconUI",void 0),c([n(cc.Label)],B.prototype,"recoverRemainTimeLabel",void 0),c([n(cc.Label)],B.prototype,"recoverRemainTimesTodayLabel",void 0),c([n(cc.Node)],B.prototype,"startLabelNode",void 0),c([n({tooltip:"\u4e09\u500d\u6807\u8bb0",type:cc.Node})],B.prototype,"adRewardIcon",void 0),a=c([a],B),r.default=a,cc._RF.pop()},{}],soldier_info_ui:[function(t,e,o){"use strict";cc._RF.push(e,"8afc3uwbt9EYp8SA93jge5h","soldier_info_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("avatar_config"),u=a("i18n"),d=a("gnode"),p=a("soldier"),f=(h=cc._decorator).ccclass,h=(a=h.property,h.menu);function g(){var t=null!==c&&c.apply(this,arguments)||this;return t.nameLabel=null,t.descLabel=null,t.spine=null,t.soldier=null,t}r(g,c=cc.Component),g.prototype.onLoad=function(){},g.prototype.onEnable=function(){var t;this.nameLabel&&(this.nameLabel.string=u.i18n.t(this.soldier.entry.name)),this.descLabel&&(this.descLabel.string=u.i18n.t(this.soldier.entry.desc)),this.spine&&(t=s.sAvatarConfig.getEntry(this.soldier.entry.avatar),d.sGNode.setSpine(this.spine,t.spine,t.skin,p.animationNameDic[p.enumAnimationState.idle],this))},l([a({displayName:"\u540d\u5b57",type:cc.Label})],g.prototype,"nameLabel",void 0),l([a({displayName:"\u63cf\u8ff0",type:cc.Label})],g.prototype,"descLabel",void 0),l([a({displayName:"\u5f62\u8c61",type:sp.Skeleton})],g.prototype,"spine",void 0),h=l([f,h("Game/UI/SoldierInfoUI")],g),n.default=h,cc._RF.pop()},{}],soldier:[function(t,e,o){"use strict";cc._RF.push(e,"31e67I7vgtLmLsL6oWzHaGn","soldier");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.animationNameDic=r.sSoldierNodeEvent=r.enumSoldierStandType=r.enumAnimationState=r.enumSoldierMoveState=r.enumSoldierAttackState=void 0;var s,u,d,p,f,h=a("audio_config"),g=a("avatar_config"),y=a("client_config"),m=a("player_attribute_config"),b=a("soldier_attribute_config"),_=a("i18n"),v=a("gaudio"),C=a("glog"),P=a("gnode"),S=a("gnumber"),G=a("ggame"),M=a("attribute_slot"),w=a("attribute_system"),A=a("local_attribute"),B=a("local_battle"),R=a("local_card"),k=a("local_soldier"),T=a("building_base"),L=a("unit"),D=a("unit_attribute"),O=a("unit_health"),I=a("unit_skill_buff_package"),N=a("unit_skill_package"),E=cc._decorator,j=E.ccclass;function U(){var t=null!==p&&p.apply(this,arguments)||this;return t.unitSpine=null,t.dropGoldAnim=null,t.dropGoldLabel=null,t.soldier=null,t.avatarEntry=null,t.meleeAttackDistance=100,t.attackCountdown=0,t.attackState=s.idle,t.moveState=u.idle,t.targetUnitID=0,t.unit=null,t.unitHealth=null,t.unitAttribute=null,t.currentAnimationName="",t.spineLoaded=!1,t.autoRecoverSeconds=0,t.attackPassTime=0,t.updatePassTime=0,t.lastAttackPassTime=0,t.isBuy=!1,t.spineTimeScaleDown=1,t.spineTimeScaleUp=1,t.spineTimeScale=1,t.unitSkillPackage=null,t.unitBuffPackage=null,t.autoRecoverTriggerPassTime=0,t}n=E.property,a=E.menu,(E=s=r.enumSoldierAttackState||(r.enumSoldierAttackState={}))[E.idle=0]="idle",E[E.waitAttack=1]="waitAttack",E[E.melee=2]="melee",E[E.range=3]="range",E[E.skill=4]="skill",(E=u=r.enumSoldierMoveState||(r.enumSoldierMoveState={}))[E.idle=0]="idle",E[E.stand=1]="stand",E[E.move=2]="move",(E=d=r.enumAnimationState||(r.enumAnimationState={}))[E.idle=0]="idle",E[E.move=1]="move",E[E.die=2]="die",E[E.melee=3]="melee",E[E.range=4]="range",(E=r.enumSoldierStandType||(r.enumSoldierStandType={}))[E.invalid=0]="invalid",E[E.land=1]="land",E[E.air=2]="air",E[E.all=3]="all",r.sSoldierNodeEvent={attack:"sSoldierNodeEvent.attack",hurt:"sSoldierNodeEvent.hurt"},r.animationNameDic=["idle","move","death","attack","attack"],l(U,p=cc.Component),(f=U).prototype._beforeInit=function(t,e,o,i){var a=G.sGGame.localModel.getModule(k.LocalSoldierPackage);this.soldier=a.getSoldier(e),this.unit=P.sGNode.addUniqueComponent(this.node,L.default),this.unitHealth=P.sGNode.addUniqueComponent(this.node,O.default),this.unitAttribute=P.sGNode.addUniqueComponent(this.node,D.default),this.unitSkillPackage=P.sGNode.addUniqueComponent(this.node,N.default),this.unitBuffPackage=P.sGNode.addUniqueComponent(this.node,I.UnitSkillBuffPackage),this.unit.unitID=t,this.unit.teamID=o,this.unit.unitType=B.enumUnitType.soldier,this.unit.battleManager=i,this.avatarEntry=g.sAvatarConfig.getEntry(this.soldier.entry.avatar),this.soldier.entry.skillID&&this.unitSkillPackage.addSkill(this.soldier.entry.skillID)},U.prototype._afterInit=function(){this.unitHealth.maxHP=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.maxHP),this.unitHealth.hp=this.unitHealth.maxHP,y.sClientConfig.config.devMode&&(C.sGLog.log("----------"),C.sGLog.log("soldier("+this.soldier.entry.id+":"+_.i18n.t(this.soldier.entry.name)+")team("+this.unit.teamID+")"),C.sGLog.log(this._attributeToString(b.sSoldierAttributeConfig.config.maxHP)),C.sGLog.log(this._attributeToString(b.sSoldierAttributeConfig.config.attack)),C.sGLog.log(this._attributeToString(b.sSoldierAttributeConfig.config.attackInterval)),C.sGLog.log(this._attributeToString(b.sSoldierAttributeConfig.config.moveSpeed)),C.sGLog.log("----------"))},U.prototype._attributeToString=function(t){var e=this.unitAttribute.attributeSystem.getValue(t),o=this.unitAttribute.attributeSystem.getValue(t,w.eAttributeValueType.init),i=this.unitAttribute.attributeSystem.getValue(t,w.eAttributeValueType.add),a=this.unitAttribute.attributeSystem.getValue(t,w.eAttributeValueType.percent);return t.id+": ("+o+"+"+i+")*"+a+"/100="+e},U.prototype.initByLevel=function(t,e,o,i,a,n){var r;void 0===n&&(n=0),this._beforeInit(t,e,o,i),this.unitAttribute.attributeSystem=this.soldier.getLevelAttributeSystem(a=a<=0?1:a),0<n&&((r=this.unitAttribute.attributeSystem.getSlot("ext")).addPosValue(b.sSoldierAttributeConfig.config.maxHP,M.eAttributePos.mul,(n+100)/100),r.addPosValue(b.sSoldierAttributeConfig.config.attack,M.eAttributePos.mul,(n+100)/100),r.addPosValue(b.sSoldierAttributeConfig.config.attackInterval,M.eAttributePos.div,(n/10+100)/100)),o===B.enumTeam.player&&(i=G.sGGame.localModel.getModule(A.LocalAttribute),a=this.unitAttribute.attributeSystem.getSlot("player"),o=n=r=100,r+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.allSoldierMaxHPPercent),n+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.allSoldierAttackPercent),o+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.allSoldierAttackIntervalPercent),this.soldier&&this.soldier.card&&(R.eCardType[this.soldier.card.entry.type]===R.eCardType.melee?(r+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.meleeSoldierMaxHPAddPercent),n+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.meleeSoldierAttackAddPercent),o+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.meleeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.range?(r+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.rangeSoldierMaxHPAddPercent),n+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.rangeSoldierAttackAddPercent),o+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.rangeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.air&&(r+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.airSoldierMaxHPAddPercent),n+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.airSoldierAttackAddPercent),o+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.airSoldierAttackIntervalAddPercent))),r+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataAllSoldierMaxHPAddPercent),n+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataAllSoldierAttackAddPercent),o+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataAllSoldierAttackIntervalAddPercent),this.soldier&&this.soldier.card&&(R.eCardType[this.soldier.card.entry.type]===R.eCardType.melee?(r+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataMeleeSoldierMaxHPAddPercent),n+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataMeleeSoldierAttackAddPercent),o+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataMeleeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.range?(r+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataRangeSoldierMaxHPAddPercent),n+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataRangeSoldierAttackAddPercent),o+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataRangeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.air&&(r+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataAirSoldierMaxHPAddPercent),n+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataAirSoldierAttackAddPercent),o+=i.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.pataAirSoldierAttackIntervalAddPercent))),a.setPosValue(b.sSoldierAttributeConfig.config.maxHP,M.eAttributePos.mul,r/100),a.setPosValue(b.sSoldierAttributeConfig.config.attackInterval,M.eAttributePos.div,o/100),a.setPosValue(b.sSoldierAttributeConfig.config.attack,M.eAttributePos.mul,n/100)),this._afterInit()},U.prototype.initByBuy=function(t,e,o,i){this._beforeInit(t,e,o,i),this.isBuy=!0,this.unitAttribute.attributeSystem=this.soldier.getLevelAttributeSystem(0<this.soldier.getLevel()?this.soldier.getLevel():1);var a=G.sGGame.localModel.getModule(A.LocalAttribute);t=this.unitAttribute.attributeSystem.getSlot("player"),e=100,o=100,i=100,e+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.allSoldierMaxHPPercent),o+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.allSoldierAttackPercent),i+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.allSoldierAttackIntervalPercent),this.soldier&&this.soldier.card&&(R.eCardType[this.soldier.card.entry.type]===R.eCardType.melee?(e+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.meleeSoldierMaxHPAddPercent),o+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.meleeSoldierAttackAddPercent),i+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.meleeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.range?(e+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.rangeSoldierMaxHPAddPercent),o+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.rangeSoldierAttackAddPercent),i+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.rangeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.air&&(e+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.airSoldierMaxHPAddPercent),o+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.airSoldierAttackAddPercent),i+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.airSoldierAttackIntervalAddPercent))),e+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAllSoldierAttackAddPercent),o+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAllSoldierAttackAddPercent),i+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAllSoldierAttackIntervalAddPercent),this.soldier&&this.soldier.card&&(R.eCardType[this.soldier.card.entry.type]===R.eCardType.melee?(e+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingMeleeSoldierMaxHPAddPercent),o+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingMeleeSoldierAttackAddPercent),i+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingMeleeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.range?(e+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingRangeSoldierMaxHPAddPercent),o+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingRangeSoldierAttackAddPercent),i+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingRangeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.air&&(e+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAirSoldierMaxHPAddPercent),o+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAirSoldierAttackAddPercent),i+=a.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAirSoldierAttackIntervalAddPercent))),t.setPosValue(b.sSoldierAttributeConfig.config.maxHP,M.eAttributePos.mul,e/100),t.setPosValue(b.sSoldierAttributeConfig.config.attackInterval,M.eAttributePos.div,i/100),t.setPosValue(b.sSoldierAttributeConfig.config.attack,M.eAttributePos.mul,o/100),t=this.unitAttribute.attributeSystem.getSlot("battleBuff"),o=a.attributeSystem.getValue(m.sPlayerAttributeConfig.config.battleAttackAddPercent),t.setPosValue(b.sSoldierAttributeConfig.config.attack,M.eAttributePos.mul,o/100),a=a.attributeSystem.getValue(m.sPlayerAttributeConfig.config.battleMaxHPAddPercent),t.setPosValue(b.sSoldierAttributeConfig.config.maxHP,M.eAttributePos.mul,a/100),this._afterInit()},U.prototype.initBySummon=function(t,e,o,i,a){void 0===a&&(a=100),this._beforeInit(t,e,o,i),this.unitAttribute.attributeSystem=this.soldier.getLevelAttributeSystem(0<this.soldier.getLevel()?this.soldier.getLevel():1);var n=G.sGGame.localModel.getModule(A.LocalAttribute);t=this.unitAttribute.attributeSystem.getSlot("player"),e=100,o=100,i=100,e+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.allSoldierMaxHPPercent),o+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.allSoldierAttackPercent),i+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.allSoldierAttackIntervalPercent),this.soldier&&this.soldier.card&&(R.eCardType[this.soldier.card.entry.type]===R.eCardType.melee?(e+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.meleeSoldierMaxHPAddPercent),o+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.meleeSoldierAttackAddPercent),i+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.meleeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.range?(e+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.rangeSoldierMaxHPAddPercent),o+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.rangeSoldierAttackAddPercent),i+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.rangeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.air&&(e+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.airSoldierMaxHPAddPercent),o+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.airSoldierAttackAddPercent),i+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.airSoldierAttackIntervalAddPercent))),e+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAllSoldierAttackAddPercent),o+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAllSoldierAttackAddPercent),i+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAllSoldierAttackIntervalAddPercent),this.soldier&&this.soldier.card&&(R.eCardType[this.soldier.card.entry.type]===R.eCardType.melee?(e+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingMeleeSoldierMaxHPAddPercent),o+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingMeleeSoldierAttackAddPercent),i+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingMeleeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.range?(e+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingRangeSoldierMaxHPAddPercent),o+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingRangeSoldierAttackAddPercent),i+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingRangeSoldierAttackIntervalAddPercent)):R.eCardType[this.soldier.card.entry.type]===R.eCardType.air&&(e+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAirSoldierMaxHPAddPercent),o+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAirSoldierAttackAddPercent),i+=n.getValue(A.eAttributeObjectType.player,0,m.sPlayerAttributeConfig.config.buildingAirSoldierAttackIntervalAddPercent))),t.setPosValue(b.sSoldierAttributeConfig.config.maxHP,M.eAttributePos.mul,e/100),t.setPosValue(b.sSoldierAttributeConfig.config.attackInterval,M.eAttributePos.div,i/100),t.setPosValue(b.sSoldierAttributeConfig.config.attack,M.eAttributePos.mul,o/100),t=this.unitAttribute.attributeSystem.getSlot("battleBuff"),o=n.attributeSystem.getValue(m.sPlayerAttributeConfig.config.battleAttackAddPercent),t.setPosValue(b.sSoldierAttributeConfig.config.attack,M.eAttributePos.mul,o/100),n=n.attributeSystem.getValue(m.sPlayerAttributeConfig.config.battleMaxHPAddPercent),t.setPosValue(b.sSoldierAttributeConfig.config.maxHP,M.eAttributePos.mul,n/100),(n=this.unitAttribute.attributeSystem.getSlot("ext")).addPosValue(b.sSoldierAttributeConfig.config.maxHP,M.eAttributePos.mul,a/100),n.addPosValue(b.sSoldierAttributeConfig.config.attack,M.eAttributePos.mul,a/100),this._afterInit()},U.prototype.onLoad=function(){},U.prototype.onEnable=function(){var t=this;this.currentAnimationName=r.animationNameDic[d.idle],this.dropGoldAnim&&(this.dropGoldAnim.node.parent.opacity=0),this.setSpine(),G.sGGame.on(B.sLocalBattleEvent.battleTimeScaleChanged,function(){t.resetSpineScale()},this),G.sGGame.on(B.sLocalBattleEvent.buffChanged,function(){var e=t.unitAttribute.attributeSystem.getSlot("battleBuff"),o=G.sGGame.localModel.getModule(A.LocalAttribute),i=o.attributeSystem.getValue(m.sPlayerAttributeConfig.config.battleAttackAddPercent);e.setPosValue(b.sSoldierAttributeConfig.config.attack,M.eAttributePos.mul,i/100),o=o.attributeSystem.getValue(m.sPlayerAttributeConfig.config.battleMaxHPAddPercent),e.setPosValue(b.sSoldierAttributeConfig.config.maxHP,M.eAttributePos.mul,o/100),t.unitHealth.maxHP=t.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.maxHP),t.unitHealth.onHeal(void 0,t.unitHealth.maxHP)},this)},U.prototype.onDisable=function(){this.spineLoaded=!1,P.sGNode.targetOff(this),G.sGGame.targetOff(this)},U.prototype.destorySelf=function(){var t=this;this.dropGoldLabel&&(this.dropGoldLabel.string=S.sGNumber.toHuman(this.soldier.entry.dropGold)),this.dropGoldAnim&&this.unit.teamID===B.enumTeam.enemy&&(this.dropGoldAnim.node.parent.opacity=255,this.dropGoldAnim.play()),this.unitSpine&&this.spineLoaded?(this.unitSpine.setCompleteListener(function(){t.unitSpine.setCompleteListener(void 0),P.sGNode.destoryNode(t.node)}),this.unitSpine.setAnimation(0,r.animationNameDic[d.die],!1),this.unitSpine.clearTrack(1),this.avatarEntry.dieSound&&v.sGAudio.playEffect(h.sAudioConfig.getEntry(this.avatarEntry.dieSound))):P.sGNode.destoryNode(this.node)},U.prototype.isFaceRight=function(){return this.unit.teamID===B.enumTeam.player&&this.avatarEntry.spineFaceRight||this.unit.teamID===B.enumTeam.enemy&&!this.avatarEntry.spineFaceRight},U.prototype.setSpine=function(){var t=this;this.spineLoaded=!1,P.sGNode.setSpine(this.unitSpine,this.avatarEntry.spine,null,null,function(e){e.setEventListener(function(e,o){if("hit"==o.data.name){var i=t.unit.battleManager.getNearestHostileUnit(t.unit.getComponent(f),t.unit.teamID);if(i.getComponent(O.default)&&i.unitID===t.targetUnitID)if(t.attackState==s.range&&t.soldier.entry.bullet)for(var a=i.node.getPosition(),n=(a=(o=i.getComponent(f))?a.add(cc.v2(t.isFaceRight()?-o.avatarEntry.hitOffset[0]:o.avatarEntry.hitOffset[0],o.avatarEntry.hitOffset[1])):a.add(cc.v2(0,50)),t.node.getPosition().add(cc.v2((t.isFaceRight(),t.avatarEntry.shootOffset[0]),t.avatarEntry.shootOffset[1]))),r=(a=a.sub(n),180*cc.v2(1,0).signAngle(cc.v2(a.x,a.y))/Math.PI),l=t._getAttack(),c=t.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.shootCount),u=0;u<c;++u)t.unit.battleManager.createBullet(t.unit,t.soldier.entry.bullet,n.x,n.y,r,1,l,t.unit.teamID);else l=t._getAttack(),t.unit.onAttackDamage(i,l);t.attackState===s.melee?t.avatarEntry.hitSound&&v.sGAudio.playEffect(h.sAudioConfig.getEntry(t.avatarEntry.hitSound)):t.attackState===s.range&&t.avatarEntry.rangeHitSound&&v.sGAudio.playEffect(h.sAudioConfig.getEntry(t.avatarEntry.rangeHitSound))}}),t.unitSpine.node.parent.scaleX=t.isFaceRight()?Math.abs(t.unitSpine.node.parent.scaleX):-Math.abs(t.unitSpine.node.parent.scaleX),t.unitSpine.findAnimation(r.animationNameDic[d.melee])&&t.unitSpine.setMix(r.animationNameDic[d.melee],r.animationNameDic[d.idle],.2),t.unitSpine.findAnimation(r.animationNameDic[d.range])&&t.unitSpine.setMix(r.animationNameDic[d.range],r.animationNameDic[d.idle],.2),t.spineLoaded=!0,t.resetSpineScale()},this)},U.prototype.updateAttack=function(t,e){var o=this;this.updatePassTime+=e;var i,a,n,l=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.spineScale)/100;l!=this.spineTimeScale&&(this.spineTimeScale=l,this.resetSpineScale()),this.unitBuffPackage.hasFlag(I.eFlagType.cantAction)?this.attackState=s.idle:this.attackState!=s.skill&&(i=Math.abs(t.node.x-this.node.x),a=t.getComponent(f),n=t.getComponent(T.default),e=this.soldier.entry.meleeAttackDistance,l=this.soldier.entry.rangeAttackDistance,a?(0<e&&(e=this.soldier.entry.meleeAttackDistance+this.soldier.entry.bodyWidth/2+a.soldier.entry.bodyWidth/2),0<l&&(l=this.soldier.entry.rangeAttackDistance+this.soldier.entry.bodyWidth/2+a.soldier.entry.bodyWidth/2)):n&&(0<e&&(e=this.soldier.entry.meleeAttackDistance+this.soldier.entry.bodyWidth/2),0<l&&(l=this.soldier.entry.rangeAttackDistance+this.soldier.entry.bodyWidth/2)),this.attackState!==s.melee&&this.attackState!==s.range&&this.unitSpine&&this.spineLoaded&&(this.attackPassTime=this.updatePassTime-this.lastAttackPassTime,this.targetUnitID=0,a=!1,n=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.attackInterval),0==l&&i<e?(this.attackPassTime>n&&(this.attackState=s.melee,this.unitSpine.setAnimation(1,r.animationNameDic[d.melee],!1)),a=!0):0<l&&i<l&&(this.attackPassTime>n&&(this.attackState=s.range,this.unitSpine.findAnimation(r.animationNameDic[d.range])?this.unitSpine.setAnimation(1,r.animationNameDic[d.range],!1):this.unitSpine.setAnimation(1,r.animationNameDic[d.melee],!1)),a=!0),a?(this.soldier.entry.skillID&&0==this.unitSkillPackage.checkUseSkill(this.soldier.entry.skillID)&&this.unitSkillPackage.useSkill(this.soldier.entry.skillID),this.attackPassTime>n?(this.targetUnitID=t.unitID,this.lastAttackPassTime=this.updatePassTime,this.unitSpine.setCompleteListener(function(t){1===t.trackIndex&&(o.attackState=s.waitAttack,o.attackPassTime=0,o.unitSpine.clearTrack(1),o.unitSpine.setCompleteListener(null))})):this.attackState=s.waitAttack):this.attackState=s.idle))},U.prototype.updateMove=function(t,e){var o,i;this.unitSpine&&this.spineLoaded&&(this.unitBuffPackage.hasFlag(I.eFlagType.cantAction)||this.unitBuffPackage.hasFlag(I.eFlagType.cantMove)?(i=u.stand,this.moveState!==i&&(this.moveState=i,this.unitSpine.setAnimation(0,r.animationNameDic[d.idle],!0))):(o=u.stand,this.attackState===s.idle&&(o=u.move),this.moveState==u.move&&((i=this.node.getPosition()).x=i.x+e*this._getMoveSpeed(),this.node.setPosition(i)),this.moveState!==o&&(this.moveState=o,this.moveState==u.move?this.unitSpine.setAnimation(0,r.animationNameDic[d.move],!0):this.unitSpine.setAnimation(0,r.animationNameDic[d.idle],!0))))},U.prototype.updateAutoRecover=function(t){0!==this.autoRecoverSeconds&&(this.autoRecoverSeconds-=t,this.autoRecoverSeconds<0?this.autoRecoverSeconds=0:(this.autoRecoverTriggerPassTime+=t,.025<this.autoRecoverTriggerPassTime&&(this.autoRecoverTriggerPassTime=0,t=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.maxHP),this.unitHealth.hp<t&&(this.unitHealth.hp+=1))))},U.prototype._getMoveSpeed=function(){if(this.unitBuffPackage.hasFlag(I.eFlagType.cantAction)||this.unitBuffPackage.hasFlag(I.eFlagType.cantMove))return 0;var t=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.moveSpeed);return 1===this.unit.teamID?Math.abs(t):-Math.abs(t)},U.prototype._getAttack=function(){var t=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.attack);return Math.floor(t)},U.prototype.onAttackDamage=function(t,e){var o=t.getComponent(f),i=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.criticalChance),a=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.criticalDamage),n=O.eUnitHurtType.normal;0<i&&0<a&&100*Math.random()<i&&(e=Math.floor(e*a/100),C.sGLog.debug("soldier("+this.unit.teamID+":"+this.unit.unitID+") critical"),n=O.eUnitHurtType.critical);var l=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.splashDamage);if(0<l){for(var c=this.unit.battleManager.getAttackableDistanceHostileUnit(this,250),s=0;s<c.length;++s){var u=c[s];u!=o&&u.onHurt(this.unit,Math.floor(e*l/100),O.eUnitHurtType.splash)}C.sGLog.debug("soldier("+this.unit.teamID+":"+this.unit.unitID+") splash")}0<(a=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.extDamage))&&o&&(d=Math.floor(e*a/100),o.onHurt(this.unit,d,O.eUnitHurtType.extra),C.sGLog.debug("soldier("+this.unit.teamID+":"+this.unit.unitID+") extDamage")),a=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.suckBloodChance);var d=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.suckBlood);0<a&&0<d&&o&&100*Math.random()<a&&(this.unit.onHeal(this.unit,Math.ceil(d*e/100)),C.sGLog.debug("soldier("+this.unit.teamID+":"+this.unit.unitID+") Suck Blood")),0<(d=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.oneHitKillChance))&&o&&o.unitHealth.hp<.3*o.unitHealth.maxHP&&100*Math.random()<d&&(e=o.unitHealth.maxHP,C.sGLog.debug("soldier("+this.unit.teamID+":"+this.unit.unitID+") One Hit Kill")),e=Math.floor(e),this.node.emit(r.sSoldierNodeEvent.attack,t,e),o?o.onHurt(this.unit,e,n):(t=t.getComponent(O.default))&&t.onHurt(this.unit,e,n)},U.prototype.onHurt=function(t,e,o){var i;this.soldier.entry.skillID&&0==this.unitSkillPackage.checkUseSkill(this.soldier.entry.skillID)&&this.unitSkillPackage.useSkill(this.soldier.entry.skillID),this.unitBuffPackage.hasFlag(I.eFlagType.immuneDamage)?(e=0,o=O.eUnitHurtType.immuneDamage):0<(i=this.unitAttribute.attributeSystem.getValue(b.sSoldierAttributeConfig.config.damageReduction))&&(e=Math.floor(e*(100-i)/100),C.sGLog.debug("soldier("+this.unit.teamID+":"+this.unit.unitID+") damageReduction")),e=Math.floor(e),this.unitHealth.onHurt(t,e,o),this.node.emit(r.sSoldierNodeEvent.hurt,t,e)},U.prototype.resetSpineScale=function(){this.spineLoaded&&this.unitSpine&&(this.unitSpine.timeScale=this.spineTimeScaleDown*G.sGGame.localModel.getModule(B.LocalBattle).battleTimeScale*this.spineTimeScaleUp*this.spineTimeScale)},c([n({type:sp.Skeleton,tooltip:"\u58eb\u5175\u9aa8\u9abc\u52a8\u753b"})],U.prototype,"unitSpine",void 0),c([n({type:cc.Animation,tooltip:"\u6389\u843d\u91d1\u5e01\u6839\u8282\u70b9"})],U.prototype,"dropGoldAnim",void 0),c([n({type:cc.Label,tooltip:"\u6389\u843d\u91d1\u5e01\u6570\u5b57"})],U.prototype,"dropGoldLabel",void 0),a=f=c([j,a("Game/Battle/Soldier")],U),r.default=a,cc._RF.pop()},{}],store_button_root_ui:[function(t,e,o){"use strict";cc._RF.push(e,"1d687oHMrJJIprSqkalRw17","store_button_root_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gui"),d=a("gaudio"),p=a("ggame"),f=a("gview_model"),h=a("vm_store"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu);function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t}r(m,c=cc.Component),m.prototype.onLoad=function(){this.button&&this.button.node.on("click",this.onOpenButtonClick.bind(this))},m.prototype.onEnable=function(){this.refresh()},m.prototype.onDisable=function(){p.sGGame.targetOff(this)},m.prototype.onOpenButtonClick=function(){d.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),u.sGUI.openDialogUI("prefabs/ui/shop_bottom")},m.prototype.refresh=function(){this.button&&(this.button.node.active=f.sGViewModel.getModule(h.VMStore).canShowButton())},l([a(cc.Button)],m.prototype,"button",void 0),y=l([g,y("Game/Store/StoreButtonRootUI")],m),n.default=y,cc._RF.pop()},{}],store_placement_201_ui:[function(t,e,o){"use strict";cc._RF.push(e,"2d1e2Ra7sJO56OHQg+ZNnlL","store_placement_201_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("store_goods_config"),d=a("reward_helper"),p=a("gaudio"),f=a("gnode"),h=a("ggame"),g=a("gview_model"),y=a("local_store"),m=a("vm_store"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu);function v(){var t=null!==c&&c.apply(this,arguments)||this;return t.buyButtonAd=null,t.countLabel=null,t.bgRoot=null,t.errorNode=null,t.storePlacementID=201,t.storePlacementRecord=null,t.dtPerSecond=0,t}r(v,c=cc.Component),v.prototype.init=function(t){this.storePlacementID=t,this.enabledInHierarchy&&this._refresh()},v.prototype.onLoad=function(){var t=this;this.buyButtonAd&&this.buyButtonAd.node.on("click",function(){p.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),g.sGViewModel.getModule(m.VMStore).buyGoods(t.storePlacementID)},this)},v.prototype.onEnable=function(){var t=this;this._refresh(),h.sGGame.on(y.sLocalStoreEvent.refreshPlacement,function(e){e===t.storePlacementID&&t._refresh()},this)},v.prototype.onDisable=function(){h.sGGame.targetOff(this),f.sGNode.targetOff(this)},v.prototype.update=function(t){this.dtPerSecond+=t},v.prototype.onButtonTip=function(){var t;this.storePlacementRecord=h.sGGame.localModel.getModule(y.default).getPlacement(this.storePlacementID),!this.storePlacementRecord||(t=u.sStoreGoodsConfig.getEntry(this.storePlacementRecord.goodsID))&&(this.storePlacementRecord=h.sGGame.localModel.getModule(y.default).getPlacement(this.storePlacementID),y.ePayType[t.payType]===y.ePayType.rmb||201===t.id||this.storePlacementRecord.stockLimit&&this.storePlacementRecord.stockNumber)},v.prototype._refresh=function(){if(this.storePlacementID&&(this.storePlacementRecord=h.sGGame.localModel.getModule(y.default).getPlacement(this.storePlacementID),this.storePlacementRecord)){var t=u.sStoreGoodsConfig.getEntry(this.storePlacementRecord.goodsID);if(t){var e=d.RewardList.createFromString(this.storePlacementRecord.rewardString).getReward(0);if(this.countLabel&&(this.countLabel.string="x"+e.count,this.countLabel.node.active=!0),this.bgRoot)for(var o=1;o<5;++o){var i=this.bgRoot.getChildByName("bg"+o);i&&(i.active=t.id%20100===o)}e=0===h.sGGame.localModel.getModule(y.default).checkBuyGoods(this.storePlacementID),this.buyButtonAd&&(this.buyButtonAd.interactable=e),this.errorNode&&(this.errorNode.active=!e)}}},l([a({type:cc.Button,tooltip:"\u5e7f\u544a\u6309\u94ae"})],v.prototype,"buyButtonAd",void 0),l([a({type:cc.Label,tooltip:"\u540d\u5b57"})],v.prototype,"countLabel",void 0),l([a({type:cc.Node,tooltip:"\u80cc\u666f\u6839\u8282\u70b9"})],v.prototype,"bgRoot",void 0),l([a({type:cc.Node,tooltip:"\u4e0d\u53ef\u8d2d\u4e70\u65f6\u7684\u63d0\u793a"})],v.prototype,"errorNode",void 0),_=l([b,_("Game/Store/StorePlacement201UI")],v),n.default=_,cc._RF.pop()},{}],store_placement_pop_ui:[function(t,e,o){"use strict";cc._RF.push(e,"7c9acMB+HxJNrQCMc4EVL2J","store_placement_pop_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("vm_encourage"),u=a("vm_store"),d=a("audio_config"),p=a("encourage_config"),f=a("store_goods_config"),h=a("reward_helper"),g=a("i18n"),y=a("gaudio"),m=a("gnode"),b=a("gtime"),_=a("ggame"),v=a("gview_model"),C=a("local_store"),P=a("vm_reward"),S=(G=cc._decorator).ccclass,G=(a=G.property,G.menu);function M(){var t=null!==c&&c.apply(this,arguments)||this;return t.buyButtonFree=null,t.buyButtonAd=null,t.buyButtonGem=null,t.buyButtonRmb=null,t.buyButtonSubscribe=null,t.bigIconSprite=null,t.iconSprite=null,t.iconBgSprite=null,t.freeNode=null,t.adNode=null,t.gemLabel=null,t.rmbLabel=null,t.cooldownLabel=null,t.cooldownLabelByAd=null,t.stockLabel=null,t.discountDescLabel=null,t.nameLabel=null,t.descLabel=null,t.qualityRoot=null,t.storePlacementID=0,t.storePlacementRecord=null,t.closeCallback=null,t.dtPerSecond=0,t}r(M,c=cc.Component),M.prototype.init=function(t,e){this.storePlacementID=t,this.closeCallback=e,this.enabledInHierarchy&&this._refresh()},M.prototype.onLoad=function(){var t=this;this.buyButtonFree&&this.buyButtonFree.node.on("click",function(){y.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),v.sGViewModel.getModule(u.VMStore).buyGoods(t.storePlacementID)},this),this.buyButtonAd&&this.buyButtonAd.node.on("click",function(){y.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),v.sGViewModel.getModule(u.VMStore).buyGoods(t.storePlacementID)},this),this.buyButtonSubscribe&&this.buyButtonSubscribe.node.on("click",function(){y.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),v.sGViewModel.getModule(u.VMStore).buyGoods(t.storePlacementID)},this),this.buyButtonGem&&this.buyButtonGem.node.on("click",function(){y.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),v.sGViewModel.getModule(u.VMStore).buyGoods(t.storePlacementID)},this),this.buyButtonRmb&&this.buyButtonRmb.node.on("click",function(){y.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),v.sGViewModel.getModule(u.VMStore).buyGoods(t.storePlacementID)},this)},M.prototype.onEnable=function(){var t=this;this._refresh(),_.sGGame.on(C.sLocalStoreEvent.refreshPlacement,function(){t._refresh()},this),_.sGGame.on(C.sLocalStoreEvent.buyGoods,function(){t.close()},this)},M.prototype.onDisable=function(){_.sGGame.targetOff(this),m.sGNode.targetOff(this)},M.prototype.update=function(t){var e;this.dtPerSecond+=t,.2<this.dtPerSecond&&(this.dtPerSecond=0,this.cooldownLabel&&this.cooldownLabel.node.activeInHierarchy?0<(e=_.sGGame.localModel.getModule(C.default).getBuyCooldown(this.storePlacementID))?this.cooldownLabel.string=b.sGTime.toTimeSpanString(e/1e3,!0):this._refresh():this.cooldownLabelByAd&&this.cooldownLabelByAd.node.activeInHierarchy&&(0<(e=_.sGGame.localModel.getModule(C.default).getBuyCooldown(this.storePlacementID))?this.cooldownLabelByAd.string=b.sGTime.toTimeSpanString(e/1e3,!0):this._refresh()))},M.prototype._refresh=function(){if(this.storePlacementID&&(this.storePlacementRecord=_.sGGame.localModel.getModule(C.default).getPlacement(this.storePlacementID),this.storePlacementRecord)){var t=f.sStoreGoodsConfig.getEntry(this.storePlacementRecord.goodsID),e=h.RewardList.createFromString(this.storePlacementRecord.rewardString).getReward(0);if(t.icon?this.iconSprite&&(this.iconSprite.node.parent.active=!0,this.iconBgSprite&&(this.iconBgSprite.node.active=!1),this.bigIconSprite&&(this.bigIconSprite.node.active=!1),m.sGNode.setSprite(this.iconSprite,t.icon,this)):t.bigIcon?this.bigIconSprite&&(this.iconSprite&&(this.iconSprite.node.parent.active=!1),this.iconBgSprite&&(this.iconBgSprite.node.active=!1),this.bigIconSprite.node.active=!0,m.sGNode.setSprite(this.bigIconSprite,t.bigIcon,this)):(this.iconSprite&&(this.iconSprite.node.parent.active=!0,this.bigIconSprite&&(this.bigIconSprite.node.active=!1),m.sGNode.setSprite(this.iconSprite,v.sGViewModel.getModule(P.VMReward).getIcon(e.type,e.id),this)),this.iconBgSprite&&this.iconBgSprite.node.active),this.qualityRoot)for(var o=1;;++o){var i=this.qualityRoot.getChildByName("quality"+o);if(!i)break;i.active=t.quality===o}this.nameLabel&&(this.nameLabel.string=g.i18n.t(t.name)),this.discountDescLabel&&(C.ePayType[t.payType]!==C.ePayType.rmb&&201!==t.id?this.discountDescLabel.node.parent.parent.active=!1:(this.discountDescLabel.node.parent.parent.active=!0,t.discountDesc?(this.discountDescLabel.node.parent.active=!0,this.discountDescLabel.string=g.i18n.t(t.discountDesc)):this.discountDescLabel.node.parent.active=!1));var a=null;switch(C.ePayType[t.payType]){case C.ePayType.free:a=this.buyButtonFree;break;case C.ePayType.ad:s.eEncourageType.rewardedVideoAd,t.encourageID&&_.sGGame.localModel.getModule(s.VMEncourage).preEncourage(p.sEncourageConfig.config[t.encourageID]),a=this.buyButtonAd;break;case C.ePayType.gem:a=this.buyButtonGem;break;case C.ePayType.rmb:a=this.buyButtonRmb}if(this.buyButtonFree&&(this.buyButtonFree.node.active=this.buyButtonFree===a),this.buyButtonAd&&(this.buyButtonAd.node.active=this.buyButtonAd===a),this.buyButtonGem&&(this.buyButtonGem.node.active=this.buyButtonGem===a),this.buyButtonRmb&&(this.buyButtonRmb.node.active=this.buyButtonRmb===a),this.buyButtonSubscribe&&(this.buyButtonSubscribe.node.active=this.buyButtonSubscribe===a),0<(e=_.sGGame.localModel.getModule(C.default).getBuyCooldown(this.storePlacementID)))a&&(a.interactable=!1),this.cooldownLabel&&(this.cooldownLabel.node.active=!0,this.cooldownLabel.string=b.sGTime.toTimeSpanString(e/1e3)),this.cooldownLabelByAd&&(this.cooldownLabelByAd.node.active=!0,this.cooldownLabelByAd.string=b.sGTime.toTimeSpanString(e/1e3)),this.freeNode&&(this.freeNode.active=!1),this.adNode&&(this.adNode.active=!1),this.gemLabel&&(this.gemLabel.node.active=!1),this.rmbLabel&&(this.rmbLabel.node.active=!1);else switch(a&&(a.interactable=!0),this.cooldownLabel&&(this.cooldownLabel.node.active=!1),this.cooldownLabelByAd&&(this.cooldownLabelByAd.node.active=!1),C.ePayType[t.payType]){case C.ePayType.free:this.freeNode&&(this.freeNode.active=!0),this.adNode&&(this.adNode.active=!1),this.gemLabel&&(this.gemLabel.node.active=!1),this.rmbLabel&&(this.rmbLabel.node.active=!1);break;case C.ePayType.ad:this.gemLabel&&(this.gemLabel.node.active=!1),this.adNode&&(this.adNode.active=!0),this.freeNode&&(this.freeNode.active=!1),this.rmbLabel&&(this.rmbLabel.node.active=!1);break;case C.ePayType.gem:this.freeNode&&(this.freeNode.active=!1),this.adNode&&(this.adNode.active=!1),this.gemLabel&&(this.gemLabel.node.active=!0,this.gemLabel.string=t.price.toString()),this.rmbLabel&&(this.rmbLabel.node.active=!1);break;case C.ePayType.rmb:this.freeNode&&(this.freeNode.active=!1),this.adNode&&(this.adNode.active=!1),this.gemLabel&&(this.gemLabel.node.active=!1),this.rmbLabel&&(this.rmbLabel.node.active=!0,this.rmbLabel.string=t.price.toString())}}},M.prototype.onButtonClose=function(){this.close()},M.prototype.close=function(){m.sGNode.destoryNode(this.node),this.closeCallback&&this.closeCallback()},l([a({type:cc.Button,tooltip:"\u514d\u8d39\u6309\u94ae"})],M.prototype,"buyButtonFree",void 0),l([a({type:cc.Button,tooltip:"\u5e7f\u544a\u6309\u94ae"})],M.prototype,"buyButtonAd",void 0),l([a({type:cc.Button,tooltip:"\u94bb\u77f3\u6309\u94ae"})],M.prototype,"buyButtonGem",void 0),l([a({type:cc.Button,tooltip:"\u8d27\u5e01\u6309\u94ae"})],M.prototype,"buyButtonRmb",void 0),l([a({type:cc.Button,tooltip:"\u8ba2\u9605\u514d\u8d39\u6309\u94ae"})],M.prototype,"buyButtonSubscribe",void 0),l([a({type:cc.Sprite,tooltip:"\u5927\u56fe\u6807"})],M.prototype,"bigIconSprite",void 0),l([a({type:cc.Sprite,tooltip:"\u5c0f\u56fe\u6807"})],M.prototype,"iconSprite",void 0),l([a({type:cc.Sprite,tooltip:"\u56fe\u6807\u80cc\u666f"})],M.prototype,"iconBgSprite",void 0),l([a({type:cc.Node,tooltip:"\u514d\u8d39"})],M.prototype,"freeNode",void 0),l([a({type:cc.Node,tooltip:"\u5e7f\u544a"})],M.prototype,"adNode",void 0),l([a({type:cc.Label,tooltip:"\u94bb\u77f3"})],M.prototype,"gemLabel",void 0),l([a({type:cc.Label,tooltip:"\u5b9e\u4f53\u5e01"})],M.prototype,"rmbLabel",void 0),l([a({type:cc.Label,tooltip:"\u514d\u8d39\u51b7\u5374"})],M.prototype,"cooldownLabel",void 0),l([a({type:cc.Label,tooltip:"\u5e7f\u544a\u51b7\u5374"})],M.prototype,"cooldownLabelByAd",void 0),l([a({type:cc.Label,tooltip:"\u5e93\u5b58"})],M.prototype,"stockLabel",void 0),l([a({type:cc.Label,tooltip:"\u6253\u6298\u8bf4\u660e"})],M.prototype,"discountDescLabel",void 0),l([a({type:cc.Label,tooltip:"\u540d\u5b57"})],M.prototype,"nameLabel",void 0),l([a({type:cc.Label,tooltip:"\u63cf\u8ff0"})],M.prototype,"descLabel",void 0),l([a(cc.Node)],M.prototype,"qualityRoot",void 0),G=l([S,G("Game/Store/StorePlacementPopUI")],M),n.default=G,cc._RF.pop()},{}],store_placement_ui:[function(t,e,o){"use strict";cc._RF.push(e,"48123DhpftMaY0IhQhn+nYX","store_placement_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("vm_store"),u=a("audio_config"),d=a("store_goods_config"),p=a("reward_helper"),f=a("i18n"),h=a("gaudio"),g=a("gnode"),y=a("gtime"),m=a("ggame"),b=a("gview_model"),_=a("local_store"),v=a("vm_reward"),C=(P=cc._decorator).ccclass,P=(a=P.property,P.menu);function S(){var t=null!==c&&c.apply(this,arguments)||this;return t.buyButtonFree=null,t.buyButtonAd=null,t.buyButtonGem=null,t.buyButtonRmb=null,t.bigIconSprite=null,t.iconSprite=null,t.iconBgSprite=null,t.freeNode=null,t.adNode=null,t.gemLabel=null,t.rmbLabel=null,t.cooldownLabel=null,t.cooldownLabelByAd=null,t.stockLabel=null,t.discountDescLabel=null,t.nameLabel=null,t.countLabel=null,t.nameLabelWithGem=null,t.nameWithGemNode=null,t.stockEmptyNode=null,t.qualityRoot=null,t.storePlacementID=0,t.reddotNode=null,t.storePlacementRecord=null,t.dtPerSecond=0,t}r(S,c=cc.Component),S.prototype.init=function(t){this.storePlacementID=t,this.enabledInHierarchy&&this._refresh()},S.prototype.onLoad=function(){var t=this;this.buyButtonFree&&this.buyButtonFree.node.on("click",function(){h.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),b.sGViewModel.getModule(s.VMStore).buyGoods(t.storePlacementID)},this),this.buyButtonAd&&this.buyButtonAd.node.on("click",function(){h.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),b.sGViewModel.getModule(s.VMStore).buyGoods(t.storePlacementID)},this),this.buyButtonGem&&this.buyButtonGem.node.on("click",function(){h.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),b.sGViewModel.getModule(s.VMStore).buyGoods(t.storePlacementID)},this),this.buyButtonRmb&&this.buyButtonRmb.node.on("click",function(){h.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),b.sGViewModel.getModule(s.VMStore).buyGoods(t.storePlacementID)},this)},S.prototype.onEnable=function(){var t=this;this._refresh(),m.sGGame.on(_.sLocalStoreEvent.refreshPlacement,function(e){e===t.storePlacementID&&t._refresh()},this)},S.prototype.onDisable=function(){m.sGGame.targetOff(this),g.sGNode.targetOff(this)},S.prototype.update=function(t){var e;this.dtPerSecond+=t,.2<this.dtPerSecond&&(this.dtPerSecond=0,this.cooldownLabel&&this.cooldownLabel.node.activeInHierarchy?0<(e=m.sGGame.localModel.getModule(_.default).getBuyCooldown(this.storePlacementID))?this.cooldownLabel.string=y.sGTime.toTimeSpanString(e/1e3,!0):this._refresh():this.cooldownLabelByAd&&this.cooldownLabelByAd.node.activeInHierarchy&&(0<(e=m.sGGame.localModel.getModule(_.default).getBuyCooldown(this.storePlacementID))?this.cooldownLabelByAd.string=y.sGTime.toTimeSpanString(e/1e3,!0):this._refresh()))},S.prototype.onButtonTip=function(){var t;this.storePlacementRecord=m.sGGame.localModel.getModule(_.default).getPlacement(this.storePlacementID),!this.storePlacementRecord||(t=d.sStoreGoodsConfig.getEntry(this.storePlacementRecord.goodsID))&&(this.storePlacementRecord=m.sGGame.localModel.getModule(_.default).getPlacement(this.storePlacementID),_.ePayType[t.payType]===_.ePayType.rmb||201===t.id||this.storePlacementRecord.stockLimit&&this.storePlacementRecord.stockNumber)},S.prototype._refresh=function(){if(this.storePlacementID&&(this.storePlacementRecord=m.sGGame.localModel.getModule(_.default).getPlacement(this.storePlacementID),this.storePlacementRecord)){var t=d.sStoreGoodsConfig.getEntry(this.storePlacementRecord.goodsID);if(t){var e,o=p.RewardList.createFromString(this.storePlacementRecord.rewardString).getReward(0);if(t.icon){if(this.iconSprite&&(this.iconSprite.node.parent.active=!0,this.iconBgSprite&&(this.iconBgSprite.node.active=!1),this.bigIconSprite&&(this.bigIconSprite.node.active=!1),g.sGNode.setSprite(this.iconSprite,t.icon,this)),this.qualityRoot)for(var i=1;i<=5;++i)(a=this.qualityRoot.getChildByName("quality"+i))&&(a.active=t.quality===i)}else if(t.bigIcon){if(this.bigIconSprite&&(this.iconSprite&&(this.iconSprite.node.parent.active=!1),this.iconBgSprite&&(this.iconBgSprite.node.active=!1),this.bigIconSprite.node.active=!0,g.sGNode.setSprite(this.bigIconSprite,t.bigIcon,this)),this.qualityRoot)for(i=1;i<=5;++i)(a=this.qualityRoot.getChildByName("quality"+i))&&(a.active=t.quality===i)}else if(this.iconSprite&&(this.iconSprite.node.parent.active=!0,this.bigIconSprite&&(this.bigIconSprite.node.active=!1),g.sGNode.setSprite(this.iconSprite,b.sGViewModel.getModule(v.VMReward).getIcon(o.type,o.id),this)),this.iconBgSprite&&(this.iconBgSprite.node.active=!1),this.qualityRoot){var a,n=b.sGViewModel.getModule(v.VMReward).getQuality(o.type,o.id);for(i=1;i<=5;++i)(a=this.qualityRoot.getChildByName("quality"+i))&&(a.active=n===i)}this.nameLabel&&(t.name,e=t.name?f.i18n.t(t.name):b.sGViewModel.getModule(v.VMReward).getName(o.type,o.id),this.nameLabel.string=e,this.nameLabel.node.active=!0),this.countLabel&&(this.countLabel.string=b.sGViewModel.getModule(v.VMReward).getCount(o.type,o.count),this.countLabel.node.active=!0),this.nameWithGemNode&&(this.nameWithGemNode.parent.active=!1),this.discountDescLabel&&(_.ePayType[t.payType]!==_.ePayType.rmb&&201!==t.id?this.discountDescLabel.node.parent.parent.active=!1:(this.discountDescLabel.node.parent.parent.active=!0,t.discountDesc?(this.discountDescLabel.node.parent.active=!0,this.discountDescLabel.string=f.i18n.t(t.discountDesc)):this.discountDescLabel.node.parent.active=!1)),this.stockEmptyNode&&(this.stockEmptyNode.active=this.storePlacementRecord.stockLimit&&!this.storePlacementRecord.stockNumber);var r=null;switch(_.ePayType[t.payType]){case _.ePayType.free:r=this.buyButtonFree,this.buyButtonFree&&(this.buyButtonFree.node.active=!0),this.buyButtonAd&&(this.buyButtonAd.node.active=!1),this.buyButtonGem&&(this.buyButtonGem.node.active=!1),this.buyButtonRmb&&(this.buyButtonRmb.node.active=!1);break;case _.ePayType.ad:r=this.buyButtonAd,this.buyButtonFree&&(this.buyButtonFree.node.active=!1),this.buyButtonAd&&(this.buyButtonAd.node.active=!0),this.buyButtonGem&&(this.buyButtonGem.node.active=!1),this.buyButtonRmb&&(this.buyButtonRmb.node.active=!1);break;case _.ePayType.gem:r=this.buyButtonGem,this.buyButtonFree&&(this.buyButtonFree.node.active=!1),this.buyButtonAd&&(this.buyButtonAd.node.active=!1),this.buyButtonGem&&(this.buyButtonGem.node.active=!0),this.buyButtonRmb&&(this.buyButtonRmb.node.active=!1);break;case _.ePayType.rmb:r=this.buyButtonRmb,this.buyButtonFree&&(this.buyButtonFree.node.active=!1),this.buyButtonAd&&(this.buyButtonAd.node.active=!1),this.buyButtonGem&&(this.buyButtonGem.node.active=!1),this.buyButtonRmb&&(this.buyButtonRmb.node.active=!0)}if(0<(o=m.sGGame.localModel.getModule(_.default).getBuyCooldown(this.storePlacementID)))r&&(r.interactable=!1),this.cooldownLabel&&(this.cooldownLabel.node.active=!0,this.cooldownLabel.string=y.sGTime.toTimeSpanString(o/1e3)),this.cooldownLabelByAd&&(this.cooldownLabelByAd.node.active=!0,this.cooldownLabelByAd.string=y.sGTime.toTimeSpanString(o/1e3)),this.freeNode&&(this.freeNode.active=!1),this.adNode&&(this.adNode.active=!1),this.gemLabel&&(this.gemLabel.node.active=!1),this.rmbLabel&&(this.rmbLabel.node.active=!1),this.reddotNode&&(this.reddotNode.active=!1);else switch(r&&(r.interactable=!this.storePlacementRecord.stockLimit||this.storePlacementRecord.stockNumber),this.cooldownLabel&&(this.cooldownLabel.node.active=!1),this.cooldownLabelByAd&&(this.cooldownLabelByAd.node.active=!1),_.ePayType[t.payType]){case _.ePayType.free:this.freeNode&&(this.freeNode.active=!0),this.adNode&&(this.adNode.active=!1),this.gemLabel&&(this.gemLabel.node.active=!1),this.rmbLabel&&(this.rmbLabel.node.active=!1),this.reddotNode&&(this.reddotNode.active=!0);break;case _.ePayType.ad:this.gemLabel&&(this.gemLabel.node.active=!1),this.adNode&&(this.adNode.active=!0),this.freeNode&&(this.freeNode.active=!1),this.rmbLabel&&(this.rmbLabel.node.active=!1),this.reddotNode&&(this.reddotNode.active=!1);break;case _.ePayType.gem:this.freeNode&&(this.freeNode.active=!1),this.adNode&&(this.adNode.active=!1),this.gemLabel&&(this.gemLabel.node.active=!0,this.gemLabel.string="x"+t.price.toString()),this.rmbLabel&&(this.rmbLabel.node.active=!1),this.reddotNode&&(this.reddotNode.active=!1);break;case _.ePayType.rmb:}}}},l([a({type:cc.Button,tooltip:"\u514d\u8d39\u6309\u94ae"})],S.prototype,"buyButtonFree",void 0),l([a({type:cc.Button,tooltip:"\u5e7f\u544a\u6309\u94ae"})],S.prototype,"buyButtonAd",void 0),l([a({type:cc.Button,tooltip:"\u94bb\u77f3\u6309\u94ae"})],S.prototype,"buyButtonGem",void 0),l([a({type:cc.Button,tooltip:"\u8d27\u5e01\u6309\u94ae"})],S.prototype,"buyButtonRmb",void 0),l([a({type:cc.Sprite,tooltip:"\u5927\u56fe\u6807"})],S.prototype,"bigIconSprite",void 0),l([a({type:cc.Sprite,tooltip:"\u5c0f\u56fe\u6807"})],S.prototype,"iconSprite",void 0),l([a({type:cc.Sprite,tooltip:"\u56fe\u6807\u80cc\u666f"})],S.prototype,"iconBgSprite",void 0),l([a({type:cc.Node,tooltip:"\u514d\u8d39"})],S.prototype,"freeNode",void 0),l([a({type:cc.Node,tooltip:"\u5e7f\u544a"})],S.prototype,"adNode",void 0),l([a({type:cc.Label,tooltip:"\u94bb\u77f3"})],S.prototype,"gemLabel",void 0),l([a({type:cc.Label,tooltip:"\u5b9e\u4f53\u5e01"})],S.prototype,"rmbLabel",void 0),l([a({type:cc.Label,tooltip:"\u514d\u8d39\u51b7\u5374"})],S.prototype,"cooldownLabel",void 0),l([a({type:cc.Label,tooltip:"\u5e7f\u544a\u51b7\u5374"})],S.prototype,"cooldownLabelByAd",void 0),l([a({type:cc.Label,tooltip:"\u5e93\u5b58"})],S.prototype,"stockLabel",void 0),l([a({type:cc.Label,tooltip:"\u6253\u6298\u8bf4\u660e"})],S.prototype,"discountDescLabel",void 0),l([a({type:cc.Label,tooltip:"\u540d\u5b57"})],S.prototype,"nameLabel",void 0),l([a({type:cc.Label,tooltip:"\u540d\u5b57"})],S.prototype,"countLabel",void 0),l([a({type:cc.Label,tooltip:"\u94bb\u77f3\u540d\u5b57"})],S.prototype,"nameLabelWithGem",void 0),l([a({type:cc.Node,tooltip:"\u540d\u5b57\u7684\u94bb\u77f3\u524d\u7f00"})],S.prototype,"nameWithGemNode",void 0),l([a({type:cc.Node,tooltip:"\u5e93\u5b58\u7a7a\u7f3a"})],S.prototype,"stockEmptyNode",void 0),l([a(cc.Node)],S.prototype,"qualityRoot",void 0),l([a],S.prototype,"storePlacementID",void 0),l([a(cc.Node)],S.prototype,"reddotNode",void 0),P=l([C,P("Game/Store/StorePlacementUI")],S),n.default=P,cc._RF.pop()},{}],store_ui:[function(t,e,o){"use strict";cc._RF.push(e,"ff082GBBsxEq4vDO+Woza4W","store_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s,u=a("encourage_icon_ui"),d=a("vm_encourage"),p=a("vm_store"),f=a("audio_config"),h=a("encourage_config"),g=a("store_goods_config"),y=a("store_goods_placement_config"),m=a("gaudio"),b=a("gnode"),_=a("gtime"),v=a("ggame"),C=a("gview_model"),P=a("local_store"),S=a("store_placement_ui"),G=(M=cc._decorator).ccclass,M=(a=M.property,M.menu);function w(){var t=null!==c&&c.apply(this,arguments)||this;return t.storeSlotCellRootArray=[],t.refreshButton=null,t.refreshTimeLabel=null,t.adNode=null,t.refreshGemLabel=null,t.scrollview=null,t.placementNodeArray=[],t.placementUINodeDic=new Map,t.encourageIconUI=null,t.dtPerSecond=0,t}r(w,c=cc.Component),(s=w).prototype.onLoad=function(){var t=this;this.refreshButton&&this.refreshButton.node.on("click",function(){m.sGAudio.playEffect(f.sAudioConfig.config.buttonClick),0<v.sGGame.localModel.getModule(P.default).getTodayMaunalTimes()?C.sGViewModel.getModule(d.VMEncourage).encourage(h.sEncourageConfig.config.manualRefreshStore,t.encourageType,function(){C.sGViewModel.getModule(p.VMStore).manualRefresh()}):C.sGViewModel.getModule(p.VMStore).manualRefresh()},this)},w.prototype.onEnable=function(){var t=this;if(this.storeSlotCellRootArray.length){this.encourageType=C.sGViewModel.getModule(d.VMEncourage).preEncourage(h.sEncourageConfig.config.manualRefreshStore),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType);var e,o=v.sGGame.localModel.getModule(P.default),i=this;for(e in y.sStoreGoodsPlacementConfig.config)!function(e){for(var a=parseInt(e),n=y.sStoreGoodsPlacementConfig.getEntry(a),r=void 0,l=0;l<i.storeSlotCellRootArray.length;++l){var c=i.storeSlotCellRootArray[l];if(c&&(r=c.getChildByName("strip_root"+n.id)))break}r&&!i.placementUINodeDic.get(a)&&(e=o.getPlacement(n.id),"randomFragment"!==g.sStoreGoodsConfig.getEntry(e.goodsID).goodsType?b.sGNode.createNode("prefabs/ui/shop_prop_strip",r,function(e){var o=e.getComponent(S.default);o&&o.init(n.id),t.placementUINodeDic.set(a,e)},i):b.sGNode.createNode("prefabs/ui/shop_fragment_strip",r,function(e){var o=e.getComponent(S.default);o&&o.init(n.id),t.placementUINodeDic.set(a,e)},i))}(e);v.sGGame.on(P.sLocalStoreEvent.refreshStore,function(){},this),s.scrollOffset&&this.scrollview&&this.scrollview.scrollToOffset(s.scrollOffset)}},w.prototype.onDisable=function(){this.scrollview&&(s.scrollOffset=this.scrollview.getScrollOffset()),v.sGGame.targetOff(this),b.sGNode.targetOff(this)},w.prototype.update=function(t){var e;this.dtPerSecond+=t,.2<this.dtPerSecond&&(this.dtPerSecond=0,e=v.sGGame.localModel.getModule(P.default),this.refreshTimeLabel&&(t=e.getRefreshCooldown(),this.refreshTimeLabel.string=_.sGTime.toTimeSpanString(t/1e3,!0)),this.adNode&&(this.adNode.active=0<e.getTodayMaunalTimes()))},w.scrollOffset=null,l([a({type:cc.Node,tooltip:"\u5404\u7ec4\u8d27\u67b6\u6761\u6839\u8282\u70b9"})],w.prototype,"storeSlotCellRootArray",void 0),l([a(cc.Button)],w.prototype,"refreshButton",void 0),l([a(cc.Label)],w.prototype,"refreshTimeLabel",void 0),l([a(cc.Node)],w.prototype,"adNode",void 0),l([a(cc.Label)],w.prototype,"refreshGemLabel",void 0),l([a(cc.ScrollView)],w.prototype,"scrollview",void 0),l([a(u.default)],w.prototype,"encourageIconUI",void 0),M=s=l([G,M("Game/Store/StoreUI")],w),n.default=M,cc._RF.pop()},{}],tech_air_drop_button_root:[function(t,e,o){"use strict";cc._RF.push(e,"103f1kpAxZKfKK7twdlVQr6","tech_air_drop_button_root");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gui"),d=a("gaudio"),p=a("gtime"),f=a("ggame"),h=a("local_tech"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu);function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t.remainTime=null,t.passTime=0,t}r(m,c=cc.Component),m.prototype.onLoad=function(){this.button&&this.button.node.on("click",this.onOpenButtonClick.bind(this))},m.prototype.onEnable=function(){var t=this;f.sGGame.on(h.sLocalTechEvent.collectAirDrop,function(){t.refresh()},this),f.sGGame.on(h.sLocalTechEvent.airDropDisapear,function(){t.refresh()},this),this.refresh()},m.prototype.onDisable=function(){f.sGGame.targetOff(this)},m.prototype.update=function(t){var e=f.sGGame.localModel.getModule(h.LocalTechPackage),o=e.hasAirDrop();o&&(this.button&&(this.button.node.active=o),this.passTime+=t,.3<this.passTime&&(this.passTime=0,this.remainTime&&(e=e.remainTimeOfAirDrop(),this.remainTime.string=p.sGTime.toTimeSpanString(0<=e?e:0))))},m.prototype.onOpenButtonClick=function(){d.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),f.sGGame.localModel.getModule(h.LocalTechPackage).hasAirDrop()&&u.sGUI.openDialogUI("prefabs/ui/airdrop_bottom_pop")},m.prototype.refresh=function(){var t=f.sGGame.localModel.getModule(h.LocalTechPackage).hasAirDrop();this.button&&(this.button.node.active=t),t&&this.remainTime&&(t=f.sGGame.localModel.getModule(h.LocalTechPackage).remainTimeOfAirDrop(),this.remainTime.string=p.sGTime.toTimeSpanString(0<=t?t:0))},l([a(cc.Button)],m.prototype,"button",void 0),l([a(cc.Label)],m.prototype,"remainTime",void 0),y=l([g,y("Game/Tech/TechAirDropButtonRoot")],m),n.default=y,cc._RF.pop()},{}],tech_air_drop_ui:[function(t,e,o){"use strict";cc._RF.push(e,"577bctoIAxKp78ikC3QZwjC","tech_air_drop_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("encourage_config"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_tech"),b=a("vm_reward"),_=a("gnumber"),v=(C=cc._decorator).ccclass,C=(a=C.property,C.menu);function P(){var t=null!==c&&c.apply(this,arguments)||this;return t.adConfirmButton=null,t.collectButton=null,t.closeButton=null,t.cardPointLabel=null,t.encourageIconUI=null,t}r(P,c=cc.Component),P.prototype.onLoad=function(){this.adConfirmButton&&this.adConfirmButton.node.on("click",this.onAdConfirmClick.bind(this)),this.collectButton&&this.collectButton.node.on("click",this.onCollectClick.bind(this)),this.closeButton&&this.closeButton.node.on("click",this.onCloseButtonClick.bind(this))},P.prototype.onEnable=function(){var t;this.encourageType=y.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.techAirDrop),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType),this.cardPointLabel&&(t=g.sGGame.localModel.getModule(m.LocalTechPackage).getAirDropValue(),this.cardPointLabel.string=_.sGNumber.toHuman(t)),f.sGAudio.playEffect(d.sAudioConfig.config.popUI)},P.prototype.onDisable=function(){g.sGGame.targetOff(this)},P.prototype.onAdConfirmClick=function(){var t=this;f.sGAudio.playEffect(d.sAudioConfig.config.buttonClick);var e=g.sGGame.localModel.getModule(m.LocalTechPackage);y.sGViewModel.getModule(u.VMEncourage).encourage(p.sEncourageConfig.config.techAirDrop,this.encourageType,function(){e.collectAirDrop(!0,function(e,o){e||(h.sGNode.destoryNode(t.node),y.sGViewModel.getModule(b.VMReward).openRewardResult(o.rewardList))})})},P.prototype.onCloseButtonClick=function(){f.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),h.sGNode.destoryNode(this.node)},P.prototype.onCollectClick=function(){var t=this;f.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),g.sGGame.localModel.getModule(m.LocalTechPackage).collectAirDrop(!1,function(e,o){e||(h.sGNode.destoryNode(t.node),y.sGViewModel.getModule(b.VMReward).openRewardResult(o.rewardList))})},l([a(cc.Button)],P.prototype,"adConfirmButton",void 0),l([a(cc.Button)],P.prototype,"collectButton",void 0),l([a(cc.Button)],P.prototype,"closeButton",void 0),l([a(cc.Label)],P.prototype,"cardPointLabel",void 0),l([a(s.default)],P.prototype,"encourageIconUI",void 0),C=l([v,C("Game/Tech/TechAirDropUI")],P),n.default=C,cc._RF.pop()},{}],template_scroll_view_cell_ui:[function(t,e,o){"use strict";cc._RF.push(e,"bbb34ESqhFJvqCZ4RTjHocC","template_scroll_view_cell_ui");var i,a=o,n=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var r,l=(c=cc._decorator).ccclass,c=(c.property,c.menu);function s(){var t=null!==r&&r.apply(this,arguments)||this;return t.fastScrollViewCell=null,t}n(s,r=cc.Component),s.prototype.onLoad=function(){},s.prototype.onEnable=function(){},c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([l,c("Game/UI/TemplateScrollViewCellUI")],s),a.default=c,cc._RF.pop()},{}],template_scroll_view_ui:[function(t,e,o){"use strict";cc._RF.push(e,"e69a67EOlNEKYGp+WPBuqmh","template_scroll_view_ui");var i,a=o,n=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var r,l=(c=cc._decorator).ccclass,c=(c.property,c.menu);function s(){var t=null!==r&&r.apply(this,arguments)||this;return t.fastScrollView=null,t}n(s,r=cc.Component),s.prototype.onLoad=function(){},s.prototype.onEnable=function(){},c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([l,c("Game/UI/TemplateScrollViewUI")],s),a.default=c,cc._RF.pop()},{}],test_button_ui2:[function(t,e,o){"use strict";cc._RF.push(e,"0b26a9vgrJMY76shZNtZE70","test_button_ui2");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("client_config"),u=a("player_attribute_config"),d=a("glog"),p=a("ggame"),f=a("gview_model"),h=a("local_attribute"),g=a("local_building"),y=a("local_card"),m=a("vm_reward"),b=(_=cc._decorator).ccclass,_=(a=_.property,_.menu);function v(){var t=null!==c&&c.apply(this,arguments)||this;return t.clickButton=null,t}r(v,c=cc.Component),v.prototype.onLoad=function(){this.clickButton&&(this.clickButton.node.active=s.sClientConfig.config.devMode,this.clickButton.node.active&&this.clickButton.node.on("click",function(){var t,e=p.sGGame.localModel.getModule(h.LocalAttribute);for(t in u.sPlayerAttributeConfig.config){var o=u.sPlayerAttributeConfig.getEntry(t);d.sGLog.info(o.name+" = "+e.attributeSystem.getValue(o))}p.sGGame.localModel.getModule(y.LocalCardPackage).freeMultiPull(10,function(t,e){t||f.sGViewModel.getModule(m.VMReward).openRewardResult(e.rewardList)}),p.sGGame.localModel.getModule(g.LocalBuildingPackage).testAllUpgrade()},this))},l([a({displayName:"\u70b9\u51fb\u6309\u94ae",type:cc.Button})],v.prototype,"clickButton",void 0),_=l([b,_("Game/Main/TestButtonUI2")],v),n.default=_,cc._RF.pop()},{}],test_button_ui3:[function(t,e,o){"use strict";cc._RF.push(e,"fd115QMibhPeaZljKTD55tj","test_button_ui3");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("client_config"),u=a("stage_config"),d=a("input_ui"),p=a("gui"),f=a("gnode"),h=a("ggame"),g=a("local_stage"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.clickButton=null,t}r(b,c=cc.Component),b.prototype.onLoad=function(){var t=this;this.clickButton&&(this.clickButton.node.active=s.sClientConfig.config.devMode,this.clickButton.node.active&&this.clickButton.node.on("click",function(){p.sGUI.openDialogUI("prefabs/ui/input_ui",function(t){t&&t.getComponent(d.default).init("Input Pass StageID",function(e){var o,i;e&&(!(o=parseInt(e))||(i=u.sStageConfig.getEntry(o))&&(e=h.sGGame.localModel.getModule(g.LocalStage),i.nextID?(e.currentPassStageID=o,e.currentBattleStageID=i.nextID):e.currentPassStageID=e.currentBattleStageID=o),f.sGNode.destoryNode(t))})},t)},this))},l([a({displayName:"\u70b9\u51fb\u6309\u94ae",type:cc.Button})],b.prototype,"clickButton",void 0),m=l([y,m("Game/Main/TestButtonUI3")],b),n.default=m,cc._RF.pop()},{}],test_button_ui4:[function(t,e,o){"use strict";cc._RF.push(e,"1975e3IFolAwKhWA9rp+ngN","test_button_ui4");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("vm_guide"),u=a("client_config"),d=a("input_ui"),p=a("gui"),f=a("gnode"),h=a("gview_model"),g=(y=cc._decorator).ccclass,y=(a=y.property,y.menu);function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.clickButton=null,t}r(m,c=cc.Component),m.prototype.onLoad=function(){var t=this;this.clickButton&&(this.clickButton.node.active=u.sClientConfig.config.devMode,this.clickButton.node.active&&this.clickButton.node.on("click",function(){p.sGUI.openDialogUI("prefabs/ui/input_ui",function(t){t&&t.getComponent(d.default).init("Input GuideID",function(e){e&&((e=parseInt(e))&&h.sGViewModel.getModule(s.VMGuide).testGuide(e),f.sGNode.destoryNode(t))})},t)},this))},l([a({displayName:"\u70b9\u51fb\u6309\u94ae",type:cc.Button})],m.prototype,"clickButton",void 0),y=l([g,y("Game/Main/TestButtonUI4")],m),n.default=y,cc._RF.pop()},{}],test_button_ui:[function(t,e,o){"use strict";cc._RF.push(e,"a71bbJnCwxIYLhGTICzcRgZ","test_button_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("client_config"),u=a("gtime"),d=(p=cc._decorator).ccclass,p=(a=p.property,p.menu);function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.clickButton=null,t}r(f,c=cc.Component),f.prototype.onLoad=function(){this.clickButton&&(this.clickButton.node.active=s.sClientConfig.config.devMode,this.clickButton.node.active&&this.clickButton.node.on("click",function(){u.sGTime.resetStartTime(u.sGTime.timestamp()+864e5)},this))},l([a({displayName:"\u70b9\u51fb\u6309\u94ae",type:cc.Button})],f.prototype,"clickButton",void 0),p=l([d,p("Game/Main/TestButtonUI")],f),n.default=p,cc._RF.pop()},{}],test_ui:[function(t,e,o){"use strict";cc._RF.push(e,"d4a13svF3dE17KmlQsONyk0","test_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("player_attribute_config"),u=a("glog"),d=a("gnode"),p=a("gtime"),f=a("ggame"),h=a("gview_model"),g=a("local_attribute"),y=a("local_stage"),m=a("local_card"),b=a("local_reward"),_=a("reason_define"),v=a("vm_reward"),C=(P=cc._decorator).ccclass,P=(a=P.property,P.menu);function S(){var t=null!==c&&c.apply(this,arguments)||this;return t.closeButton=null,t.stageLabel=null,t.timeLabel=null,t}r(S,c=cc.Component),S.prototype.onLoad=function(){var t=this;this.closeButton&&this.closeButton.node.active&&this.closeButton.node.on("click",function(){d.sGNode.destoryNode(t.node)},this)},S.prototype.update=function(){var t;this.stageLabel&&(t=f.sGGame.localModel.getModule(y.LocalStage).currentBattleStageEntry,this.stageLabel.string=t.name),this.timeLabel&&(this.timeLabel.string=p.sGTime.format(p.sGTime.timestamp()))},S.prototype.onResetTime=function(){p.sGTime.resetStartTime(p.sGTime.timestamp()+864e5)},S.prototype.onPull1000=function(){f.sGGame.localModel.getModule(m.LocalCardPackage).pullTest()},S.prototype.onShowPlayerAttr=function(){var t,e=f.sGGame.localModel.getModule(g.LocalAttribute);for(t in s.sPlayerAttributeConfig.config){var o=s.sPlayerAttributeConfig.getEntry(t);u.sGLog.info(o.name+" = "+e.attributeSystem.getValue(o))}},S.prototype.onPull10=function(){var t=f.sGGame.localModel.getModule(b.LocalReward).takeRewardString("randomCard/0/10",!0,1,_.eReasonType.freeMultiPullCard);h.sGViewModel.getModule(v.VMReward).openRewardResult(t.rewardList)},S.prototype.onAddStage10=function(){},l([a({displayName:"\u5173\u95ed\u6309\u94ae",type:cc.Button})],S.prototype,"closeButton",void 0),l([a({displayName:"\u5173\u5361\u6807\u9898",type:cc.Label})],S.prototype,"stageLabel",void 0),l([a({displayName:"\u65f6\u95f4\u6807\u9898",type:cc.Label})],S.prototype,"timeLabel",void 0),P=l([C,P("Game/Main/TestUI")],S),n.default=P,cc._RF.pop()},{}],treasure_chest_button_ui:[function(t,e,o){"use strict";cc._RF.push(e,"a974cNxtFRB3L7uNDKS/AfI","treasure_chest_button_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("gui"),d=a("gaudio"),p=a("gnode"),f=a("ggame"),h=a("local_stage"),g=a("treasure_chest_preview_ui"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.root=null,t}r(b,c=cc.Component),b.prototype.init=function(){},b.prototype.onLoad=function(){this.localStage=f.sGGame.localModel.getModule(h.LocalStage)},b.prototype.onEnable=function(){var t=this;f.sGGame.on(h.sLocalStageEvent.currentTreasureChestStageIDChanged,function(){t.refresh()},this),this.refresh()},b.prototype.onDisable=function(){f.sGGame.targetOff(this),p.sGNode.targetOff(this)},b.prototype.onClick=function(){var t=this;d.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),u.sGUI.openDialogUI("prefabs/ui/treasure_chest_reward",function(e){!e||(e=e.getComponent(g.default))&&e.init(t.localStage.getCurrentTreasureChestStageID())},this)},b.prototype.refresh=function(){this.root&&(this.root.active=0==this.localStage.checkTakeTreasureChest())},l([a({displayName:"\u6309\u94ae\u8282\u70b9",type:cc.Node})],b.prototype,"root",void 0),m=l([y,m("Game/Stage/TreasureChestButtonUI")],b),n.default=m,cc._RF.pop()},{}],treasure_chest_icon_ui:[function(t,e,o){"use strict";cc._RF.push(e,"bc5c1DK8XpK0K1buRyuPfDO","treasure_chest_icon_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var c,s=a("gui"),u=a("gnode"),d=a("ggame"),p=a("treasure_chest_preview_ui");function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.stageID=0,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,l(f,c=cc.Component),f.prototype.init=function(t){this.stageID=t},f.prototype.onDisable=function(){d.sGGame.targetOff(this),u.sGNode.targetOff(this)},f.prototype.onClick=function(){var t=this;s.sGUI.openDialogUI("prefabs/ui/treasure_chest_preview",function(e){!e||(e=e.getComponent(p.default))&&e.init(t.stageID)},this)},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Stage/TreasureChestIconUI")],f),r.default=n,cc._RF.pop()},{}],treasure_chest_preview_ui:[function(t,e,o){"use strict";cc._RF.push(e,"965e0yatU5G06BIM1uqy9Q3","treasure_chest_preview_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("stage_config"),u=a("gnode"),d=a("ggame"),p=(f=cc._decorator).ccclass,f=(a=f.property,f.menu);function h(){var t=null!==c&&c.apply(this,arguments)||this;return t.labelStageName=null,t.stageID=0,t}r(h,c=cc.Component),h.prototype.init=function(t){this.stageID=t},h.prototype.onEnable=function(){var t=s.sStageConfig.getEntry(this.stageID);this.labelStageName&&(this.labelStageName.string=t.name)},h.prototype.onDisable=function(){d.sGGame.targetOff(this),u.sGNode.targetOff(this)},l([a(cc.Label)],h.prototype,"labelStageName",void 0),f=l([p,f("Game/Stage/TreasureChestPreviewUI")],h),n.default=f,cc._RF.pop()},{}],treasure_chest_reward_ui:[function(t,e,o){"use strict";cc._RF.push(e,"c0c79bN0yxGzo+MDuMwSJFG","treasure_chest_reward_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("encourage_config"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_stage"),b=a("vm_reward"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.encourageIconUI=null,t}r(C,c=cc.Component),C.prototype.init=function(){},C.prototype.onEnable=function(){void 0===this.encourageType&&(this.encourageType=y.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.stageTreasureChestReward)),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType)},C.prototype.onDisable=function(){g.sGGame.targetOff(this),h.sGNode.targetOff(this)},C.prototype.onClick=function(){var t=this;f.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),y.sGViewModel.getModule(u.VMEncourage).encourage(p.sEncourageConfig.config.stageTreasureChestReward,this.encourageType,function(){var e=g.sGGame.localModel.getModule(m.LocalStage).takeTreasureChest();e&&y.sGViewModel.getModule(b.VMReward).openRewardResult(e.rewardList),h.sGNode.destoryNode(t.node)})},l([a({displayName:"\u6fc0\u52b1\u56fe\u6807",type:s.default})],C.prototype,"encourageIconUI",void 0),v=l([_,v("Game/Stage/TreasureChestRewardUI")],C),n.default=v,cc._RF.pop()},{}],unit_attribute:[function(t,e,o){"use strict";cc._RF.push(e,"478a7EHTyBAvImVWkBTXVE1","unit_attribute");var i,a=o,n=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var r,l=(c=cc._decorator).ccclass,c=(c.property,c.menu);function s(){return null!==r&&r.apply(this,arguments)||this}n(s,r=cc.Component),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([l,c("Game/Battle/UnitAttribute")],s),a.default=c,cc._RF.pop()},{}],unit_health_ui:[function(t,e,o){"use strict";cc._RF.push(e,"cf0e0i2Q9NGPaiTgDQsas2f","unit_health_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("soldier_attribute_config"),u=a("gnumber"),d=a("game_define"),p=a("building_base"),f=a("unit"),h=a("unit_attribute"),g=a("unit_health"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.hpProgressBar=null,t.hpBarSprite=null,t.unitNode=null,t.hpLabel=null,t.hurtRoot=null,t.health=1,t.maxHealth=1,t.unitHealth=null,t.unitAttribute=null,t.dirty=!0,t.hurted=!1,t}r(b,c=cc.Component),b.prototype.onEnable=function(){var t=this;this.unitNode&&this.hurtRoot&&this.unitNode.on(g.sUnitHealthEvent.hurt,function(){t.hurted||(t.hurted=!0)},this)},b.prototype.onDisable=function(){this.unitNode&&this.hurtRoot&&this.unitNode.targetOff(this)},b.prototype.setHealth=function(t){this.health!==t&&(this.health=Math.floor(t),this.dirty=!0)},b.prototype.setMaxHealth=function(t){this.maxHealth!==t&&(this.maxHealth=Math.floor(t),this.dirty=!0)},b.prototype.update=function(){var t,e;this.unitNode&&!this.unitHealth&&(this.unitHealth=this.unitNode.getComponent(g.default),this.unitAttribute=this.unitNode.getComponent(h.default),e=this.unitNode.getComponent(f.default),this.hpBarSprite&&(this.hpBarSprite.node.color=d.GameDefine.teamColorArray[e.teamID])),this.unitHealth&&(t=this.unitHealth.hp,e=this.unitAttribute.attributeSystem.getValue(s.sSoldierAttributeConfig.config.maxHP),this.setHealth(t),this.setMaxHealth(e),this.dirty&&(this.dirty=!1,e=this.unitNode.getComponent(p.default),this.hpProgressBar&&(this.hpProgressBar.progress=this.health/this.maxHealth,this.hpProgressBar.node.active=!!e||this.hurted),this.hpLabel&&(this.hpLabel.string=u.sGNumber.toHuman(t),this.hpLabel.node.active=!!e||this.hurted)))},l([a(cc.ProgressBar)],b.prototype,"hpProgressBar",void 0),l([a(cc.Sprite)],b.prototype,"hpBarSprite",void 0),l([a(cc.Node)],b.prototype,"unitNode",void 0),l([a(cc.Label)],b.prototype,"hpLabel",void 0),l([a(cc.Node)],b.prototype,"hurtRoot",void 0),m=l([y,m("Game/Battle/UnitHealthUI")],b),n.default=m,cc._RF.pop()},{}],unit_health:[function(t,e,o){"use strict";cc._RF.push(e,"3d16bB9lwxL84+YwWm5kyI3","unit_health");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.UnitDamageResult=n.eUnitHurtType=n.sUnitHealthEvent=void 0;var l,c,s=a("gnode"),u=a("ggame"),d=a("unit"),p=a("unit_shield_package"),f=cc._decorator,h=f.ccclass;function g(){var t=null!==c&&c.apply(this,arguments)||this;return t.maxHP=0,t._hp=0,t.unitHealthUI=null,t.unit=null,t}f.property,a=f.menu,n.sUnitHealthEvent={hurt:"sUnitHealthEvent.hurt",damageResult:"sUnitHealthEvent.damageResult"},(f=l=n.eUnitHurtType||(n.eUnitHurtType={}))[f.invalid=0]="invalid",f[f.normal=1]="normal",f[f.critical=2]="critical",f[f.extra=3]="extra",f[f.splash=4]="splash",f[f.shield=5]="shield",f[f.oneHitKill=6]="oneHitKill",f[f.immuneDamage=7]="immuneDamage",f[f.heal=8]="heal",n.UnitDamageResult=function(){this.unit=null,this.damage=null,this.hurtType=l.normal},r(g,c=cc.Component),Object.defineProperty(g.prototype,"hp",{get:function(){return this._hp},set:function(t){this._hp=Math.floor(t)},enumerable:!1,configurable:!0}),g.prototype.onEnable=function(){this.unit=this.node.getComponent(d.default),this.unitShieldPackage=s.sGNode.addUniqueComponent(this.node,p.default)},g.prototype.onDisable=function(){s.sGNode.targetOff(this)},g.prototype.onHurt=function(t,e,o){e=Math.floor(e),this.node.emit(n.sUnitHealthEvent.hurt,e,this.unit.teamID);var i,a=this.unitShieldPackage.subDamageByShield(e);a<e&&(i={unit:this.unit,damage:e-a,hurtType:l.shield},u.sGGame.emit(n.sUnitHealthEvent.damageResult,i)),0<a&&(this.hp=this.hp-a,i={unit:this.unit,damage:a,hurtType:o},u.sGGame.emit(n.sUnitHealthEvent.damageResult,i),this.hp<0&&(this.hp=0))},g.prototype.onHeal=function(t,e){var o;this.isDead()||(e=Math.floor(e),o=this.hp+e,e={unit:this.unit,damage:e,hurtType:l.heal},u.sGGame.emit(n.sUnitHealthEvent.damageResult,e),o>this.maxHP?this.hp=this.maxHP:this.hp=o)},g.prototype.isDead=function(){return this.hp<=0},a=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([h,a("Game/Battle/UnitHealth")],g),n.default=a,cc._RF.pop()},{}],unit_movement:[function(t,e,o){"use strict";cc._RF.push(e,"bef6bCvmi9OqJcS0BNYntfL","unit_movement");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var c,s=a("geometry"),u=a("gnode"),d=a("map_define");function p(){var t=null!==c&&c.apply(this,arguments)||this;return t.dir=void 0,t.path=void 0,t.startPosition=void 0,t.targetPosition=void 0,t.defineVelocity=300,t.velocity=0,t.moveLength=0,t.targetLength=0,t.passTime=0,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,cc.v2(0,-1),cc.v2(-1,0),cc.v2(0,1),cc.v2(1,0),l(p,c=cc.Component),p.prototype.onEnable=function(){var t=this;this.velocity=0,this.targetPosition=void 0,this.startPosition=void 0,this.passTime=0,cc.director.on(d.sMapEvent.update,function(e){t._updateMovement(e)},this)},p.prototype.stopMove=function(){this.dir=void 0,this.path=void 0},p.prototype.setMoveDir=function(t){this.path=void 0,this.dir=t.clone(),this._trySetNextTarget()},p.prototype.setMoveTarget=function(){var t=cc.v2();t=u.sGNode.convertToNodeSpaceAR(this.node.getParent(),t),this.dir=void 0,this.path=[t],this._trySetNextTarget()},p.prototype._trySetNextTarget=function(){0==this.velocity&&(this.path?0!==this.path.length?this._setNextTargetWithPath():this.path=void 0:!this.dir||this.dir.equals(cc.v2())||this._setNextTargetWithDir())},p.prototype._setNextTargetWithPath=function(){var t=this.path.splice(0,1)[0];this._setTargetPos(t)},p.prototype._setNextTargetWithDir=function(){s.sGGeometry.convertDirNumber(this.dir,90);var t=this.node.getPosition();this._setTargetPos(t)},p.prototype._setTargetPos=function(t){this.startPosition=this.node.getPosition(),this.targetPosition=t,this.targetLength=this.targetPosition.sub(this.startPosition).mag(),this.velocity=this.defineVelocity},p.prototype._updateMovement=function(t){var e;this.targetPosition&&(this.passTime+=t,this.moveLength=this.passTime*this.velocity,this.moveLength>=this.targetLength?(e=this.targetPosition,this.node.setPosition(e),this.velocity=0,this.targetPosition=void 0,this.startPosition=void 0,this.passTime=0,this._trySetNextTarget()):(t=this.targetPosition.sub(this.startPosition).normalize().mul(this.moveLength),e=this.startPosition.add(t),this.node.setPosition(e)))},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/UnitMovement")],p),r.default=n,cc._RF.pop()},{}],unit_search:[function(t,e,o){"use strict";cc._RF.push(e,"6048eGj1fhNF4TeuZZIiyng","unit_search");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0}),r.eSearchType=r.eSearchRelation=void 0;var c,s,u,d=a("local_battle"),p=a("soldier"),f=a("unit");function h(){var t=null!==u&&u.apply(this,arguments)||this;return t.unit=null,t}(n=c=r.eSearchRelation||(r.eSearchRelation={}))[n.self=0]="self",n[n.friendly=1]="friendly",n[n.hostile=2]="hostile",n[n.target=3]="target",(a=s=r.eSearchType||(r.eSearchType={}))[a.invalid=0]="invalid",a[a.distance=1]="distance",a[a.random=2]="random",a[a.lowestHP=3]="lowestHP",a[a.distance250=4]="distance250",a=(n=cc._decorator).ccclass,n.property,n=n.menu,l(h,u=cc.Component),h.prototype.onEnable=function(){this.unit=this.getComponent(f.default)},h.prototype.searchSoldier=function(t,e,o){if(t==c.self)return[this.getComponent(p.default)];var i=this.unit.battleManager;t=t==c.friendly?this.unit.teamID===d.enumTeam.player?i.playerSoldierDic:i.enemySoldierDic:this.unit.teamID===d.enumTeam.enemy?i.playerSoldierDic:i.enemySoldierDic,i=9999,e===s.distance250&&(i=250);var a=this._searchSoldierInDistance(t,i);if(!a||0===a.length)return[];var n=[];if(0===o||o>=a.length){for(var r=0;r<a.length;r++)a[r].unit.getComponent(p.default)&&n.push(a[r].unit.getComponent(p.default));return n}switch(e){case s.distance:case s.distance250:a.sort(function(t,e){return t.distance-e.distance});break;case s.lowestHP:a.sort(function(t,e){return t.hpPercent-e.hpPercent});break;case s.invalid:case s.random:}for(r=0;r<o;)a[r].unit.getComponent(p.default)&&(n.push(a[r].unit.getComponent(p.default)),++r);return n},h.prototype._searchSoldierInDistance=function(t,e){var o,i=[];for(o in t){var a=t[o],n=a.node.getPosition().sub(this.unit.node.getPosition()).mag();n<e&&i.push({unit:a.unit,distance:n,hpPercent:a.unitHealth.hp/a.unitHealth.maxHP})}return i},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/UnitSearch")],h),r.default=n,cc._RF.pop()},{}],unit_shield_package:[function(t,e,o){"use strict";cc._RF.push(e,"40dcbni5JJH2LI8ou+OPZ9u","unit_shield_package");var i,a=t,n=e,r=o;function l(){this.buffID=0,this.shield=0}i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},n=function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},Object.defineProperty(r,"__esModule",{value:!0});var c,s=a("unit"),u=a("unit_skill_buff_package");function d(){var t=null!==c&&c.apply(this,arguments)||this;return t.unitShieldDic={},t}n(d,c=cc.Component),d.prototype.onEnable=function(){},d.prototype.addShield=function(t,e){if(!this.getComponent(s.default).isDead()){var o=this.unitShieldDic[t];return o||((o=new l).buffID=t,this.unitShieldDic[t]=o),o.shield=e,!0}},d.prototype.removeShield=function(t){this.unitShieldDic[t]&&delete this.unitShieldDic[t]},d.prototype.subDamageByShield=function(t){for(var e in this.unitShieldDic){if(!((e=this.unitShieldDic[e]).shield<t)){e.shield=e.shield-t,t=0;break}t-=e.shield,e.shield=0,this.unitBuffPackage||(this.unitBuffPackage=this.getComponent(u.UnitSkillBuffPackage)),this.unitBuffPackage.removeBuff(e.buffID)}return t},n=d,r.default=n,cc._RF.pop()},{}],unit_skill_buff_package:[function(t,e,o){"use strict";cc._RF.push(e,"d76c7/OHFBPBbx0LC1J4TRX","unit_skill_buff_package");var i,a=t,n=e,r=o;i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},n=function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},Object.defineProperty(r,"__esModule",{value:!0}),r.UnitSkillBuffPackage=r.UnitSkillBuff=r.eBuffTriggerEvent=r.eBuffType=r.eFlagType=void 0;var l,c,s,u=a("soldier_buffer_config"),d=a("glog"),p=a("gnode"),f=a("gtime"),h=a("ggame"),g=a("soldier"),y=a("unit_attribute"),m=a("unit_health"),b=a("unit_search"),_=a("unit_shield_package"),v=a("unit_skill_effect");function C(){this.id=0,this.duration=0,this.count=0,this.shieldArray=[],this.triggerCount=0,this.triggerTimestamp=0}function P(){var t=null!==s&&s.apply(this,arguments)||this;return t.unitSkillBuffDic={},t.flagRefDic={},t._inEventExcuting={},t.effectSpineNodeDic={},t}(a=l=r.eFlagType||(r.eFlagType={}))[a.invalid=0]="invalid",a[a.cantMove=1]="cantMove",a[a.cantAction=2]="cantAction",a[a.immuneDamage=3]="immuneDamage",a[a.max=4]="max",(a=r.eBuffType||(r.eBuffType={}))[a.nil=0]="nil",a[a.buff=1]="buff",a[a.debuff=2]="debuff",a[a.max=3]="max",(a=c=r.eBuffTriggerEvent||(r.eBuffTriggerEvent={}))[a.invalid=0]="invalid",a[a.onAddBuff=1]="onAddBuff",a[a.onRemoveBuff=2]="onRemoveBuff",a[a.onAttack=3]="onAttack",a[a.onHurt=4]="onHurt",a[a.max=5]="max",r.UnitSkillBuff=C,n(P,s=cc.Component),P.prototype.onEnable=function(){for(var t=this,e=0;e<l.max;++e)this.flagRefDic[e]=0;for(e=0;e<c.max;++e)this._inEventExcuting[e]=!1;this.unitSkillEffect=p.sGNode.addUniqueComponent(this.node,v.default),this.unitSearch=p.sGNode.addUniqueComponent(this.node,b.default),this.unitShieldPackage=p.sGNode.addUniqueComponent(this.node,_.default),this.node.on(g.sSoldierNodeEvent.attack,function(e){t._onEvent(c.onAttack,e)},this),this.node.on(g.sSoldierNodeEvent.hurt,function(e){t._onEvent(c.onHurt,e)},this)},P.prototype.onDisable=function(){this.removeAllSpineEffect(),p.sGNode.targetOff(this),h.sGGame.targetOff(this),this.node.targetOff(this)},P.prototype.hasFlag=function(t){return!!this.flagRefDic[t]},P.prototype.addBuff=function(t,e){var o=u.sSoldierBufferConfig.getEntry(e);if(o){var i=this.getComponent(m.default);if(i&&!(i.hp<=0)){var a=this.unitSkillBuffDic[e];if(!a){if((a=new C).buffEntry=o,a.duration=0,a.id=e,a.count=0,this._addUnitBuff(a),o.flag&&l[o.flag]&&this.flagRefDic[l[o.flag]]++,o.attributeTypeArray&&0<o.attributeTypeArray.length)for(var n=this.getComponent(y.default).attributeSystem.getSlot("buff"),r=0;r<o.attributeTypeArray.length;++r){var s=o.attributeTypeArray[r],p=o.attributePosArray[r],f=o.attributeValueArray[r];n.addPosValue(s,p,f)}o.shield&&this.unitShieldPackage.addShield(a.id,Math.ceil(o.shield/100*i.maxHP)),this._doSkillEffect(c.onAddBuff,a),this.addSpineEffect(a.id,a.buffEntry.spine,a.buffEntry.animations)}return a.sourceUnitID!==t.unit.unitID&&(a.sourceUnitID=t.unit.unitID),a.duration=o.duration,d.sGLog.debug("add buff "+e),!0}}},P.prototype.removeBuff=function(t){if(t=this.unitSkillBuffDic[t]){var e=t.buffEntry;if(this._removeUnitBuff(t),e.flag&&l[e.flag]&&this.flagRefDic[l[e.flag]]--,e.attributeTypeArray&&0<e.attributeTypeArray.length)for(var o=this.getComponent(y.default).attributeSystem.getSlot("buff"),i=0;i<e.attributeTypeArray.length;++i){var a=e.attributeTypeArray[i],n=e.attributePosArray[i],r=e.attributeValueArray[i];o.addPosValue(a,n,-r)}e.shield&&this.unitShieldPackage.removeShield(t.id),this.removeSpineEffect(t.id),this._doSkillEffect(c.onRemoveBuff,t),d.sGLog.debug("remove buff "+e.id)}},P.prototype.getBuff=function(t){return this.unitSkillBuffDic[t]},P.prototype._doSkillEffect=function(t,e,o){void 0===o&&(o=null);var i=e.buffEntry;if(c[i.triggerEvent]===t&&(t=f.sGTime.timestamp(),!(e.buffEntry.triggerInterval&&t-e.triggerTimestamp<1e3*e.buffEntry.triggerInterval||e.buffEntry.triggerChance&&100*Math.random()>=e.buffEntry.triggerChance))){for(var a=0;a<i.triggerTargetRelation.length;++a)for(var n=i.triggerTargetRelation[a],r=i.triggerTargetSearch&&a<i.triggerTargetSearch.length?i.triggerTargetSearch[a]:"invalid",l=i.triggerTargetCount&&a<i.triggerTargetCount.length?i.triggerTargetCount[a]:1,s=i.triggerSkillEffectType&&a<i.triggerSkillEffectType.length?i.triggerSkillEffectType[a]:"",u=i.triggerSkillEffectParam&&a<i.triggerSkillEffectParam.length?i.triggerSkillEffectParam[a]:1,d=b.eSearchRelation[n]===b.eSearchRelation.target?o?[o]:[]:this.unitSearch.searchSoldier(b.eSearchRelation[n],b.eSearchType[r],l),p=0;p<d.length;++p){var h=d[p];this.unitSkillEffect.addSkillEffect(h,s,u)}e.triggerCount++,e.triggerTimestamp=f.sGTime.timestamp(),e.buffEntry.triggerLimit&&e.triggerCount>=e.buffEntry.triggerLimit&&this.removeBuff(e.id)}},P.prototype.battleUpdate=function(t){for(var e in this.unitSkillBuffDic){var o=this.unitSkillBuffDic[e];o&&(e=!1,0<o.duration&&(t>=o.duration?e=!(o.duration=0):o.duration-=t),e&&this.removeBuff(o.id))}},P.prototype.addSpineEffect=function(t,e,o){var i,a;e&&(this.effectSpineNodeDic[t]&&(a=this.effectSpineNodeDic[t],p.sGNode.targetOff(a),p.sGNode.destoryNode(a),delete this.effectSpineNodeDic[t]),(a=(i=new cc.Node).addComponent(sp.Skeleton)).premultipliedAlpha=!1,this.node.addChild(i),p.sGNode.setSpine(a,e,null,null,function(t){if(t)for(var e=0;e<o.length;++e){var i=o[e];e==o.length-1?t.addAnimation(0,i,!0):t.addAnimation(0,i,!1)}},i),this.effectSpineNodeDic[t]=i)},P.prototype.removeSpineEffect=function(t){var e;this.effectSpineNodeDic[t]&&(e=this.effectSpineNodeDic[t],p.sGNode.targetOff(e),p.sGNode.destoryNode(e),delete this.effectSpineNodeDic[t])},P.prototype.removeAllSpineEffect=function(){for(var t in this.effectSpineNodeDic)t=this.effectSpineNodeDic[t],p.sGNode.targetOff(t),p.sGNode.destoryNode(t);this.effectSpineNodeDic={}},P.prototype._addUnitBuff=function(t){this.unitSkillBuffDic[t.id]=t},P.prototype._removeUnitBuff=function(t){t&&delete this.unitSkillBuffDic[t.id]},P.prototype._onEvent=function(t,e){if(!this._inEventExcuting[t]){for(var o in this._inEventExcuting[t]=!0,this.unitSkillBuffDic)o=this.unitSkillBuffDic[o],this._doSkillEffect(t,o,e?e.getComponent(g.default):null);this._inEventExcuting[t]=!1}},n=P,r.UnitSkillBuffPackage=n,cc._RF.pop()},{}],unit_skill_effect:[function(t,e,o){"use strict";cc._RF.push(e,"04753+N2jZEILzu1lR+w5DJ","unit_skill_effect");var i,a=t,n=e,r=o;i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},n=function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},Object.defineProperty(r,"__esModule",{value:!0}),r.eSkillEffectType=void 0;var l,c,s=a("soldier_attribute_config"),u=a("glog"),d=a("soldier"),p=a("unit"),f=a("unit_attribute"),h=a("unit_health"),g=a("unit_skill_buff_package");function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.skillEffectCallbackDic={},t}(a=l=r.eSkillEffectType||(r.eSkillEffectType={}))[a.invalid=0]="invalid",a[a.buff=1]="buff",a[a.damagePercent=2]="damagePercent",a[a.damageTargetMaxHPPercent=3]="damageTargetMaxHPPercent",a[a.damage=4]="damage",a[a.damageTimes=5]="damageTimes",a[a.healPercent=6]="healPercent",a[a.heal=7]="heal",a[a.max=8]="max",n(y,c=cc.Component),y.prototype.onEnable=function(){this._register(l.buff,this._addSkillBuff.bind(this)),this._register(l.damage,this._addSkillDamage.bind(this)),this._register(l.damagePercent,this._addSkillDamagePercent.bind(this)),this._register(l.damageTargetMaxHPPercent,this._addSkillDamageTargetMaxHPPercent.bind(this)),this._register(l.damageTimes,this._addSkillDamageTimes.bind(this)),this._register(l.healPercent,this._addSkillHealPercent.bind(this)),this._register(l.heal,this._addSkillHeal.bind(this))},y.prototype._register=function(t,e){this.skillEffectCallbackDic[t]=e},y.prototype.addSkillEffect=function(t,e,o){var i=this.skillEffectCallbackDic[l[e]];u.sGLog.debug("add skill effect "+e+" "+o),i&&(u.sGLog.debug("callback skill effect "+e+" "+o),i(t,o))},y.prototype._addSkillBuff=function(t,e){(t=t.getComponent(g.UnitSkillBuffPackage))&&t.addBuff(this.getComponent(d.default),e)},y.prototype._addSkillDamage=function(t,e){(t=t.getComponent(p.default))&&t.onHurt(this.getComponent(p.default),e,h.eUnitHurtType.normal)},y.prototype._addSkillDamagePercent=function(t,e){var o=t.getComponent(p.default);t=this.getComponent(f.default),o&&t&&(t=t.attributeSystem.getValue(s.sSoldierAttributeConfig.config.attack),o.onHurt(this.getComponent(p.default),Math.ceil(t*e/100),h.eUnitHurtType.normal))},y.prototype._addSkillDamageTimes=function(t,e){var o=t.getComponent(p.default);if(t=this.getComponent(f.default),o&&t)for(var i=t.attributeSystem.getValue(s.sSoldierAttributeConfig.config.attack),a=0;a<e;++a)o.onHurt(this.getComponent(p.default),Math.floor(i),h.eUnitHurtType.normal)},y.prototype._addSkillDamageTargetMaxHPPercent=function(t,e){var o=t.getComponent(p.default);t=t.getComponent(f.default),o&&t&&(t=t.attributeSystem.getValue(s.sSoldierAttributeConfig.config.maxHP),o.onHurt(this.getComponent(p.default),Math.ceil(t*e/100),h.eUnitHurtType.normal))},y.prototype._addSkillHeal=function(t,e){(t=t.getComponent(p.default))&&t.onHeal(this.getComponent(p.default),e)},y.prototype._addSkillHealPercent=function(t,e){var o=t.getComponent(p.default);t=t.getComponent(f.default),o&&t&&(t=t.attributeSystem.getValue(s.sSoldierAttributeConfig.config.maxHP),o.onHeal(this.getComponent(p.default),Math.ceil(t*e/100)))},n=y,r.default=n,cc._RF.pop()},{}],unit_skill_package:[function(t,e,o){"use strict";cc._RF.push(e,"c672ac9ZpxGHq1asYJF+dy8","unit_skill_package");var i,a=t,n=e,r=o;i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},n=function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},Object.defineProperty(r,"__esModule",{value:!0}),r.UnitSkill=r.eUseSkillError=void 0;var l,c,s=a("soldier_skill_config"),u=a("spine_player"),d=a("glog"),p=a("gnode"),f=a("ggame"),h=a("unit_health"),g=a("unit_search"),y=a("unit_shield_package"),m=a("unit_skill_buff_package"),b=a("unit_skill_effect");function _(){this.cd=0,this.useTimes=0}function v(){var t=null!==c&&c.apply(this,arguments)||this;return t.skillDic={},t.tempSpineAiid=0,t.tempEffectSpineNodeDic={},t}(a=l=r.eUseSkillError||(r.eUseSkillError={}))[a.ok=0]="ok",a[a.inCD=1]="inCD",a[a.dead=2]="dead",a[a.flagForbid=3]="flagForbid",a[a.skillNotExist=4]="skillNotExist",a[a.inUsing=5]="inUsing",r.UnitSkill=_,n(v,c=cc.Component),v.prototype.onEnable=function(){p.sGNode.addUniqueComponent(this.node,m.UnitSkillBuffPackage),p.sGNode.addUniqueComponent(this.node,y.default),this.unitSkillEffect=p.sGNode.addUniqueComponent(this.node,b.default),this.unitSearch=p.sGNode.addUniqueComponent(this.node,g.default)},v.prototype.onDisable=function(){p.sGNode.targetOff(this),f.sGGame.targetOff(this),this.removeAllTempSpine()},v.prototype.battleUpdate=function(t){for(var e in this.skillDic)0<(e=this.skillDic[e]).cd&&(e.cd-=t)},v.prototype.addSkill=function(t){var e,o=this.skillDic[t];o||(e=s.sSoldierSkillConfig.getEntry(t))&&((o=new _).entry=e,this.skillDic[t]=o)},v.prototype.getSkill=function(t){return this.skillDic[t]},v.prototype.checkUseSkill=function(t){return(t=this.getSkill(t))?this.getComponent(h.default).hp<=0?l.dead:t.entry.cd?0<t.cd?l.inCD:l.ok:0==t.useTimes?l.ok:l.inCD:l.skillNotExist},v.prototype.useSkill=function(t){var e=this.checkUseSkill(t);return 0!==e?e:((e=this.skillDic[t]).useTimes++,e.cd=e.entry.cd,this._doSkillEffect(e),e.entry.spine&&this.addTempSpine(e.entry.spine,e.entry.animations),d.sGLog.debug("use skill "+t),0)},v.prototype._doSkillEffect=function(t){for(var e=t.entry,o=0;o<e.triggerTargetRelation.length;++o)for(var i=e.triggerTargetRelation[o],a=e.triggerTargetSearch&&o<e.triggerTargetSearch.length?e.triggerTargetSearch[o]:"invalid",n=e.triggerTargetCount&&o<e.triggerTargetCount.length?e.triggerTargetCount[o]:1,r=e.triggerSkillEffectType&&o<e.triggerSkillEffectType.length?e.triggerSkillEffectType[o]:"",l=e.triggerSkillEffectParam&&o<e.triggerSkillEffectParam.length?e.triggerSkillEffectParam[o]:1,c=this.unitSearch.searchSoldier(g.eSearchRelation[i],g.eSearchType[a],n),s=0;s<c.length;++s){var u=c[s];this.unitSkillEffect.addSkillEffect(u,r,l),e.targetSpine&&u.unitSkillPackage.addTempSpine(e.targetSpine,e.targetAnimations)}},v.prototype.addTempSpine=function(t,e){var o,i,a,n=this;t&&(this.tempSpineAiid++,o=this.tempSpineAiid,(i=new cc.Node).addComponent(sp.Skeleton).premultipliedAlpha=!1,this.node.addChild(i),this.tempEffectSpineNodeDic[o]=i,(a=p.sGNode.addUniqueComponent(i,u.default)).init(t,e,1,function(){p.sGNode.destoryNode(i),delete n.tempEffectSpineNodeDic[o]}),a.play())},v.prototype.removeAllTempSpine=function(){for(var t in this.tempEffectSpineNodeDic)t=this.tempEffectSpineNodeDic[t],p.sGNode.targetOff(t),p.sGNode.destoryNode(t);this.tempEffectSpineNodeDic={}},n=v,r.default=n,cc._RF.pop()},{}],unit:[function(t,e,o){"use strict";cc._RF.push(e,"996c5ebB/9HqLIaue6AK0bN","unit");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var c,s=a("local_battle"),u=a("soldier"),d=a("unit_health");function p(){var t=null!==c&&c.apply(this,arguments)||this;return t.unitID=0,t.teamID=s.enumTeam.enemy,t.battleManager=null,t.unitType=s.enumUnitType.invalid,t}a=(n=cc._decorator).ccclass,n.property,n=n.menu,l(p,c=cc.Component),p.prototype.init=function(t,e,o,i){this.unitID=t,this.unitType=e,this.battleManager=i,this.teamID=o},p.prototype.onAttackDamage=function(t,e){var o=this.getComponent(u.default);o?o.onAttackDamage(t,e):t.onHurt(this,e,d.eUnitHurtType.normal)},p.prototype.onHurt=function(t,e,o){var i=this.getComponent(u.default);i?i.onHurt(t,e,o):(i=this.getComponent(d.default))&&i.onHurt(t,e,o)},p.prototype.onHeal=function(t,e){var o=this.getComponent(d.default);o&&o.onHeal(t,e)},p.prototype.isDead=function(){var t=this.getComponent(d.default);return!t||t.hp<=0},n=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r}([a,n("Game/Battle/Unit")],p),r.default=n,cc._RF.pop()},{}],vip_button_root_ui:[function(t,e,o){"use strict";cc._RF.push(e,"eab38sNeF1DpYtVmuZKeLbZ","vip_button_root_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("reddot"),u=a("gui"),d=a("ggame"),p=a("gview_model"),f=a("vm_vip"),h=(g=cc._decorator).ccclass,g=(a=g.property,g.menu);function y(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t.passTimeDt1=1,t}r(y,c=cc.Component),y.prototype.onLoad=function(){this.button&&(this.button.node.on("click",this.onOpenButtonClick.bind(this)),this.button.addComponent(s.default).init(function(){return p.sGViewModel.getModule(f.VMVIP).hasVIPReddot()},"root/reddot"))},y.prototype.onEnable=function(){this.refresh()},y.prototype.onDisable=function(){d.sGGame.targetOff(this)},y.prototype.update=function(t){this.passTimeDt1+=t,1<this.passTimeDt1&&(this.passTimeDt1=0,this.refresh())},y.prototype.onOpenButtonClick=function(){u.sGUI.openDialogUI("prefabs/ui/vip_bottom")},y.prototype.refresh=function(){this.button&&(this.button.node.active=p.sGViewModel.getModule(f.VMVIP).canShowButton())},l([a(cc.Button)],y.prototype,"button",void 0),g=l([h,g("Game/Vip/VIPButtonRootUI")],y),n.default=g,cc._RF.pop()},{}],vip_button_ui:[function(t,e,o){"use strict";cc._RF.push(e,"0b176lHpXFKf6w7q3EqDBeY","vip_button_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.VipButtonUIData=void 0;var s,u=a("audio_config"),d=a("gaudio"),p=cc._decorator,f=p.ccclass,h=(n=p.property,a=p.menu,p.executeInEditMode,cc.color(161,161,161));function g(){var t=null!==s&&s.apply(this,arguments)||this;return t.normalNode=null,t.selectedNode=null,t.vipLabel=null,t.isSelected=!1,t.isUnlocked=!1,t}r.VipButtonUIData=function(){},l(g,s=cc.Component),g.prototype.init=function(t){return this.data=t,this},g.prototype.onLoad=function(){this.normalNode=this.node.getChildByName("normal"),this.normalNode&&(this.vipLabel=this.normalNode.getChildByName("Label_lv")),this.selectedNode=this.node.getChildByName("select"),this.node&&this.node.on("click",this.onClickButton.bind(this),this)},g.prototype.onEnable=function(){this.refreshUnlocked(),this.refreshSelected()},g.prototype.onDisable=function(){},g.prototype.onClickButton=function(){d.sGAudio.playEffect(u.sAudioConfig.config.buttonClick),this.data&&this.data.selectCallback&&this.data.selectCallback()},g.prototype.setSelected=function(t){this.isSelected!==t&&(this.isSelected=t,this.refreshSelected())},g.prototype.refreshSelected=function(){this.selectedNode&&(this.selectedNode.active=this.isSelected),this.normalNode&&(this.normalNode.scale=this.isSelected?1:.8)},g.prototype.setUnlocked=function(t){this.isUnlocked!==t&&(this.isUnlocked=t,this.refreshUnlocked())},g.prototype.refreshUnlocked=function(){this.normalNode&&(this.normalNode.color=this.isUnlocked?cc.Color.WHITE:h),this.vipLabel&&(this.vipLabel.color=this.isUnlocked?cc.Color.WHITE:h)},c([n({type:cc.Node,displayName:"\u9009\u62e9\u6309\u94ae"})],g.prototype,"normalNode",void 0),c([n({type:cc.Node,displayName:"\u9009\u4e2d\u5c55\u793a"})],g.prototype,"selectedNode",void 0),a=c([f,a("Game/Vip/VipButtonUI")],g),r.default=a,cc._RF.pop()},{}],vip_first_ad_reward_button_root_ui:[function(t,e,o){"use strict";cc._RF.push(e,"f37betG155IP6AkWh/6WDtY","vip_first_ad_reward_button_root_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("audio_config"),u=a("const_config"),d=a("gui"),p=a("gaudio"),f=a("ggame"),h=a("local_stage"),g=a("local_vip"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.button=null,t}r(b,c=cc.Component),b.prototype.onLoad=function(){this.button&&this.button.node.on("click",this.onOpenButtonClick.bind(this))},b.prototype.onEnable=function(){var t=this;f.sGGame.on(g.sLocalVIPEvent.collectVipADReward,function(){t.refresh()},this),this.refresh()},b.prototype.onDisable=function(){f.sGGame.targetOff(this)},b.prototype.onOpenButtonClick=function(){p.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),f.sGGame.localModel.getModule(g.LocalVIP).isADVIPCollected()||d.sGUI.openDialogUI("prefabs/ui/first_ad_reward_pop")},b.prototype.refresh=function(){var t=f.sGGame.localModel.getModule(g.LocalVIP).isADVIPCollected();this.button&&(this.button.node.active=!t&&f.sGGame.localModel.getModule(h.LocalStage).isSystemIsOpened(u.sConstConfig.config.checkInPopUnlockStage))},l([a(cc.Button)],b.prototype,"button",void 0),m=l([y,m("Game/Vip/VIPFirstADRewardButtonRootUI")],b),n.default=m,cc._RF.pop()},{}],vip_first_ad_reward_ui:[function(t,e,o){"use strict";cc._RF.push(e,"e7f0cXdXRJH8YVs7AJ7ood8","vip_first_ad_reward_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("encourage_icon_ui"),u=a("vm_encourage"),d=a("audio_config"),p=a("encourage_config"),f=a("gaudio"),h=a("gnode"),g=a("ggame"),y=a("gview_model"),m=a("local_vip"),b=a("vm_reward"),_=(v=cc._decorator).ccclass,v=(a=v.property,v.menu);function C(){var t=null!==c&&c.apply(this,arguments)||this;return t.adConfirmButton=null,t.closeButton=null,t.encourageIconUI=null,t}r(C,c=cc.Component),C.prototype.onLoad=function(){this.adConfirmButton&&this.adConfirmButton.node.on("click",this.onAdConfirmClick.bind(this)),this.closeButton&&this.closeButton.node.on("click",this.onCloseButtonClick.bind(this))},C.prototype.onEnable=function(){this.encourageType=y.sGViewModel.getModule(u.VMEncourage).preEncourage(p.sEncourageConfig.config.firstADChest),this.encourageIconUI&&this.encourageIconUI.setEncourageType(this.encourageType)},C.prototype.onDisable=function(){g.sGGame.targetOff(this)},C.prototype.onAdConfirmClick=function(){var t=this;f.sGAudio.playEffect(d.sAudioConfig.config.buttonClick);var e=g.sGGame.localModel.getModule(m.LocalVIP);y.sGViewModel.getModule(u.VMEncourage).encourage(p.sEncourageConfig.config.firstADChest,this.encourageType,function(){e.collectADVIPReward(function(e,o){e||(h.sGNode.destoryNode(t.node),y.sGViewModel.getModule(b.VMReward).openRewardResult(o.rewardList))})})},C.prototype.onCloseButtonClick=function(){f.sGAudio.playEffect(d.sAudioConfig.config.buttonClick),h.sGNode.destoryNode(this.node)},l([a(cc.Button)],C.prototype,"adConfirmButton",void 0),l([a(cc.Button)],C.prototype,"closeButton",void 0),l([a(s.default)],C.prototype,"encourageIconUI",void 0),v=l([_,v("Game/Vip/VIPFirstADRewardUI")],C),n.default=v,cc._RF.pop()},{}],vip_ui:[function(t,e,o){"use strict";cc._RF.push(e,"82a73NqrZNAv5In5NM2CbrL","vip_ui");var i,a=t,n=e,r=o,l=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var s,u=a("audio_config"),d=a("client_config"),p=a("player_attribute_config"),f=a("vip_config"),h=a("scroll_process_bar"),g=a("i18n"),y=a("gaudio"),m=a("gnode"),b=a("ggame"),_=a("local_vip"),v=a("vip_button_ui"),C=cc._decorator,P=C.ccclass;function S(){var t=null!==s&&s.apply(this,arguments)||this;return t.vipButtonRoot=null,t.vipButtonUIArray=[],t.expTitleLabel=null,t.expProgressBar=null,t.expScrollProgressBar=null,t.expLabel=null,t.contentTitleLabel=null,t.maxActionCurrencyLabel=null,t.maxTurnTableFreeTimesLabel=null,t.maxTurnTableAdTimesLabel=null,t.maxBuyActionCurrencyTimesLabel=null,t.maxRandomCardTimesLabel=null,t.maxOfflineHoursLabel=null,t.currentLevel=1,t}n=C.property,a=C.menu,C.executeInEditMode,l(S,s=cc.Component),S.prototype.onLoad=function(){var t=this;if(this.vipButtonRoot)for(var e=this,o=1;"break"!==function(o){if(!f.sVipConfig.getEntry(o))return"break";var i,a=void 0,n=e.vipButtonRoot.getChildByName("vip"+o+"_button");n&&((i=new v.VipButtonUIData).selectCallback=function(){t.onSelect(o)},a=m.sGNode.addUniqueComponent(n,v.default).init(i)),e.vipButtonUIArray.push(a)}(o);++o);this.expProgressBar&&(this.expScrollProgressBar=m.sGNode.addUniqueComponent(this.expProgressBar,h.default)),d.sClientConfig.config.devMode&&this.expLabel&&(m.sGNode.addUniqueComponent(this.expLabel,cc.Button),this.expLabel.node.on("click",function(){b.sGGame.localModel.getModule(_.LocalVIP).addExp(10)},this))},S.prototype.onSelect=function(t){this.currentLevel!=t&&(this.currentLevel=t,this.refreshVipLevel())},S.prototype.onEnable=function(){var t=this;b.sGGame.on(_.sLocalVIPEvent.expChanged,function(){t.refreshVipExp()},this),b.sGGame.on(_.sLocalVIPEvent.levelChanged,function(){t.refreshVipExp()},this),this.refreshVipExp(),this.currentLevel=b.sGGame.localModel.getModule(_.LocalVIP).getCurrentLevel(),0===this.currentLevel&&(this.currentLevel=1),this.refreshVipLevel(),y.sGAudio.playEffect(u.sAudioConfig.config.popUI)},S.prototype.onDisable=function(){b.sGGame.targetOff(this)},S.prototype.refreshVipExp=function(){var t=b.sGGame.localModel.getModule(_.LocalVIP),e=t.getNextEntry(),o=(e=e||t.getCurrentEntry())?e.exp:0;this.expTitleLabel&&(this.expTitleLabel.string=e?g.i18n.t("vip.labelExpTitle").replace("${vip}",e.id.toString()):""),this.expScrollProgressBar&&(0<o?(this.expScrollProgressBar.node.active=!0,this.expScrollProgressBar.setProgress(t.getCurrentExp()/o)):this.expScrollProgressBar.node.active=!1),this.expLabel&&(0<o?(this.expLabel.node.active=!0,this.expLabel.string=t.getCurrentExp()+"/"+o):this.expLabel.node.active=!1);for(var i=t.getCurrentLevel(),a=0;a<this.vipButtonUIArray.length;++a){var n=this.vipButtonUIArray[a];n&&n.setUnlocked(a+1<=i)}},S.prototype.refreshVipLevel=function(){for(var t=0;t<this.vipButtonUIArray.length;++t){var e=this.vipButtonUIArray[t];e&&e.setSelected(t+1===this.currentLevel)}var o=f.sVipConfig.getEntry(this.currentLevel);this.contentTitleLabel&&(this.contentTitleLabel.string=g.i18n.t("vip.labelContentTitle").replace("${vip}",this.currentLevel.toString())),this.maxActionCurrencyLabel&&(this.maxActionCurrencyLabel.string=(p.sPlayerAttributeConfig.config.maxActionCurrency.init+o.moreActionCurrency).toString()),this.maxTurnTableFreeTimesLabel&&(this.maxTurnTableFreeTimesLabel.string=(p.sPlayerAttributeConfig.config.maxTurnTableFreeTimes.init+o.moreTurnTableFreeTimes).toString()),this.maxTurnTableAdTimesLabel&&(this.maxTurnTableAdTimesLabel.string=(p.sPlayerAttributeConfig.config.maxTurnTableAdTimes.init+o.moreTurnTableAdTimes).toString()),this.maxBuyActionCurrencyTimesLabel&&(this.maxBuyActionCurrencyTimesLabel.string=(p.sPlayerAttributeConfig.config.maxBuyActionCurrencyTimes.init+o.moreBuyActionCurrencyTimes).toString()),this.maxRandomCardTimesLabel&&(this.maxRandomCardTimesLabel.string=(p.sPlayerAttributeConfig.config.maxRandomCardTimes.init+o.moreRandomCardTimes).toString()),this.maxOfflineHoursLabel&&(this.maxOfflineHoursLabel.string=(p.sPlayerAttributeConfig.config.maxOfflineHours.init+o.moreOfflineHours).toString())},c([n({type:cc.Node,displayName:"VIP\u6309\u94ae\u6839\u8282\u70b9"})],S.prototype,"vipButtonRoot",void 0),c([n({type:cc.Label,displayName:"VIP\u7ecf\u9a8c\u6761\u540d\u79f0"})],S.prototype,"expTitleLabel",void 0),c([n({type:cc.ProgressBar,displayName:"VIP\u7ecf\u9a8c\u6761"})],S.prototype,"expProgressBar",void 0),c([n({type:cc.Label,displayName:"VIP\u7ecf\u9a8c\u6570\u503c"})],S.prototype,"expLabel",void 0),c([n({type:cc.Label,displayName:"\u7279\u6743\u6807\u9898"})],S.prototype,"contentTitleLabel",void 0),c([n({type:cc.Label,displayName:"\u4f53\u529b\u4e0a\u9650"})],S.prototype,"maxActionCurrencyLabel",void 0),c([n({type:cc.Label,displayName:"\u514d\u8d39\u8f6c\u76d8\u6b21\u6570\u4e0a\u9650"})],S.prototype,"maxTurnTableFreeTimesLabel",void 0),c([n({type:cc.Label,displayName:"\u5e7f\u544a\u8f6c\u76d8\u6b21\u6570\u4e0a\u9650"})],S.prototype,"maxTurnTableAdTimesLabel",void 0),c([n({type:cc.Label,displayName:"\u8d2d\u4e70\u4f53\u529b\u6b21\u6570\u4e0a\u9650"})],S.prototype,"maxBuyActionCurrencyTimesLabel",void 0),c([n({type:cc.Label,displayName:"\u62bd\u5361\u6b21\u6570\u4e0a\u9650"})],S.prototype,"maxRandomCardTimesLabel",void 0),c([n({type:cc.Label,displayName:"\u79bb\u7ebf\u5b58\u50a8\u65f6\u957f\u4e0a\u9650"})],S.prototype,"maxOfflineHoursLabel",void 0),a=c([P,a("Game/Vip/VipUI")],S),r.default=a,cc._RF.pop()},{}],vip_upgrade_tip_ui:[function(t,e,o){"use strict";cc._RF.push(e,"fc5ddSwDlFFT7VDH1PlaDha","vip_upgrade_tip_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("ggame"),u=a("local_vip"),d=(p=cc._decorator).ccclass,p=(a=p.property,p.menu);function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.vipLevelLabel=null,t}r(f,c=cc.Component),f.prototype.onLoad=function(){},f.prototype.onEnable=function(){this.vipLevelLabel&&(this.vipLevelLabel.string=s.sGGame.localModel.getModule(u.LocalVIP).getCurrentLevel().toString())},f.prototype.onDisable=function(){},l([a(cc.Label)],f.prototype,"vipLevelLabel",void 0),p=l([d,p("Game/Vip/VIPUpgradeTipUI")],f),n.default=p,cc._RF.pop()},{}],vm_attribute:[function(t,e,o){"use strict";cc._RF.push(e,"f3b14/WTA5NS78WQdVa5455","vm_attribute");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMAttribute=void 0;var l,c=a("player_attribute_config"),s=a("i18n"),u=a("glog"),d=a("gmodule"),p=a("attribute_slot"),f=a("attribute_system"),h=a("local_attribute");function g(){return null!==l&&l.apply(this,arguments)||this}r(g,l=d.GModule),g.prototype.getAttributeConfig=function(t){return(t="string"==typeof t?h.eAttributeObjectType[t]:t)===h.eAttributeObjectType.player||t===h.eAttributeObjectType.skill||t===h.eAttributeObjectType.soldier?c.sPlayerAttributeConfig:void 0},g.prototype.getAttributeName=function(t,e){return(t=this.getAttributeConfig(t).getEntry(e))&&(t=t.name)&&t.length?s.i18n.t(t):"(miss)"+e},g.prototype.formatAttributeEffectValueString=function(t,e,o,i,a,n,r){return void 0===a&&(a=!1),void 0===n&&(n=!1),void 0===r&&(r=!1),i?(t=this.getAttributeConfig(t).getEntry(e),e=o,r&&(i=-i),r="",(e="string"==typeof o?p.eAttributePos[o]:e)===p.eAttributePos.init||e===p.eAttributePos.add||e===p.eAttributePos.extend?(a&&e!==p.eAttributePos.init&&(r=0<i?"+":""),r+=i,n&&t&&t.unitName&&(r+=s.i18n.t(t.unitName))):e===p.eAttributePos.percentAdd?(a&&(r=0<i?"+":""),r+=i,r+="%"):(e===p.eAttributePos.mul?a&&(r="x"):a&&(r="/"),r+=i),r):(u.sGLog.error("attributeValue not exist!"),"")},g.prototype.formatAttributeEffectDesc=function(t,e,o,i){if(!i)return u.sGLog.error("attributeValue not exist!"),"";var a=this.getAttributeConfig(t),n=a.getEntry(e);return t=!1,n&&n.isNegative&&(t=!0),this.getAttributeName(a,e)+" "+this.formatAttributeEffectValueString(a,e,o,i,!0,!0,t)},g.prototype.formatAttributeAddDesc=function(t,e,o,i){return i?(t=this.getAttributeConfig(t).getEntry(e),e=o,"string"==typeof o&&(e=p.eAttributePos[o]),o=s.i18n.t("attribute.effectAdd"),e===p.eAttributePos.init||e===p.eAttributePos.add||e===p.eAttributePos.extend?(o+=i,t&&t.unitName&&(o+=s.i18n.t(t.unitName))):e===p.eAttributePos.percentAdd?(o+=i,o+="%"):(p.eAttributePos.mul,o+=i),o):(u.sGLog.error("attributeValue not exist!"),"")},g.prototype.formatAttributeValueString=function(t,e,o){if(!t)return"";var i="";return e=t.getValue(e,o),o===f.eAttributeValueType.init||o===f.eAttributeValueType.add||o===f.eAttributeValueType.extend||o===f.eAttributeValueType.total?i+=e:o===f.eAttributeValueType.percent&&(i+=e+"%"),i},r=g,n.VMAttribute=r,cc._RF.pop()},{}],vm_audio:[function(t,e,o){"use strict";cc._RF.push(e,"e39fcuvrBZMBo4iwmBxrlmY","vm_audio");var i,a=t,n=e,r=o;i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},n=function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},Object.defineProperty(r,"__esModule",{value:!0}),r.VMAduio=void 0;var l,c=a("audio_config"),s=a("gui"),u=a("gaudio"),d=a("gtime"),p=a("ggame");function f(){var t=null!==l&&l.apply(this,arguments)||this;return t.lastPlayPickUpGoldTimestamp=0,t.phasePlayCount=0,t.soundIntervalMin=200,t.isInBattle=!0,t}n(f,l=a("gmodule").GModule),f.prototype.init=function(){!cc.sys.isNative&&(!cc.sys.isBrowser||cc.sys.os!==cc.sys.OS_WINDOWS&&cc.sys.os!==cc.sys.OS_OSX)||(this.soundIntervalMin=60)},f.prototype.start=function(){var t=this;p.sGGame.on(p.sGGameEvent.beforeUpdate,function(){var e="main"===(e=s.sGUI.getTopName())||"sword"===e;t.isInBattle!==e&&(e?u.sGAudio.stopEffectEnv(null):u.sGAudio.playEffectEnv(null),t.isInBattle=e)},this)},f.prototype.stop=function(){p.sGGame.targetOff(this)},f.prototype.pickUpGold=function(){var t=d.sGTime.timestamp();t-this.lastPlayPickUpGoldTimestamp>this.getSoundIntervalMin()&&(this.playBattleSound(c.sAudioConfig.config.buttonClick),this.lastPlayPickUpGoldTimestamp=t)},f.prototype.getSoundIntervalMin=function(){return this.soundIntervalMin},f.prototype.playBattleSound=function(t){var e=1;this.isInBattle||(e=.4),u.sGAudio.playEffect(t,e)},n=f,r.VMAduio=n,cc._RF.pop()},{}],vm_battle:[function(t,e,o){"use strict";cc._RF.push(e,"bf50cAFHIRDDo2vpPW55xui","vm_battle");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMBattle=void 0;var l,c=a("vm_encourage"),s=a("vm_ui"),u=a("audio_config"),d=a("client_config"),p=a("const_config"),f=a("encourage_config"),h=a("player_attribute_config"),g=a("skill_config"),y=a("stage_config"),m=a("channel_config_manager"),b=a("i18n"),_=a("gui"),v=a("gapp"),C=a("gaudio"),P=a("glog"),S=a("gtime"),G=a("common_channel_config"),M=a("ggame"),w=a("gmodule"),A=a("gview_model"),B=a("vm_app"),R=a("game_define"),k=a("local_attribute"),T=a("local_battle"),L=a("local_fuben"),D=a("local_pata"),O=a("local_stage"),I=a("battle_defeat_ui"),N=a("main_tab_ui"),E=a("vm_game");function j(){var t=null!==l&&l.apply(this,arguments)||this;return t._passTimeDt=0,t.running=!1,t.loadCompleted=!1,t.battleManager=null,t}r(j,l=w.GModule),j.prototype.enterBattleStage=function(){var t,e=this;M.sGGame.localModel.getModule(O.LocalStage).checkStartStage()?(A.sGViewModel.getModule(s.VMUI).addMessageTip(b.i18n.t("tip.actionIsNotEnough")),_.sGUI.openDialogUI("prefabs/ui/tl_add_tips_bottom")):(t=A.sGViewModel.getModule(B.VMApp))&&(this.running=!1,this.loadCompleted=!1,t.loadScene(t.getGameScene(),function(){C.sGAudio.playMusic(u.sAudioConfig.config.battleBGM),_.sGUI.openStackUI(R.GameDefine.prefabBattleStage),m.sChannelConfigManager.channelType===G.enumChannelType.test&&_.sGUI.openUI(R.GameDefine.prefabResDebug,_.sGUIZorder.notice)},function(){e.loadCompleted=!0}),cc.director.on(v.sGAppEvent.afterUpdate,function(t){e.running||(e._passTimeDt+=t,.1<=e._passTimeDt&&(e._passTimeDt=0,e._tryStartBattle()))},this))},j.prototype.exitBattleStage=function(t){var e;cc.director.targetOff(this),t===I.eBattleDefeatGotoType.retry?this.enterBattleStage():(e=void 0,t===I.eBattleDefeatGotoType.upgradeBuilding?e=N.eMainTabType.home:t===I.eBattleDefeatGotoType.pullCard?e=N.eMainTabType.pullCard:t===I.eBattleDefeatGotoType.upgradeCard&&(e=N.eMainTabType.cardPackage),A.sGViewModel.getModule(E.VMGame).enterMain(e))},j.prototype.canSelectBattleBuff=function(){return 5<=M.sGGame.localModel.getModule(O.LocalStage).getCurrentBattleStageID()},j.prototype._tryStartBattle=function(){!this.running&&this.loadCompleted&&(this.running=!0,this.battleManager&&this.battleManager.readyBattle(),this.battleManager&&this.battleManager.startBattle())},j.prototype.openBattleBuff=function(){M.sGGame.localModel.getModule(T.LocalBattle).pause(),_.sGUI.openDialogUI(R.GameDefine.prefabBattleBuff)},j.prototype.buySoldier=function(t,e){var o=M.sGGame.localModel.getModule(T.LocalBattle),i=A.sGViewModel.getModule(s.VMUI),a=o.checkBuySoldier(t);if(0===a)return o.buySoldier(t),a;if(!e)switch(a){case 1:i.addMessageTip(b.i18n.t("tip.notEnoughGold"));break;case 2:i.addMessageTip(b.i18n.t("tip.arraySizeIsFull"));break;case 3:i.addMessageTip(b.i18n.t("tip.soldierIsNotActive"))}return a},j.prototype.selectBattleStartBuff=function(t){var e=M.sGGame.localModel.getModule(T.LocalBattle);e.battleStartBuffSelected||(e.selectBattleStartBuff(t),e.resume(),d.sClientConfig.config.devMode&&(e=M.sGGame.localModel.getModule(k.LocalAttribute),P.sGLog.log("battleGoldAddPercent "+e.attributeSystem.getValue(h.sPlayerAttributeConfig.config.battleGoldAddPercent)),P.sGLog.log("battleAttackAddPercent "+e.attributeSystem.getValue(h.sPlayerAttributeConfig.config.battleAttackAddPercent)),P.sGLog.log("battleCardIntervalSubPercent "+e.attributeSystem.getValue(h.sPlayerAttributeConfig.config.battleCardIntervalSubPercent))))},j.prototype.selectAllBattleStartBuff=function(t){var e=M.sGGame.localModel.getModule(T.LocalBattle);e.battleStartBuffSelected||(e.selectAllBattleStartBuff(),e.resume(),d.sClientConfig.config.devMode&&(e=M.sGGame.localModel.getModule(k.LocalAttribute),P.sGLog.log("battleGoldAddPercent "+e.attributeSystem.getValue(h.sPlayerAttributeConfig.config.battleGoldAddPercent)),P.sGLog.log("battleAttackAddPercent "+e.attributeSystem.getValue(h.sPlayerAttributeConfig.config.battleAttackAddPercent)),P.sGLog.log("battleCardIntervalSubPercent "+e.attributeSystem.getValue(h.sPlayerAttributeConfig.config.battleCardIntervalSubPercent))),t&&t())},j.prototype.openSweepUI=function(){var t=M.sGGame.localModel.getModule(O.LocalStage).currentPassStageEntry,e=y.sStageConfig.getEntry(p.sConstConfig.config.unlockSweep);t.sortID<e.sortID?A.sGViewModel.getModule(s.VMUI).addMessageTip(b.i18n.t("tip.sweepSystemIsNotUnlock")):_.sGUI.openDialogUI(R.GameDefine.prefabBattleSweep)},j.prototype._sweep=function(t){var e=M.sGGame.localModel.getModule(O.LocalStage).sweep();e?(A.sGViewModel.getModule(s.VMUI).addMessageTip(b.i18n.t("tip.sweepActionPointNotEnough")),_.sGUI.openDialogUI("prefabs/ui/tl_add_tips_bottom"),t&&t(e)):(t&&t(e),_.sGUI.openDialogUI(R.GameDefine.prefabBattleSweepResult))},j.prototype.sweep=function(t){var e=this,o=M.sGGame.localModel.getModule(O.LocalStage),i=o.getSweepRemainEffectiveTime();0!=i?(P.sGLog.info("sweepRemainEffectiveTime:",S.sGTime.toTimeSpanString(i/1e3)),this._sweep(t)):A.sGViewModel.getModule(c.VMEncourage).openEncourageMessageBox(b.i18n.t("sweep.encourageMessage"),f.sEncourageConfig.config.effectSweep,function(i){i?(o.effectSweep(),e._sweep(t)):t&&t(1)},this)},j.prototype.useGlobalSkill=function(t){M.sGGame.localModel.getModule(T.LocalBattle).useSkillCard(t);var e=this.battleManager;switch(g.sSkillConfig.getEntry(t.skill.entry.id).id){case 1:e.useSkillStone();break;case 2:e.useSkillEarthquake();break;case 3:e.useSkillTsunami();break;case 4:e.useSkillTornado();break;case 5:e.useSkillArrow();break;case 6:e.useSkillStonecastn();break;case 7:e.useSkillCannon();break;case 8:e.useSkillCallSoldier(8);break;case 9:e.useSkillCallSoldier(9);break;case 10:e.useSkillCallSoldier(10);break;case 11:e.useSkillCallSoldier(11);break;case 12:e.useSkillCallSoldier(12);break;case 13:e.useSkillCallSoldier(13);break;default:e.useSkillStone()}},j.prototype.useLocalSkill=function(t){var e=M.sGGame.localModel.getModule(T.LocalBattle).useLocalSkill(t);if(0!==e)return e;var o=this.battleManager;switch(g.sSkillConfig.getEntry(t.entry.id).id){case 1:o.useSkillStone();break;case 2:o.useSkillEarthquake();break;case 3:o.useSkillTsunami();break;case 4:o.useSkillTornado();break;case 5:o.useSkillArrow();break;case 6:o.useSkillStonecastn();break;case 7:o.useSkillCannon();break;case 8:o.useSkillCallSoldier(8);break;case 9:o.useSkillCallSoldier(9);break;case 10:o.useSkillCallSoldier(10);break;case 11:o.useSkillCallSoldier(11);break;case 12:o.useSkillCallSoldier(12);break;case 13:o.useSkillCallSoldier(13);break;default:o.useSkillStone()}return 0},j.prototype.isPataOpened=function(){var t=p.sConstConfig.config.pataUnlockStage;return!!M.sGGame.localModel.getModule(O.LocalStage).isSystemIsOpened(t)},j.prototype.openPataMainUI=function(){_.sGUI.openDialogUI("prefabs/ui/dungeon_bottom_pop")},j.prototype.enterBattlePata=function(){var t=this,e=M.sGGame.localModel.getModule(D.LocalPata);e.checkReadyBattle()||(e.readyBattle(),(e=A.sGViewModel.getModule(B.VMApp))&&(this.running=!1,this.loadCompleted=!1,e.loadScene(e.getGameScene(),function(){C.sGAudio.playMusic(u.sAudioConfig.config.battleBGM),_.sGUI.openStackUI(R.GameDefine.prefabBattlePata),m.sChannelConfigManager.channelType===G.enumChannelType.test&&_.sGUI.openUI(R.GameDefine.prefabResDebug,_.sGUIZorder.notice)},function(){t.loadCompleted=!0}),cc.director.on(v.sGAppEvent.afterUpdate,function(e){t.running||(t._passTimeDt+=e,.1<=t._passTimeDt&&(t._passTimeDt=0,t._tryStartBattle()))},this)))},j.prototype.exitBattlePata=function(t){var e,o=this;cc.director.targetOff(this),t===I.eBattleDefeatGotoType.retry?this.enterBattlePata():(e=void 0,t===I.eBattleDefeatGotoType.upgradeBuilding?e=N.eMainTabType.home:t===I.eBattleDefeatGotoType.pullCard?e=N.eMainTabType.pullCard:t===I.eBattleDefeatGotoType.upgradeCard&&(e=N.eMainTabType.cardPackage),A.sGViewModel.getModule(E.VMGame).enterMain(e,function(){t||o.openPataMainUI()}))},j.prototype.isFubneOpened=function(t){return!!M.sGGame.localModel.getModule(L.LocalFuben).isSystemIsOpened(t)},j.prototype.hasFubenAnythingToDo=function(){var t=M.sGGame.localModel.getModule(L.LocalFuben);return 0==t.checkStartBattle(0)||0==t.checkStartBattle(1)},j.prototype.openFubenMainUI=function(){_.sGUI.openDialogUI("prefabs/ui/fb_bottom")},j.prototype.enterBattleFuben=function(t){var e=this,o=M.sGGame.localModel.getModule(L.LocalFuben);o.checkStartBattle(t)||(o.startBattle(t),t=A.sGViewModel.getModule(B.VMApp),this.running=!1,this.loadCompleted=!1,t.loadScene(t.getGameScene(),function(){C.sGAudio.playMusic(u.sAudioConfig.config.battleBGM),_.sGUI.openStackUI(R.GameDefine.prefabBattleFuben),m.sChannelConfigManager.channelType===G.enumChannelType.test&&_.sGUI.openUI(R.GameDefine.prefabResDebug,_.sGUIZorder.notice)},function(){e.loadCompleted=!0}),cc.director.on(v.sGAppEvent.afterUpdate,function(t){e.running||(e._passTimeDt+=t,.1<=e._passTimeDt&&(e._passTimeDt=0,e._tryStartBattle()))},this))},j.prototype.exitBattleFuben=function(t){var e=this;cc.director.targetOff(this);var o=M.sGGame.localModel.getModule(L.LocalFuben);t===I.eBattleDefeatGotoType.retry?this.enterBattleFuben(o.currentBattleFubenType):(o=void 0,t===I.eBattleDefeatGotoType.upgradeBuilding?o=N.eMainTabType.home:t===I.eBattleDefeatGotoType.pullCard?o=N.eMainTabType.pullCard:t===I.eBattleDefeatGotoType.upgradeCard&&(o=N.eMainTabType.cardPackage),A.sGViewModel.getModule(E.VMGame).enterMain(o,function(){t||e.openFubenMainUI()}))},r=j,n.VMBattle=r,cc._RF.pop()},{}],vm_benefit:[function(t,e,o){"use strict";cc._RF.push(e,"90f9ace76FDupKCYtKLpKNu","vm_benefit");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMBenefit=void 0;var l,c=a("vm_guide"),s=a("daily_gift_config"),u=a("gui"),d=a("ggame"),p=a("gmodule"),f=a("gview_model"),h=a("local_benefits"),g=a("benefit_ui"),y=a("vm_reward");function m(){var t=null!==l&&l.apply(this,arguments)||this;return t.isBenefitShowing=!1,t}r(m,l=p.GModule),m.prototype.tryCompleteBenefit=function(){var t=this;if(!this.isBenefitShowing&&!f.sGViewModel.getModule(c.VMGuide).isGuideOpened()){var e,o=d.sGGame.localModel.getModule(h.LocalBenefits),i=this;for(e in s.sDailyGiftConfig.config){var a=function(e){var a=s.sDailyGiftConfig.config[e];if(a&&0===o.checkCollectReward(a.id))return i.isBenefitShowing=!0,u.sGUI.openDialogUI("prefabs/ui/benefit",function(e){e?e.getComponent(g.default).init(a.id,function(){t.isBenefitShowing=!1}):t.isBenefitShowing=!1},i),{value:void 0}}(e);if("object"==typeof a)return a.value}}},m.prototype.commit=function(t,e){0==(t=d.sGGame.localModel.getModule(h.LocalBenefits).collectReward(t)).err&&(t.data?f.sGViewModel.getModule(y.VMReward).openRewardResult(t.data.rewardList,e):e&&e())},r=m,n.VMBenefit=r,cc._RF.pop()},{}],vm_building:[function(t,e,o){"use strict";cc._RF.push(e,"07241YB2ihM+aKk3hVR1TaE","vm_building");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMBuilding=void 0;var l,c=a("vm_guide"),s=a("i18n"),u=a("gui"),d=a("gnode"),p=a("ggame"),f=a("gmodule"),h=a("gview_model"),g=a("game_define"),y=a("local_battle_stage"),m=a("local_building"),b=a("local_card"),_=a("building_unlock_ui"),v=a("building_upgrade_ui"),C=a("double_collect_ui"),P=a("offline_reward_ui"),S=a("promote_tip_ui");function G(){var t=null!==l&&l.apply(this,arguments)||this;return t._offlineCollectedBuildingUpgradePoint=0,t._offlineDuration=0,t._isAutoPopStarted=!0,t.lastBattleScore=0,t}r(G,l=f.GModule),G.prototype.start=function(){var t=this,e=p.sGGame.localModel.getModule(y.LocalBattleStage);this.lastBattleScore=e.getBattleScore(),p.sGGame.on(m.sLocalBuildingEvent.collectOffline,function(e,o){t._offlineCollectedBuildingUpgradePoint=e,t._offlineDuration=o,t._isAutoPopStarted=!1},this),p.sGGame.on(m.sLocalBuildingEvent.upgrade,function(){var o=e.getBattleScore();t.onBattleScoreChange(o)},this),p.sGGame.on(b.sLocalCardEvent.changeEquip,function(){var o=e.getBattleScore();t.onBattleScoreChange(o)},this),p.sGGame.on(b.sLocalCardEvent.upgrade,function(){var o=e.getBattleScore();t.onBattleScoreChange(o)},this),p.sGGame.on(b.sLocalCardEvent.pullCard,function(){var o=e.getBattleScore();t.onBattleScoreChange(o)},this)},G.prototype.stop=function(){p.sGGame.targetOff(this),d.sGNode.targetOff(this)},G.prototype.update=function(){this._tryShowOfflineTip()},G.prototype.hasBuildingReddot=function(t){var e=p.sGGame.localModel.getModule(m.LocalBuildingPackage);return 0==e.checkUnlock(t.entry.id)||0==e.checkUpgrade(t.entry.id)},G.prototype.hasAnyBuildingReddot=function(){for(var t=p.sGGame.localModel.getModule(m.LocalBuildingPackage),e=1;e<m.eBuildingType.max;e++){var o=t.getBuildingByType(e);if(o&&this.hasBuildingReddot(o))return!0}return!1},G.prototype.openUnlockUI=function(t){u.sGUI.openDialogUI(g.GameDefine.prefabBuildingUnlock,function(e){(e=e.getComponent(_.default))&&(e.building=t)},this)},G.prototype.openUpgradeUI=function(t){u.sGUI.openDialogUI(g.GameDefine.prefabBuildingUpgrade,function(e){(e=e.getComponent(v.default))&&(e.building=t)},this)},G.prototype.openUpgradeAgeUI=function(){u.sGUI.openDialogUI(g.GameDefine.prefabUpgradeAge,this)},G.prototype.canShow=function(){return!h.sGViewModel.getModule(c.VMGuide).isGuideOpened()&&!u.sGUI.hasDialog()},G.prototype.isInMain=function(){var t=u.sGUI.getTopName();return"map_home_bottom"==t||"world_map"==t},G.prototype._tryShowOfflineTip=function(){var t=this;this._isAutoPopStarted||!this.isInMain()||u.sGUI.isLoading()||(0<this._offlineCollectedBuildingUpgradePoint?this.canShow()&&(this._isAutoPopStarted=!0,u.sGUI.openDialogUI(g.GameDefine.prefabOffline,function(e){!e||(e=e.getComponent(P.default))&&e.init(t._offlineCollectedBuildingUpgradePoint,t._offlineDuration)},this)):this._isAutoPopStarted=!0)},G.prototype.openDoubleCollectUI=function(t,e){u.sGUI.openDialogUI(g.GameDefine.prefabDoubleCollectUI,function(e){!e||(e=e.getComponent(C.default))&&(e.callback=t)},e)},G.prototype.onBattleScoreChange=function(t){(t=void 0===t?0:t)!=this.lastBattleScore&&(this.lastBattleScore<t&&u.sGUI.openNoticeUI("prefabs/ui/promote_tips",function(e){e.getComponent(S.default).init(s.i18n.t("promoteTips.labelZdlTips").replace("${value}",t.toString()))},this),this.lastBattleScore=t)},r=G,n.VMBuilding=r,cc._RF.pop()},{}],vm_card:[function(t,e,o){"use strict";cc._RF.push(e,"4e9b9nuqcJAdp6cKxp1yyXB","vm_card");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMCard=void 0;var l,c=a("vm_ui"),s=a("const_config"),u=a("i18n"),d=a("ggame"),p=a("gmodule"),f=a("gview_model"),h=a("local_card"),g=a("local_stage"),y=a("vm_reward");function m(){return null!==l&&l.apply(this,arguments)||this}r(m,l=p.GModule),m.prototype.getDesc=function(t){return t=d.sGGame.localModel.getModule(h.LocalCardPackage).getCard(t),u.i18n.t(t.entry.desc).replace("${value}",t.getAttributeValue1()+"")},m.prototype.getNextDesc=function(t){return t=d.sGGame.localModel.getModule(h.LocalCardPackage).getCard(t),u.i18n.t(t.entry.desc).replace("${value}",t.getNextAttributeValue1()+"")},m.prototype.pullCard=function(t){d.sGGame.localModel.getModule(h.LocalCardPackage).pull(!1,function(e,o){e||f.sGViewModel.getModule(y.VMReward).openPullCardRewardPage(o.rewardList.getReward(0),t)})},m.prototype.pullCard10Times=function(t){d.sGGame.localModel.getModule(h.LocalCardPackage).pull10Times(function(e,o){e||f.sGViewModel.getModule(y.VMReward).openRewardResult(o.rewardList,t)})},m.prototype.upgrade=function(t,e){return void 0===e&&(e=!1),0==(e=d.sGGame.localModel.getModule(h.LocalCardPackage).upgrade(t,e))&&f.sGViewModel.getModule(c.VMUI).addMessageTip(u.i18n.t("tip.upgradeCardSuccess")),e},m.prototype.hasCardReddot=function(){return this.skillCardPackageHasReddot()||this.soldierCardPackageHasReddot()||this.pullHasReddot()||this.freePullHasReddot()},m.prototype.skillCardPackageHasReddot=function(){for(var t=d.sGGame.localModel.getModule(h.LocalCardPackage),e=t.getCardArray(),o=0;o<e.length;++o){var i=e[o];if(!i.isSoldierCard&&0===t.checkUpgrade(i.entry.id))return!0}return!1},m.prototype.soldierCardPackageHasReddot=function(){for(var t=d.sGGame.localModel.getModule(h.LocalCardPackage),e=t.getCardArray(),o=0;o<e.length;++o){var i=e[o];if(i.isSoldierCard&&0===t.checkUpgrade(i.entry.id))return!0}return!1},m.prototype.pullHasReddot=function(){return 0===d.sGGame.localModel.getModule(h.LocalCardPackage).checkPull(!1)},m.prototype.freePullHasReddot=function(){var t=d.sGGame.localModel.getModule(h.LocalCardPackage),e=(o=d.sGGame.localModel.getModule(g.LocalStage)).isSystemIsOpened(s.sConstConfig.config.normalSacrificeUnlockStage),o=o.isSystemIsOpened(s.sConstConfig.config.advancedSacrificeUnlockStage);return!(!e&&!o||0!==t.checkStartAdvancedFreePull()&&0!==t.checkStartNormalFreePull())},m.prototype.startNormalFreePull=function(){d.sGGame.localModel.getModule(h.LocalCardPackage).startNormalFreePull(function(t,e){t||f.sGViewModel.getModule(y.VMReward).openRewardResult(e.rewardList)})},m.prototype.startAdvancedFreePull=function(){d.sGGame.localModel.getModule(h.LocalCardPackage).startAdvancedFreePull(function(t,e){t||f.sGViewModel.getModule(y.VMReward).openRewardResult(e.rewardList)})},r=m,n.VMCard=r,cc._RF.pop()},{}],vm_channel:[function(t,e,o){"use strict";cc._RF.push(e,"dcecbUd/nFDXr9fAdZadjEz","vm_channel");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMChannel=void 0;var l,c=a("local_currency"),s=a("vm_ad"),u=a("vm_guide"),d=a("currency_config"),p=a("event_config"),f=a("i18n"),h=a("ganalytics"),g=a("thirdplatform_util"),y=a("common_channel_config"),m=a("common_guide_config"),b=a("ggame"),_=a("gmodule"),v=a("gview_model"),C=a("local_battle"),P=a("local_battle_stage"),S=a("local_building"),G=a("local_card"),M=a("local_checkin_beginner"),w=a("local_quest"),A=a("local_quest_main"),B=a("local_stage"),R=a("local_vip"),k=a("reason_define"),T=a("vm_quest");function L(){return null!==l&&l.apply(this,arguments)||this}r(L,l=_.GModule),L.prototype.start=function(){g.sThirdPlatformUtil.channelType!==y.enumChannelType.riceball_android&&g.sThirdPlatformUtil.channelType!==y.enumChannelType.riceball_ios||(h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_init,{initid:"1",initname:"\u52a0\u8f7d\u6d41\u7a0b"}),b.sGGame.on(h.sAnalyticsEventType.report,function(t){t===p.sEventConfig.config.joinGame&&h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_init,{initid:"2",initname:"\u8fdb\u5165\u6e38\u620f"})},this),b.sGGame.on(c.sLocalCurrencyEvent.changed,function(t,e,o,i){var a,n;if(t==d.sCurrencyConfig.config.cardUpgradePoint)a="2",n="\u7ecf\u9a8c\u77f3";else{if(t!=d.sCurrencyConfig.config.pullCardPoint)return;a="1",n="\u94bb\u77f3"}h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_moneyflow,{moneytype:a,moneyname:n,addorreduce:(0<o?1:0).toString(),mchage:Math.abs(o).toString(),moneyleft:e.toString(),reason:k.eReasonType[i]})},this),b.sGGame.on(s.sVMAdEventType.preShowRewardedVideoAd,function(t,e){var o=b.sGGame.localModel.getModule(B.LocalStage).getCurrentBattleStageID();h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_button_show,{ad_type:"\u6fc0\u52b1\u89c6\u9891",ad_position:e,ad_position_type:"\u5b9a\u5236",rit_id:t,level:o.toString()})},this),b.sGGame.on(s.sVMAdEventType.startShowRewardedVideoAd,function(t,e){var o=b.sGGame.localModel.getModule(B.LocalStage).getCurrentBattleStageID();h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_show,{ad_type:"\u6fc0\u52b1\u89c6\u9891",ad_position:e,ad_position_type:"\u5b9a\u5236",rit_id:t,rit_scene:"0",rit_scene_describe:e,level:o.toString()})},this),b.sGGame.on(s.sVMAdEventType.endShowRewardedVideoAd,function(t,e,o){var i=b.sGGame.localModel.getModule(B.LocalStage).getCurrentBattleStageID();h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_show_end,{ad_type:"\u6fc0\u52b1\u89c6\u9891",ad_position:e,ad_position_type:"\u5b9a\u5236",rit_id:t,result:o?"\u6210\u529f":"\u5931\u8d25",level:i.toString()})},this),b.sGGame.on(u.sGuideEventType.openGuide,function(t){var e=m.sGuideConfig.getGuide(t);e&&h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_guide,{guideid:t.toString(),guidedesc:e.comment})},this),b.sGGame.on(P.sLocalBattleStageEvent.start,function(t){h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_battlemap,{battletype:"\u666e\u653b\u6a21\u5f0f",mapchapter:t.toString(),mapid:t.toString(),battleresult:"0",passed:"0",skill:"0",costtime:"0"})},this),b.sGGame.on(P.sLocalBattleStageEvent.pause,function(t){h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_battlemap,{battletype:"\u666e\u653b\u6a21\u5f0f",mapchapter:t.toString(),mapid:t.toString(),battleresult:"1",passed:"0",skill:"0",costtime:"0"})},this),b.sGGame.on(P.sLocalBattleStageEvent.resume,function(t){h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_battlemap,{battletype:"\u666e\u653b\u6a21\u5f0f",mapchapter:t.toString(),mapid:t.toString(),battleresult:"2",passed:"0",skill:"0",costtime:"0"})},this),b.sGGame.on(P.sLocalBattleStageEvent.victory,function(t){var e=b.sGGame.localModel.getModule(C.LocalBattle);h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_battlemap,{battletype:"\u666e\u653b\u6a21\u5f0f",mapchapter:t.toString(),mapid:t.toString(),battleresult:"3",passed:"0",skill:e.skillTimes.toString(),costtime:Math.floor(e.battlePassTime).toString()})},this),b.sGGame.on(P.sLocalBattleStageEvent.defeat,function(t){var e=b.sGGame.localModel.getModule(C.LocalBattle);h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_battlemap,{battletype:"\u666e\u653b\u6a21\u5f0f",mapchapter:t.toString(),mapid:t.toString(),battleresult:"4",passed:"0",skill:e.skillTimes.toString(),costtime:Math.floor(e.battlePassTime).toString()})},this),b.sGGame.on(B.sLocalStageEvent.sweep,function(t){h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_battlemap,{battletype:"\u626b\u8361",mapchapter:t.toString(),mapid:t.toString(),battleresult:"3",passed:"1",skill:"0",costtime:"0"})},this),b.sGGame.on(S.sLocalBuildingEvent.newAge,function(t){h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_otherlevelup,{othertype:"\u65f6\u4ee3",otherid:"0",othername:"",uptype:"level",bef:"0",af:"0",befvalue:(t-1).toString(),afvalue:t.toString(),reason:"",subreason:""})},this),b.sGGame.on(S.sLocalBuildingEvent.upgrade,function(t){h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_otherlevelup,{othertype:"\u5efa\u7b51",otherid:t.entry.id.toString(),othername:f.i18n.t(t.entry.name),uptype:"level",bef:"0",af:"0",befvalue:(t.getLevel()-1).toString(),afvalue:t.getLevel().toString(),reason:"",subreason:""})},this),b.sGGame.on(G.sLocalCardEvent.unlockCard,function(t){h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_otherlevelup,{othertype:t.isSoldierCard?"\u5175\u79cd\u5361\u724c":"\u6280\u80fd\u5361\u724c",otherid:t.entry.id.toString(),othername:f.i18n.t(t.entry.name),uptype:"level",bef:"0",af:"0",befvalue:"0",afvalue:"1",reason:"",subreason:""})},this),b.sGGame.on(G.sLocalCardEvent.upgrade,function(t){h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_otherlevelup,{othertype:t.isSoldierCard?"\u5175\u79cd\u5361\u724c":"\u6280\u80fd\u5361\u724c",otherid:t.entry.id.toString(),othername:f.i18n.t(t.entry.name),uptype:"level",bef:"0",af:"0",befvalue:(t.getLevel()-1).toString(),afvalue:t.getLevel().toString(),reason:"",subreason:""})},this),b.sGGame.on(R.sLocalVIPEvent.levelChanged,function(t){h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_task,{tasktype:"VIP",taskid:t.toString(),taskname:"",taskdesc:"",taskresult:"1"})},this),b.sGGame.on(M.sLocalCheckinBeginnerEventType.checkin,function(t){h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_task,{tasktype:"\u7b7e\u5230",taskid:t.toString(),taskname:"",taskdesc:"",taskresult:"1"})},this),b.sGGame.on(A.sQuestMainEvent.completed,function(t){var e,o,i=b.sGGame.localModel.getModule(w.LocalQuest).getQuest(t);i&&(o=(e=v.sGViewModel.getModule(T.VMQuest)).getQuestName(i),i=e.getQuestDesc(i),h.sGAnalytics.reportAnalytics(p.sEventConfig.config.ohayoo_game_task,{tasktype:"\u4e3b\u7ebf\u4efb\u52a1",taskid:t.toString(),taskname:o,taskdesc:i,taskresult:"1"}))},this))},L.prototype.stop=function(){b.sGGame.targetOff(this)},r=L,n.VMChannel=r,cc._RF.pop()},{}],vm_check_in_7days:[function(t,e,o){"use strict";cc._RF.push(e,"61107VHVGFHB4LuiHrCa36m","vm_check_in_7days");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMCheckIn7Days=n.sVMCheckInEvent=void 0;var l,c=a("vm_guide"),s=(a("ui_controller"),a("gui")),u=a("ggame"),d=a("gmodule"),p=a("gview_model"),f=a("game_define"),h=a("local_check_in_7day"),g=a("local_quest_stat"),y=a("check_in_ui"),m=a("vm_reward");function b(){var t=null!==l&&l.apply(this,arguments)||this;return t._hasCheckInTipShown=!1,t._onlyShowCheckInAd=!1,t._isCheckinAdFinished=!1,t}n.sVMCheckInEvent={adFinished:"sVMCheckInEvent.adFinished"},r(b,l=d.GModule),Object.defineProperty(b.prototype,"isCheckinAdFinished",{get:function(){return this._isCheckinAdFinished},enumerable:!1,configurable:!0}),b.prototype.canShowCheckInButton=function(){return u.sGGame.localModel.getModule(g.LocalQuestStat).getValue(g.eQuestStat.statTopStage).greaterThanOrEqualTo(15)},b.prototype._canShow=function(){return!p.sGViewModel.getModule(c.VMGuide).isGuideOpened()&&!s.sGUI.hasDialog()&&this.canShowCheckInButton()},b.prototype.tryShowCheckInTip=function(){return!(this._hasCheckInTipShown||!this._canShow()||(this._hasCheckInTipShown=!0,this._onlyShowCheckInAd||u.sGGame.localModel.getModule(h.default).checkTodayChecked()!==h.eLocalCheckIn7DayError.ok?this.nextCheckInBeginnerAd():this.openCheckIn7DayUI(this),0))},b.prototype.start=function(){this._onlyShowCheckInAd=!0},b.prototype.stop=function(){},b.prototype.openCheckIn7DayUI=function(t){s.sGUI.openDialogUI(f.GameDefine.prefabCheckIn,function(t){t&&t.getComponent(y.default).init(y.CheckInUITabType.sevenDays)},t)},b.prototype.nextCheckInBeginnerAd=function(){7<=u.sGGame.localModel.getModule(h.default).getDayForChecked()&&this._finishCheckinAd()},b.prototype._finishCheckinAd=function(){this._isCheckinAdFinished=!0,u.sGGame.emit(n.sVMCheckInEvent.adFinished)},b.prototype.checkIn=function(){var t=u.sGGame.localModel.getModule(h.default).checkIn();return 0===t.errorCode&&p.sGViewModel.getModule(m.VMReward).openRewardResult(t.rewardResult.rewardList),t.errorCode},r=b,n.VMCheckIn7Days=r,cc._RF.pop()},{}],vm_check_in_daily:[function(t,e,o){"use strict";cc._RF.push(e,"35771j9BwhAQqWHE6RQJEr/","vm_check_in_daily");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMCheckInDaily=void 0;var l,c=a("ggame"),s=a("gmodule"),u=a("gview_model"),d=a("local_check_in_daily"),p=a("vm_reward");function f(){return null!==l&&l.apply(this,arguments)||this}r(f,l=s.GModule),f.prototype.checkIn=function(){var t=c.sGGame.localModel.getModule(d.default).checkIn();return 0===t.errorCode&&u.sGViewModel.getModule(p.VMReward).openRewardResult(t.rewardResult.rewardList),t.errorCode},r=f,n.VMCheckInDaily=r,cc._RF.pop()},{}],vm_check_in:[function(t,e,o){"use strict";cc._RF.push(e,"17df9bHZndH+r2Y1c410DRb","vm_check_in");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMCheckIn=void 0;var l,c=a("vm_guide"),s=a("const_config"),u=a("ui_controller"),d=a("gui"),p=a("ggame"),f=a("gmodule"),h=a("gview_model"),g=a("game_define"),y=a("local_checkin_beginner"),m=a("local_stage"),b=a("checkin_beginner_ui"),_=a("vm_check_in_7days");function v(){var t=null!==l&&l.apply(this,arguments)||this;return t._isCheckinAdFinished=!1,t._isAutoPopStarted=!1,t}r(v,l=f.GModule),Object.defineProperty(v.prototype,"isCheckinAdFinished",{get:function(){return this._isCheckinAdFinished},enumerable:!1,configurable:!0}),v.prototype.openCheckInUI=function(t,e){d.sGUI.openDialogUI(g.GameDefine.prefabCheckIn,function(t){t.getComponent(b.default).init(e)},t)},v.prototype.canShowButton=function(){return!p.sGGame.localModel.getModule(y.default).checkEnd()&&p.sGGame.localModel.getModule(m.LocalStage).isSystemIsOpened(s.sConstConfig.config.checkInPopUnlockStage)},v.prototype.isInMain=function(){var t=d.sGUI.getTopName();return"map_home_bottom"==t||"world_map"==t},v.prototype._tryShowCheckInTip=function(){this._isAutoPopStarted||!this.isInMain()||d.sGUI.isLoading()||h.sGViewModel.getModule(c.VMGuide).isGuideOpened()||d.sGUI.hasDialog()||!this.canShowButton()||(this._isAutoPopStarted=!0,p.sGGame.localModel.getModule(y.default).checkTodayChecked()===y.eLocalCheckinError.ok?this.openCheckInUI(this):this.nextCheckInBeginnerAd())},v.prototype.start=function(){},v.prototype.stop=function(){p.sGGame.targetOff(this)},v.prototype.update=function(){this._tryShowCheckInTip()},v.prototype.nextCheckInBeginnerAd=function(t){var e=this;7<=p.sGGame.localModel.getModule(y.default).getDayForChecked()?this._finishCheckinAd():d.sGUI.openDialogUI(g.GameDefine.prefabCheckinAdDay,function(o){o&&o.getComponent(u.default).setCloseCallback(function(){e._finishCheckinAd(),t&&t()})},this)},v.prototype._finishCheckinAd=function(){this._isCheckinAdFinished=!0,p.sGGame.emit(_.sVMCheckInEvent.adFinished)},v.prototype.hasAnythingToDo=function(){return p.sGGame.localModel.getModule(y.default).checkTodayChecked()===y.eLocalCheckinError.ok},r=v,n.VMCheckIn=r,cc._RF.pop()},{}],vm_game_guide:[function(t,e,o){"use strict";cc._RF.push(e,"374edwuMitCDYAhtpqQ2Tpm","vm_game_guide");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMGameGuide=void 0;var l,c=a("local_guide"),s=a("const_config"),u=a("gui"),d=a("common_guide_config"),p=a("ggame"),f=a("gmodule"),h=a("gview_model"),g=a("local_battle"),y=a("local_building"),m=a("local_card"),b=a("local_pata"),_=a("local_quest_main"),v=a("local_stage"),C=(a("main_home_function_ui"),a("main_tab_ui"),a("vm_battle")),P=a("vm_card"),S={guideCheckOpen1:function(){return 1===p.sGGame.localModel.getModule(y.LocalBuildingPackage).getBuilding(1001).getLevel()},guideGetInitStep1:function(t){return"map_home_bottom"===t?1:-1},guideStepUpdate1_2:function(){if(0!=p.sGGame.localModel.getModule(y.LocalBuildingPackage).checkCollectWithID(1001))return-1;var t=u.sGUI.getNode("building_bt1.goods_tips");return t&&t.active?3:-1},guideCheckOpen2:function(){return p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(1)&&0===p.sGGame.localModel.getModule(y.LocalBuildingPackage).checkUpgrade(1001)},guideGetInitStep2:function(t){return"map_home_bottom"===t?1:-1},guideStepUpdate2_2:function(){var t=p.sGGame.localModel.getModule(y.LocalBuildingPackage);return t?!(t=t.getBuilding(1001))||t.getLevel()<2?-1:3:-1},guideCheckOpen3:function(){return p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(2)&&1==p.sGGame.localModel.getModule(v.LocalStage).getCurrentBattleStageID()},guideGetInitStep3:function(t){return"map_home_bottom"===t?1:-1},onGuideStepEnable3_4:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable3_4:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable3_5:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable3_5:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},guideStepUpdate3_6:function(){return 0!==p.sGGame.localModel.getModule(g.LocalBattle).checkBuySoldier(1001)?-1:7},onGuideStepEnable3_7:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable3_7:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable3_8:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable3_8:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},guideStepUpdate3_9:function(){return 0!==p.sGGame.localModel.getModule(g.LocalBattle).checkBuySoldier(1001)?-1:10},onGuideStepEnable3_10:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable3_10:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable3_11:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable3_11:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable3_12:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable3_12:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},guideStepUpdate3_13:function(){var t=p.sGGame.localModel.getModule(g.LocalBattle),e=t.getSkillEquiped(0);return e&&0==t.checkUseLocalSkill(e)?14:-1},onGuideStepEnable3_14:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable3_14:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable3_15:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable3_15:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable3_17:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable3_17:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable3_18:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable3_18:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},guideCheckOpen4:function(){return!!p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(3)},guideGetInitStep4:function(t){return"map_home_bottom"===t?3:"world_map"===t?1:-1},guideStepUpdate4_4:function(){var t=p.sGGame.localModel.getModule(y.LocalBuildingPackage);return t?!(t=t.getBuilding(1001))||t.getLevel()<5?-1:5:-1},guideCheckOpen5:function(){if(!p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(4))return!1;var t=p.sGGame.localModel.getModule(y.LocalBuildingPackage);return!!t&&0==t.checkUnlock(1002)},guideGetInitStep5:function(t){return"map_home_bottom"===t?1:-1},guideCheckOpen6:function(){return!!p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(5)&&2==p.sGGame.localModel.getModule(v.LocalStage).getCurrentBattleStageID()},guideGetInitStep6:function(t){return"map_home_bottom"===t?1:-1},onGuideStepEnable6_3:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable6_3:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable6_4:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable6_4:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable6_5:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable6_5:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable6_6:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable6_6:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},guideStepUpdate6_7:function(){return 0===p.sGGame.localModel.getModule(g.LocalBattle).checkBuySoldier(1002)?8:-1},onGuideStepEnable6_8:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable6_8:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable6_9:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable6_9:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},guideCheckOpen7:function(){return!!p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(6)},guideGetInitStep7:function(t){return"map_home_bottom"===t?3:"world_map"===t?1:-1},guideStepUpdate7_4:function(){var t=p.sGGame.localModel.getModule(y.LocalBuildingPackage);return t?!(t=t.getBuilding(1002))||t.getLevel()<5?-1:5:-1},guideCheckOpen8:function(){if(!p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(7)||p.sGGame.localModel.getModule(_.default).isQuestMainDone())return!1;var t=u.sGUI.getTopUI();return"world_map"===t.uiName||"map_home_bottom"===t.uiName},guideGetInitStep8:function(t){return"world_map"===t||"map_home_bottom"===t?1:-1},guideCheckOpen9:function(){if(!p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(8)||p.sGGame.localModel.getModule(_.default).isQuestMainDone())return!1;if(0!=p.sGGame.localModel.getModule(_.default).checkCommit())return!1;var t=u.sGUI.getTopUI();return"world_map"===t.uiName||"map_home_bottom"===t.uiName||"draw_card_root"===t.uiName},guideGetInitStep9:function(t){return"draw_card_root"===t?1:"world_map"===t||"map_home_bottom"===t?2:-1},guideCheckOpen10:function(){return!!p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(9)&&3==p.sGGame.localModel.getModule(v.LocalStage).getCurrentBattleStageID()},guideGetInitStep10:function(t){return"map_home_bottom"===t?1:"world_map"===t?2:"battle_zd_tips"===t?3:-1},onGuideStepEnable10_4:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable10_4:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable10_5:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable10_5:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable10_6:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable10_6:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable10_7:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable10_7:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable10_8:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable10_8:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},guideStepUpdate10_9:function(){return 0===p.sGGame.localModel.getModule(g.LocalBattle).checkBuySoldier(1003)?10:-1},onGuideStepEnable10_10:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable10_10:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable10_11:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable10_11:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},guideCheckOpen11:function(){return!!p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(10)},guideGetInitStep11:function(t){return"map_home_bottom"===t||"world_map"===t?1:-1},guideCheckOpen12:function(){if(!p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(11)||0!=p.sGGame.localModel.getModule(y.LocalBuildingPackage).checkUpgradeAge())return!1;var t=u.sGUI.getTopUI();return"map_home_bottom"===t.uiName||"age_info_bottom"==t.uiName},guideGetInitStep12:function(t){return"map_home_bottom"===t?1:"age_info_bottom"===t?2:-1},guideCheckOpen13:function(){return p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(12)&&0===p.sGGame.localModel.getModule(m.LocalCardPackage).checkPull(!1)},guideGetInitStep13:function(t){return"world_map"===t||"map_home_bottom"===t?1:-1},guideCheckOpen14:function(){return!!p.sGGame.localModel.getModule(c.LocalGuide).isGuideFinished(13)},guideGetInitStep14:function(t){return"map_home_bottom"===t||"draw_card_root"===t?1:"world_map"===t?2:-1},onGuideStepEnable14_4:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable14_4:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable14_5:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable14_5:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable14_6:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable14_6:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},guideCheckOpen17:function(){var t=p.sGGame.localModel.getModule(v.LocalStage);return-1!==t.victoryRandomCardIndex&&!(!(t=t.extendRewardArray)||6!==t.length)&&"settlement_win_sd"===u.sGUI.getTopUI().uiName},guideGetInitStep17:function(t){return"settlement_win_sd"===t?1:-1},guideCheckOpen18:function(){return"battle_buff"===u.sGUI.getTopUI().uiName},guideGetInitStep18:function(t){return"battle_buff"===t?1:-1},guideCheckOpen19:function(){return!!h.sGViewModel.getModule(P.VMCard).soldierCardPackageHasReddot()},guideGetInitStep19:function(t){return"world_map"===t||"draw_card_root"===t||"map_home_bottom"===t?1:"card_root"===t?3:-1},guideCheckOpen20:function(){return 5<p.sGGame.localModel.getModule(m.LocalCardPackage).getActivedSoldierCardArray().length},guideGetInitStep20:function(t){return"world_map"===t||"map_home_bottom"===t||"draw_card_root"===t?1:"card_root"===t?3:"card_skill_root"===t?6:-1},guideCheckOpen21:function(){return!!p.sGGame.localModel.getModule(v.LocalStage).canCollectDoubleVictoryReward()&&"settlement_win"===u.sGUI.getTopUI().uiName},guideGetInitStep21:function(t){return"settlement_win"!==t?-1:1},guideCheckOpen22:function(){return!!p.sGGame.localModel.getModule(v.LocalStage).isSystemIsOpened(s.sConstConfig.config.checkInPopUnlockStage)},guideGetInitStep22:function(t){return"world_map"===t||"draw_card_root"===t?1:"map_home_bottom"===t?2:-1},guideCheckOpen23:function(){return!!p.sGGame.localModel.getModule(g.LocalBattle).doubleSpeedEnabled&&"battle"===u.sGUI.getTopUI().uiName},guideGetInitStep23:function(){return 1},onGuideStepEnable23_1:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable23_1:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},onGuideStepEnable23_2:function(){p.sGGame.localModel.getModule(g.LocalBattle).pause()},onGuideStepDisable23_2:function(){p.sGGame.localModel.getModule(g.LocalBattle).resume()},guideCheckOpen24:function(){return!!h.sGViewModel.getModule(C.VMBattle).isPataOpened()},guideGetInitStep24:function(t){return"map_home_bottom"===t||"draw_card_root"===t?1:"world_map"===t?2:-1},guideCheckOpen27:function(){return!!h.sGViewModel.getModule(C.VMBattle).isFubneOpened(0)},guideGetInitStep27:function(t){return"map_home_bottom"===t||"draw_card_root"===t?1:"world_map"===t?2:-1},guideCheckOpen28:function(){return 3==p.sGGame.localModel.getModule(b.LocalPata).getPataWaitCollectBuffArray().length&&"dungeon_settlement_win"===u.sGUI.getTopUI().uiName},guideGetInitStep28:function(){return 1}};function G(){return null!==l&&l.apply(this,arguments)||this}r(G,l=f.GModule),G.prototype.start=function(){d.sGuideConfig.callbacks=S,d.sGuideConfig.init()},r=G,n.VMGameGuide=r,cc._RF.pop()},{}],vm_game_recorder:[function(t,e,o){"use strict";cc._RF.push(e,"9c772wVPB9EXbMMURRikw2y","vm_game_recorder");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMGameRecorder=void 0;var l,c=a("const_config"),s=a("i18n"),u=a("gui"),d=a("thirdplatform_util"),p=a("ggame"),f=a("gmodule"),h=a("local_battle");function g(){return null!==l&&l.apply(this,arguments)||this}r(g,l=f.GModule),g.prototype.start=function(){cc.director.on("stopGameRecord",function(t,e){e<c.sConstConfig.config.minGameRecordDuration?u.sGUI.openMessageBoxOKUI(s.i18n.t("gameRecorder.gameRecordTooShort"),void 0,!0):(p.sGGame.localModel.getModule(h.LocalBattle).pause(),u.sGUI.openMessageBoxOKCancelUI(s.i18n.t("gameRecorder.shareRecord"),function(e){p.sGGame.localModel.getModule(h.LocalBattle).resume(),e&&d.sThirdPlatformUtil.share("","",t,function(){})},!0))})},r=g,n.VMGameRecorder=r,cc._RF.pop()},{}],vm_game:[function(t,e,o){"use strict";cc._RF.push(e,"139d6T3M3dLkqtzlnZF34eE","vm_game");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMGame=void 0;var l,c=a("vm_cloud_storage"),s=a("audio_config"),u=a("event_config"),d=a("channel_config_manager"),p=a("gui"),f=a("ganalytics"),h=a("gaudio"),g=a("gres"),y=a("gtask"),m=a("common_channel_config"),b=a("ggame"),_=a("gmodule"),v=a("gview_model"),C=a("vm_app"),P=a("game_define"),S=a("local_stage"),G=a("local_config"),M=a("beginning_ui"),w=a("main_tab_ui"),A=[cc.color(0,0,0),cc.color(255,255,255),cc.color(156,156,156)],B=[cc.color(0,0,0),cc.color(0,255,15),cc.color(255,15,0)];function R(){var t=null!==l&&l.apply(this,arguments)||this;return t.inited=!1,t.dummyCount=0,t.enabled=!1,t.attributesNode=null,t.testNode=null,t}r(R,l=_.GModule),R.prototype.init=function(){var t=this,e=v.sGViewModel.getModule(C.VMApp);e&&(y.sGTask.addTask(function(){return g.sGRes.preloadRes("prefabs/ui/main",cc.Prefab,!0)}),e.setEnterGameCallback(function(){t.enterGame()})),(e=v.sGViewModel.getModule(c.VMCloudStorage))&&e.setCheckConflictCallback(function(e){return t.checkConfilict(e)})},R.prototype.enterGame=function(t){var e=this;1!=b.sGGame.localModel.getModule(S.LocalStage).getCurrentBattleStageID()||b.sGGame.localModel.getModule(G.LocalConfig).beginningShown?this.openMainUI(t):p.sGUI.openNoticeUI("prefabs/common/intro_animation",function(o){!o||(o=o.getComponent(M.default))&&(o.init(function(){b.sGGame.localModel.getModule(G.LocalConfig).beginningShown=!0,e.openMainUI(t),f.sGAnalytics.reportAnalytics(u.sEventConfig.config.finishBeginning,{})}),o.playAnimationStart())})},R.prototype.enterMain=function(t,e,o,i){var a=this,n=v.sGViewModel.getModule(C.VMApp);n&&n.loadScene(n.getGameScene(),function(){a.enterGame(t),e&&e()},function(){o&&o()},i)},R.prototype.openMainUI=function(t){h.sGAudio.playMusic(s.sAudioConfig.config.gameBGM),p.sGUI.openStackUI(P.GameDefine.prefabMain,function(e){e&&e.getComponent(w.default).openTab(t)}),d.sChannelConfigManager.channelType===m.enumChannelType.test&&p.sGUI.openUI(P.GameDefine.prefabResDebug,p.sGUIZorder.notice)},R.prototype.checkConfilict=function(t){return t.playerAuth&&(t.playerAuth.openIDType,t.playerAuth.openID),!1},R.prototype.getValidColor=function(t){return t?A[1]:A[2]},R.prototype.getCondtionValidColor=function(t){return t?B[1]:B[2]},r=R,n.VMGame=r,cc._RF.pop()},{}],vm_notification:[function(t,e,o){"use strict";cc._RF.push(e,"420f0cBRWxDg6Ft0/1xeTK8","vm_notification");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMNotification=void 0;var l,c=a("i18n"),s=a("gtime"),u=a("thirdplatform_util"),d=a("ggame"),p=a("gmodule"),f=a("local_benefits");function h(){return null!==l&&l.apply(this,arguments)||this}r(h,l=p.GModule),h.prototype._pushNotificationAboutTest=function(){var t=(new Date).getTime()+5e3;u.sThirdPlatformUtil.pushNotification("test","just test","click here",!0,s.sGTime.format(t,"yyyy-MM-dd hh:mm:ss"),!1),u.sThirdPlatformUtil.pushNotification("test2","just test too","click here",!1,s.sGTime.format(t+=5e3,"yyyy-MM-dd hh:mm:ss"),!1),u.sThirdPlatformUtil.pushNotification("test3",null,"click here",!0,s.sGTime.format(t+=5e3,"yyyy-MM-dd hh:mm:ss"),!1)},h.prototype._pushNotificationAboutClock=function(){var t,e;d.sGGame.localModel.getModule(f.LocalBenefits).isSystemOpen()&&(t=(new Date).getTime(),e=s.sGTime.nearestTime(t,11,0,0),u.sThirdPlatformUtil.pushNotification("clock1100",c.i18n.t("notification.clock1100"),c.i18n.t("notification.context"),!1,s.sGTime.format(e.getTime(),"yyyy-MM-dd hh:mm:ss"),!0),e=s.sGTime.nearestTime(t,17,0,0),u.sThirdPlatformUtil.pushNotification("clock1700",c.i18n.t("notification.clock1700"),c.i18n.t("notification.context"),!1,s.sGTime.format(e.getTime(),"yyyy-MM-dd hh:mm:ss"),!0))},h.prototype.start=function(){var t=this;cc.director.on(u.sThirdPlatformEvent.onHide,function(){t._pushNotificationAboutClock()},this)},h.prototype.stop=function(){cc.director.targetOff(this)},r=h,n.VMNotification=r,cc._RF.pop()},{}],vm_quest:[function(t,e,o){"use strict";cc._RF.push(e,"970f7tvfZxEGbeHBBjeqBqQ","vm_quest");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMQuest=void 0;var l,c=a("vm_guide"),s=a("building_config"),u=a("stage_config"),d=a("reward_helper"),p=a("i18n"),f=a("gui"),h=a("gdecimal"),g=a("ggame"),y=a("gmodule"),m=a("gview_model"),b=a("game_define"),_=a("local_building"),v=a("local_quest"),C=a("local_quest_achievement"),P=a("local_quest_condition"),S=a("local_quest_daily"),G=a("local_quest_main"),M=a("main_tab_ui"),w=a("promote_tip_ui"),A=a("quest_main_complete_ui"),B=a("vm_building"),R=a("vm_reward");function k(){var t=null!==l&&l.apply(this,arguments)||this;return t.condtionGotoCallbackDic={},t.canCommitQuestMain=!1,t.isQuestMainResultShowing=!1,t}r(k,l=y.GModule),k.prototype.init=function(){var t=this;this.condtionGotoCallbackDic[P.eConditionType.passStage]=function(){M.default.singleton&&M.default.singleton.openTab(1),f.sGUI.openDialogUI(b.GameDefine.prefabBattleStart,t)},this.condtionGotoCallbackDic[P.eConditionType.unlockBuilding]=function(t){M.default.singleton&&M.default.singleton.openTab(0),0==(t=g.sGGame.localModel.getModule(_.LocalBuildingPackage).getBuilding(t.conditions[0].params.id.toNumber())).getLevel()&&m.sGViewModel.getModule(B.VMBuilding).openUnlockUI(t)},this.condtionGotoCallbackDic[P.eConditionType.upgradeBuilding]=function(t){M.default.singleton&&M.default.singleton.openTab(0),0==(t=g.sGGame.localModel.getModule(_.LocalBuildingPackage).getBuilding(t.conditions[0].params.id.toNumber())).getLevel()?m.sGViewModel.getModule(B.VMBuilding).openUnlockUI(t):m.sGViewModel.getModule(B.VMBuilding).openUpgradeUI(t)},this.condtionGotoCallbackDic[P.eConditionType.collectBuildingUpgradePointTimes]=function(){M.default.singleton&&M.default.singleton.openTab(0)},this.condtionGotoCallbackDic[P.eConditionType.passStageTimes]=function(){M.default.singleton&&M.default.singleton.openTab(1),f.sGUI.openDialogUI(b.GameDefine.prefabBattleStart,t)},this.condtionGotoCallbackDic[P.eConditionType.upgradeBuildingTimes]=function(){M.default.singleton&&M.default.singleton.openTab(0)},this.condtionGotoCallbackDic[P.eConditionType.pullCardTimes]=function(){M.default.singleton&&M.default.singleton.openTab(2)},this.condtionGotoCallbackDic[P.eConditionType.useSkillTimes]=function(){M.default.singleton&&M.default.singleton.openTab(1)},this.condtionGotoCallbackDic[P.eConditionType.statPassStageTimes]=function(){M.default.singleton&&M.default.singleton.openTab(1),f.sGUI.openDialogUI(b.GameDefine.prefabBattleStart,t)},this.condtionGotoCallbackDic[P.eConditionType.statUpgradeBuildingTimes]=function(){M.default.singleton&&M.default.singleton.openTab(0)},this.condtionGotoCallbackDic[P.eConditionType.statPullCardTimes]=function(){M.default.singleton&&M.default.singleton.openTab(2)},this.condtionGotoCallbackDic[P.eConditionType.statUseSkillTimes]=function(){M.default.singleton&&M.default.singleton.openTab(1)},this.condtionGotoCallbackDic[P.eConditionType.statUnlockCardCount]=function(){M.default.singleton&&M.default.singleton.openTab(2)}},k.prototype.start=function(){var t=this;g.sGGame.on(g.sGGameEvent.afterUpdate,function(e){t.customUpdate(e)},this),g.sGGame.on(v.sQuestEvent.conditionChanged,function(){var e;t.canCommitQuestMain||(e=0==g.sGGame.localModel.getModule(G.default).checkCommit())&&(t.canCommitQuestMain=e,f.sGUI.openNoticeUI("prefabs/ui/important_tips",function(t){t.getComponent(w.default).init(p.i18n.t("promoteTips.labelQuestMainTips"))}))},this),g.sGGame.on(G.sQuestMainEvent.completed,function(){t.canCommitQuestMain=0==g.sGGame.localModel.getModule(G.default).checkCommit()},this),this.canCommitQuestMain=0==g.sGGame.localModel.getModule(G.default).checkCommit()},k.prototype.stop=function(){g.sGGame.targetOff(this)},k.prototype.customUpdate=function(){},k.prototype.openAchievement=function(){f.sGUI.openDialogUI("prefabs/ui/achievement_bottom")},k.prototype.hasAnyQuestCanCommit=function(){return g.sGGame.localModel.getModule(C.default).isAnyThingTodo()||g.sGGame.localModel.getModule(S.LocalDailyQuest).hasAnyThingTodo()},k.prototype.canShowQuestButton=function(){return g.sGGame.localModel.getModule(S.LocalDailyQuest).isSystemOpen()},k.prototype.collectDailyBox=function(){g.sGGame.localModel.getModule(S.LocalDailyQuest).dataPlayerDailyQuest.chestStep,g.sGGame.localModel.getModule(S.LocalDailyQuest).collectChest()},k.prototype.openTaskTab=function(){},k.prototype.openDaily=function(){this.openTaskTab(0)},k.prototype.openStage=function(){this.openTaskTab(1)},k.prototype.getQuestName=function(t){return t?p.i18n.t(t.entry.name):""},k.prototype.getQuestDesc=function(t){if(!t)return"";t.entry.desc&&(e=p.i18n.t(t.entry.desc));var e,o,i=t.getConditionEntry(0);return i&&(e=e||p.i18n.t("quest."+i.conditionType),(o=P.eConditionType[i.conditionType])===P.eConditionType.unlockBuilding||o===P.eConditionType.upgradeBuilding?(i=t.getConditionParams(0).id,(i=s.sBuildingConfig.getEntry(i))&&i.name&&(e=e.replace("${buildingName}",p.i18n.t(i.name)))):o===P.eConditionType.passStage&&(o=t.getCondtionRequirement(0),(o=u.sStageConfig.getEntry(o))&&(e=e.replace("${stageName}",p.i18n.t(o.name))))),e.replace("${value}",h.sGDecimal.toHuman(t.getCondtionRequirement(0)))},k.prototype.getQuestReward=function(t){return t?((o=t.entry.rewardDesc?p.i18n.t(t.entry.rewardDesc):o)||(e=d.RewardList.createFromString(t.entry.reward).getReward(0))&&(o=(t=m.sGViewModel.getModule(R.VMReward)).getName(e.type,e.id),1<e.count&&(o+=t.getCount(e.type,e.count))),o):"";var e,o},k.prototype.getProgressString=function(t){return t?t.getProgressString(0):""},k.prototype.getProgress=function(t){return t?t.getProgress(0):0},k.prototype.hasGoto=function(t){return t=t.getConditionEntry(0),t=P.eConditionType[t.conditionType],!!this.condtionGotoCallbackDic[t]},k.prototype.goto=function(t){var e=t.getConditionEntry(0);e=P.eConditionType[e.conditionType],(e=this.condtionGotoCallbackDic[e])&&e(t)},k.prototype.closeGotoParentUI=function(){},k.prototype.tryCompleteQuestMain=function(){var t=this;this.isQuestMainResultShowing||m.sGViewModel.getModule(c.VMGuide).isGuideOpened()||0!=g.sGGame.localModel.getModule(G.default).checkCommit()||(this.isQuestMainResultShowing=!0,f.sGUI.openDialogUI("prefabs/ui/quest_main_result",function(e){e?e.getComponent(A.default).commitCallback=function(){t.isQuestMainResultShowing=!1}:t.isQuestMainResultShowing=!1},this))},k.prototype.commitQuestMain=function(t){var e=g.sGGame.localModel.getModule(G.default),o=e.getQuestMainReward();0==e.commit()&&(o?m.sGViewModel.getModule(R.VMReward).openRewardResult(d.RewardList.createFromString(o),t):t&&t())},r=k,n.VMQuest=r,cc._RF.pop()},{}],vm_reward:[function(t,e,o){"use strict";cc._RF.push(e,"fe2c342NuRJMq5b7+EzTzzU","vm_reward");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMReward=n.eIconType=void 0;var l,c=a("card_config"),s=a("const_config"),u=a("currency_config"),d=a("reward_helper"),p=a("i18n"),f=a("gui"),h=a("glog"),g=a("gnode"),y=a("gnumber"),m=a("gmodule"),b=a("game_define"),_=a("local_reward"),v=a("ad_reward_collect_ui"),C=a("currency_reward_ui"),P=a("reward_card10_ui"),S=a("reward_currency_ui"),G=a("reward_ui");(a=l=n.eIconType||(n.eIconType={}))[a.smallIcon=0]="smallIcon",a[a.frameIcon=1]="frameIcon",a[a.bigIcon=2]="bigIcon",a[a.flyIcon=3]="flyIcon",a[a.superIcon=4]="superIcon";var M,w=[cc.color(0,0,0),cc.color(255,255,255),cc.color(63,255,32),cc.color(32,205,255),cc.color(204,65,255),cc.color(255,139,36),cc.color(254,245,7),cc.color(255,36,149)];function A(){var t=null!==M&&M.apply(this,arguments)||this;return t.currentRewardList=null,t.currentRewardIndex=0,t.showFinishCallback=null,t}r(A,M=m.GModule),A.prototype.openCollectCard10=function(t){var e=this;f.sGUI.openDialogUI(b.GameDefine.prefabCardReward10,function(o){o.getComponent(P.default).init(t,function(){e._openNextReward()})},this)},A.prototype.openRewardResult=function(t,e,o){var i=this;if(t){if(this.currentRewardList)return void h.sGLog.error("openRewardResult twice!");this.currentRewardList=t,this.currentRewardIndex=0,this.showFinishCallback=e}if(this.currentRewardList.length!==this.currentRewardIndex){if(this.currentRewardList.length>=10+this.currentRewardIndex){for(var a=new d.RewardList,n=!0,r=this.currentRewardIndex;r<this.currentRewardIndex+10;++r){var l=this.currentRewardList.getReward(r);if(l.type!==_.eRewardType.card&&l.type!==_.eRewardType.card2Fragment){n=!1;break}a.addUnqniue(l.type,l.id,l.count)}if(n)return this.openCollectCard10(a),void(this.currentRewardIndex+=10)}var c=this.currentRewardList.getReward(this.currentRewardIndex);if(this.currentRewardIndex+=1,c)switch(c.type){case _.eRewardType.buildingUpgradePoint:case _.eRewardType.cardUpgradePoint:case _.eRewardType.pullCardPoint:case _.eRewardType.actionPoint:case _.eRewardType.vipExp:case _.eRewardType.questToken:case _.eRewardType.activeDoubleSpeed:case _.eRewardType.activeSweep:this.openRewardCurrency(c,o,function(){i._openNextReward()});break;case _.eRewardType.cardFragment:case _.eRewardType.randomCardFragment:this.openRewardCardFragment(c,function(){i._openNextReward()});break;case _.eRewardType.card:case _.eRewardType.card2Fragment:case _.eRewardType.randomCard:this.openRewardCard(c,function(){i._openNextReward()});break;default:this._openNextReward()}}else this.currentRewardList=null,this.currentRewardIndex=0,this.showFinishCallback&&this.showFinishCallback()},A.prototype._openNextReward=function(){this.openRewardResult(null,null)},A.prototype.openRewardCard=function(t,e){f.sGUI.openDialogUI(b.GameDefine.prefabNormalCardReward,function(o){o.getComponent(G.default).init(t,function(){e&&e()})},this)},A.prototype.openRewardCardFragment=function(t,e){f.sGUI.openDialogUI(b.GameDefine.prefabNormalCardFragmentReward,function(o){o.getComponent(G.default).init(t,function(){e&&e()})},this)},A.prototype.openPullCardRewardPage=function(t,e){f.sGUI.openDialogUI(b.GameDefine.prefabPullCardReward,function(o){o.getComponent(G.default).init(t,function(){e&&e()})},this)},A.prototype.openAdRewardCollect=function(t,e,o,i){f.sGUI.openDialogUI(b.GameDefine.prefabAdReward,function(i){i.getComponent(v.default).reset(t,e,o)},i)},A.prototype._playCollectCurrencyTip=function(t,e,o,i){f.sGUI.openNoticeUI("prefabs/ui/get_currency_tips",function(a){var n=a.getComponent(S.default);i=i||a,a=g.sGNode.convertToWorldSpaceAR(i,cc.v2(0,0)),n.init(a,t,e,o)},null)},A.prototype.getName=function(t,e){return this._getNameString(t,e)},A.prototype._getNameString=function(t,e){switch(t){case _.eRewardType.buildingUpgradePoint:case _.eRewardType.cardUpgradePoint:case _.eRewardType.pullCardPoint:case _.eRewardType.actionPoint:case _.eRewardType.vipExp:case _.eRewardType.questToken:var o=u.sCurrencyConfig.getEntry(_.eRewardType[t]);return o?p.i18n.t(o.name):"";case _.eRewardType.card:return(i=c.sCardConfig.getEntry(e))?p.i18n.t(i.name):"";case _.eRewardType.cardFragment:case _.eRewardType.card2Fragment:var i;return(i=c.sCardConfig.getEntry(e))?p.i18n.t("reward.cardFragment").replace("${cardName}",p.i18n.t(i.name)):"";case _.eRewardType.buildingUpgradePointOverTime:return p.i18n.t(u.sCurrencyConfig.config.buildingUpgradePoint.name)}return p.i18n.t(_.eRewardType[t])},A.prototype.getCount=function(t,e){switch(t){case _.eRewardType.buildingUpgradePoint:case _.eRewardType.cardUpgradePoint:case _.eRewardType.pullCardPoint:case _.eRewardType.actionPoint:case _.eRewardType.vipExp:case _.eRewardType.questToken:return"x"+y.sGNumber.toHuman(e);case _.eRewardType.cardFragment:case _.eRewardType.card:case _.eRewardType.card2Fragment:case _.eRewardType.randomCard:case _.eRewardType.randomCardFragment:return"x"+y.sGNumber.toHuman(e);case _.eRewardType.buildingUpgradePointOverTime:return e%60==0?p.i18n.t("reward.buildingUpgradePointOverMins").replace("${mins}",(e/60).toString()):p.i18n.t("reward.buildingUpgradePointOverSecs").replace("${secs}",e.toString())}return""},A.prototype.getIcon=function(t,e,o){switch(void 0===o&&(o=l.bigIcon),t){case _.eRewardType.buildingUpgradePoint:case _.eRewardType.cardUpgradePoint:case _.eRewardType.pullCardPoint:case _.eRewardType.actionPoint:case _.eRewardType.vipExp:case _.eRewardType.questToken:var i=u.sCurrencyConfig.getEntry(_.eRewardType[t]);return i?i[l[o]]:"";case _.eRewardType.cardFragment:case _.eRewardType.card:case _.eRewardType.card2Fragment:case _.eRewardType.randomCard:case _.eRewardType.randomCardFragment:return(i=c.sCardConfig.getEntry(e))?i.icon:"";case _.eRewardType.activeDoubleSpeed:return s.sConstConfig.config.doubleSpeedIcon;case _.eRewardType.activeSweep:return s.sConstConfig.config.sweepIcon;case _.eRewardType.buildingUpgradePointOverTime:return u.sCurrencyConfig.config.buildingUpgradePoint[l[o]]}return _.eRewardType[t]},A.prototype.isFragment=function(t){switch(t){case _.eRewardType.cardFragment:case _.eRewardType.card:case _.eRewardType.card2Fragment:case _.eRewardType.randomCard:case _.eRewardType.randomCardFragment:return!0}return!1},A.prototype.getQuality=function(t,e){switch(t){case _.eRewardType.buildingUpgradePoint:case _.eRewardType.cardUpgradePoint:case _.eRewardType.pullCardPoint:case _.eRewardType.actionPoint:case _.eRewardType.vipExp:case _.eRewardType.questToken:return 1;case _.eRewardType.cardFragment:case _.eRewardType.card:case _.eRewardType.card2Fragment:case _.eRewardType.randomCard:case _.eRewardType.randomCardFragment:var o=c.sCardConfig.getEntry(e);return o?o.quality:1;case _.eRewardType.activeDoubleSpeed:case _.eRewardType.activeSweep:return 1}return 1},A.prototype.openRewardCurrency=function(t,e,o){f.sGUI.openDialogUI(b.GameDefine.prefabCurrencyReward,function(i){i&&i.getComponent(C.default).init(t,e,function(){o&&o()})},this)},A.prototype.getQualityColor=function(t){return t<w.length?w[t]:w[0]},r=A,n.VMReward=r,cc._RF.pop()},{}],vm_skill:[function(t,e,o){"use strict";cc._RF.push(e,"b3d33X+ItdDpZBGwphVd/qG","vm_skill");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMSkill=void 0;var l,c=a("i18n"),s=a("ggame"),u=a("gmodule"),d=a("local_skill");function p(){return null!==l&&l.apply(this,arguments)||this}r(p,l=u.GModule),p.prototype.getDesc=function(t){return t=s.sGGame.localModel.getModule(d.LocalSkillPackage).getSkill(t),c.i18n.t(t.entry.desc).replace("${value1}",t.getAttr1()+"").replace("${value2}",t.getAttr2()+"").replace("${value3}",t.getAttr3()+"")},r=p,n.VMSkill=r,cc._RF.pop()},{}],vm_slot_machine:[function(t,e,o){"use strict";cc._RF.push(e,"4f102A8o8VM1bZXyeERZAIK","vm_slot_machine");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMSlotMachine=void 0;var l,c=a("gui"),s=a("ggame"),u=a("gmodule"),d=a("game_define"),p=a("local_reward_slot_machine");function f(){return null!==l&&l.apply(this,arguments)||this}r(f,l=u.GModule),f.prototype.openSlotMachine=function(){c.sGUI.openDialogUI(d.GameDefine.prefabSlotMachine)},f.prototype.canShow=function(){return 0<s.sGGame.localModel.getModule(p.default).maxTurnTableTimes},r=f,n.VMSlotMachine=r,cc._RF.pop()},{}],vm_store:[function(t,e,o){"use strict";cc._RF.push(e,"dc395wzG7pCjb+SP3cJfQsd","vm_store");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMStore=void 0;var l,c=a("local_store"),s=a("vm_reward"),u=a("vm_encourage"),d=a("encourage_config"),p=a("store_goods_config"),f=a("gui"),h=a("ggame"),g=a("gmodule"),y=a("gview_model"),m=a("vm_ui"),b=a("local_stage"),_=a("const_config");function v(){var t=null!==l&&l.apply(this,arguments)||this;return t.vipInAppID="vip",t.freeAdInAppID="freeAd",t}r(v,l=g.GModule),v.prototype.start=function(){h.sGGame.on(c.sLocalStoreEvent.buyGoods,function(t,e){y.sGViewModel.getModule(s.VMReward).openRewardResult(e.rewardList)},this)},v.prototype.stop=function(){h.sGGame.targetOff(this)},v.prototype.buyGoods=function(t){var e,o=h.sGGame.localModel.getModule(c.default),i=o.getPlacement(t);!i||(e=p.sStoreGoodsConfig.getEntry(i.goodsID))&&(0==(t=o.checkBuyGoods(t))?c.ePayType[e.payType]===c.ePayType.ad?this._buyGoodsByAd(i,e):c.ePayType[e.payType]===c.ePayType.rmb||o.buyGoods(i.cid):t===c.eStoreError.notEnoughGems&&y.sGViewModel.getModule(m.VMUI).openNotEnoughGem())},v.prototype._buyGoodsByAd=function(t,e){var o=d.sEncourageConfig.getEntry(e.encourageID),i=y.sGViewModel.getModule(u.VMEncourage).preEncourage(o),a=h.sGGame.localModel.getModule(c.default);y.sGViewModel.getModule(u.VMEncourage).encourage(o,i,function(){a.buyGoodsComplete(t,e)})},v.prototype.manualRefresh=function(){var t=h.sGGame.localModel.getModule(c.default).manualRefresh();t&&1===t&&y.sGViewModel.getModule(m.VMUI).openNotEnoughGem()},v.prototype.checkAnyThingToDo=function(){return h.sGGame.localModel.getModule(c.default).checkBuyGoods(101)?1:0},v.prototype.canShowButton=function(){return h.sGGame.localModel.getModule(b.LocalStage).isSystemIsOpened(_.sConstConfig.config.storeUnlockStage)},v.prototype.openStoreUI=function(){f.sGUI.openDialogUI("prefabs/ui/shop_bottom")},r=v,n.VMStore=r,cc._RF.pop()},{}],vm_vip:[function(t,e,o){"use strict";cc._RF.push(e,"a8ca8oXprZBGpJISDQHyMXc","vm_vip");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(n,"__esModule",{value:!0}),n.VMVIP=void 0;var l,c=a("vm_guide"),s=a("audio_config"),u=a("const_config"),d=a("gui"),p=a("gaudio"),f=a("ggame"),h=a("gmodule"),g=a("gview_model"),y=a("local_stage"),m=a("local_reward_slot_machine"),b=a("local_vip"),_=a("local_building");function v(){var t=null!==l&&l.apply(this,arguments)||this;return t._isAutoPopStarted=!1,t._isCheckinAdFinished=!1,t}r(v,l=h.GModule),Object.defineProperty(v.prototype,"isCheckinAdFinished",{get:function(){return this._isCheckinAdFinished},enumerable:!1,configurable:!0}),v.prototype.canShowPopUI=function(){return!(!f.sGGame.localModel.getModule(y.LocalStage).isSystemIsOpened(u.sConstConfig.config.checkInPopUnlockStage)||f.sGGame.localModel.getModule(b.LocalVIP).isADVIPCollected()||g.sGViewModel.getModule(c.VMGuide).isGuideOpened()||d.sGUI.hasDialog())},v.prototype.isInMain=function(){var t=d.sGUI.getTopName();return"map_home_bottom"==t||"world_map"==t},v.prototype._tryShowPopUI=function(){!this._isAutoPopStarted&&this.isInMain()&&!d.sGUI.isLoading()&&this.canShowPopUI()&&(this._isAutoPopStarted=!0,this.openVIPFirstRewardUI())},v.prototype.start=function(){f.sGGame.on(b.sLocalVIPEvent.levelChanged,function(){d.sGUI.openDialogUI("prefabs/ui/vip_upgrade_tips_pop")},this)},v.prototype.stop=function(){f.sGGame.targetOff(this)},v.prototype.update=function(){},v.prototype.openVIPFirstRewardUI=function(){p.sGAudio.playEffect(s.sAudioConfig.config.buttonClick),f.sGGame.localModel.getModule(b.LocalVIP).isADVIPCollected()||d.sGUI.openDialogUI("prefabs/ui/first_ad_reward_pop")},v.prototype.hasVIPReddot=function(){var t=f.sGGame.localModel.getModule(m.default),e=t.getRemainTimes();return 0<t.getRemainTimesToday()&&0<e&&!t.isAd()},v.prototype.canShowButton=function(){return f.sGGame.localModel.getModule(y.LocalStage).isSystemIsOpened(u.sConstConfig.config.checkInPopUnlockStage)||0<f.sGGame.localModel.getModule(b.LocalVIP).getCurrentLevel()},v.prototype.canShowFirstAdButton=function(){return!f.sGGame.localModel.getModule(b.LocalVIP).isADVIPCollected()&&f.sGGame.localModel.getModule(y.LocalStage).isSystemIsOpened(u.sConstConfig.config.checkInPopUnlockStage)},v.prototype.canShowDoubleCollectButton=function(){var t=f.sGGame.localModel.getModule(_.LocalBuildingPackage).getDoubleCollectRemainTime();return f.sGGame.localModel.getModule(y.LocalStage).isSystemIsOpened(u.sConstConfig.config.checkInPopUnlockStage)&&t<=0},r=v,n.VMVIP=r,cc._RF.pop()},{}],world_battle_ui:[function(t,e,o){"use strict";cc._RF.push(e,"585bc/yG5tJTLZ3nrx0+UGM","world_battle_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("age_config"),u=a("const_config"),d=a("stage_config"),p=a("i18n"),f=a("gnode"),h=a("gnumber"),g=a("ggame"),y=a("gview_model"),m=a("local_building"),b=a("local_stage"),_=a("vm_battle"),v=a("vm_benefit"),C=a("world_map_age_ui"),P=(S=cc._decorator).ccclass,S=(a=S.property,S.menu);function G(){var t=null!==c&&c.apply(this,arguments)||this;return t.ageNameLabel=null,t.stageLabel=null,t.recommendBattleScoreLabel=null,t.lockSweepLabel=null,t.sweepButton=null,t.lockSweepNode=null,t.worldMapAgeRoot=null,t.leftButton=null,t.rightButton=null,t.worldMapAgeNode=null,t.currentPageAge=0,t.passTimeDt1=1,t}r(G,c=cc.Component),G.prototype.onLoad=function(){var t=this;this.sweepButton&&this.sweepButton.node.on("click",function(){t.onSweep()}),this.leftButton&&this.leftButton.node.on("click",this.onClickPreBattle,this),this.rightButton&&this.rightButton.node.on("click",this.onClickAfterBattle,this)},G.prototype.onEnable=function(){var t=this,e=g.sGGame.localModel.getModule(b.LocalStage),o=u.sConstConfig.config.unlockSweep,i=d.sStageConfig.getEntry(o),a=e.currentBattleStageEntry,n=a.age,r=e.currentPassStageEntry;this.stageLabel&&(this.stageLabel.string=a.name),this.recommendBattleScoreLabel&&(this.recommendBattleScoreLabel.string=h.sGNumber.toHuman(a.recommendBattleScore)),this.lockSweepLabel&&(o=d.sStageConfig.getEntry(o),this.lockSweepLabel.string=p.i18n.t("tip.unlockSweep").replace("${value}",o.name),this.lockSweepLabel.node.active=r.sortID<i.sortID),this.lockSweepNode&&(this.lockSweepNode.active=r.sortID<i.sortID),g.sGGame.on(b.sLocalStageEvent.activeSweep,function(){t.refreshSweepButton()},this),this.refreshSweepButton(),this.refreshBattlePage(n),e.isEnterNewAgeWorldMap&&(e.isEnterNewAgeWorldMap=!1)},G.prototype.onDisable=function(){f.sGNode.targetOff(this),g.sGGame.targetOff(this),this.worldMapAgeNode&&(f.sGNode.destoryNode(this.worldMapAgeNode),this.worldMapAgeNode=null)},G.prototype.refreshSweepButton=function(){this.sweepButton&&(this.sweepButton.node.active=g.sGGame.localModel.getModule(b.LocalStage).sweepEnabled)},G.prototype.update=function(t){var e;this.passTimeDt1+=t,1<this.passTimeDt1&&(this.passTimeDt1=0,t=(e=g.sGGame.localModel.getModule(b.LocalStage)).isSystemIsOpened(u.sConstConfig.config.unlockSweep),e.isSystemIsOpened(u.sConstConfig.config.checkInPopUnlockStage),this.lockSweepLabel&&(this.lockSweepLabel.node.active=!t),this.lockSweepNode&&(this.lockSweepNode.active=!t)),y.sGViewModel.getModule(v.VMBenefit).tryCompleteBenefit()},G.prototype.onSweep=function(){y.sGViewModel.getModule(_.VMBattle).openSweepUI()},G.prototype.onClickPreBattle=function(){1<this.currentPageAge&&this.refreshBattlePage(this.currentPageAge-1)},G.prototype.onClickAfterBattle=function(){this.currentPageAge<g.sGGame.localModel.getModule(m.LocalBuildingPackage).maxAge&&this.refreshBattlePage(this.currentPageAge+1)},G.prototype.refreshBattlePage=function(t){var e=this;this.currentPageAge=t;var o=s.sAgeConfig.getEntry(this.currentPageAge);g.sGGame.localModel.getModule(m.LocalBuildingPackage),this.ageNameLabel&&(this.ageNameLabel.string=p.i18n.t(o.name)),this.worldMapAgeNode&&(f.sGNode.destoryNode(this.worldMapAgeNode),this.worldMapAgeNode=null),f.sGNode.createNode(o.worldPrefab,function(t){t&&(t.getComponent(C.default).age=o.id,e.worldMapAgeNode=t,e.worldMapAgeRoot.addChild(e.worldMapAgeNode))},this),this.leftButton&&(this.leftButton.node.active=1<this.currentPageAge),this.rightButton&&(t=g.sGGame.localModel.getModule(b.LocalStage).currentBattleStageEntry.age,this.rightButton.node.active=this.currentPageAge<t,this.rightButton.interactable=this.currentPageAge<t)},l([a(cc.Label)],G.prototype,"ageNameLabel",void 0),l([a(cc.Label)],G.prototype,"stageLabel",void 0),l([a(cc.Label)],G.prototype,"recommendBattleScoreLabel",void 0),l([a(cc.Label)],G.prototype,"lockSweepLabel",void 0),l([a(cc.Button)],G.prototype,"sweepButton",void 0),l([a(cc.Node)],G.prototype,"lockSweepNode",void 0),l([a(cc.Node)],G.prototype,"worldMapAgeRoot",void 0),l([a(cc.Button)],G.prototype,"leftButton",void 0),l([a(cc.Button)],G.prototype,"rightButton",void 0),S=l([P,S("Game/UI/WorldBattleUI")],G),n.default=S,cc._RF.pop()},{}],world_map_age_ui:[function(t,e,o){"use strict";cc._RF.push(e,"42bfc6R78JNMKbUjKY1eIZM","world_map_age_ui");var i,a=t,n=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;0<=l;l--)(a=t[l])&&(r=(n<3?a(r):3<n?a(e,o,r):a(e,o))||r);return 3<n&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,s=a("stage_config"),u=a("gnode"),d=a("gtime"),p=a("ggame"),f=a("game_define"),h=a("local_stage"),g=a("treasure_chest_icon_ui"),y=(m=cc._decorator).ccclass,m=(a=m.property,m.menu);function b(){var t=null!==c&&c.apply(this,arguments)||this;return t.levelRoot=null,t.currentLevelShowNode=null,t.mapNode=null,t.posPrefab=null,t.nodeTouch=null,t.levelNodeArray=[],t.posNode=null,t.age=0,t._touchBeginTick=0,t._isMoving=!1,t._clickCallback=null,t}r(b,c=cc.Component),b.prototype.onLoad=function(){for(var t=1,e=1;;++e){var o=s.sStageConfig.getEntry(e);if(!o)break;if(o.age===this.age){t=e;break}}var i=p.sGGame.localModel.getModule(h.LocalStage).getCurrentPassStageID(),a=this;for(e=0;"break"!==function(e){var o=e+1,n=a.levelRoot.getChildByName("level_"+o);if(!n)return"break";a.levelNodeArray.push(n),n.zIndex=-o;var r=t+e;(e=s.sStageConfig.getEntry(r))&&e.hasTreasureChest&&i<r&&u.sGNode.createNode(f.GameDefine.prefabTreasureChestIcon,n,function(t){!t||(t=t.getComponent(g.default))&&t.init(r)},a)}(e);++e);this.nodeTouch=this.node,this.nodeTouch&&(this.nodeTouch.on(cc.Node.EventType.TOUCH_START,this._onTouchStart.bind(this)),this.nodeTouch.on(cc.Node.EventType.TOUCH_END,this._onTouchEnd.bind(this)),this.nodeTouch.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel.bind(this)),this.nodeTouch.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove.bind(this)))},b.prototype.onEnable=function(){this.refresh()},b.prototype.onDisable=function(){this.posNode&&(u.sGNode.destoryNode(this.posNode),this.posNode=null)},b.prototype.refresh=function(){var t=s.sStageConfig.getEntry(p.sGGame.localModel.getModule(h.LocalStage).getCurrentBattleStageID()),e=u.sGNode.convertToWorldSpaceAR(this.currentLevelShowNode.parent,this.currentLevelShowNode.getPosition()),o=u.sGNode.convertToNodeSpaceAR(this.mapNode.parent,e),i=0;t.age==this.age&&(i=t.agePosID-1),(e=this.levelNodeArray[i])&&(i=u.sGNode.convertToWorldSpaceAR(e.parent,e.getPosition()),o=u.sGNode.convertToNodeSpaceAR(this.mapNode.parent,i).y-o.y,0<(o=this.mapNode.y-o)?o=0:o<-this.mapNode.getContentSize().height&&(o=-this.mapNode.getContentSize().height),this.mapNode.setPosition(cc.v2(this.mapNode.x,o)),t.age==this.age&&(this.posPrefab&&(this.posNode=cc.instantiate(this.posPrefab)),this.posNode&&(this.posNode.parent=e)))},b.prototype.init=function(t){this._clickCallback=t},b.prototype._onTouchStart=function(t){this._isMoving=!1,this._lastTouchPos=t.getLocation(),this._touchBeginTick=d.sGTime.timestamp()},b.prototype._onTouchMove=function(t){var e,o,i;this._lastTouchPos&&(i=(e=t.getLocation()).sub(this._lastTouchPos),!this._isMoving&&100<i.magSqr()&&(this._isMoving=!0),this._isMoving&&(o=(d.sGTime.timestamp()-this._touchBeginTick)/1e3,this._fadeSpeed=o<1e-5?t.getDelta().normalize().mul(100):t.getDelta().div(o),this._fadeSpeed.negSelf(),this._lastTouchPos=e,0<(i=this.mapNode.y+i.y)?i=0:i<-this.mapNode.getContentSize().height&&(i=-this.mapNode.getContentSize().height),this.mapNode.setPosition(cc.v2(this.mapNode.x,i))))},b.prototype._onTouchEnd=function(){var t;this._isMoving||(t=cc.v2(),this._clickCallback&&this._clickCallback(t)),this._touchFinish()},b.prototype._onTouchCancel=function(){this._touchFinish()},b.prototype._touchFinish=function(){this._lastTouchPos&&(this._fadeSpeed=void 0,this._lastTouchPos=void 0,this._isMoving=!1)},l([a({displayName:"\u5173\u5361\u6839\u8282\u70b9",type:cc.Node})],b.prototype,"levelRoot",void 0),l([a({displayName:"\u5f53\u524d\u5173\u5361\u4f4d\u7f6e",type:cc.Node})],b.prototype,"currentLevelShowNode",void 0),l([a({displayName:"\u5730\u56fe\u8282\u70b9",type:cc.Node})],b.prototype,"mapNode",void 0),l([a({displayName:"\u4f4d\u7f6e\u70b9\u9884\u5236\u4ef6",type:cc.Prefab})],b.prototype,"posPrefab",void 0),m=l([y,m("Game/Battle/WorldMapUI")],b),n.default=m,cc._RF.pop()},{}]},{},["action_point_recover_time_ui","ad_reward_collect_ui","add_action_point_button_root_ui","add_action_point_ui","age_background","age_info_button_root","age_node","age_sprite","age_sprite_editor_test","age_upgrade_effect_ui","age_upgrade_tip_ui","age_upgrade_ui","attribute_slot","attribute_system","battle_building_health_ui","battle_building_icon_ui","battle_bullet","battle_bullet_linear","battle_bullet_point","battle_damage_number","battle_debug_button_root","battle_debug_ui","battle_defeat_ui","battle_define","battle_exit_button_root","battle_icon_manager","battle_manager","battle_manager_lock_zone","battle_manager_mode_base","battle_manager_mode_fuben","battle_manager_mode_pata","battle_manager_mode_stage","battle_manager_spawner","battle_monitor_ui","battle_particle","battle_skill_arrow","battle_skill_cannon","battle_skill_earthquake","battle_skill_earthquake_bullet","battle_skill_panel_icon","battle_skill_plane","battle_skill_plane_bullet","battle_skill_stone","battle_skill_stone_bullet","battle_skill_summon","battle_skill_tank","battle_skill_tonecastn","battle_skill_tonecastn_bullet","battle_skill_tornado","battle_skill_tornado_bullet","battle_skill_tsunami","battle_soldier_icon_ui","battle_soldier_progress_tip_ui","battle_start_buff_status_ui","battle_start_buff_ui","battle_start_button_root","battle_start_ui","battle_sweep_result_ui","battle_sweep_ui","battle_victory_card_ui","battle_victory_ui","beginning_ui","benefit_ui","building_avatar_all","building_avatar_ui","building_base","building_simple_all","building_simple_ui","building_unlock_ui","building_upgrade_button_ui","building_upgrade_ui","card_button_ui","card_equip_skill_package_icon_ui","card_equip_skill_top_icon_ui","card_equip_skill_ui","card_equip_soldier_package_icon_ui","card_equip_soldier_top_icon_ui","card_equip_soldier_ui","card_hero_info_ui","card_icon_ui","card_library_icon_ui","card_library_ui","card_package_tab_skill_ui","card_package_tab_soldier_ui","card_package_tab_ui","card_skill_equip_simple_ui","card_skill_info_ui","card_soldier_equip_simple_ui","card_tab_free_pull_card_ui","card_tab_package_cell_ui","card_tab_package_ui","card_tab_pakcage_equip_icon_ui","card_tab_pull_card_ui","card_tips_ui","card_ui","check_in_7days_ad_ui","check_in_7days_ui","check_in_daily_ui","check_in_ui","checkin_beginner_day_icon_ui","checkin_beginner_ui","checkin_button","client_template","currency_reward_ui","currency_ui","double_collect_button_root","double_collect_ui","encourage_close_button_ui","fuben_battle_monitor_ui","fuben_button_root_ui","fuben_main_type_ui","fuben_victory_ui","game_currency_ui","game_define","game_init","game_recorder_open","game_recorder_ui","info_ui","local_action","local_attribute","local_battle","local_battle_fuben","local_battle_pata","local_battle_stage","local_benefits","local_building","local_card","local_check_in_7day","local_check_in_daily","local_checkin_beginner","local_config","local_debug","local_fuben","local_pata","local_quest","local_quest_achievement","local_quest_activity","local_quest_condition","local_quest_daily","local_quest_event","local_quest_main","local_quest_stage","local_quest_stat","local_reward","local_reward_slot_machine","local_skill","local_soldier","local_stage","local_store","local_tech","local_template","local_vip","main_home_bottom_ui","main_home_function_ui","main_home_ui","main_tab_ui","main_ui","map_background_hscroll","map_background_parallax_layer","map_background_vscroll","map_camera","map_define","map_manager","map_scrollview","move_man","move_object","new_world_map_tip_ui","offline_reward_ui","pata_battle_monitor_ui","pata_battle_victory_ui","pata_buff_history_icon_ui","pata_buff_history_ui","pata_buff_stat_cell_ui","pata_buff_stat_ui","pata_buff_tab_ui","pata_button_root_ui","pata_enemy_soldier_icon_ui","pata_enemy_soldier_ui","pata_main_player_soldier_icon_ui","pata_main_ui","pata_reset_ui","pata_reward_icon_ui","pata_reward_ui","pata_soldier_setting_ui","promote_tip_ui","pull_card_times_box_ui","quest_achievement_cell_ui","quest_achievement_ui","quest_button_ui","quest_daily_cell_ui","quest_daily_ui","quest_main_complete_ui","quest_main_pop_ui","quest_main_ui","quest_root_ui","quest_token_reward_ui","reason_define","reward_card10_icon_ui","reward_card10_ui","reward_currency_ui","reward_ui","setting_ui","slot_machine_button_ui","slot_machine_icon_ui","slot_machine_ui","soldier","soldier_info_ui","store_button_root_ui","store_placement_201_ui","store_placement_pop_ui","store_placement_ui","store_ui","tech_air_drop_button_root","tech_air_drop_ui","template_scroll_view_cell_ui","template_scroll_view_ui","test_button_ui","test_button_ui2","test_button_ui3","test_button_ui4","test_ui","treasure_chest_button_ui","treasure_chest_icon_ui","treasure_chest_preview_ui","treasure_chest_reward_ui","unit","unit_attribute","unit_health","unit_health_ui","unit_movement","unit_search","unit_shield_package","unit_skill_buff_package","unit_skill_effect","unit_skill_package","vip_button_root_ui","vip_button_ui","vip_first_ad_reward_button_root_ui","vip_first_ad_reward_ui","vip_ui","vip_upgrade_tip_ui","vm_attribute","vm_audio","vm_battle","vm_benefit","vm_building","vm_card","vm_channel","vm_check_in","vm_check_in_7days","vm_check_in_daily","vm_game","vm_game_guide","vm_game_recorder","vm_notification","vm_quest","vm_reward","vm_skill","vm_slot_machine","vm_store","vm_vip","world_battle_ui","world_map_age_ui"]);